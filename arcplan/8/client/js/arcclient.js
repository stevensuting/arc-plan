/*!
 * jQuery outside events - v1.1 - 3/16/2010
 * http://benalman.com/projects/jquery-outside-events-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
define("clienttype",[],function(){var a={E_HTML5CLIENT:1004,E_HTML5MOBILECLIENT:1005,E_HTML5LOGONCLIENT:1006};return a}),define("propertybuilder",[],function(){var a={};return a.buildProperties=function(a,b,c,d,e,f){var g=0,h=a.length,i,j,k,l,m,n,o=new RegExp("^[a-z|A-Z|0-9]*$");for(g=0;g<h;g+=1){m=a[g],n=m.property;if(o.test(n))j=m.prefix?m.prefix:"get",j+=n,i="set"+n,k="has"+n+"Changed",l="set"+n+"Changed",b[j]=d(n),b[i]=c(n),b[k]=f(n),b[l]=e(n),m.equalsMethod&&(b["are"+n+"sEqual"]=m.equalsMethod);else throw"No special characters allowed in property names."}},a}),define("keycodes",{Backspace:8,Tab:9,Enter:13,Shift:16,ESC:27,UpArrow:38,DownArrow:40,LeftArrow:37,RightArrow:39,Space:32,Semicolon:186,Equals:187,Slash:191,Point:190,Dash:189,DecimalPoint:110,Minus:109,Divide:111,OpenBracket:219,CloseBracket:221,PageUp:33,PageDown:34,End:35,Pos1:36,Delete:46}),define("assert/assert",[],function(){return function(a,b){if(!a)throw b=b||"Assertion failed",new Error(b)}}),define("arcplanobjects/objectcontainertools",["assert/assert"],function(a){return{positionToZIndex:function(b){return a(typeof b=="string"),(parseInt(b,10)+1)*10}}}),define("components/datatranslators/taborderhelper",["assert/assert"],function(a){var b={};return b.c_defaultBaseTabIndex=500,b.translateTabOrder=function(c,d,e){a(typeof d=="object");var f,g;return c===!1?-1:(f=d.TabOrder,typeof f!="object"?undefined:typeof f.Value!="string"?undefined:(g=parseInt(f.Value,10),g<=0||e===!0?g:ARCPLAN.baseTabIndex===undefined?g+b.c_defaultBaseTabIndex:g+parseInt(ARCPLAN.baseTabIndex,10)))},b}),define("arcplanobjects/containerfactory",["assert/assert","arcplanobjects/objectcontainertools","components/datatranslators/taborderhelper"],function(a,b,c){function d(a){return typeof a=="string"?b.positionToZIndex(a):0}function e(b,e,f,g){function o(a){var d=a.BaseProperties,e=parseInt(d.Width.Value,10),f=parseInt(d.Height.Value,10),g;return g={isVisible:e>0&&f>0,left:Math.abs(parseInt(d.Position.XPos,10)),top:Math.abs(parseInt(d.Position.YPos,10)),width:Math.abs(e),height:Math.abs(f),isAvailableInView:d.ViewAvailability==="true",hasChanged:!0},typeof d.Layout=="string"&&(g.layoutBehavior=parseInt(d.Layout,10)),typeof a.ObjectProperties=="object"?g.isObjectActive=a.ObjectProperties.SelectionEnabled==="true":typeof h=="object"?g.isObjectActive=h.isObjectActive:g.isObjectActive=!0,g.tabOrder=c.translateTabOrder(g.isObjectActive,a.BaseProperties,b.isDialog()),g}function p(){var a="z-index: "+j+";"+"left: "+h.left+"px;"+"top: "+h.top+"px;"+"width: "+h.width+"px;"+"height: "+h.height+"px";n.attr("style",a),h.hasChanged=!1}function q(){g?h.hasChanged=!0:(p(),h.hasChanged=!1)}function r(){h.isAvailableInView===!1?n.css("display","none"):n.css("display","")}function s(a){if(a.width!==i.width||a.height!==i.height||a.left!==i.left||a.top!==i.top||a.isVisible!==i.isVisible)i.left=a.left,i.top=a.top,i.width=a.width,i.height=a.height,i.isVisible=a.isVisible,b.isLayoutManaged()||(h.left=a.left,h.top=a.top,h.width=a.width,h.height=a.height),h.isVisible=a.isVisible,q()}function t(a){f===!0&&a.tabOrder!==h.tabOrder&&(h.tabOrder=a.tabOrder,n.attr("tabindex",h.tabOrder))}a(typeof b=="object"),a(typeof e=="object"),a(typeof e.BaseProperties=="object"),a(typeof f=="boolean");var h,i,j=d(e.Position),k=!1,l,m,n=$('<div class="arcComponentContainer" />');return h=o(e),i=o(e),q(),r(),f===!1?n.attr("tabindex","-1"):n.attr("tabindex",h.tabOrder),{$container:n,isAvailableInView:function(){return h.isAvailableInView},isVisible:function(){return h.isVisible},getXPos:function(){return h.left},getYPos:function(){return h.top},getWidth:function(){return h.width},getHeight:function(){return h.height},getOrigXPos:function(){return i.left},getOrigYPos:function(){return i.top},getOrigWidth:function(){return i.width},getOrigHeight:function(){return i.height},setXPos:function(a){a!==h.left&&(h.left=a,q())},setYPos:function(a){a!==h.top&&(h.top=a,q())},setWidth:function(a){a!==h.width&&(h.width=a,typeof m=="function"&&m(h.width,h.height),q())},setHeight:function(a){a!==h.height&&(h.height=a,typeof m=="function"&&m(h.width,h.height),q())},getLayoutBehavior:function(){return h.layoutBehavior},isResizeable:function(){return k},setResizeable:function(a){k=a},moveToOriginalPosition:function(){var a=i.width!==h.width||i.height!==h.height,b=i.left!==h.left||i.top!==h.top;h.left=i.left,h.top=i.top,h.width=i.width,h.height=i.height,h.isVisible=i.isVisible,(b||a)&&q(),a===!0&&typeof m=="function"&&m(h.width,h.height)},update:function(a){var b=o(a);s(b),t(b),typeof b.layoutBehavior!="undefined"&&(h.layoutBehavior=b.layoutBehavior)},resetForViewChange:function(b,c){var d,e;b.ViewAvailability==="false"?(h.isAvailableInView=!1,g||n.css("display","none")):(h.isAvailableInView=!0,a(typeof h.isObjectActive=="boolean"),e={BaseProperties:b},d=o(e),s(d),t(d),typeof l=="function"&&l(b,c),g||n.css("display",""))},applyScrollBars:function(){},applyHierProperties:function(){},applyTableRowHeight:function(){},adjustToContentIfNecessary:function(){},registerSizeChangedCallback:function(a){m=a},registerResponsiveDesignViewChangedCallback:function(a){l=a},render:function(){h.hasChanged&&p(),r()}}}return{createObjectContainer:e}}),define("datavirtualization/celltypes",{EText:1,ETextLink:2,EImage:3,EImageLink:4,EHtml:5,ENumber:6}),define("components/cssgenerators/backgroundcolorcssgenerator",[],function(){var a={};return a.createCss=function(a){var b="";return typeof a=="object"&&typeof a.color1=="string"&&(b+="background-color:"+a.color1+";"),b},a}),define("components/cssgenerators/backgroundimagecssgenerator",[],function(){var a={};return a.createCss=function(a){var b="";if(typeof a=="object"){typeof a.url=="string"&&(b+="background-image:url("+a.url+");");if(typeof a.mode=="string")switch(a.mode){case"Zoom":b+="background-repeat:no-repeat;",b+="background-size:100% 100%;";break;case"Center":b+="background-repeat:no-repeat;",b+="background-position:50% 50%;";break;case"Tile":b+="background-repeat:repeat;"}}return b},a}),define("components/cssgenerators/fontcssgenerator",[],function(){var a={};return a.createCss=function(a){var b="";return typeof a=="object"&&(typeof a.fontFamily=="string"&&(b+="font-family:"+a.fontFamily+";"),typeof a.fontSize=="string"&&(b+="font-size:"+a.fontSize+";"),typeof a.fontWeight=="string"&&(b+="font-weight:"+a.fontWeight+";"),typeof a.fontStyle=="string"&&(b+="font-style:"+a.fontStyle+";"),typeof a.lineHeight=="string"&&(b+="line-height:"+a.lineHeight+";"),typeof a.textDecoration=="string"&&(b+="text-decoration:"+a.textDecoration+";")),b},a}),define("components/cssgenerators/fontcolorcssgenerator",[],function(){var a={};return a.createCss=function(a){var b="";return typeof a=="object"&&typeof a.color=="string"&&(b+="color:"+a.color+";"),b},a}),define("components/cssgenerators/horizontalalignmentcssgenerator",[],function(){var a={};return a.createCss=function(a){var b="";return typeof a=="object"&&typeof a.horizontalAlign=="string"&&(b+="text-align:"+a.horizontalAlign+";"),b},a}),define("components/cssgenerators/verticalalignmentcssgenerator",[],function(){var a={};return a.createCss=function(a){var b="";return typeof a=="object"&&typeof a.verticalAlign=="string"&&(b+="vertical-align:"+a.verticalAlign+";"),b},a}),define("components/cssgenerators/wordwrapcssgenerator",[],function(){var a={};return a.createCss=function(a){var b="";return typeof a=="object"&&typeof a.isMultiline=="boolean"&&(a.isMultiline?b="white-space:pre-wrap;":b="white-space:pre;"),b},a}),define("components/common/contentsizecalculator",[],function(){function b(a,b){var c;return typeof a=="object"&&(c=a.width,typeof b=="object"&&(typeof b.left=="number"&&(c-=b.left),typeof b.right=="number"&&(c-=b.right))),c}function c(a,b){var c;return typeof a=="object"&&(c=a.height,typeof b=="object"&&(typeof b.top=="number"&&(c-=b.top),typeof b.bottom=="number"&&(c-=b.bottom))),c}var a={};return a.getContentSize=function(a,d){var e=b(a,d),f=c(a,d),g={};return typeof e=="number"&&(g.width=e),typeof f=="number"&&(g.height=f),g},a.getCellContentSize=function(a,b,c){var d={width:a.width,height:a.height};return b&&(d.width-=b.left+b.right,d.height-=b.top+b.bottom),c&&(d.width-=c.left+c.right,d.height-=c.top+c.bottom),d},a}),define("components/cssgenerators/sizecssgenerator",["components/common/contentsizecalculator"],function(a){var b={};return b.createCss=function(b,c){var d="",e=a.getContentSize(b,c);return typeof e=="object"&&(typeof e.width=="number"&&(d+="width:"+e.width+"px;"),typeof e.height=="number"&&(d+="height:"+e.height+"px;")),d},b}),define("tooltip",[],function(){var a={},b=2;return a.toolTipStringForObject=function(a){return a.Elements[b]&&a.Elements[b].ToolTip?a.Elements[b].ToolTip:""},a.toolTipStringForRow=function(a,c){var d=b+c;return a.Elements[d]&&a.Elements[d].ToolTip?a.Elements[d].ToolTip:""},a.toolTipStringForColumn=function(a,c){var d=b+c;return a.Elements[d]&&a.Elements[d].ToolTip?a.Elements[d].ToolTip:""},a.toolTipStringForCell=function(a,c,d){var e=b+(c*a.Elements[0].NumCols+d);return a.Elements[e]&&a.Elements[e].ToolTip?a.Elements[e].ToolTip:""},a}),define("dmfieldtypes",[],function(){var a={VEmpty:"0",VDouble:"1",VChar:"2",VTime:"5",VImage:"6",VError:"11",VBlob:"12",VSAP:"20",VRTF:"22",VLink:"28",VEnterprise:"32",VEmfDib:"35",VMetadata:"38",VHTML:"39"};return a}),define("components/common/dataobjects",["assert/assert"],function(a){function c(a){return typeof a=="number"&&isNaN(a)}function d(d,e,f,g){var h=typeof d[f];a(h!=="function"),a(!c(d[f])),a(!c(e[f]));if(f!=="imageUrl"&&f!=="text"||g){if(h==="object")return b.areEqual(d[f],e[f]);if(e[f]!==d[f])return!1}return!0}var b={};return b.areEqual=function(a,b){var c,e,f,g;return a===null||b===null?a===b?!0:!1:(c=Object.keys(a),e=Object.keys(b),f=!0,g=!0,typeof a.hash=="string"&&(g=!1),c.forEach(function(c){f=f&&d(a,b,c,g)}),f?(e.forEach(function(c){f=f&&d(a,b,c,g)}),f):!1)},b.update=function(c,d,e){var f=!1;return a(typeof c=="object"),a(typeof c[d]=="object"),f=!b.areEqual(c[d],e),f?(c[d]=e,!0):!1},b}),define("components/datatranslators/celldatatranslator",["dmfieldtypes","datavirtualization/celltypes","components/common/dataobjects","assert/assert"],function(a,b,c,d){function f(a,b){a.RowSpan&&(b.rowSpan=parseInt(a.RowSpan,10)),a.ColSpan&&(b.colSpan=parseInt(a.ColSpan,10)),a.PrimaryRow&&(b.primaryRow=parseInt(a.PrimaryRow,10)),a.PrimaryCol&&(b.primaryCol=parseInt(a.PrimaryCol,10)),a.RemainRowSpan&&(b.remainRowSpan=parseInt(a.RemainRowSpan,10)),a.RemainColSpan&&(b.remainColSpan=parseInt(a.RemainColSpan,10))}function g(a,b){var c="data:image/"+a+";base64,"+b;return c}function h(a,c){c.type=b.ENumber,c.text=a.value,c.unformatted=a.Data,c.decimalSeparator=a.DecimalSeparator}function i(a,c){c.type=b.EText,c.text=a.value,c.unformatted=a.Data}function j(a,c){c.type=b.EHtml,c.htmlSource=a.HtmlSource||a.value}function k(a,c){c.type=b.ETextLink,c.text=a.value,c.url=a.URL}function l(a,c,e,f){var h;c.type=b.EImageLink,d(typeof a.Width=="string"),d(typeof a.Height=="string"),c.width=parseInt(a.Width,10),c.height=parseInt(a.Height,10),a.Image?(h=g(a.ImageType,a.Image),c.imageUrl=h,c.url=a.URL):(c.hash=a.hash,c.url=a.URL,a.hash&&(c.text="",e.loadImageForHash(a.hash,function(a){delete c.text,c.imageUrl=a,typeof f=="function"&&f()})))}function m(a,c,e,f){var h;c.type=b.EImage,d(typeof a.Width=="string"),d(typeof a.Height=="string"),c.width=parseInt(a.Width,10),c.height=parseInt(a.Height,10),a.Image?(h=g(a.ImageType,a.Image),c.imageUrl=h):(c.hash=a.hash,a.hash&&(c.text="",e.loadImageForHash(a.hash,function(a){delete c.text,c.imageUrl=a,typeof f=="function"&&f()})))}var e={};return e.create=function(c,e,g){var n={};d(typeof e=="object","imageLoader must be an object"),d(typeof c=="object");if(c===null)n.type=b.EText,n.text="";else{d(c.Type!==undefined);switch(c.Type){case a.VDouble:h(c,n);break;case a.VEmpty:case a.VChar:case a.VTime:case a.VError:case a.VSAP:case a.VEnterprise:case a.VMetadata:i(c,n);break;case a.VLink:typeof c.value=="string"?k(c,n):l(c,n,e,g);break;case a.VHTML:j(c,n);break;case a.VRTF:case a.VBlob:typeof c.value=="string"?i(c,n):m(c,n,e,g);break;case a.VImage:case a.VEmfDib:m(c,n,e,g)}f(c,n)}return n},e.update=function(a,b,f,g,h){d(typeof a=="object"),d(typeof a[b]=="object");var i,j,k={loadImageForHash:function(a,b){d(typeof j=="undefined","only expect one image per cell"),j={hash:a,callback:b}}};return typeof f!="object"?!1:(i=e.create(f,k,h),c.areEqual(a[b],i)?!1:(typeof j=="object"&&i.hash!==a[b].hash&&g.loadImageForHash(j.hash,j.callback),a[b]=i,!0))},e}),define("components/datatranslators/activedatatranslator",["assert/assert","components/common/dataobjects"],function(a,b){var c={};return c.create=function(b,c){var d;return a(typeof c=="object"),a(typeof c.ObjectProperties=="object"),c.ObjectProperties.SelectionEnabled==="true"?d=!0:c.ObjectProperties.SelectionEnabled==="false"&&(d=!1),{isActive:d}},c}),define("components/datatranslators/alignmenthelper",[],function(){var a={};return a.translateVerticalAlignment=function(a){switch(a){case"101":return"middle";case"301":return"bottom";case"401":return"top";default:return"middle"}},a.translateHorizontalAlignment=function(a){switch(a){case"-1":return"left";case"0":return"center";case"1":return"right";default:return"left"}},a}),define("components/datatranslators/alignmentdatatranslator",["assert/assert","components/datatranslators/alignmenthelper","components/common/dataobjects"],function(a,b,c){var d={};return d.create=function(c,d){var e,f={};return a(typeof d=="object"),a(typeof d.ObjectProperties=="object"),e=d.ObjectProperties,typeof e.VerticalAlignment=="object"&&(f.verticalAlign=b.translateVerticalAlignment(e.VerticalAlignment.Value),a(typeof f.verticalAlign=="string","unknown value: "+e.VerticalAlignment.Value+" for VerticalAlignment")),typeof e.HorizontalAlignment=="object"&&(f.horizontalAlign=b.translateHorizontalAlignment(e.HorizontalAlignment.Value),a(typeof f.horizontalAlign=="string","unknown value: "+e.HorizontalAlignment.Value+" for HorizontalAlignment")),f},d}),define("components/datatranslators/backgroundcolordatatranslator",["assert/assert","components/common/dataobjects"],function(a,b){var c={};return c.create=function(b,c){var d,e={};return a(typeof c=="object"),a(typeof c.ObjectProperties=="object"),d=c.ObjectProperties,typeof d.BackgroundColor=="object"&&(d.BackgroundColor.Transparency==="true"?e.color1="rgba(255,255,255,0.0)":e.color1=d.BackgroundColor.TrueColor1,e.color2=d.BackgroundColor.TrueColor2),e},c}),define("components/datatranslators/backgroundimagedatatranslator",["assert/assert"],function(a){function c(b){var c={};return a(typeof b=="object"),typeof b.Pattern=="object"&&(c.hash=b.Pattern.ImageReference,typeof b.Pattern.PatternFormat=="object"&&(c.mode=b.Pattern.PatternFormat.Format)),c}function d(a,b,c){typeof a.hash=="string"&&b.loadImageForHash(a.hash,function(b){a.url=b,c()})}var b={};return b.create=function(b,e,f,g){a(typeof e=="object"),a(typeof e.ObjectProperties=="object");var h=c(e.ObjectProperties);return d(h,f,g),h},b.update=function(a,b,e,f,g,h){var i,j=!1;return typeof f.ObjectProperties!="object"?!1:(i=c(f.ObjectProperties),i.mode!==a[b].mode&&(j=!0),i.hash!==a[b].hash&&(d(i,g,h),j=!0),j===!0&&(a[b]=i),j)},b}),define("components/datatranslators/foregroundcolordatatranslator",["assert/assert","components/common/dataobjects"],function(a,b){var c={};return c.create=function(b,c){a(typeof c=="object"),a(typeof c.ObjectProperties=="object");var d=c.ObjectProperties.ForegroundColor,e={};return typeof d=="object"&&(d.Transparency==="true"?e.color="transparent":e.color=d.TrueColor1),e},c}),define("components/datatranslators/sizedatatranslator",["assert/assert","components/common/dataobjects"],function(a,b){function d(a){var b={};return typeof a.Width=="object"&&(b.width=parseInt(a.Width.Value,10)),typeof a.Height=="object"&&(b.height=parseInt(a.Height.Value,10)),b}var c={};return c.create=function(b,c){return a(typeof c=="object"),a(typeof c.BaseProperties=="object"),d(c.BaseProperties)},c.updateForResponsiveDesignViewChange=function(c,e,f,g,h){a(typeof h=="object");var i=d(h);return b.update(c,e,i)},c.updateForContainerSizeChange=function(a,b,c,d){var e=!1;return c!==a[b].width&&(a[b].width=c,e=!0),d!==a[b].height&&(a[b].height=d,e=!0),e},c}),define("components/datatranslators/taborderdatatranslator",["assert/assert","components/datatranslators/taborderhelper","components/common/dataobjects"],function(a,b,c){function e(a,c,d){return a.hasTabOrderObjects()===!1?a.isDialog()?{value:1}:{value:0}:{cssClassForHighlightWhenFocussed:"arcComponentWithHighlightBoxWhenFocussed",cssClassForHighlight:"arcComponentWithHighlightBox",value:b.translateTabOrder(c,d,a.isDialog())}}var d={};return d.create=function(b,c){a(typeof b=="object"),a(typeof c=="object"),a(typeof c.ObjectProperties=="object"),a(typeof c.BaseProperties=="object");var d=c.ObjectProperties.SelectionEnabled==="true";return e(b,d,c.BaseProperties)},d.update=function(b,e,f,g){a(typeof f=="object"),a(typeof g=="object");var h;return typeof g.BaseProperties!="object"?!1:typeof g.ObjectProperties!="object"?!1:(h=d.create(f,g),c.update(b,e,h))},d.updateForResponsiveDesignViewChange=function(a,b,d,f,g){var h;return h=e(d,f,g),c.update(a,b,h)},d}),define("components/datatranslators/tooltipdatatranslator",["assert/assert","tooltip","components/common/dataobjects"],function(a,b,c){var d={};return d.create=function(c,d){a(typeof d=="object"),a(typeof d.ObjectProperties=="object");var e={};return typeof d.ObjectProperties.ToolTip=="object"&&(e.text=b.toolTipStringForObject(d.ObjectProperties.ToolTip),e.text===""&&(e.text=undefined)),e},d}),define("components/datatranslators/wordwrapdatatranslator",["assert/assert","components/common/dataobjects"],function(a,b){var c={};return c.create=function(b,c){var d={};return a(typeof c=="object"),a(typeof c.ObjectProperties=="object"),typeof c.ObjectProperties.WordWrap=="object"&&(c.ObjectProperties.WordWrap.Value==="Wrap"?d.isMultiline=!0:d.isMultiline=!1),d},c}),define("components/datatranslators/compositedatatranslatorfactory",["assert/assert","components/common/dataobjects"],function(a,b){return{createCompositeDataTranslator:function(){function e(c,d,e,f,g){a(typeof g=="object");var h;return typeof g.ObjectProperties!="object"?!1:(h=c(f,g),b.update(d,e,h))}var c={},d=[];return c.addDataTranslator=function(a,b){d.push({propertyNameInViewModel:a,dataTranslator:b})},c.createInViewModel=function(a,b,c,e,f){d.forEach(function(d){a[d.propertyNameInViewModel]=d.dataTranslator.create(b,c,e,f)})},c.updateViewModel=function(a,b,c,f,g){var h=!1;return d.forEach(function(d){var i=d.propertyNameInViewModel,j=!1;typeof d.dataTranslator.update=="function"?j=d.dataTranslator.update(a,i,b,c,f,g):j=e(d.dataTranslator.create,a,i,b,c),j===!0&&(h=!0)}),h},c.updateViewModelForResponsiveDesignViewChange=function(b,c,e){var f=!1,g;return a(typeof b.active.isActive=="boolean"),g=b.active.isActive,d.forEach(function(a){var d=a.propertyNameInViewModel;typeof a.dataTranslator.updateForResponsiveDesignViewChange=="function"&&a.dataTranslator.updateForResponsiveDesignViewChange(b,d,c,g,e)&&(f=!0)}),f},c.updateViewModelForContainerSizeChange=function(a,b,c){var e=!1;return d.forEach(function(d){var f=d.propertyNameInViewModel;typeof d.dataTranslator.updateForContainerSizeChange=="function"&&d.dataTranslator.updateForContainerSizeChange(a,f,b,c)&&(e=!0)}),e},c}}}),define("components/datatranslators/passworddatatranslator",["assert/assert","components/common/dataobjects"],function(a,b){var c={};return c.create=function(b,c){a(typeof c=="object"),a(typeof c.ObjectProperties=="object");var d={};return c.ObjectProperties.Password&&(d.isPassword=c.ObjectProperties.Password==="true"),d},c}),define("components/field/fieldeditedcallbackdatatranslator",["assert/assert"],function(a){function b(b){var c={};return c.create=function(c,d){a(typeof d=="object"),a(typeof d.ObjectProperties=="object");var e={};return d.ObjectProperties.SelectionEnabled==="true"&&d.ObjectProperties.EditEnabled==="true"&&(e.textEdited=b),e},c.update=function(a,d,e,f){var g,h,i;return g=c.create(e,f),h=typeof g.textEdited=="function",i=typeof a[d].textEdited=="function",h!==i?(h?a[d].textEdited=b:delete a[d].textEdited,!0):!1},c}return{createDataTranslator:b}}),define("nodetypes",[],{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}),define("guitypes",[],function(){var a={Undefined:"0",Logon:"-1",Question:"-2",Message:"-3",SAPVariable:"-4",Popupmenu:"-5",Textentry:"-6",DomainLogon:"-7",UserPrinter:"-8",FileToApplet:"-11",FileFromApplet:"-12",ClientParameter:"-13",UserFunction:"-14",LogonMixed:"-15",DomainLogonMixed:"-16",SAPCookie:"-17",WebServerVariable:"-18",Mkdir:"-19",StartJS:"-20",GetKeychain:"-21",ClientStoreKey:"-22",LogonMixedKeepLogin:"-23",LongviewGroup:"-24"};return a.isLoginGUIType=function(b){var c=b.Type||a.Undefined;return c===a.Logon||c===a.DomainLogon||c===a.LogonMixed||c===a.DomainLogonMixed||c===a.LogonMixedKeepLogin},a.isDomainLogin=function(b){var c=b.Type||a.Undefined;return c===a.DomainLogon||b.Type===a.DomainLogonMixed},a.isLogonMixedKeepLogin=function(b){var c=b.Type||a.Undefined;return c===a.LogonMixedKeepLogin},a}),define("drivertype",[],function(){var a=["SAPDriver","SAPSEMDriver","OIWDriver","OLAPBIWDriver","BWNativeDriver","SAPQueryDriver","SAPHANAMDXDriver"],b=["SAPDriver","OIWDriver","SAPQueryDriver","BWNativeDriver","SAPSEMDriver","ESSBASEDriver","EssbaseMDXDriver","IBMOLAPDriver","ALEADriver","TM1Driver","MIKOLAPDriver"],c={SQLSDriver:"1",ODBCDriver:"2",MAC_ODBCDriver:"3",MAC_DALDriver:"4",ISObjectDriver:"5",SAPDriver:"6",MIKDriver:"7",MCubeDriver:"8",OIWDriver:"9",SAPHier:"10",ALEADriver:"11",EXPRESSDriver:"12",ESSBASEDriver:"13",BIWDriver:"14",MIKOLAPDriver:"15",TM1Driver:"16",BIWHier:"17",MDXHier:"18",DYNADriver:"19",HYPERIONDriver:"20",SAPQueryDriver:"21",XMLDriver:"22",NewBIWHier:"23",OLAPODBCDriver:"24",XMLONLINEDriver:"25",WEBSERVICEDriver:"26",SAPSEMDriver:"27",HFMDriver:"28",IBMOLAPDriver:"29",ORACLEDriver:"30",LDAPDriver:"31",CubeViewsDriver:"32",ORACLEOLAPDMLDriver:"33",TAMINODriver:"34",OLAPZeroSuppression:"35",AdabasDriver:"36",PowerOLAPDriver:"37",NoDriverClientLogin:"38",OLAPDBDriver:"1000",OLAPBIWDriver:"1001",OLAPTM1Driver:"1003",OLAPMSDriver:"1004",OLAPUniversal:"1005",BWNativeDriver:"1006",MICROSTRATDriver:"1007",XMLADriver:"1008",EssbaseMDXDriver:"1009",CubingServicesDriver:"1010",OLAPTeraDataDriver:"1011",OracleOLAPMDXDriver:"1012",SAPHANAMDXDriver:"1013",KOGNITIOPABLODriver:"1014",LUCANETDriver:"1015",ORACLEOLAPDriver:"1101",UNDEFINEDDRIVER:"10000",UNDEFINEDOLAPDRIVER:"10001",FORMULAREFDriver:"10002"};return c.isSAPDriver=function(b){var d="",e;typeof b.UserLogin=="object"&&(d=b.UserLogin.DriverType||"");for(e=0;e<a.length;e+=1)if(d===c[a[e]])return!0;return!1},c.isChangePasswordAllowed=function(a){var d="",e;typeof a.UserLogin=="object"&&(d=a.UserLogin.DriverType||"");for(e=0;e<b.length;e+=1)if(d===c[b[e]])return!0;return!1},c}),define("usertypes",{windows:"0",arcplan:"1",arcplanOrWindows:"2"}),define("replytypes",{storeKey:22,getKeychain:21,startJS:20,msgbox:2,question:2,popupmenu:5,printerAlias:8,longviewGroup:24}),define("jstorage",[],function(){var a={};return function(){function s(){var a=!1;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval"),a=!0,window.localStorage.removeItem("_tmptest")}catch(b){}if(a)try{window.localStorage&&(f=window.localStorage,i="localStorage",l=f.jStorage_update)}catch(c){}else if("globalStorage"in window)try{window.globalStorage&&(f=window.globalStorage[window.location.hostname],i="globalStorage",l=f.jStorage_update)}catch(d){}else{g=document.createElement("link");if(!g.addBehavior){g=null;return}g.style.behavior="url(#default#userData)",document.getElementsByTagName("head")[0].appendChild(g);try{g.load("jStorage")}catch(e){g.setAttribute("jStorage","{}"),g.save("jStorage"),g.load("jStorage")}var h="{}";try{h=g.getAttribute("jStorage")}catch(j){}try{l=g.getAttribute("jStorage_update")}catch(k){}f.jStorage=h,i="userDataBehavior"}A(),D(),t("local"),t("session"),v(),E(),"addEventListener"in window&&window.addEventListener("pageshow",function(a){a.persisted&&w()},!1)}function t(a,b){function m(){if(a!="session")return;try{k=d.parse(window.name||"{}")}catch(b){k={}}}function n(){if(a!="session")return;window.name=d.stringify(k)}var f=!1,g=0,h,j,k={},l=Math.random();if(!b&&typeof window[a+"Storage"]!="undefined")return;if(a=="local"&&window.globalStorage){localStorage=window.globalStorage[window.location.hostname];return}if(i!="userDataBehavior")return;b&&window[a+"Storage"]&&window[a+"Storage"].parentNode&&window[a+"Storage"].parentNode.removeChild(window[a+"Storage"]),j=document.createElement("button"),document.getElementsByTagName("head")[0].appendChild(j),a=="local"?k=e:a=="session"&&m();for(h in k)k.hasOwnProperty(h)&&h!="__jstorage_meta"&&h!="length"&&typeof k[h]!="undefined"&&(h in j||g++,j[h]=k[h]);j.length=g,j.key=function(a){var b=0,c;m();for(c in k)if(k.hasOwnProperty(c)&&c!="__jstorage_meta"&&c!="length"&&typeof k[c]!="undefined"){if(b==a)return c;b++}},j.getItem=function(b){return m(),a=="session"?k[b]:c.jStorage.get(b)},j.setItem=function(a,b){if(typeof b=="undefined")return;j[a]=(b||"").toString()},j.removeItem=function(b){if(a=="local")return c.jStorage.deleteKey(b);j[b]=undefined,f=!0,b in j&&j.removeAttribute(b),f=!1},j.clear=function(){if(a=="session"){window.name="",t("session",!0);return}c.jStorage.flush()},a=="local"&&(r=function(a,b){if(a=="length")return;f=!0,typeof b=="undefined"?a in j&&(g--,j.removeAttribute(a)):(a in j||g++,j[a]=(b||"").toString()),j.length=g,f=!1}),j.attachEvent("onpropertychange",function(b){if(b.propertyName=="length")return;if(f||b.propertyName=="length")return;if(a=="local")!(b.propertyName in k)&&typeof j[b.propertyName]!="undefined"&&g++;else if(a=="session"){m(),typeof j[b.propertyName]=="undefined"||b.propertyName in k?typeof j[b.propertyName]=="undefined"&&b.propertyName in k?(delete k[b.propertyName],g--):k[b.propertyName]=j[b.propertyName]:(k[b.propertyName]=j[b.propertyName],g++),n(),j.length=g;return}c.jStorage.set(b.propertyName,j[b.propertyName]),j.length=g}),window[a+"Storage"]=j}function u(){var a="{}";if(i=="userDataBehavior"){g.load("jStorage");try{a=g.getAttribute("jStorage")}catch(b){}try{l=g.getAttribute("jStorage_update")}catch(c){}f.jStorage=a}A(),D(),E()}function v(){i=="localStorage"||i=="globalStorage"?"addEventListener"in window?window.addEventListener("storage",w,!1):document.attachEvent("onstorage",w):i=="userDataBehavior"&&setInterval(w,1e3)}function w(){var a;clearTimeout(k),k=setTimeout(function(){if(i=="localStorage"||i=="globalStorage")a=f.jStorage_update;else if(i=="userDataBehavior"){g.load("jStorage");try{a=g.getAttribute("jStorage_update")}catch(b){}}a&&a!=l&&(l=a,x())},25)}function x(){var a=d.parse(d.stringify(e.__jstorage_meta.CRC32)),b;u(),b=d.parse(d.stringify(e.__jstorage_meta.CRC32));var c,f=[],g=[];for(c in a)if(a.hasOwnProperty(c)){if(!b[c]){g.push(c);continue}a[c]!=b[c]&&f.push(c)}for(c in b)b.hasOwnProperty(c)&&(a[c]||f.push(c));y(f,"updated"),y(g,"deleted")}function y(a,b){a=[].concat(a||[]);if(b=="flushed"){a=[];for(var c in j)j.hasOwnProperty(c)&&a.push(c);b="deleted"}for(var d=0,e=a.length;d<e;d++)if(j[a[d]])for(var f=0,g=j[a[d]].length;f<g;f++)j[a[d]][f](a[d],b)}function z(){var a=(+(new Date)).toString();i=="localStorage"||i=="globalStorage"?f.jStorage_update=a:i=="userDataBehavior"&&(g.setAttribute("jStorage_update",a),g.save("jStorage")),w()}function A(){if(f.jStorage)try{e=d.parse(String(f.jStorage))}catch(a){f.jStorage="{}"}else f.jStorage="{}";h=f.jStorage?String(f.jStorage).length:0,e.__jstorage_meta||(e.__jstorage_meta={}),e.__jstorage_meta.CRC32||(e.__jstorage_meta.CRC32={})}function B(){G();try{f.jStorage=d.stringify(e),g&&(g.setAttribute("jStorage",f.jStorage),g.save("jStorage")),h=f.jStorage?String(f.jStorage).length:0}catch(a){}}function C(a){if(!a||typeof a!="string"&&typeof a!="number")throw new TypeError("Key name must be string or numeric");if(a=="__jstorage_meta")throw new TypeError("Reserved key name");return!0}function D(){var a,b,c,d,f=Infinity,g=!1,h=[];clearTimeout(o);if(!e.__jstorage_meta||typeof e.__jstorage_meta.TTL!="object")return;a=+(new Date),c=e.__jstorage_meta.TTL,d=e.__jstorage_meta.CRC32;for(b in c)c.hasOwnProperty(b)&&(c[b]<=a?(delete c[b],delete d[b],delete e[b],g=!0,h.push(b)):c[b]<f&&(f=c[b]));f!=Infinity&&(o=setTimeout(D,f-a)),g&&(B(),z(),y(h,"deleted"))}function E(){if(!e.__jstorage_meta.PubSub)return;var a,b=n;for(var c=len=e.__jstorage_meta.PubSub.length-1;c>=0;c--)a=e.__jstorage_meta.PubSub[c],a[0]>n&&(b=a[0],F(a[1],a[2]));n=b}function F(a,b){if(m[a])for(var c=0,e=m[a].length;c<e;c++)m[a][c](a,d.parse(d.stringify(b)))}function G(){if(!e.__jstorage_meta.PubSub)return;var a=+(new Date)-2e3;for(var b=0,c=e.__jstorage_meta.PubSub.length;b<c;b++)if(e.__jstorage_meta.PubSub[b][0]<=a){e.__jstorage_meta.PubSub.splice(b,e.__jstorage_meta.PubSub.length-b);break}e.__jstorage_meta.PubSub.length||delete e.__jstorage_meta.PubSub}function H(a,b){e.__jstorage_meta||(e.__jstorage_meta={}),e.__jstorage_meta.PubSub||(e.__jstorage_meta.PubSub=[]),e.__jstorage_meta.PubSub.unshift([+(new Date),a,b]),B(),z()}function I(a,b){b=b||0;var c=0,d=0;b^=-1;for(var e=0,f=a.length;e<f;e++)c=(b^a.charCodeAt(e))&255,d="0x"+p.substr(c*9,8),b=b>>>8^d;return b^-1}var b="0.3.0",c=window.jQuery||window.$||(window.$={}),d={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(a){return String(a).evalJSON()}||c.parseJSON||c.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||c.toJSON};if(!d.parse||!d.stringify)throw new Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page");var e={},f={jStorage:"{}"},g=null,h=0,i=!1,j={},k=!1,l=0,m={},n=+(new Date),o,p="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D",q={isXML:function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1},encode:function(a){if(!this.isXML(a))return!1;try{return(new XMLSerializer).serializeToString(a)}catch(b){try{return a.xml}catch(c){}}return!1},decode:function(a){var b="DOMParser"in window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(a){var b=new ActiveXObject("Microsoft.XMLDOM");return b.async="false",b.loadXML(a),b},c;return b?(c=b.call("DOMParser"in window&&new DOMParser||window,a,"text/xml"),this.isXML(c)?c:!1):!1}},r=function(){};a={version:b,set:function(a,b,c){C(a),c=c||{};if(typeof b=="undefined")return this.deleteKey(a),b;if(q.isXML(b))b={_is_xml:!0,xml:q.encode(b)};else{if(typeof b=="function")return undefined;b&&typeof b=="object"&&(b=d.parse(d.stringify(b)))}return e[a]=b,e.__jstorage_meta.CRC32[a]=I(d.stringify(b)),this.setTTL(a,c.TTL||0),r(a,b),y(a,"updated"),b},get:function(a,b){return C(a),a in e?e[a]&&typeof e[a]=="object"&&e[a]._is_xml&&e[a]._is_xml?q.decode(e[a].xml):e[a]:typeof b=="undefined"?null:b},deleteKey:function(a){return C(a),a in e?(delete e[a],typeof e.__jstorage_meta.TTL=="object"&&a in e.__jstorage_meta.TTL&&delete e.__jstorage_meta.TTL[a],delete e.__jstorage_meta.CRC32[a],r(a,undefined),B(),z(),y(a,"deleted"),!0):!1},setTTL:function(a,b){var c=+(new Date);return C(a),b=Number(b)||0,a in e?(e.__jstorage_meta.TTL||(e.__jstorage_meta.TTL={}),b>0?e.__jstorage_meta.TTL[a]=c+b:delete e.__jstorage_meta.TTL[a],B(),D(),z(),!0):!1},getTTL:function(a){var b=+(new Date),c;return C(a),a in e&&e.__jstorage_meta.TTL&&e.__jstorage_meta.TTL[a]?(c=e.__jstorage_meta.TTL[a]-b,c||0):0},flush:function(){return e={__jstorage_meta:{CRC32:{}}},t("local",!0),B(),z(),y(null,"flushed"),!0},storageObj:function(){function a(){}return a.prototype=e,new a},index:function(){var a=[],b;for(b in e)e.hasOwnProperty(b)&&b!="__jstorage_meta"&&a.push(b);return a},storageSize:function(){return h},currentBackend:function(){return i},storageAvailable:function(){return!!i},listenKeyChange:function(a,b){C(a),j[a]||(j[a]=[]),j[a].push(b)},stopListening:function(a,b){C(a);if(!j[a])return;if(!b){delete j[a];return}for(var c=j[a].length-1;c>=0;c--)j[a][c]==b&&j[a].splice(c,1)},subscribe:function(a,b){a=(a||"").toString();if(!a)throw new TypeError("Channel not defined");m[a]||(m[a]=[]),m[a].push(b)},publish:function(a,b){a=(a||"").toString();if(!a)throw new TypeError("Channel not defined");H(a,b)},reInit:function(){u()}},s()}(),a}),define("keychainstorage",["jstorage"],function(a){function e(){return{rows:function(){function d(a,b){var c;return b>=0&&b<a.length&&(c=a[b]),c}var a=[],b=[],c=0;return{length:0,rowCount:function(){return a.length},item:function(b){return d(a,b)},id:function(a){return d(b,a)},push:function(d,e){b.push(d),a.push(e),c+=1,this.length=c}}}()}}function f(a,b,c){return{application:a,user:b,key:c}}function g(b){var c,d,e;if(b&&b.rows){c=b.rows.rowCount();for(d=0;d<c;d+=1)e=b.rows.id(d),a.deleteKey(e.toString())}}function h(b){var c=e(),d=a.index(),f=d.length,g,h,i,j;for(h=0;h<f;h+=1)g=d[h],i=a.get(g.toString()),j=!0,b&&typeof b=="function"&&(j=b(i)),j&&c.rows.push(g,i);return c}var b,c=1,d={version:"1.0"};return d.databaseSupported=function(){return b===undefined&&(b=a?a.storageAvailable():!1),b},d.initDatabase=function(){var b,e;if(!d.databaseSupported())return;b=a.index(),e=Math.max.apply(Math,b),c=e<0?0:1*e+1},d.updateEntryById=function(b,c,e,g){if(!d.databaseSupported())return;a.set(b.toString(),f(c,e,g))},d.createEntry=function(a,b,e){if(!d.databaseSupported())return-1;d.updateEntryById(c,a,b,e);var f=d.selectById(c);return f.row!==0?(c+=1,c-1):-1},d.selectByUsername=function(a){if(!d.databaseSupported())return e();var b=h(function(b){return b.user===a});return b},d.selectById=function(b){var c=e(),f;return d.databaseSupported()&&(f=a.get(b.toString()),f!==undefined&&c.rows.push(b,f)),c},d.selectByKey=function(a){var b=e();return d.databaseSupported()&&(b=h(function(b){return b.key===a})),b},d.selectByApplication=function(a){var b=e();return d.databaseSupported()&&(b=h(function(b){return b.application===a})),b},d.selectAll=function(){var a=e();return d.databaseSupported()&&(a=h(function(){return!0})),a},d.updateEntryByKey=function(b,c,e,g){if(!d.databaseSupported())return;var h=d.selectByKey(b);h.rows.rowCount()>0&&a.set(h.rows.id(0).toString(),f(c,e,g))},d.deleteEntriesByUsername=function(a){if(!d.databaseSupported())return;var b=d.selectByUsername(a);g(b)},d.deleteEntriesByKey=function(a){if(!d.databaseSupported())return;var b=d.selectByKey(a);g(b)},d.deleteEntriesById=function(a){if(!d.databaseSupported())return;var b=d.selectById(a);g(b)},d.deleteEntriesByApplication=function(a){if(!d.databaseSupported())return;var b=d.selectByApplication(a);g(b)},d.deleteAllEntries=function(){if(!d.databaseSupported())return;var a=d.selectAll();g(a)},d.getEntryCount=function(){var a=d.selectAll();return a.rows.length},d.initDatabase(),d}),define("keepalive",[],function(){var a={},b=3e5;return a.startKeepAlives=function(a){return setInterval(a,b)},a.stopKeepAlives=function(a){a!==undefined&&clearInterval(a)},a}),define("tooltiptypes",[],function(){var a={None:0,EachCell:1,EachRow:2,EachColumn:3,WholeObject:4};return a}),define("layoutmanagement/chartresizerfactory",[],function(){function a(a){var b={};return b.$svgRoot=a,b.$backgroundRect=$("#background",a),b.$contentClipRect=$("#content-clip rect:first",a),b.$borderRect=$("#border",a),b.$VLAxisClipRect=$("#Axes_0 rect:first",a),b.$VRAxisClipRect=$("#Axes_1 rect:first",a),b.$HBAxisClipRect=$("#Axes_2 rect:first",a),b.$HTAxisClipRect=$("#Axes_3 rect:first",a),b.$contentBackgroundRect=$("#content_background",a),b.$contentFrameRect=$("#content_frame",a),b.$HBAxisLabelRects=$("#AxisGroup_2_clip rect",a),b.$HBAxisLabelTexts=$("#AxisGroup_2_clip text",a),b.$VRAxisLabelRects=$("#AxisGroup_1_clip rect",a),b.$VRAxisLabelTexts=$("#AxisGroup_1_clip text",a),b.$verticalGridLines=$("#AxisGroup_2_clip line",a),b.$horizontalGridLines=$("#AxisGroup_0_clip line",a),b.$leftBorderLine=$("#border_left",a),b.$rightBorderLine=$("#border_right",a),b.$topBorderLine=$("#border_top",a),b.$bottomBorderLine=$("#border_bottom",a),b}function b(a){var b={},c=a[0].getAttribute("viewBox"),d;return typeof c=="string"&&c!==""&&(d=c.split(" "),d.length===4&&(b.x=parseInt(d[0],10),b.y=parseInt(d[1],10),b.width=parseInt(d[2],10),b.height=parseInt(d[3],10))),b}function c(a,b,c){var d=a[0].getAttribute("viewBox"),e;typeof d=="string"&&d!==""&&(e=d.split(" "),e[3]=""+(c+b),a[0].setAttribute("viewBox",e.join(" ")))}function d(a,b,c){var d=a[0].getAttribute("viewBox"),e;typeof d=="string"&&d!==""&&(e=d.split(" "),e[2]=""+(c+b),a[0].setAttribute("viewBox",e.join(" ")))}function e(a){return{x:parseInt(a.attr("x"),10),y:parseInt(a.attr("y"),10)}}function f(a){return{x:parseInt(a.attr("x"),10),y:parseInt(a.attr("y"),10),width:parseInt(a.attr("width"),10),height:parseInt(a.attr("height"),10)}}function g(a){return{x1:parseInt(a.attr("x1"),10),x2:parseInt(a.attr("x2"),10),y1:parseInt(a.attr("y1"),10),y2:parseInt(a.attr("y2"),10)}}function h(a){var b,c=a.length,d=[],e=[],f=[],h=[],i;for(b=0;b<c;b+=1)i=g($(a[b])),d.push(i.x1),e.push(i.x2),f.push(i.y1),h.push(i.y2);return{x1s:d,x2s:e,y1s:f,y2s:h}}function i(a){var b,c=a.length,d=[],f=[],g;for(b=0;b<c;b+=1)g=e($(a[b])),d.push(g.x),f.push(g.y);return{xs:d,ys:f}}function j(a){var b,c=a.length,d=[],e=[],g=[],h=[],i;for(b=0;b<c;b+=1)i=f($(a[b])),d.push(i.x),e.push(i.y),g.push(i.width),h.push(i.height);return{xs:d,ys:e,widths:g,heights:h}}function k(a){var c={};return c.viewBox=b(a.$svgRoot),c.backgroundRect=f(a.$backgroundRect),c.contentClipRect=f(a.$contentClipRect),c.borderRect=f(a.$borderRect),c.contentBackgroundRect=f(a.$contentBackgroundRect),c.contentFrameRect=f(a.$contentFrameRect),c.hbAxisClipRect=f(a.$HBAxisClipRect),c.vrAxisClipRect=f(a.$VRAxisClipRect),c.vlAxisClipRect=f(a.$VLAxisClipRect),c.htAxisClipRect=f(a.$HTAxisClipRect),c.verticalGridLines=h(a.$verticalGridLines),c.horizontalGridLines=h(a.$horizontalGridLines),c.hbAxisLabelRects=j(a.$HBAxisLabelRects),c.vrAxisLabelRects=j(a.$VRAxisLabelRects),c.hbAxisLabelTexts=i(a.$HBAxisLabelTexts),c.vrAxisLabelTexts=i(a.$VRAxisLabelTexts),c.leftBorderLine=g(a.$leftBorderLine),c.rightBorderLine=g(a.$rightBorderLine),c.bottomBorderLine=g(a.$bottomBorderLine),c.topBorderLine=g(a.$topBorderLine),c}function l(a,b,c,d){var e=c+a;b.attr(d,e)}function m(a,b,c,d){var e,f=b.length;for(e=0;e<f;e+=1)l(a,$(b[e]),c[e],d)}return function(e){function i(){return[{element:g.$backgroundRect,origValue:h.backgroundRect.height,attribute:"height"},{element:g.$contentClipRect,origValue:h.contentClipRect.height,attribute:"height"},{element:g.$borderRect,origValue:h.borderRect.height,attribute:"height"},{element:g.$contentBackgroundRect,origValue:h.contentBackgroundRect.height,attribute:"height"},{element:g.$contentFrameRect,origValue:h.contentFrameRect.height,attribute:"height"},{element:g.$VLAxisClipRect,origValue:h.vlAxisClipRect.height,attribute:"height"},{element:g.$VRAxisClipRect,origValue:h.vrAxisClipRect.height,attribute:"height"},{elements:g.$HBAxisLabelRects,origValueArray:h.hbAxisLabelRects.ys,attribute:"y"},{elements:g.$HBAxisLabelTexts,origValueArray:h.hbAxisLabelTexts.ys,attribute:"y"},{element:g.$HBAxisClipRect,origValue:h.hbAxisClipRect.height,attribute:"height"},{element:g.$HTAxisClipRect,origValue:h.htAxisClipRect.height,attribute:"height"},{elements:g.$verticalGridLines,origValueArray:h.verticalGridLines.y2s,attribute:"y2"},{element:g.$leftBorderLine,origValue:h.leftBorderLine.y2,attribute:"y2"},{element:g.$rightBorderLine,origValue:h.rightBorderLine.y2,attribute:"y2"},{element:g.$bottomBorderLine,origValue:h.bottomBorderLine.y1,attribute:"y1"},{element:g.$bottomBorderLine,origValue:h.bottomBorderLine.y2,attribute:"y2"}]}function j(){return[{element:g.$backgroundRect,origValue:h.backgroundRect.width,attribute:"width"},{element:g.$contentClipRect,origValue:h.contentClipRect.width,attribute:"width"},{element:g.$borderRect,origValue:h.borderRect.width,attribute:"width"},{element:g.$contentBackgroundRect,origValue:h.contentBackgroundRect.width,attribute:"width"},{element:g.$contentFrameRect,origValue:h.contentFrameRect.width,attribute:"width"},{element:g.$VLAxisClipRect,origValue:h.vlAxisClipRect.width,attribute:"width"},{element:g.$VRAxisClipRect,origValue:h.vrAxisClipRect.width,attribute:"width"},{element:g.$HBAxisClipRect,origValue:h.hbAxisClipRect.width,attribute:"width"},{element:g.$HTAxisClipRect,origValue:h.htAxisClipRect.width,attribute:"width"},{elements:g.$VRAxisLabelRects,origValueArray:h.vrAxisLabelRects.xs,attribute:"x"},{elements:g.$VRAxisLabelTexts,origValueArray:h.vrAxisLabelTexts.xs,attribute:"x"},{elements:g.$horizontalGridLines,origValueArray:h.horizontalGridLines.x2s,attribute:"x2"},{element:g.$topBorderLine,origValue:h.topBorderLine.x2,attribute:"x2"},{element:g.$bottomBorderLine,origValue:h.bottomBorderLine.x1,attribute:"x1"},{element:g.$rightBorderLine,origValue:h.rightBorderLine.x1,attribute:"x1"},{element:g.$rightBorderLine,origValue:h.rightBorderLine.x2,attribute:"x2"}]}var f={},g=a(e),h=k(g);return f.updateHeight=function(a){var b=i(),d=a-h.viewBox.height;c(g.$svgRoot,d,h.viewBox.height),b.forEach(function(a){typeof a.origValueArray=="object"?m(d,a.elements,a.origValueArray,a.attribute):l(d,a.element,a.origValue,a.attribute)})},f.updateWidth=function(a){var b=j(),c=a-h.viewBox.width;d(g.$svgRoot,c,h.viewBox.width),b.forEach(function(a){typeof a.origValueArray=="object"?m(c,a.elements,a.origValueArray,a.attribute):l(c,a.element,a.origValue,a.attribute)})},f}}),define("menuseparatortypes",[],function(){var a={SpaceSeparator:0,LineSeparator:1,NoSeparator:2};return a}),define("htmltemplates",[],function(){var a={},b={};return a.flatMenuNativeDesktop='<div class="dynaMenu arcDraggable" ><div class="arcHierPopupSelectionOverflowContainer"><div class="arcHierPopupSelection"></div></div><select class="arcMenu flatMenuNativeDesktop" {tabIndex} ></select></div>',a.flatMenu='<div class="dynaMenu arcDraggable" {tabIndex} ><div class="arcHierPopup"><div class="arcHierPopupSelectionOverflowContainer"><div class="arcHierPopupSelection"></div></div></div><div style="z-index: auto;" class="arcPopupContent arcHierPopupContent"><div class="arcMenu"><ul></ul></div></div></div>',a.flatMenuNative='<div class="dynaMenu arcDraggable" {tabIndex} ><div class="arcHierPopup"><div class="arcHierPopupSelectionOverflowContainer"><div class="arcHierPopupSelection"></div></div></div><select class="arcMenu arcPopupContent"></select></div>',a.hierMenu='<div class="dynaHierMenu arcDraggable" {tabIndex} ><div class="arcHierPopup"><div class="arcHierPopupSelectionOverflowContainer"><div class="arcHierPopupSelection"></div></div></div><div style="z-index: auto;" class="arcHierPopupContent"><div class="arcHierPopupInnerDiv" style="position:relative;overflow-y:auto;overflow-x:hidden;border-style:none;top:0px;left:0px;width:100%;"><div style="position:relative;overflow:hidden;border-style:none;top:0px;left:0px;"><div class="arcHier arcVert arcTree"><ol></ol></div></div></div><div class="arcHierPopupDlgContainer"><div style="background-color: rgb(255, 255, 255); visibility: hidden;" class="arcHierPopupDlg"><input type="button" value="Cancel" name="cancel"><input type="button" value="OK" name="ok" disabled="disabled"></div></div></div></div>',a.checkBox='<div class="dynaCheckbox" {tabIndex} style="z-index:{z-index}; {borderDivStyle}" {title}><div class="dynaCheckbox" style="left: 0px; top: 0px; position: relative;"><div class="dynaCheckbox" style="left: 0px; top: 0px; position: relative;"><table class="dynaTable dynaCheckbox" cellspacing="0" style="left: 0px; top: 0px; position: relative; border-collapse: separate; {tableStyle}"><tbody></tbody></table></div></div></div>',a.radioButton='<div class="dynaRadio" style="z-index:{z-index};" {title}><div class="dynaRadio" style="left: 0px; top: 0px; position: relative;"><div class="dynaRadio" style="left: 0px; top: 0px; position: relative;"><table class="dynaRadio {tableClass}" style="left: 0px; top: 0px; position: relative; border-collapse: separate;"><tbody></tbody></table></div></div></div>',b.getHtmlTemplate=function(b){return a[b]},b}),define("datavirtualization/horizontalhierarchydomupdaterfactory",[],function(){return function(b){function d(a){var c;c=$("ol:first",b),c.replaceWith(a)}function e(a){return a}function f(a){var c,d;c=e(a),d=$("ol:first",b),d.css({left:c.left+"px",top:c.top+"px",width:c.width+"px",height:c.height+"px"})}var c={};return c.insertRangeIntoDom=function(a,b){d(a),f(b)},c}}),define("scrollstates",[],function(){var a={EShowIfNeeded:0,EHidden:1,EPrevented:2};return a}),define("components/cssgenerators/cellbordercssgenerator",["assert/assert"],function(a){var b={};return b.createCss=function(a){var b="";return a&&(a.top>0&&(b+="border-top:"+a.top+"px solid "+a.color+";"),a.left>0&&(b+="border-left:"+a.left+"px solid "+a.color+";"),a.right>0&&(b+="border-right:"+a.right+"px solid "+a.color+";"),a.bottom>0&&(b+="border-bottom:"+a.bottom+"px solid "+a.color+";")),b},b}),define("components/cssgenerators/margincssgenerator",["assert/assert"],function(a){var b={};return b.createCss=function(a){return a?"margin:"+a.top+"px "+a.right+"px "+a.bottom+"px "+a.left+"px;":""},b}),define("components/cssgenerators/paddingcssgeneratory",["assert/assert"],function(a){var b={};return b.createCss=function(a){return a?"padding:"+a.top+"px "+a.right+"px "+a.bottom+"px "+a.left+"px;":""},b}),define("layoutmanagement/layoutbehavior",{EAdjustToAvailableSpace:0,EAdjustToContent:1,EAdjustToLayoutObject:2,EFixedSize:3,EFixedSizeAndPosition:4,EAdjustToContentVertically:5,EAdjustToContentHorizontally:6}),define("rect/rectfactory",[],function(){function a(){this.x=0,this.y=0,this.width=0,this.height=0}function b(){return new a}return{createInstance:b}}),define("timinginfofactory",["assert/assert"],function(a){function b(){var b={},c={};return b.setRequestStartTime=function(b){a(typeof b=="number"),c={},c.requestStartTime=b},b.setRequestEndTime=function(b){a(typeof b=="number"),c.requestEndTime=b},b.setNetworkDuration=function(a){var b;typeof a=="object"&&typeof c.requestEndTime!="undefined"&&(b=a.getResponseHeader("Server-Response-Time"),b&&(c.serverResponseTime=parseInt(b,10),c.networkDuration=c.requestEndTime-c.requestStartTime-c.serverResponseTime,c.networkDuration=Math.max(c.networkDuration,0)))},b.setClientProcessingDuration=function(b){a(typeof b=="number"),typeof c.requestStartTime!="undefined"&&c.networkDuration>=0&&(c.clientProcessingDuration=b-c.requestEndTime,c.clientProcessingDuration=Math.max(c.clientProcessingDuration,0))},b.getTimingInfo=function(){if(c.networkDuration>=0)return c},b}return{createInstance:b}}),define("events/eventdatafactory",[],function(){function a(a,b){return{id:a,ref:b}}return{createInstance:a}}),define("logger",[],function(){function b(a){return""+("0"+a.getHours()).slice(-2)+":"+("0"+a.getMinutes()).slice(-2)+":"+("0"+a.getSeconds()).slice(-2)+"."+("00"+a.getMilliseconds()).slice(-3)}var a={};return window.console?(a.log=function(a){window.console.log(b(new Date)+"\t"+a)},a.error=function(a){window.console.error(b(new Date)+"\t"+a)},a.info=function(a){window.console.info(b(new Date)+"\t"+a)},a.warn=function(a){window.console.warn(b(new Date)+"\t"+a)},a.debug=function(a){ARCPLAN.debug&&window.console.log(b(new Date)+"\t"+a)}):(a.log=function(){},a.error=function(){},a.info=function(){},a.warn=function(){},a.debug=function(){}),a}),define("colortools",["logger"],function(a){function c(b){return $.each(b,function(c,d){d>255&&(b[c]=255),d<0&&(b[c]=0),isNaN(d)&&(a.error("Invalid Color Value "+c+" = "+d),b[c]=0)}),b.A>1&&(b.A=1),b}function d(a,b){var d={},e=Math.round(2.55*b);return d.R=a.R+e,d.G=a.G+e,d.B=a.B+e,d.A=a.A,c(d)}var b={};return b.toRGBAString=function(a,b){var d,e=c(a);return d="rgba("+e.R+","+e.G+","+e.B+",",b?d+=b:d+=e.A,d+=")",d},b.fromHexColor=function(a){var b=a,d={R:0,G:0,B:0,A:0};return b&&(b.indexOf("#")===0&&(b=b.slice(1)),b.length>=6&&(d.A=1,d.R=parseInt(b.substring(0,2),16),d.G=parseInt(b.substring(2,4),16),d.B=parseInt(b.substring(4,6),16),b.length>6&&(d.A=parseInt(b.substring(6),16)/255))),c(d)},b.toLighterColor=function(a){return d(a,50)},b.toDarkerColor=function(a){return d(a,-30)},b.c_transparentColor="rgba(255,255,255,0.0)",b}),define("components/cssgenerators/bordercssgenerator",["assert/assert","colortools"],function(a,b){function d(a,c,d){var e,f,g,h={};switch(c){case"1Point":case"2Point":g=b.fromHexColor(a),e=b.toRGBAString(g,1),f=b.toRGBAString(g,1);break;case"3D1":e="rgba(160, 160, 160, 0.75)",f="rgba(230, 230, 230, 0.75)";break;case"3D2":e="rgba(230, 230, 230, 0.75)",f="rgba(160, 160, 160, 0.75)";break;case"3D3":e="rgba(255, 255, 255, 0.4)",f="rgba(220, 220, 220, 0.4)";break;case"3D4":e="rgba(160, 160, 160, 0.75)",f="rgba(160, 160, 160, 0.75)"}return h.top=d.top?e:"transparent",h.bottom=d.bottom?f:"transparent",h.left=d.left?e:"transparent",h.right=d.right?f:"transparent",h}function e(a){switch(a){case"1Point":case"2Point":case"3D4":return"solid";case"3D1":return"inset";case"3D2":return"outset";case"3D3":return"groove"}}var c={};return c.getShadowCss=function(a){var b=a.activeSides,c="";return a.type==="3D4"&&(b.right&&b.bottom?c="box-shadow:3px 3px 6px 0 rgba(0,0,0,0.5);":b.right?c="box-shadow:8px 0 6px -6px rgba(0,0,0,0.5);":b.bottom&&(c="box-shadow:0 8px 6px -6px rgba(0,0,0,0.5);")),c},c.calculateBorderWidths=function(a,b){var c,d={},e,f;if(typeof a=="object"){c=a.activeSides;switch(a.type){case"1Point":e=1,f=1;break;case"2Point":case"3D1":case"3D2":case"3D3":e=2,f=2;break;case"3D4":e=0,f=1}b=typeof b=="number"?b:1,d.top=c.top?e:b,d.bottom=c.bottom?f:b,d.left=c.left?e:b,d.right=c.right?f:b}else d.top=0,d.bottom=0,d.left=0,d.right=0;return d},c.createCss=function(b,f){var g="",h,i,j;return typeof b=="object"&&(a(typeof b.type=="string"),a(typeof b.activeSides=="object"),h=c.calculateBorderWidths(b,f),g+="border-top-width:"+h.top+"px;",g+="border-bottom-width:"+h.bottom+"px;",g+="border-left-width:"+h.left+"px;",g+="border-right-width:"+h.right+"px;",i=d(b.color,b.type,b.activeSides),g+="border-top-color:"+i.top+";",g+="border-bottom-color:"+i.bottom+";",g+="border-left-color:"+i.left+";",g+="border-right-color:"+i.right+";",j=e(b.type),g+="border-style:"+j+";",g+=c.getShadowCss(b)),g},c}),define("components/button/buttonbordercssgenerator",["assert/assert","components/cssgenerators/bordercssgenerator","colortools"],function(a,b,c){function e(a,b,d){var e="rgba(230, 230, 230, 0.75)",f="rgba(130, 130, 130, 0.75)",g;if(b==="1Point"||b==="2Point")g=c.fromHexColor(a),e=c.toRGBAString(c.toLighterColor(g),.75),f=c.toRGBAString(c.toDarkerColor(g),.75);return{top:d?f:e,bottom:d?e:f,left:d?f:e,right:d?e:f}}var d={};return d.calculateBorderWidths=function(a){var b,c,d={};if(typeof a=="object"){b=a.activeSides;switch(a.type){case"1Point":c=1;break;case"2Point":case"3D1":case"3D2":case"3D3":case"3D4":c=2}d.top=b.top?c:0,d.bottom=b.bottom?c:0,d.left=b.left?c:0,d.right=b.right?c:0}else d.top=0,d.bottom=0,d.left=0,d.right=0;return d},d.createCss=function(c,f){var g="",h,i;return typeof c=="object"&&(a(typeof c.type=="string"),a(typeof c.activeSides=="object"),h=d.calculateBorderWidths(c),g+="border-top-width:"+h.top+"px;",g+="border-bottom-width:"+h.bottom+"px;",g+="border-left-width:"+h.left+"px;",g+="border-right-width:"+h.right+"px;",i=e(c.color,c.type,f),g+="border-top-color:"+i.top+";",g+="border-bottom-color:"+i.bottom+";",g+="border-left-color:"+i.left+";",g+="border-right-color:"+i.right+";",g+=b.getShadowCss(c),typeof f=="boolean"&&(g=g+"border-style:"+(f===!0?"inset":"outset")+";")),g},d}),define("components/datatranslators/borderdatatranslator",["assert/assert","colortools","components/common/dataobjects"],function(a,b,c){var d={};return d.create=function(b,c){a(typeof c=="object"),a(typeof c.ObjectProperties=="object");var d,e={};return d=c.ObjectProperties.Frame,typeof d=="object"&&(e.type=d.Type,e.activeSides={top:d.Top==="true",bottom:d.Bottom==="true",left:d.Left==="true",right:d.Right==="true"},typeof d.FrameColor=="object"&&(d.Type==="1Point"||d.Type==="2Point")&&(e.color=d.FrameColor.TrueColor1)),e},d}),define("clientcredentials",["keychainstorage","replytypes","logger"],function(a,b,c){var d={};return d.getKeychain=function(d){var e,f,g,h="",i={UserInformation:{KeyChain:{Reply:b.getKeychain,KeyChain:"empty"}}};if(a.databaseSupported()){c.info("Schlüssel für Applikation: "+d),g=a.selectByApplication(d);for(e=0;e<g.rows.length;e+=1)f=g.rows.item(e),h+=f.user+"\t"+f.key+"\n";c.info("KeyChain: "+h),i.UserInformation.KeyChain.KeyChain=h}return i},d.dropClientCredentials=function(b){a.deleteEntriesByApplication(b)},d.storeKey=function(d,e,f){var g=-1;return c.info("storeKey: "+e+" "+f),g=a.createEntry(d,e,f),{UserInformation:{Reply:{Type:b.storeKey,Result:g>-1?1:0}}}},d}),define("events/pendingeventshandlerfactory",["logger"],function(a){function b(){return{setPendingBlurEvent:function(){},executePendingBlurEvent:function(){return!1},processPendingBlurEvent:function(){return!1},executePendingEvent:function(){return!1}}}function c(){var c,d,e,f={};return ARCPLAN.useEventOrder===!0?b():(f.setPendingBlurEvent=function(b,e){a.info("pendingEventHandler: setting pending blur event"),c=b,d=e,typeof c=="function"&&window.setTimeout(f.executePendingBlurEvent,300)},f.executePendingBlurEvent=function(){var b;return typeof c=="function"?(a.info("pendingEventHandler: executing pending blur event"),b=c(),typeof d=="function"&&d(),c=undefined,d=undefined,b):!1},f.processPendingBlurEvent=function(b){return f.executePendingBlurEvent()?(a.info("pendingEventHandler: set pending event"),e=b,!0):!1},f.executePendingEvent=function(b){return typeof e=="function"?(a.info("pendingEventHandler: executing pending event"),e(b),e=undefined,!0):!1},f)}return{createInstance:c}}),define("arcplandocuments/selectedobjectmanagerfactory",["assert/assert"],function(a){function b(){var b={selectedObject:undefined,callbacks:[]};return b.setSelectedObject=function(c){a(typeof c=="string"||c===undefined,"Wrong parameter type passed to setSelectedObject. It takes a string parameter or undefined."),c!==b.selectedObject&&(b.selectedObject=c,b.callbacks.forEach(function(a){a(b.selectedObject)}))},b.getSelectedObject=function(){return b.selectedObject},b.registerSelectedObjectChangedCallback=function(c){a(typeof c=="function","Wrong parameter type passed to registerSelectedObjectChangedCallback. It takes a function parameter."),b.callbacks.push(c)},b}return{createInstance:b}}),define("events/selectedobjectchangedhandlerfactory",["assert/assert"],function(a){function b(a){return{selectedObjectChangedCallback:function(b){$(".selectedObject",a).removeClass("selectedObject"),$("#"+b,a).find(":first").addClass("selectedObject")}}}return{createInstance:b}}),define("layoutmanagement/resizestrategyfactory",["jquery","layoutmanagement/layoutbehavior"],function(a,b){function e(a){var c=a.getLayoutBehavior();return c===b.EAdjustToLayoutObject?!0:c===b.EAdjustToContent?!0:c===b.EAdjustToContentVertically?!0:c===b.EAdjustToContentHorizontally?!0:c===b.EAdjustToAvailableSpace?!0:a.isResizeable()==="true"?!0:!1}function f(a){var c=a.getLayoutBehavior();return c===b.EFixedSizeAndPosition?!0:!1}function g(a,b){return a.getOrigWidth()<=b.width&&a.getOrigHeight()<=b.height}function h(a,b){return a.getOrigXPos()<=b.x&&a.getOrigYPos()<=b.y}function i(a,b,c){var d;if(f(a))return;d={x:a.getXPos(),y:Math.max(a.getYPos()+c-b,a.getOrigYPos())},h(a,d)&&a.setYPos(d.y)}function j(a,b,c){var d,e,h,i;if(f(a))return;e=a.getOrigHeight(),h=a.getHeight(),i=a.getWidth(),d={width:i,height:Math.max(h+c-b,e)},g(a,d)&&a.setHeight(d.height)}function k(a,b,c){var d;if(f(a))return;d={x:Math.max(a.getXPos()+c-b,a.getOrigXPos()),y:a.getYPos()},h(a,d)&&a.setXPos(d.x)}function l(a,b,c){var d,e,h,i;if(f(a))return;e=a.getOrigWidth(),h=a.getWidth(),i=a.getHeight(),d={width:Math.max(h+c-b,e),height:i},g(a,d)&&a.setWidth(d.width)}var c=3,d={};return d.createResizeStrategy=function(a,b){function f(a,b,f){var g=a.getOrigYPos(),h=a.getOrigHeight();d.origPos-c<=g?i(a,b,f):g+h>d.origPos-c&&(e(a)?j(a,b,f):i(a,b,f))}function g(a,b,f){var g=a.getOrigXPos(),h=a.getOrigWidth();d.origPos-c<=g?k(a,b,f):g+h>d.origPos-c&&(e(a)?l(a,b,f):k(a,b,f))}var d={origPos:parseInt(a,10)};return{adjustObjectsVertically:function(a,c){var d;for(d=0;d<b.length;d+=1)f(b[d],a,c)},adjustObjectsHorizontally:function(a,c){var d;for(d=0;d<b.length;d+=1)g(b[d],a,c)}}},d}),define("layoutmanagement/resizelinefactory",["layoutmanagement/resizestrategyfactory"],function(a){var b={constants:{horizontal:0,vertical:1}};return b.createResizeLine=function(c,d,e,f,g){function i(a,b){h.location.x=a,h.location.y=b}var h={location:{x:0,y:0},limit:g,orientation:d,origPos:f,pos:e,resStrategy:undefined};h.resStrategy=a.createResizeStrategy(f,c);switch(d){case b.constants.horizontal:i(0,e);break;case b.constants.vertical:i(e,0)}return{setLocation:i,orientation:h.orientation,moveLine:function(a,c){var d=h.origPos,e,f,g,j,k;h.orientation===b.constants.horizontal?(e=c.height-d,f=a.height-h.location.y,g=f-e,j=h.location.x,k=Math.max(h.limit,h.location.y+g),i(j,k)):(e=c.width-d,f=a.width-h.location.x,g=f-e,j=Math.max(h.limit,h.location.x+g),k=h.location.y,i(j,k))},adjustObjectSizesAndPositions:function(){var a;h.orientation===b.constants.horizontal?(a=h.location.y,h.resStrategy.adjustObjectsVertically(h.pos,a)):(a=h.location.x,h.resStrategy.adjustObjectsHorizontally(h.pos,a)),h.pos=a}}},b}),define("responsivedesign/viewupdater",[],function(){function b(a,b,c){var d=c.split("/"),e=d.length,f,g,h,i;for(i in a)if(a.hasOwnProperty(i)){g=a[i],h=b;if(typeof g=="object"){for(f=0;f<e-1;f+=1)g.hasOwnProperty(d[f])&&h.hasOwnProperty(d[f])&&(h=h[d[f]],g=g[d[f]]);g[d[e-1]]=h[d[e-1]]}}}function c(a,c){var d={BaseProperties:c};b(a,d,"BaseProperties/Position/XPos"),b(a,d,"BaseProperties/Position/YPos")}function d(a,c){var d={BaseProperties:c};b(a,d,"BaseProperties/Width/Value")}function e(a,c){var d={BaseProperties:c};b(a,d,"BaseProperties/Height/Value")}function f(a,c){var d={BaseProperties:c};b(a,d,"BaseProperties/Export")}function g(a,c){var d={BaseProperties:c};b(a,d,"BaseProperties/ViewAvailability")}function h(a,c){var d={BaseProperties:c};b(a,d,"BaseProperties/Layout")}function i(a,c){var d={BaseProperties:c};b(a,d,"BaseProperties/TabOrder")}function j(a,c){var d={ObjectProperties:c};b(a,d,"ObjectProperties/ColumnWidth/Elements")}function k(a,c){var d={ObjectProperties:c};b(a,d,"ObjectProperties/VScrollbarAllowed/Value")}function l(a,c){var d={ObjectProperties:c};b(a,d,"ObjectProperties/HScrollbarAllowed/Value")}function m(a,b){}function n(a,b){}function o(a,c){var d={ObjectProperties:c};b(a,d,"ObjectProperties/VertScrollDependencies/Elements")}function p(a,c){var d={ObjectProperties:c};b(a,d,"ObjectProperties/HoriScrollDependencies/Elements")}var a={};return a.updateViewBaseProperties=function(a,b){c(a,b),d(a,b),e(a,b),f(a,b),g(a,b),h(a,b),i(a,b)},a.updateViewObjectProperties=function(a,b){j(a,b),k(a,b),l(a,b),m(a,b),n(a,b),o(a,b),p(a,b)},a}),define("servercommunication/imageloader",[],function(){function b(b){a=b}function c(b,c){var d=a.buildObjectPictRequest(b);a.downloadPictToBrowserCache(d,c)}var a;return{loadImageForHash:c,setRequestProcessor:b}}),function(a){typeof define=="function"&&define.amd?define("jquery.simplemodal",["jquery"],a):a(jQuery)}(function(a){var b=[],c=a(document),d=navigator.userAgent.toLowerCase(),e=a(window),f=[],g={ieQuirks:null,msie:/msie/.test(d)&&!/opera/.test(d),opera:/opera/.test(d)};g.ie6=g.msie&&/msie 6./.test(d)&&typeof window.XMLHttpRequest!="object",g.ie7=g.msie&&/msie 7.0/.test(d),a.modal=function(b,c){return a.modal.impl.init(b,c)},a.modal.close=function(){a.modal.impl.close()},a.modal.focus=function(b){a.modal.impl.focus(b)},a.modal.setContainerDimensions=function(){a.modal.impl.setContainerDimensions()},a.modal.setPosition=function(){a.modal.impl.setPosition()},a.modal.update=function(b,c){a.modal.impl.update(b,c)},a.fn.modal=function(b){return a.modal.impl.init(this,b)},a.modal.defaults={appendTo:"body",focus:!0,opacity:50,overlayId:"simplemodal-overlay",overlayCss:{},containerId:"simplemodal-container",containerCss:{},dataId:"simplemodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:!1,autoPosition:!0,zIndex:1e3,close:!0,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"simplemodal-close",escClose:!0,overlayClose:!1,fixed:!0,position:null,persist:!1,modal:!0,onOpen:null,onShow:null,onClose:null,fadeInTime:600,fadeInDelay:0,onEscCloseCallback:null},a.modal.impl={d:{},init:function(b,c){var d=this;if(d.d.data)return!1;g.ieQuirks=g.msie&&document.compatMode==="BackCompat",d.o=a.extend({},a.modal.defaults,c),d.zIndex=d.o.zIndex,d.occb=!1;if(typeof b=="object")b=b instanceof a?b:a(b),d.d.placeholder=!1,b.parent().parent().size()>0&&(b.before(a("<span></span>").attr("id","simplemodal-placeholder").css({display:"none"})),d.d.placeholder=!0,d.display=b.css("display"),d.o.persist||(d.d.orig=b.clone(!0)));else if(typeof b=="string"||typeof b=="number")b=a("<div></div>").html(b);else return alert("SimpleModal Error: Unsupported data type: "+typeof b),d;return d.create(b),b=null,d.open(),a.isFunction(d.o.onShow)&&d.o.onShow.apply(d,[d.d]),d},create:function(b){var c=this;c.getDimensions(),c.o.modal&&g.ie6&&(c.d.iframe=a('<iframe src="javascript:false;"></iframe>').css(a.extend(c.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:f[0],width:f[1],zIndex:c.o.zIndex,top:0,left:0})).appendTo(c.o.appendTo)),c.d.overlay=a("<div></div>").attr("id",c.o.overlayId).addClass("simplemodal-overlay").css(a.extend(c.o.overlayCss,{display:"none",opacity:1e-4,height:c.o.modal?"100%":0,width:c.o.modal?"100%":0,position:"fixed",left:0,top:0,zIndex:c.o.zIndex+1})).appendTo(c.o.appendTo),c.d.container=a("<div></div>").attr("id",c.o.containerId).addClass("simplemodal-container").css(a.extend({position:c.o.fixed?"fixed":"absolute"},c.o.containerCss,{display:"none",zIndex:c.o.zIndex+2},{opacity:1e-4})).append(c.o.close&&c.o.closeHTML?a(c.o.closeHTML).addClass(c.o.closeClass):"").appendTo(c.o.appendTo),c.d.wrap=a("<div></div>").attr("tabIndex",-1).addClass("simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(c.d.container),c.d.data=b.attr("id",b.attr("id")||c.o.dataId).addClass("simplemodal-data").css(a.extend(c.o.dataCss,{display:"none"})).appendTo("body"),b=null,c.setContainerDimensions(),c.d.data.appendTo(c.d.wrap),(g.ie6||g.ieQuirks)&&c.fixIE(),setTimeout(function(){c&&c.d&&(c.d.container&&c.d.container.fadeTo(c.o.fadeInTime,1),c.d.overlay&&c.d.overlay.fadeTo(c.o.fadeInTime,c.o.opacity/100))},c.o.fadeInDelay)},bindEvents:function(){var b=this;a("."+b.o.closeClass).bind("click.simplemodal",function(a){a.preventDefault(),b.close()}),b.o.modal&&b.o.close&&b.o.overlayClose&&b.d.overlay.bind("click.simplemodal",function(a){a.preventDefault(),b.close()}),c.bind("keydown.simplemodal",function(a){b.o.modal&&a.keyCode===9?b.watchTab(a):b.o.close&&b.o.escClose&&a.keyCode===27&&(a.preventDefault(),b.close(),typeof b.o.onEscCloseCallback=="function"&&b.o.onEscCloseCallback(a))}),e.bind("resize.simplemodal orientationchange.simplemodal",function(){b.getDimensions(),b.o.autoResize?b.setContainerDimensions():b.o.autoPosition&&b.setPosition(),g.ie6||g.ieQuirks?b.fixIE():b.o.modal&&(b.d.iframe&&b.d.iframe.css({height:"100%",width:"100%"}),b.d.overlay.css({height:"100%",width:"100%"}))})},unbindEvents:function(){a("."+this.o.closeClass).unbind("click.simplemodal"),c.unbind("keydown.simplemodal"),e.unbind(".simplemodal"),this.d.overlay.unbind("click.simplemodal")},fixIE:function(){var b=this,c=b.o.position;a.each([b.d.iframe||null,b.o.modal?b.d.overlay:null,b.d.container.css("position")==="fixed"?b.d.container:null],function(a,b){if(b){var d="document.body.clientHeight",e="document.body.clientWidth",f="document.body.scrollHeight",g="document.body.scrollLeft",h="document.body.scrollTop",i="document.body.scrollWidth",j="document.documentElement.clientHeight",k="document.documentElement.clientWidth",l="document.documentElement.scrollLeft",m="document.documentElement.scrollTop",n=b[0].style;n.position="absolute";if(a<2)n.removeExpression("height"),n.removeExpression("width"),n.setExpression("height",""+f+" > "+d+" ? "+f+" : "+d+' + "px"'),n.setExpression("width",""+i+" > "+e+" ? "+i+" : "+e+' + "px"');else{var o,q;if(c&&c.constructor===Array){var r=c[0]?typeof c[0]=="number"?c[0].toString():c[0].replace(/px/,""):b.css("top").replace(/px/,"");o=r.indexOf("%")===-1?r+" + (t = "+m+" ? "+m+" : "+h+') + "px"':parseInt(r.replace(/%/,""))+" * (("+j+" || "+d+") / 100) + (t = "+m+" ? "+m+" : "+h+') + "px"';if(c[1]){var s=typeof c[1]=="number"?c[1].toString():c[1].replace(/px/,"");q=s.indexOf("%")===-1?s+" + (t = "+l+" ? "+l+" : "+g+') + "px"':parseInt(s.replace(/%/,""))+" * (("+k+" || "+e+") / 100) + (t = "+l+" ? "+l+" : "+g+') + "px"'}}else o="("+j+" || "+d+") / 2 - (this.offsetHeight / 2) + (t = "+m+" ? "+m+" : "+h+') + "px"',q="("+k+" || "+e+") / 2 - (this.offsetWidth / 2) + (t = "+l+" ? "+l+" : "+g+') + "px"';n.removeExpression("top"),n.removeExpression("left"),n.setExpression("top",o),n.setExpression("left",q)}}})},focus:function(b){var c=this,d=b&&a.inArray(b,["first","last"])!==-1?b:"first",e=a(":input:enabled:visible:"+d,c.d.wrap);setTimeout(function(){e.length>0?e.focus():typeof c.d.wrap!="undefined"&&c.d.wrap.focus()},10)},getDimensions:function(){var c=this,d=typeof window.innerHeight=="undefined"?e.height():window.innerHeight;b=[a(document).height(),a(document).width()],f=[a(window).height(),a(window).width()]},getVal:function(a,b){return a?typeof a=="number"?a:a==="auto"?0:a.indexOf("%")>0?parseInt(a.replace(/%/,""))/100*(b==="h"?f[0]:f[1]):parseInt(a.replace(/px/,"")):null},update:function(a,b){var c=this;if(!c.d.data)return!1;c.d.origHeight=c.getVal(a,"h"),c.d.origWidth=c.getVal(b,"w"),c.d.data.hide(),a&&c.d.container.css("height",a),b&&c.d.container.css("width",b),c.setContainerDimensions(),c.d.data.show(),c.o.focus&&c.focus(),c.unbindEvents(),c.bindEvents()},setContainerDimensions:function(){var a=this,b=g.ie6||g.ie7,c=a.d.origHeight?a.d.origHeight:g.opera?a.d.container.height():a.getVal(b?a.d.container[0].currentStyle.height:a.d.container.css("height"),"h"),d=a.d.origWidth?a.d.origWidth:g.opera?a.d.container.width():a.getVal(b?a.d.container[0].currentStyle.width:a.d.container.css("width"),"w"),e=a.d.data.outerHeight(!0),h=a.d.data.outerWidth(!0);a.d.origHeight=a.d.origHeight||c,a.d.origWidth=a.d.origWidth||d;var i=a.o.maxHeight?a.getVal(a.o.maxHeight,"h"):null,j=a.o.maxWidth?a.getVal(a.o.maxWidth,"w"):null,k=i&&i<f[0]?i:f[0],l=j&&j<f[1]?j:f[1],m=a.o.minHeight?a.getVal(a.o.minHeight,"h"):"auto";c?c=a.o.autoResize&&c>k?k:c<m?m:c:e?e>k?c=k:a.o.minHeight&&m!=="auto"&&e<m?c=m:c=e:c=m;var n=a.o.minWidth?a.getVal(a.o.minWidth,"w"):"auto";d?d=a.o.autoResize&&d>l?l:d<n?n:d:h?h>l?d=l:a.o.minWidth&&n!=="auto"&&h<n?d=n:d=h:d=n,a.d.container.css({height:c,width:"100%"}),a.d.wrap.css({overflow:e>c||h>d?"auto":"visible"}),a.o.autoPosition&&a.setPosition()},setPosition:function(){var a=this,b,c,d=f[0]/2-a.d.container.outerHeight(!0)/2,g=f[1]/2-a.d.container.outerWidth(!0)/2,h=a.d.container.css("position")!=="fixed"?e.scrollTop():0;a.o.position&&Object.prototype.toString.call(a.o.position)==="[object Array]"?(b=h+(a.o.position[0]||d),c=a.o.position[1]||g):(b=h+d,c=g),a.d.container.css({left:0,top:b})},watchTab:function(b){var c=this;if(a(b.target).parents(".simplemodal-container").length>0){c.inputs=a(":input:enabled:visible:first, :input:enabled:visible:last",c.d.data[0]);if(!b.shiftKey&&b.target===c.inputs[c.inputs.length-1]||b.shiftKey&&b.target===c.inputs[0]||c.inputs.length===0){b.preventDefault();var d=b.shiftKey?"last":"first";c.focus(d)}}else b.preventDefault(),c.focus()},open:function(){var b=this;b.d.iframe&&b.d.iframe.show(),a.isFunction(b.o.onOpen)?b.o.onOpen.apply(b,[b.d]):(b.d.overlay.show(),b.d.container.show(),b.d.data.show()),b.o.focus&&b.focus(),b.bindEvents()},close:function(){var b=this;if(!b.d.data)return!1;b.unbindEvents();if(a.isFunction(b.o.onClose)&&!b.occb)b.occb=!0,b.o.onClose.apply(b,[b.d]);else{if(b.d.placeholder){var c=a("#simplemodal-placeholder");b.o.persist?c.replaceWith(b.d.data.removeClass("simplemodal-data").css("display",b.display)):(b.d.data.hide().remove(),c.replaceWith(b.d.orig))}else b.d.data.hide().remove();b.d.container.hide().remove(),b.d.overlay.hide(),b.d.iframe&&b.d.iframe.hide().remove(),b.d.overlay.remove(),b.d={}}}}}),define("events/eventid",{EID_SWITCH:1,EID_CLICK:2,EID_OPENNODE:3,EID_CLOSENODE:4,EID_INPUT:5,EID_SWITCH_HIERPOPUP:6,EID_SELECTNODE:11,EID_MULTISELECTION:15,EID_OPENSTARTDOC:100,EID_SENDUSERPARAM:103,EID_SENDAPPLETPROPS:107,EID_DROP:115,EID_OPENBOOKMARK:117,EID_ONVIEWCHANGED:118,EID_DOCACTIVATE:104}),define("browserfeatures",["jquery"],function(a){function e(){var a=window.navigator.userAgent,c=a.indexOf("MSIE ");window.chrome?b.useChrome=!0:b.useChrome=!1,c>0?b.IEVersion=parseInt(a.substring(c+5,a.indexOf(".",c)),10):b.IEVersion=/rv:11.0/i.test(navigator.userAgent)?11:undefined}function f(c){var d,e,f=0;if(b.useChrome&&window.devicePixelRatio!==1){d='<div id="measureTableLineHeightDiv" style="left: 0px; top: 0px; position: absolute;width: 50px; height: 60px; "><div style="left: 0px; top: 0px; position: relative; width: 50px; height: 60px; overflow: hidden;"><table cellspacing="0" class="dynaTable '+c+'" style="left: 0px; top: 0px; position: relative; border-collapse: separate; width: 50px; height: 60px;">'+"<tbody>"+'<tr><td  style="height:19px"><div class="arcTdWrapOuter" style="height:19px"><div class="arcTdWrapInner"><div class="arcTdInnerDiv">1</div></div></div></td></tr>'+'<tr><td  style="height:19px"><div class="arcTdWrapOuter" style="height:19px"><div class="arcTdWrapInner"><div class="arcTdInnerDiv">2</div></div></div></td></tr>'+'<tr><td  style="height:19px"><div class="arcTdWrapOuter" style="height:19px"><div class="arcTdWrapInner"><div class="arcTdInnerDiv">3</div></div></div></td></tr>'+"</tbody>"+"</table>"+"</div>"+"</div>";try{a("body").append(d),e=a("#measureTableLineHeightDiv td")[0].getBoundingClientRect().height,window.devicePixelRatio<1&&window.devicePixelRatio>=.5?f=-((e-20)*2):window.devicePixelRatio>1.1&&window.devicePixelRatio<1.2&&(c?f=-((20-e)*2):f=(20-e)*2)}catch(g){window.console.warn("error on measureZoomOffsetTableTdHeight"+g)}finally{a("#measureTableLineHeightDiv").remove()}}return f}var b={},c={svg:"http://www.w3.org/2000/svg"},d;return function(){function a(a){return setTimeout(a,100)}var b=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||a;window.requestAnimationFrame=b}(),function(){function a(a){window.clearTimeout(a)}var b=window.cancelAnimationFrame||window.mozCancelAnimationFrame||a;window.cancelAnimationFrame=b}(),b.canUseInnerHTMLOnTable=function(){try{var b=a("<table><tbody></tbody></table>");return a("tbody",b)[0].innerHTML="<tr><td>funktioniert</td></tr>",a("tbody",b)[0].innerHTML==="<tr><td>funktioniert</td></tr>"?!0:!1}catch(c){return!1}}(),b.smil=!!document.createElementNS&&/SVGAnimate/.test(Object.prototype.toString.call(document.createElementNS(c.svg,"animate"))),b.touch="ontouchstart"in document.documentElement||window.navigator.msMaxTouchPoints>0,b.compatibilityMode=function(){return b.IEVersion&&document.documentMode&&document.documentMode<9?!0:!1},b.compatibilityModeForCssPointerEvents=function(){if(typeof d!="undefined")return d;if(b.IEVersion){if(document.documentMode&&document.documentMode<11)return d=!1,!1;if(b.IEVersion<11)return d=!1,!1}else if(Object.prototype.toString.call(window.operamini)==="[object OperaMini]")return d=!1,!1;return d=!0,!0},b.clientLanguage=navigator.language||navigator.userLanguage,b.scrollbarWidth=window.orientation!==undefined?0:17,b.measureScrollbarWidth=function(){var a,b;return window.orientation!==undefined?b=0:(a=document.createElement("div"),a.style.width="1000px",a.style.height="1000px",a.style.overflow="scroll",a.style.position="absolute",a.style.top="-9999px",document.body.appendChild(a),b=a.offsetWidth-a.clientWidth,document.body.removeChild(a)),b},b.svg=function(){return!!document.createElementNS&&!!document.createElementNS(c.svg,"svg").createSVGRect}(),b.nativeTouchControls=b.touch&&window.orientation!==undefined,b.getDocumentScrollPosition=function(){return{left:a(document).scrollLeft(),top:a(document).scrollTop()}},b.getWindowSize=function(){return{width:a(window).width(),height:a(window).height()}},b.getDocumentSize=function(){return{width:a(document).width(),height:a(document).height()}},b.mobile=!0,navigator.userAgent.match(/iPhone/)?b.platformType="iPhone":navigator.userAgent.match(/iPad/)?b.platformType="iPad":navigator.userAgent.match(/Android/)?b.platformType="Android":navigator.userAgent.match(/Blackberry/)?b.platformType="Blackberry":navigator.userAgent.match(/PlayBook/)?b.platformType="PlayBook":navigator.userAgent.match(/Kindle/)?b.platformType="Kindle":navigator.userAgent.match(/Windows Phone/)?b.platformType="Windows Phone":(b.platformType="Desktop/Unknown",b.mobile=!1),b.measureZoomOffsetHeightWithBorder=function(){var b,c,d,e=0;if(window.devicePixelRatio!==1){b='<div id="testZoomHeightDiv" style="position:absolute;top:0px;opacity:0"><div class="arcHier arcVert arcBox arcLine"><ol style="position: relative; top: 8100px; height: 40px;"><li style="border-top-width: 1px; border-left-width: 1px; line-height:19px;"><div draggable="true" style="height:19px;"><a draggable="false" ><span></span>1</a></div></li><li style="border-top-width: 1px; border-left-width: 1px; line-height:19px;"><div draggable="true" style="height:19px;"><a draggable="false" ><span></span>1</a></div></li></ol></div></div>';try{a("body").append(b),c=a("#testZoomHeightDiv li"),d=c.height(),d!==19&&(d>19?e=d-19:d>18&&(e=d-18),window.devicePixelRatio<1&&(e*=-1),window.devicePixelRatio<1&&(e=0))}catch(f){window.console.warn("error on measureZoomOffsetLineHeightWithTopBorder"+f)}finally{a("#testZoomHeightDiv").remove()}}return e},e(),b.measureZoomOffsetTdHeightWithBorder=function(){return f("arcHideVertGrid arcShowHoriGrid")},b.measureZoomOffsetTdHeightWithoutBorder=function(){return f()},b.zoomOffsetHeightWithBorder=0,b.zoomOffsetTableTdHeightWithBorder=0,b.zoomOffsetTableTdHeightWithoutBorder=0,b.c_DivSizeLimit=144e4,b}),define("popuppositioner",["browserfeatures"],function(a){function d(b,c){return b>c?a.scrollbarWidth:0}function e(b,c){return b>c?a.scrollbarWidth:0}var b={},c=10;return b.getPopupPosition=function(b,f,g,h,i){function s(){var a,d,e=b-l.left,f=e+g,h=j.width-m-c;f>h&&(b>g?o=b-(g+c):(a=h-e,d=h-a-c,a>=d?q=a:(o=b-d,q=d)))}function t(){var a,b,d=f-l.top,e=d+h,g=j.height-c-i.top;e>g&&(f>h?p=f-h:(b=g-d,a=g-b-c,b>=a?r=b:(p=f-a,r=a)))}var j=a.getWindowSize(),k=a.getDocumentSize(),l=a.getDocumentScrollPosition(),m=d(k.width,j.width),n=e(k.height,j.height),o=b,p=f,q=g,r=h;return s(),t(),{left:o,top:p,width:q,height:r}},b.getMenuPopupPosition=function(b,e,f,g,h,i){function z(){var a,d,f=n.top,g=y+b.top-f-p,h;o=w?o:0,h=u-o-c,d=h-(g+x),a=h-d-x-c,d>=e.height||d>=a?t=Math.min(d,e.height):(t=Math.min(a,e.height),q=y-t)}function A(){function d(){return t<e.height}var g=b.left-n.left-i.left,h=d()?a.scrollbarWidth:0,j=w?a.scrollbarWidth:0,l=v-c*2+j,m;s+=h,s=Math.min(l,s),m=g+s+r,m>l?(r-=m-l,r<-g+c&&(r=-g+c)):!f&&g-c<0&&(r=r-g+c,r>k&&(r=k))}var j=b.height,k=b.width,l=a.getWindowSize(),m=a.getDocumentSize(),n=a.getDocumentScrollPosition(),o=d(m.width,l.width),p=n.top-i.top<0?i.top-n.top:0,q=j,r=0,s=e.width,t=e.height,u=Math.min(h.height,l.height-p),v=Math.min(h.width,l.width),w,x,y;return f?(y=f.top-b.top+g.top,r=f.left-b.left+g.left,x=0,q=y,f.height&&(q+=f.height,x+=f.height)):(x=j,y=0),w=n.top>0&&h.height+g.top+o>=m.height,z(),A(),{left:r,top:q,width:s,height:t}},b}),define("datavirtualization/divsizelimithandler",["browserfeatures","assert/assert"],function(a,b){function d(b,c,d){return Math.round(b*(a.c_DivSizeLimit-a.scrollbarWidth-c)/(d-c))}function e(b,c,d){return Math.round(b*(d-c)/(a.c_DivSizeLimit-a.scrollbarWidth-c))}var c={};return c.domToLogicalPosition=function(b,c,d){var f={x:b.x,y:b.y};return c.width>a.c_DivSizeLimit-a.scrollbarWidth&&(f.x=e(f.x,d.width,c.width)),c.height>a.c_DivSizeLimit-a.scrollbarWidth&&(f.y=e(f.y,d.height,c.height)),f},c.determinePagePositionByDomScrollPosition=function(a,b,d,e){var f={},g=c.domToLogicalPosition(a,d,e);return f.left=b.left+a.x-g.x,f.top=b.top+a.y-g.y,f},c}),define("datavirtualization/tabledomupdaterfactory",["browserfeatures","scrollstates","assert/assert","tooltiptypes"],function(a,b,c,d){function e(c){function o(b){if(!k||k.length===0)k=$("tbody:first",c);if(k.length>0)if(a.canUseInnerHTMLOnTable)l[0].innerHTML=b.colgroupHtml+b.rowHtml;else{if(!k||k.length===0)k=$("tbody:first",c);if(b.colgroupHtml!==""){if(!j||j.length===0)j=$("colgroup:first",c);l[0].replaceChild($(b.colgroupHtml)[0],j[0]),j=$("colgroup:first",c)}l[0].replaceChild($("<tbody>"+b.rowHtml+"</tbody>")[0],k[0]),k=$("tbody:first",c)}}function p(a){l.css({left:a.left+"px",top:a.top+"px",width:a.width+"px",height:a.height+"px"})}function q(){if(!l||l.length===0)i=c.children(":first"),l=$("table:first",c),j=$("colgroup:first",c),k=$("tbody:first",c),m=l.parent(),n=m.parent()}function r(a,b){return $("td:nth-child("+(a+1)+")",$("tr:nth-child("+(b+1)+")",l))}function s(b,c,d){var e;c=a.scrollbarWidth+1,e=-d/2,b.css("left",e+"px"),b.width(c)}var e={},f,g,h,i,j,k,l,m,n;return e.updateInputValue=function(a,b,c,d){var e,g=r(a,b);typeof c!="undefined"&&g.length>0&&(l.parent().height()===0&&(l.parent().height(d),g.css("text-align","left")),g.children().length>0?(e=g.find("input:first"),e.length>0?e.attr("value",c):g.find(".arcTdInnerDiv").text(c)):g.text(c),f="")},e.insertRangeIntoDom=function(a){q(),f!==a.rowHtml&&(f=a.rowHtml,o(a))},e.updateVirtualSizeAndScrollStates=function(c,d,e,f,g,i){var j="auto",k="auto",l={height:0,width:0},o={height:0,width:0},p,r,t;q(),a.mobile&&window.iScroll?j="hidden":f===b.EHidden?(e+=a.scrollbarWidth,j="scroll"):f===b.EPrevented&&(j="hidden"),a.mobile&&window.iScroll?k="hidden":g===b.EHidden?(d+=a.scrollbarWidth,k="scroll"):g===b.EPrevented&&(k="hidden"),m.length===1&&n.length===1&&(p={width:c.width+"px",height:c.height+"px",overflowX:"hidden",overflowY:"hidden"},r={width:d,height:e,overflowX:j,overflowY:k},t={tableParentSizeAndScrollState:p,scrollElemSizeAndScrollState:r},m.css(p),n.css(r),h=t,d<=a.scrollbarWidth&&s(n,d,i))},e.updateCell=function(a,b,c){var d;q(),d=r(b,c),d.length===1&&d.replaceWith(a)},e.applySelection=function(a,b){var d=r(a,b);$(".selected",c).removeClass("selected"),d.length>0&&d.addClass("selected")},e.setFocus=function(){var a=c.hasClass("arcTextInputActive");q(),!a&&$(":focus",c).length===0&&i.focus()},e.setTablePositionAndSize=function(a){q(),g!==a&&(g=a,p(a))},e.updateTooltip=function(a,b){a===d.WholeObject?$(":first",c).attr("title",b):$(":first",c).attr("title","")},e}return{createInstance:e}}),define("version",["logger"],function(a){var b="8.6.1.7086",c={};return c.getVersion=function(){var a=b.split("."),c=a[3].substr(0,2);return parseInt(a[0],10)*16777216+parseInt(a[1],10)*65536+parseInt(a[2],10)*256+parseInt(c,10)},c.getReadableVersion=function(){return b},c.logVersion=function(){a.log("arcplan HTML5 client, version "+c.getReadableVersion())},c}),define("animationfactory",[],function(){var a={};return a.createAnimation=function(a,b,c,d){function i(a,b,c){return(c-b)*a+b}function j(a,b,c){var d,e,f,g,h,j,k;return g=parseFloat(b.split(",")[0]),h=parseFloat(c.split(",")[0]),e=i(a,g,h),j=parseFloat(b.split(",")[1]),k=parseFloat(c.split(",")[1]),f=i(a,j,k),d=e+","+f,d}function k(a,b,c){var d=b.split(" "),e=c.split(" "),f,g=d.length,h="",i=0,k=0,l=0,m=0,n,o,p;for(f=0;f<g;f+=1)n=d[f],o=e[f],p=j(a,n,o),h+=p+" ";return h.trim(" ")}function l(a,b){var c=Math.floor((a.length-1)*b),d=Math.min(a.length-1,c+1),e,f,g,h,i;return d!==c?(e=c/(a.length-1),f=d/(a.length-1),g=f-e,h=(b-e)/g,i=k(h,a[c].trim(" "),a[d].trim(" ")),i):a[c]}function m(a,b){var c=Math.floor((a.length-1)*b),d=Math.min(a.length-1,c+1),e,f,g,h;return d!==c?(e=c/(a.length-1),f=d/(a.length-1),g=f-e,h=(b-e)/g,i(h,parseFloat(a[c]),parseFloat(a[d]))):parseFloat(a[c])}function n(a,b){switch(f){case"transform":return;case"points":return l(a,b);default:return m(a,b)}}function o(a){var b,c=!1,d;return a>=1&&(a=1,c=!0),b=g.split(";"),d=n(b,a),f==="opacity"?$(e).css(f,d):e.setAttribute(f,d),c?!0:!1}var e=a,f=b,g=c,h=d;return{setAnimationToFractionOfDuration:o}},a}),define("motionchartviewmodel",["logger","animationfactory"],function(a,b){function c(c,d){function f(b,c){var d=e.svgRoot[0].getScreenCTM(),f=e.svgRoot[0].createSVGPoint();return f.x=b,f.y=c,isNaN(f.x)?(a.warn("wrong Point: p.x: "+f.x+" event: "+event),f={x:-1,y:-1}):f=f.matrixTransform(d.inverse()),f}function g(a){return f(a.clientX,a.clientY)}function h(a){return a.touches&&a.touches.length>0?f(a.touches[0].clientX,a.touches[0].clientY):{x:-1,y:-1}}function i(a,b){return a/(b-1)}function j(b){var c=$("#sliderHandle",e.svgRoot),d=e.sliderValues.split(";"),f,g,h,j;e.sliderValues&&e.sliderValues.length===0&&a.warn("There are no values for slider positions."),b.x!==-1&&b.y!==-1&&(f=k(b,d),f>=0?(h=d.length,j=i(f,h),o(j)):a.warn("wrong index: "+f+"SVGPoint: "+"x:"+b.x+"y:"+b.y))}function k(a,b){var c,d,e,f,g;return c=parseFloat(b[0]),d=parseFloat(b[b.length-1]),e=Math.max(a.x,c),e=Math.min(e,d),g=(e-c)/(d-c),f=Math.round(parseFloat(b.length-1)*g),f}function l(a,b,c,d){var e,f,g,h,i=b.Elements?b.Elements[1].NumRows:0,j=b.Elements?b.Elements[0].NumCols:0,k;a&&(e=a.attr("id"),typeof e=="string"&&(h=(new RegExp("^[0-9]{3}_([0-9]{3})_([0-9]{3})_[0-9]{3}.*")).exec(e),h.length===3&&(f=parseInt(h[1],10),g=parseInt(h[2],10),!isNaN(f)&&!isNaN(g)&&!isNaN(j)&&!isNaN(i)&&(c?k=2+f*j+g:k=2+g*j+f,k<i*j+2&&(d.textContent=b.Elements[k].ToolTip)))))}function m(a,b){var c=$("title",e.svgRoot),d,f,g;for(d=0;d<c.length;d+=1)f=c[d],g=$(f).parent(),l(g,a,b,f)}function n(a){var b,c=e.TooltipMap.Elements[0].transposed==="true";a+1<e.TooltipMap.Elements.length&&e.TooltipMap.Elements[a+1].ToolTip&&(b=e.TooltipMap.Elements[a+1].ToolTip,m(b,c))}function o(a){var b=Math.round(parseFloat(e.settings.length-1)*a),c,d=!1,f=e.animations.length;b>=0&&e.settings[b]&&(e.currentSetting(e.settings[b]),e.TooltipMap&&n(b));for(c=0;c<f;c+=1)d=e.animations[c].setAnimationToFractionOfDuration(a)||d;e.isRunning()&&d&&e.pauseUnpauseAnimation()}function p(a){var b=a/(e.duration*1e3);o(b)}function q(){var a=0,b=$("#sliderHandle",e.svgRoot),c,d=e.sliderValues.split(";"),f,g,h,i,j;return j=b.attr("x"),d.length>1&&(f=parseFloat(d[0]),g=parseFloat(d[d.length-1]),h=Math.max(j,f),h=Math.min(h,g),i=(h-f)/(g-f),i>=1?a=0:a=i*e.duration*1e3),a}function r(a){var c=$("animate,animateTransform",a),d=[],f,g,h,i,j=c.length;for(g=0;g<j;g+=1){h=$(c[g]),i=h.attr("values"),i||h.attr("from")&&h.attr("to")&&(i=h.attr("from")+";"+h.attr("to"));if(!i)continue;f=b.createAnimation(h.parent()[0],h.attr("attributeName"),i,parseFloat(h.attr("dur"))),$(h.parent()[0]).attr("id")==="sliderHandle"&&(e.sliderValues=h.attr("values"),e.sliderValues||h.attr("from")&&h.attr("to")&&(e.sliderValues=h.attr("from")+";"+h.attr("to"))),d.push(f),e.duration=parseFloat(h.attr("dur")),h.remove()}return d}var e=this;e.settings=[],e.svgRoot=$(c),e.requestId=0,e.duration=1,e.starttime=0,e.sliderValues="",e.TooltipMap=[],e.setSliderPosition=function(a,b){var c=g(b);j(c)},e.currentCursor=document.body.style.cursor,e.setHandCursor=function(a,b){e.currentCursor=b.target.style.cursor,b.target.style.cursor="pointer"},e.resetCursor=function(a,b){b.target.style.cursor=e.currentCursor},e.isRunning=d.observable(!1),e.isDragging=d.observable(!1),e.currentSetting=d.observable(""),e.startDragSlider=function(a,b){var c;this.isDragging(!0),this.svgRoot&&this.isRunning()&&(c=$("currentValue",this.svgRoot),this.isRunning(!1),this.svgRoot[0].pauseAnimations(),c&&c.attr("opacity",1))},e.stopDragSlider=function(a,b){this.isDragging(!1)},e.handleMouseMove=function(a,b){if(this.isDragging()){var c=g(b);j(c)}},e.touchMoveSlider=function(a,b){if(this.isDragging()){var c=h(b);j(c)}},e.pauseUnpauseAnimation=function(a){var b,c;this.svgRoot&&(c=$("#currentValue",this.svgRoot),this.isRunning(!this.isRunning()),this.isRunning()?(b=q(),this.starttime=Date.now()-b,this.requestId=window.requestAnimationFrame(this.step)):this.requestId&&window.cancelAnimationFrame(this.requestId))},e.handleEndEvent=function(a){this.isRunning(!1)},e.setSettings=function(){for(var a=0;a<arguments.length;a+=1)this.settings[a]=arguments[a];this.settings.length>0&&this.currentSetting(this.settings[0])},e.setTooltips=function(a){e.TooltipMap=a.ToolTipMap},e.animations=r(c),e.isClosed=!1,e.step=function(a){!e.isClosed&&e.isRunning()&&(p(Date.now()-e.starttime),e.requestId=window.requestAnimationFrame(e.step))},o(0),function(){$(e.svgRoot).unload(function(){e.isClosed=!0,e.isRunning(!1),e.requestId&&window.cancelAnimationFrame(e.requestId)})}()}return{CMotionChartViewModel:c}}),define("stringsen",{UNKNOWN_ERROR_TITLE:"Unknown error",UNKNOWN_ERROR:"An unknown error occured",ARCPLAN_SERVER_NOT_AVAILABLE:"The arcplan server is not available.",ARCPLAN_SERVER_EXCEPTION:"An exception occured on the server. Please restart.",CGI_ERROR_TITLE:"CGI error",NETWORK_ERROR_TITLE:"Network error",NETWORK_ERROR:"An error occured while contacting the server",CONFIGURATION_ERROR_TITLE:"Configuration error",PROTOCOL_MISMATCH:"Protocol mismatch for the cgi url",INTERNAL_ERROR_TITLE:"Internal error",INTERNAL_ERROR:"An internal error occured",DATA_ERROR_TITLE:"Data error",READING_SERVER_ANSWER_ERROR:"An error occured while reading the server answer",NO_SESSIONID:"The server returned no Session ID",NOTHML5_USAGE:"The usage of the HTML5 client is not allowed by the current license.",NOHTML5_MOBILEUSAGE:"The usage of the HTML5 client on mobile devices is not allowed by the current license.",NOMOBILE_CLIENT_LICENSE:"The usage of mobile devices is not allowed by the current license.",LICENCE_EXCEEDED:"The number of licensed concurrent users has currently been exceeded. Please contact your system administrator.",LICENCE_EXPIRED:"The arcplan license is invalid or has expired.",SESSION_END:"The connection was not used for some time. It was therefore terminated by the server. Please refresh the page.",WIDGET_OPEN_ANOTHER_DOCUMENT_QUESTION:"The application tries to navigate to another document. Do you want to open that document in a new window?",LICENCE_ERROR_TITLE:"License error",NOT_IMPLEMENTED_TITLE:"Not yet implemented",INFORMATION_TITLE:"Information",INFORMATION_TEXT:"This is an informational text.",SERVER_ERROR_TITLE:"Server error",SERVER_MESSAGE_TITLE:"Server message",NOTIMPLEMENTED_UNSERINFOSTYPE:"The Server sent an answer of a not implemented type:<br> {0}, {1}",COMPATIBILITY_WARNING:"Internet Explorer 9 mode is needed",COMPATIBILITY_WARNING_TITLE:"Compatibility Warning",CLIENT:"Client",WINDOWS_USER:"Windows User",ARCPLAN_USER:"arcplan User",USERNAME:"User name",PASSWORD:"Password",KEEP_LOGGEDIN:"Keep me logged in",OK:"Ok",CANCEL:"Cancel",YES:"Yes",NO:"No",LANGUAGE:"Language",LOGIN:"Login",USER_LOGIN:"User Login",UPLOAD_TITLE:"Upload File",UPLOAD_SELECT_FILE:"Please select file to upload: ",UPLOAD_IN_PROGRESS:"Upload in progress... ",UPLOAD_BROWSE:"Browse...",OPENLINK_TITLE:"Do you want to open this link in a new window?",OPENLINK_ALL_TITLE:"Do you want to open all links in a separate new window?",OPEN:"Open",DATA_ERROR_NO_BODY:"Data Error. The request contains no Data.",FILE_UPLOAD_FAILED:"File upload failed",SHOW_DETAILS:"Show details",PASSWORDNOTSAVED:"The password could not be saved.",NOT_FOR_PR_USAGE:"NOT FOR PRODUCTION USAGE",LICENSEDFOR:"Licensed Products",LICENSEOWNER:"License Owner: ",EVALUATIONVERSION:"Evaluation License",PARTNERVERSION:"Partner License",TESTORBACKUPVERSION:"Test / Backup License",ARCPLAN_MEMORY_OVERLOAD:"The session was canceled because the memory consumption was too high.",SHAREDWIDGET_CONSUMERINFO:"You don't have write permissions on this shared widget.{newline}Use the Shared Widget Menu to create a copy or contact the owner.",SHAREDWIDGET_OWNERINFO:"This is a shared widget. Saved filter settings will be shared with&nbsp;",SHAREDWIDGET_OWNERINFO_MANYUSERS:"{usercount} other users.",SHAREDWIDGET_OWNERINFO_ONEUSER:"one other user.",SHAREDWIDGET_OWNERINFO_NOUSERS:"no other users until now.",SPLASHSCREEN_LOADING_APPLICATION:"Loading Application",OPEN_SPOTLIGHTLINK_TITLE:"Open arcplan Spotlight",OPEN_SPOTLIGHTLINK_DESCRIPTION:"Proceed your analysis with arcplan Spotlight in a new window.",LONGVIEW_GROUP:"Longview Group",LONGVIEW_GROUP_DESCRIPTION:"You are member of the following groups. Select the group to be used for this session:",LOGIN_AS_ANOTHER_USER_TYPE:"Change login option",CHANGE_PASSWORD:"Change password",OLD_PASSWORD:"Old password",NEW_PASSWORD:"New password",CONFIRMATION:"Confirm new password",CONFIRM_PASSWORD_NOT_MATCH:"Passwords do not match.",ENTER_OLD_PASSWORD:"Please enter old password.",ENTER_NEW_PASSWORD:"Please enter new password.",ENTER_CONFIRM_NEW_PASSWORD:"Please confirm new password.",EMPTY_STRING:["",""]}),define("stringsde",{UNKNOWN_ERROR_TITLE:"Unbekannter Fehler",UNKNOWN_ERROR:"Ein unbekannter Fehler ist aufgetreten",ARCPLAN_SERVER_NOT_AVAILABLE:"Der arplan Server konnte nicht erreicht werden.",ARCPLAN_SERVER_EXCEPTION:"Auf dem Server ist ein Fehler aufgetreten. Bitte starten Sie neu.",CGI_ERROR_TITLE:"CGI-Fehler",NETWORK_ERROR_TITLE:"Netzwerkfehler",NETWORK_ERROR:"Bei der Verbindung zum arcplan Server ist ein Fehler aufgetreten.",CONFIGURATION_ERROR_TITLE:"Konfigurationsfehler",PROTOCOL_MISMATCH:"Das Protokoll für die Cgi Url ist falsch",INTERNAL_ERROR_TITLE:"Interner Fehler",INTERNAL_ERROR:"Ein interner Fehler ist auftreten",DATA_ERROR_TITLE:"Datenfehler",READING_SERVER_ANSWER_ERROR:"Beim Lesen der Server-Antwort ist ein Fehler aufgetreten.",NO_SESSIONID:"Der Server lieferte keine Session ID",NOTHML5_USAGE:"Die aktuell verwendete Lizenz erlaubt nicht die Benutzung des Html5 Clients",NOHTML5_MOBILEUSAGE:"Die aktuell verwendete Lizenz erlaubt nicht die Benutzung des Html5 Clients auf mobilen Geräten",NOMOBILE_CLIENT_LICENSE:"Die aktuell verwendete Lizenz erlaubt nicht die Benutzung von mobilen Geräten.",LICENCE_EXCEEDED:"Die Anzahl lizenzierter gleichzeitiger Nutzer ist gegenwärtig überschritten. Bitte benachrichtigen Sie Ihren Systemadministrator.",LICENCE_EXPIRED:"Die Version des arcplan Application Servers ist ungültig oder abgelaufen.",SESSION_END:"Die Verbindung wurde längere Zeit nicht benutzt. Die Verbindung wurde daher beendet. Bitte starten Sie neu.",WIDGET_OPEN_ANOTHER_DOCUMENT_QUESTION:"Die Applikation möchte zu einem anderen Dokument navigieren. Wollen Sie dieses nun in einem neuen Fenster anzeigen?",LICENCE_ERROR_TITLE:"Lizenzfehler",NOT_IMPLEMENTED_TITLE:"Noch nicht implementiert",INFORMATION_TITLE:"Information",INFORMATION_TEXT:"Das ist ein Informationstext.",SERVER_ERROR_TITLE:"Serverfehler",SERVER_MESSAGE_TITLE:"Servermeldung",NOTIMPLEMENTED_UNSERINFOSTYPE:"Der Server schickte eine nicht implementierte Antwort vom Typ:<br> {0}, {1}",COMPATIBILITY_WARNING:"Internet Explorer 9 ist erforderlich",COMPATIBILITY_WARNING_TITLE:"Kompatibilitätswarnung",CLIENT:"Client",WINDOWS_USER:"Windows Benutzer",ARCPLAN_USER:"arcplan Benutzer",USERNAME:"Benutzername",PASSWORD:"Passwort",KEEP_LOGGEDIN:"Angemeldet bleiben",OK:"Ok",CANCEL:"Abbrechen",YES:"Ja",NO:"Nein",LANGUAGE:"Sprache",LOGIN:"Login",USER_LOGIN:"Benutzeranmeldung",UPLOAD_TITLE:"Datei hochladen",UPLOAD_SELECT_FILE:"Wählen Sie bitte eine Datei aus: ",UPLOAD_IN_PROGRESS:"Datei wird hochgeladen... ",UPLOAD_BROWSE:"Durchsuchen...",OPENLINK_TITLE:"Möchten Sie diesen Link in einem neuen Fenster öffnen?",OPENLINK_ALL_TITLE:"Möchten Sie jeden Link in einem neuen Fenster öffnen?",OPEN:"Öffnen",DATA_ERROR_NO_BODY:"Datenfehler. Die Anfrage enthält keine Daten.",FILE_UPLOAD_FAILED:"Hochladen der Datei fehlgeschlagen",SHOW_DETAILS:"Details anzeigen",PASSWORDNOTSAVED:"Das Passwort konnte nicht gespeichert werden.",NOT_FOR_PR_USAGE:"NICHT FÜR DEN PRODUKTIVEN EINSATZ",LICENSEDFOR:"Lizenzierte Produkte",LICENSEOWNER:"Lizenznehmer: ",EVALUATIONVERSION:"Evaluationslizenz",PARTNERVERSION:"Partner Lizenz",TESTORBACKUPVERSION:"Test- / Backup- Lizenz",ARCPLAN_MEMORY_OVERLOAD:"Die Sitzung wurde abgebrochen weil der Speicherbedarf zu groß war.",SHAREDWIDGET_CONSUMERINFO:"Sie haben keine Schreiberechtigung auf dieser gemeinsamen Widget.{newline}Verwenden Sie das Shared-Widget-Menü, um eine Kopie zu erstellen oder den Besitzer zu kontaktieren.",SHAREDWIDGET_OWNERINFO:"Dies ist eine gemeinsame Widget. Gespeicherte Filtereinstellungen werden&nbsp;",SHAREDWIDGET_OWNERINFO_MANYUSERS:"mit {usercount} anderen Nutzern geteilt.",SHAREDWIDGET_OWNERINFO_ONEUSER:"mit einem anderen Nutzer geteilt.",SHAREDWIDGET_OWNERINFO_NOUSERS:"bisher mit keinem anderen Nutzer geteilt.",SPLASHSCREEN_LOADING_APPLICATION:"Lade Applikation",OPEN_SPOTLIGHTLINK_TITLE:"arcplan Spotlight öffnen",OPEN_SPOTLIGHTLINK_DESCRIPTION:"Setzen Sie Ihre Analyse mit arcplan Spotlight in einem neuen Fenster fort.",LONGVIEW_GROUP:"Longview Gruppe",LONGVIEW_GROUP_DESCRIPTION:"Sie sind Mitglied in folgenden Gruppen. Wählen Sie die Gruppe aus, die für diese Sitzungen verwendet werden soll.",LOGIN_AS_ANOTHER_USER_TYPE:"Anmeldeoption wechseln",CHANGE_PASSWORD:"Passwort ändern",OLD_PASSWORD:"Altes Passwort",NEW_PASSWORD:"Neues Passwort",CONFIRMATION:"Passwortwiederholung",CONFIRM_PASSWORD_NOT_MATCH:"Passwörter stimmen nicht überein.",ENTER_OLD_PASSWORD:"Bitte Geben Sie Ihr altes Passwort ein.",ENTER_NEW_PASSWORD:"Bitte Geben Sie Ihr neues Passwort ein.",ENTER_CONFIRM_NEW_PASSWORD:"Bitte bestätigen Sie Ihr neues Passwort.",EMPTY_STRING:["",""]}),define("stringsid",{UNKNOWN_ERROR_TITLE:"UNKNOWN_ERROR_TITLE",UNKNOWN_ERROR:"UNKNOWN_ERROR",ARCPLAN_SERVER_NOT_AVAILABLE:"ARCPLAN_SERVER_NOT_AVAILABLE",ARCPLAN_SERVER_EXCEPTION:"ARCPLAN_SERVER_EXCEPTION",CGI_ERROR_TITLE:"CGI_ERROR_TITLE",NETWORK_ERROR_TITLE:"NETWORK_ERROR_TITLE",NETWORK_ERROR:"NETWORK_ERROR",CONFIGURATION_ERROR_TITLE:"CONFIGURATION_ERROR_TITLE",PROTOCOL_MISMATCH:"PROTOCOL_MISMATCH",INTERNAL_ERROR_TITLE:"INTERNAL_ERROR_TITLE",INTERNAL_ERROR:"INTERNAL_ERROR",DATA_ERROR_TITLE:"DATA_ERROR_TITLE",READING_SERVER_ANSWER_ERROR:"READING_SERVER_ANSWER_ERROR",NO_SESSIONID:"NO_SESSIONID",NOTHML5_USAGE:"NOTHML5_USAGE",NOHTML5_MOBILEUSAGE:"NOHTML5_MOBILEUSAGE",NOMOBILE_CLIENT_LICENSE:"NOMOBILE_CLIENT_LICENSE",LICENCE_EXCEEDED:"LICENCE_EXCEEDED",LICENCE_EXPIRED:"LICENCE_EXPIRED",SESSION_END:"SESSION_END",WIDGET_OPEN_ANOTHER_DOCUMENT_QUESTION:"WIDGET_OPEN_ANOTHER_DOCUMENT_QUESTION",LICENCE_ERROR_TITLE:"LICENCE_ERROR_TITLE",NOT_IMPLEMENTED_TITLE:"NOT_IMPLEMENTED_TITLE",INFORMATION_TITLE:"INFORMATION_TITLE",INFORMATION_TEXT:"INFORMATION_TEXT",SERVER_ERROR_TITLE:"SERVER_ERROR_TITLE",SERVER_MESSAGE_TITLE:"SERVER_MESSAGE_TITLE",NOTIMPLEMENTED_UNSERINFOSTYPE:"NOTIMPLEMENTED_UNSERINFOSTYPE",COMPATIBILITY_WARNING:"COMPATIBILITY_WARNING",COMPATIBILITY_WARNING_TITLE:"COMPATIBILITY_WARNING_TITLE",CLIENT:"CLIENT",WINDOWS_USER:"WINDOWS_USER",ARCPLAN_USER:"ARCPLAN_USER",USERNAME:"USERNAME",PASSWORD:"PASSWORD",KEEP_LOGGEDIN:"KEEP_LOGGEDIN",OK:"OK",CANCEL:"CANCEL",YES:"YES",NO:"NO",LANGUAGE:"LANGUAGE",LOGIN:"LOGIN",USER_LOGIN:"USER_LOGIN",UPLOAD_TITLE:"UPLOAD_TITLE",UPLOAD_SELECT_FILE:"UPLOAD_SELECT_FILE",UPLOAD_IN_PROGRESS:"UPLOAD_IN_PROGRESS",UPLOAD_BROWSE:"UPLOAD_BROWSE",OPENLINK_TITLE:"OPENLINK_TITLE",OPENLINK_ALL_TITLE:"OPENLINK_ALL_TITLE",OPEN:"OPEN",DATA_ERROR_NO_BODY:"DATA_ERROR_NO_BODY",FILE_UPLOAD_FAILED:"FILE_UPLOAD_FAILED",SHOW_DETAILS:"SHOW_DETAILS",PASSWORDNOTSAVED:"PASSWORDNOTSAVED",NOT_FOR_PR_USAGE:"NOT_FOR_PR_USAGE",LICENSEDFOR:"LICENSEDFOR",LICENSEOWNER:"LICENSEOWNER",EVALUATIONVERSION:"EVALUATIONVERSION",PARTNERVERSION:"PARTNERVERSION",TESTORBACKUPVERSION:"TESTORBACKUPVERSION",ARCPLAN_MEMORY_OVERLOAD:"ARCPLAN_MEMORY_OVERLOAD",SHAREDWIDGET_CONSUMERINFO:"SHAREDWIDGET_CONSUMERINFO",SHAREDWIDGET_OWNERINFO:"SHAREDWIDGET_OWNERINFO",SHAREDWIDGET_OWNERINFO_MANYUSERS:"SHAREDWIDGET_OWNERINFO_MANYUSERS",SHAREDWIDGET_OWNERINFO_ONEUSER:"SHAREDWIDGET_OWNERINFO_ONEUSER",SHAREDWIDGET_OWNERINFO_NOUSERS:"SHAREDWIDGET_OWNERINFO_NOUSERS",SPLASHSCREEN_LOADING_APPLICATION:"SPLASHSCREEN_LOADING_APPLICATION",OPEN_SPOTLIGHTLINK_TITLE:"OPEN_SPOTLIGHTLINK_TITLE",OPEN_SPOTLIGHTLINK_DESCRIPTION:"OPEN_SPOTLIGHTLINK_DESCRIPTION",LONGVIEW_GROUP:"LONGVIEW_GROUP",LONGVIEW_GROUP_DESCRIPTION:"LONGVIEW_GROUP_DESCRIPTION",LOGIN_AS_ANOTHER_USER_TYPE:"LOGIN_AS_ANOTHER_USER_TYPE",CHANGE_PASSWORD:"CHANGE_PASSWORD",OLD_PASSWORD:"OLD_PASSWORD",NEW_PASSWORD:"NEW_PASSWORD",CONFIRMATION:"CONFIRMATION",CONFIRM_PASSWORD_NOT_MATCH:"CONFIRM_PASSWORD_NOT_MATCH",ENTER_OLD_PASSWORD:"ENTER_OLD_PASSWORD",ENTER_NEW_PASSWORD:"ENTER_NEW_PASSWORD",ENTER_CONFIRM_NEW_PASSWORD:"ENTER_CONFIRM_NEW_PASSWORD",EMPTY_STRING:["",""]}),define("stringtools",[],function(){var a={};return a.browserLangToArcplanLang=function(a){var b=a,c=a.indexOf("-");return c>0&&(b=a.substring(0,c)),b},a.encodeUtf8=function(a){return unescape(encodeURIComponent(a))},a.encodeBase64=function(a){var b="",c="",d,e,f,g,h,i,j,k=0,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";typeof a!="undefined"&&a!==null&&(b=a.toString());if(b.length===0)return"";do d=e=f=0,g=h=i=j=0,d=b.charCodeAt(k),k+1<b.length&&(e=b.charCodeAt(k+1)),k+2<b.length&&(f=b.charCodeAt(k+2)),k+=3,g=d/4,h=d%4*16+e/16,i=e%16*4+f/64,j=f%64,k===b.length+2?i=j=64:k===b.length+1&&(j=64),c=c+l.charAt(g)+l.charAt(h)+l.charAt(i)+l.charAt(j);while(k<b.length);return c},a.escapeForXml=function(a){var b;return typeof a=="string"?(b=a.replace(/&/g,"&amp;"),b=b.replace(/</g,"&lt;"),b=b.replace(/\|/g,"||"),b):a.toString()},a.escapeTextForHtml=function(a){return a.replace(/</g,"&#x003c;")},a.encodeDocName=function(a){var b="";return typeof a=="string"&&(b=encodeURIComponent(a),b=b.replace(/!/g,"%21"),b=b.replace(/'/g,"%27"),b=b.replace(/\(/g,"%28"),b=b.replace(/\)/g,"%29"),b=b.replace(/~/g,"%7E"),b=b.replace(/_/g,"%5F"),b=b.replace(/%/g,"_")),b},a.makeID=function(b,c){var d=a.encodeDocName(b);return"Cont"+Math.abs(c)+"_"+d},a.makeClassName=function(a){return"arc"+a},a.convertNewLineToHTMLBreaks=function(a){return typeof a=="string"?a.replace(/(\r\n|[\r\n])/g,"<br />"):""},a.removeExtension=function(a){return a.replace(/\.apd$/i,"")},a.hasUrlWrongProtocol=function(a,b){var c="",d=a.indexOf("://");return d!==-1?(c=a.substring(0,d+1),c.toLowerCase()!==b.toLowerCase()):!1},a.removeRubbishFromClientBaseURL=function(a){return a.replace(/\.js[a-zA-Z0-9=%\?\.]*/,"")},a}),define("properties",["propertybuilder","stringtools"],function(a,b){function f(a,b){d[a]=b}function g(a){return d[a]}function h(a,b){d[a]=b}function i(a){var b;switch(typeof a){case"object":b=a.length>0?a[0].id:undefined;break;case"string":b=a}return b}function j(a,b,c){var d=i(a);if(typeof d=="undefined")return;if(c!==undefined)f(d+"_"+b,c);else return g(d+"_"+b)}function k(a,b){var c=i(a);if(typeof c=="undefined")return;h(c+"_"+b)}function l(a,b,d){if(d===undefined)k(a,b);else{var e={value:d,changed:!1},f=j(a,b),g,h,i;typeof f!="undefined"?(e.changed=f.changed,e.lastAppliedProp=f.lastAppliedProp,g=f.value,typeof g=="object"?(h="are"+b+"sEqual",i=c[h],i&&(e.changed=!i(g,d)||e.changed)):e.changed=g!==d||e.changed):e.changed=!0,j(a,b,e)}}function m(a,b){var c=j(a,b);return c?c.value:c}function n(a,b){var d=j(a,b),e="are"+b+"sEqual",f=c[e];return d?(typeof d.lastAppliedProp!="undefined"&&(f?d.changed=!f(d.lastAppliedProp,d.value):d.changed=d.lastAppliedProp!==d.value),d.changed):!0}function o(a,b,c){var d=j(a,b);d&&(d.changed=c,c===!1?typeof d.value=="object"?d.lastAppliedProp=JSON.parse(JSON.stringify(d.value)):d.lastAppliedProp=d.value:d.lastAppliedProp=undefined)}function p(a){return function(b,c){return l(b,a,c)}}function q(a){return function(b){return m(b,a)}}function r(a){return function(b,c){return o(b,a,c)}}function s(a){return function(b){return n(b,a)}}var c={},d={},e=[{property:"DatavirtualizationProperties",prefix:undefined},{property:"Datavirtualization",prefix:undefined},{property:"Active",prefix:"is"},{property:"Visible",prefix:"is"},{property:"DocName",prefix:undefined},{property:"DocType",prefix:undefined},{property:"ID",prefix:undefined},{property:"ZIndex",prefix:undefined},{property:"ObjType",prefix:undefined},{property:"ScaleToObject",prefix:undefined},{property:"Pattern",prefix:undefined},{property:"SelectType",prefix:undefined},{property:"ShowIcons",prefix:undefined},{property:"SelectionPath",prefix:undefined},{property:"ShowRootNode",prefix:undefined},{property:"OneDimHasSumKnotLast",prefix:"is"},{property:"HierFormat",prefix:undefined},{property:"DimensionNumber",prefix:undefined},{property:"HTMLEditor",prefix:undefined},{property:"DocAutoCenter",prefix:"is"},{property:"Font",prefix:undefined,equalsMethod:function(a,b){var c,d,e;return d=Object.keys(a),e=Object.keys(b),c=d.length===6&&e.length===6&&a.fontFamily===b.fontFamily&&a.fontSize===b.fontSize&&a.fontStyle===b.fontStyle&&a.fontWeight===b.fontWeight&&a.lineHeight===b.lineHeight&&a.textDecoration===b.textDecoration,c}},{property:"PopupFont",prefix:undefined},{property:"Fonts",prefix:undefined},{property:"VerticalAlignment",prefix:undefined},{property:"HorizontalAlignment",prefix:undefined},{property:"GridType",prefix:undefined},{property:"GridColor",prefix:undefined},{property:"BackgroundColor",prefix:undefined},{property:"BackgroundColor2",prefix:undefined},{property:"BackgroundColors",prefix:undefined},{property:"ForegroundColor",prefix:undefined},{property:"ForegroundColor2",prefix:undefined},{property:"ForegroundColors",prefix:undefined},{property:"Border",prefix:undefined},{property:"VScrollBarAllowed",prefix:undefined},{property:"HScrollBarAllowed",prefix:undefined},{property:"ScrollHeight",prefix:undefined},{property:"ScrollWidth",prefix:undefined},{property:"ScrollBarObjHori",prefix:undefined},{property:"ScrollBarObjVert",prefix:undefined},{property:"ScrollDeps",prefix:undefined,equalsMethod:function(a,b){var c,d,e;return d=Object.keys(a),e=Object.keys(b),d.length!==e.length?!1:(c=d.every(function(c){return a[c].length===0&&b[c].length===0?!0:a[c].length!==b[c].length?!1:a[c].every(function(a,d){return b[c][d]===a})}),c)}},{property:"WasScrolled",prefix:undefined},{property:"ScrollX",prefix:undefined},{property:"ScrollY",prefix:undefined},{property:"ScrollElem",prefix:undefined},{property:"ScrollElemWidth",prefix:undefined},{property:"ScrollElemHeight",prefix:undefined},{property:"ScrollRefs",prefix:undefined},{property:"XSettingValue",prefix:undefined},{property:"YSettingValue",prefix:undefined},{property:"IScrollInstance",prefix:undefined},{property:"ScrollRequestId",prefix:undefined},{property:"ExtraScrollHeight",prefix:undefined},{property:"PendingScrollPos",prefix:undefined},{property:"HotTrackingBackColor",prefix:undefined},{property:"HotTrackingFontColor",prefix:undefined},{property:"PopupGradientColorLeft",prefix:undefined},{property:"PopupGradientColorRight",prefix:undefined},{property:"ShowSelectionArea",prefix:undefined},{property:"HasDocActivateEvent",prefix:undefined},{property:"OpenStartDocAllowed",prefix:"is"},{property:"DocViews",prefix:undefined},{property:"DocCurrentView",prefix:undefined},{property:"DocInitialRect",prefix:undefined},{property:"DocLayoutManaged",prefix:"is"},{property:"DocLayoutInitialized",prefix:"is"},{property:"DocLayoutObjectID",prefix:undefined},{property:"DocFixedSize",prefix:"has"},{property:"DocHeight",prefix:undefined},{property:"DocWidth",prefix:undefined},{property:"DocWithTabOrderObjects",prefix:"is"},{property:"LayoutBehavior",prefix:undefined},{property:"XPos",prefix:undefined},{property:"YPos",prefix:undefined},{property:"Width",prefix:undefined},{property:"Height",prefix:undefined},{property:"NumRows",prefix:undefined},{property:"NumCols",prefix:undefined},{property:"RowHeight",prefix:undefined},{property:"ColumnWidth",prefix:undefined,equalsMethod:function(a,b){var c,d;if(typeof a!="object"||typeof b!="object")return!1;if(a.numCols!==b.numCols)return!1;if(a.Width!==b.Width)return!1;if(a.Elements||b.Elements){if(!a.Elements||!b.Elements)return!1;if(a.Elements.length!==b.Elements.length)return!1;c=a.Elements.length;for(d=0;d<c;d+=1)if(typeof a.Elements[d].Width!="undefined"){if(typeof b.Elements[d].Width=="undefined")return!1;if(a.Elements[d].Width!==b.Elements[d].Width)return!1}}return!0}},{property:"OrigXPos",prefix:undefined},{property:"OrigYPos",prefix:undefined},{property:"OrigWidth",prefix:undefined},{property:"OrigHeight",prefix:undefined},{property:"Resizeable",prefix:"is"},{property:"DocResizeLineMap",prefix:undefined},{property:"Content",prefix:undefined},{property:"BookmarkObject",prefix:"is"},{property:"LabelledByObjectID",prefix:undefined},{property:"HasClickEvent",prefix:undefined},{property:"ClickingOnFieldWithClickEvent",prefix:"is"},{property:"HasInputEvent",prefix:undefined},{property:"IsEditable",prefix:undefined},{property:"IsPassword",prefix:undefined},{property:"ToolTip",prefix:undefined},{property:"ToolTipType",prefix:undefined},{property:"ShowTooltipMarker",prefix:undefined},{property:"SingleDropDownImageReference",prefix:undefined},{property:"MultiDropDownImageReference",prefix:undefined},{property:"DropDownSymbolWidth",prefix:undefined},{property:"DropDownSymbolHeight",prefix:undefined},{property:"WrapMode",prefix:undefined},{property:"MenuFilterEnabled",prefix:"is"},{property:"UseNativeMenu",prefix:"is"},{property:"DisplayStyle",prefix:undefined},{property:"Organigram",prefix:"is"},{property:"AllowOpenClose",prefix:"is"},{property:"AvailableInView",prefix:"is"},{property:"FormattedTextInput",prefix:"is"},{property:"OrigSelectionPath",prefix:undefined},{property:"UseContentPaging",prefix:"is"},{property:"ContentWidth",prefix:undefined},{property:"ContentHeight",prefix:undefined},{property:"VHTMLField",prefix:"is"},{property:"HtmlSource",prefix:undefined},{property:"LastSelectedItem",prefix:undefined},{property:"SelectedCell",prefix:undefined},{property:"DocSelectedObjectManager",prefix:undefined},{property:"MenuSeparator",prefix:undefined},{property:"HasFrame",prefix:undefined},{property:"TabOrder",prefix:undefined},{property:"ChartResizer",prefix:undefined},{property:"ObjectAlreadyCreated",prefix:"is"},{property:"ObjectData",prefix:undefined},{property:"ObjectProperties",prefix:undefined},{property:"DocObjects",prefix:undefined},{property:"BorderDiv",prefix:undefined},{property:"CacheIDHash",prefix:undefined},{property:"PropertyProvider",prefix:undefined},{property:"CellBorder",prefix:undefined},{property:"CellMargin",prefix:undefined},{property:"CellPadding",prefix:undefined}];return c.resetAllProperties=function(){d=[]},c.resetAllPropertiesForDocument=function(a){var c,e=new RegExp("Cont[0-9]*_"+b.encodeDocName(a)+"_[a-z|A-Z]*$");for(c in d)c.match(e)&&(d[c]=undefined)},a.buildProperties(e,c,p,q,r,s),c}),define("ui",["nodetypes","properties","browserfeatures"],function(a,b,c){var d={};return d.getNodeInfo=function(a){var b,c,d={row:0,x:-1,y:-1};if(a){c=a.id||a.htmlFor;if(c){b=c.split("_");if(b.length>2)return d.row=parseInt(b[0],10),d.x=parseInt(b[1],10),d.y=parseInt(b[2],10),d}}return d},d.select=function(a){return a.select()},d.getCellPosition=function(a){var c=-1,e=-1,f=a,g=$(f),h=$(a).closest(".objContainer"),i=$(a).position(),j=b.getRowHeight(h),k,l=0,m=0;return k=b.getDatavirtualizationProperties(h),k&&ARCPLAN.datavirtualization!==!1&&(k.firstElementInDOM&&(l=k.firstElementInDOM),k.firstColumnInDOM&&(m=k.firstColumnInDOM)),a!==null&&a.tagName==="LI"&&a.childNodes?(f=d.getNodeInfo(f),{x:f.x,y:f.y}):(f!==null&&f.tagName==="TD"&&(c=g.index()+m,g.hasClass("arcExtraColumn")&&(c=-1)),i!==null&&typeof i.top=="number"&&j&&(f!==null&&f.tagName==="TD"?e=g.closest("tr").index()+l:e=Math.round((i.top+.5)/j)+l),{x:c,y:e})},d.hasTargetObjectClickEvent=function(a){var d=!1,e,f,g=!1;if(a){e=$(a).closest(".objContainer"),f=b.getObjType(e);if(!f)if($(a).hasClass("arcButtonContent")||$(a).hasClass("arcButton"))return!0;switch(f){case"Menu":case"RadioGroup":case"MenuHierarchie":c.nativeTouchControls||(g=!0);break;case"Field":b.getIsEditable(e)&&(g=!0);break;case"Text":b.getIsEditable(e)&&!b.isFormattedTextInput(e)&&(g=!0)}if(g||b.getHasClickEvent(e))d=!0}return d},d.getTableCellElement=function(a,c,d){var e,f,g,h,i=0,j=0;return h=b.getDatavirtualizationProperties(a),h&&ARCPLAN.datavirtualization!==!1&&(h.firstElementInDOM&&(i=h.firstElementInDOM),h.firstColumnInDOM&&(j=h.firstColumnInDOM)),e=a.find("table").first(),f=$("> tbody > tr",e).eq(d-i),g=f.children().eq(c-j),g},d.getPositionToArcContainer=function(a,b,c){var d=$("#arcContainer"),e,f=d.offset(),g=$(".arcInnerDocContainerForWidgetHosting",d);return g.length>0?e=g.offset():e=a.offset(),{x:b+e.left-f.left,y:c+e.top-f.top}},d.getCellRect=function(a,b,c){var e,f,g;return e=d.getTableCellElement(a,b-1,c-1),e.length>0&&(f=e.offset(),g={x:f.left,y:f.top,width:e.width(),height:e.height()}),g},d}),define("events/globalmousedownhandler",["assert/assert","ui","browserfeatures"],function(a,b,c){function i(a){d=b.hasTargetObjectClickEvent(a.target),g=a.target,e=!0}function j(a){k(),a.on("mousedown.globalMouseDownHandler",i),c.nativeTouchControls&&(a.on("touchstart.globalMouseDownHandler",i),a.on("MSPointerDown.globalMouseDownHandler",i)),f=a}function k(){f instanceof $&&(f.off("mousedown.globalMouseDownHandler",i),c.nativeTouchControls&&(f.off("touchstart.globalMouseDownHandler",i),f.off("MSPointerDown.globalMouseDownHandler",i)),f=undefined)}var d=!1,e=!1,f,g,h={};return h.startListening=function(b){a(b instanceof $),d=!1,e=!1,g=undefined,j(b)},h.didWeGetAMouseDown=function(){return e},h.didAnObjectWithClickEventGetMouseDown=function(){return d},h.mouseDownTarget=function(){return g},h.stopListening=function(){k()},h}),define("events/eventorderfactory",["assert/assert","events/eventid","events/globalmousedownhandler"],function(a,b,c){function i(i){function o(){a(typeof k=="function"),k(),k=undefined,c.stopListening()}function p(a){k=a,window.setTimeout(function(){typeof k=="function"&&o()},300)}function q(a,b){typeof b=="number"?l.push(a):m.push(a)}function r(i,k){switch(j){case d:i();break;case h:q(i,k);break;case e:a(typeof k=="number"),c.didWeGetAMouseDown()?(j=g,p(i)):i();break;case f:k===b.EID_INPUT?i():q(i,k);break;case g:q(i,k),o()}}a(typeof i.doSendEvent=="function");var j=d,k,l=[],m=[],n={};return n.doArcplanEvent=function(a,b,c,d,e,f,g,k,l){var m;if(i.hasPendingUserinformation()===!0)return;if(ARCPLAN.useEventOrder!==!0){i.doSendEvent(a,b,c,d,e,f,g,k,l);return}m=function(){j=h,i.doSendEvent(a,b,c,d,e,f,g,k,l)},r(m,c)},n.doUIEvent=function(a){r(a)},n.CKEditorInputEventExpected=function(){a(j===d),j=f},n.expectedCKEditorInputEventCancelled=function(){a(j===f),n.doPendingEvent(),j=d},n.blurEventExpected=function(){a(j===d),j=e,c.startListening($("#arcContainer"))},n.expectedBlurEventCancelled=function(){a(j===e),j=d,c.stopListening()},n.doPendingEvent=function(a){var b;j=d,l.length>0?(b=l.shift(),b(a)):(m.forEach(function(b){b(a)}),m=[])},n}var d=0,e=1,f=2,g=3,h=4;return{createInstance:i}}),define("patternapplier",["jquery","logger","properties","colortools"],function(a,b,c,d){var e={};return e.applyDropdownSymbol=function(a,b){var e={},f,g,h,i=c.getDropDownSymbolWidth(a),j=c.getDropDownSymbolHeight(a),k=c.getHeight(a);c.getSelectType(a)==="HierMultiSelect"?h=c.getMultiDropDownImageReference(a):h=c.getSingleDropDownImageReference(a),h&&c.getBackgroundColor(a)!==d.c_transparentColor&&(g=a.find(".arcHierPopup:first"),f=b.buildObjectPictRequest(h),b.downloadPictToBrowserCache(f,function(a){var b;j>k&&(e.backgroundSize=i+"px "+k+"px"),b="url('"+a+"')",e["background-image"]=b,g.css(e)}))},e.loadPattern=function(a,b,d){var e={},f,g;f=c.getPattern(a);if(f&&f.PatternFormat){e.backgroundRepeat="no-repeat no-repeat";switch(f.PatternFormat.Format){case"Zoom":e.backgroundSize="100% 100%";break;case"Center":e.backgroundPosition="50% 50%";break;default:e.backgroundRepeat="repeat repeat"}g=d.buildObjectPictRequest(f.ImageReference),d.downloadPictToBrowserCache(g,function(a){e.backgroundImage="url('"+a+"')",e.webkitAppearance="none",b.css(e)})}},e}),define("datavirtualization/datavirtualizationhelper",["properties"],function(a){var b={};return b.getDatavirtualizationProperties=function(b){var c=a.getDatavirtualizationProperties(b);return typeof c!="object"&&(c={},a.setDatavirtualizationProperties(b,c)),c},b.isDatavirtualizationActiveForObject=function(b){return ARCPLAN.datavirtualization!==!1&&a.isVisible(b)===!0},b.convertScrollParams=function(a,b,c){a.height===c?(b.top=0,b.bottom=0):(b.top=(b.height-c)*a.top/(a.height-c),b.bottom=b.height-b.top-c)},b.validateScrollPos=function(b,c,d){var e;b.top>0&&b.top>b.height&&(e=a.getScrollElem(d),e&&(a.setScrollY(d,0),e[0].scrollTop=0),b.top=0,c.top=0)},b}),define("popupcalculator",["properties","popuppositioner"],function(a,b){function f(b){return a.getSelectType(b)==="HierMultiSelect"?!1:!0}function g(b,c,e,f){var g,h=2,i=e-h,j=$("#"+b[0].id+" .arcHierPopupContent");return ARCPLAN.datavirtualization!==!1&&(!f||a.isUseContentPaging(b))?a.getDatavirtualizationProperties(b).menuContentWidth:(c<d?(f&&j.find(".arcHierPopupInnerDiv").css("min-width",""),j.css({"min-width":"",top:"-1000px",left:"-1000px",height:50,display:"inline-block"}),$("ul:first",j).css("position","static"),g=j.width(),g===null&&(g=i),g=Math.max(i,g)):g=i,g)}function h(c,d,f,g){function h(a,b){var c=b.parent(),d=$(".arcInnerDocContainerForWidgetHosting",a);return d.length>0&&c.attr("id")!=="arcFilterPanel"?d.offset():c.offset()}function i(b){var c,d=b.parent();return d.attr("id")!=="arcFilterPanel"?c=d:c=$(".arcContainer",d.siblings()),{width:a.getDocWidth(c),height:a.getDocHeight(c)}}var j=$("#arcContainer"),k=j.offset(),l=h(j,c),m=i(c);return f.width=Math.max(f.width,e),b.getMenuPopupPosition(d,f,g,k,m,l)}function i(b){var c=Math.round(a.getRowHeight(b)),d=a.getNumRows(b),e=c*d+1,f=b.find(".dynaMenu").offset(),i=parseInt(a.getWidth(b),10),j,k;return j={left:f.left,top:f.top,width:parseInt(a.getWidth(b),10),height:parseInt(a.getHeight(b),10)},i=g(b,d,j.width,!1),k={width:i,height:e},h(b,j,k)}function j(b,c){var e=0,i,j,k,l,m,n,o,p,q,r;return a.isUseContentPaging(b)?m=a.getNumRows(b):(o=$("#"+b[0].id+" .arcHier"),m=$("li",o).length),f(b)||(e=34),n=Math.round(a.getRowHeight(b)),p=c?165:parseInt(a.getWidth(b),10),j=m*n+1+e,i=g(b,m,p,!0),b.find(".dynaHierMenu").length>0&&(l=b.find(".dynaHierMenu").offset()),q={left:l?l.left:0,top:l?l.top:0,width:p,height:parseInt(a.getHeight(b),10)},r={width:i,height:j},k=h(b,q,r,c),k.childrenHeight=k.height-e,m>d&&!a.isUseContentPaging(b)&&(k.width="auto"),k}function k(c){var d=$("#arcContainer").offset(),e=a.getNumRows(c),f=a.getRowHeight(c),g=a.getXPos(c),h=a.getYPos(c),i,j,k,l=$("#"+c[0].id+" .arcHierPopupContent");return i=e*f,j=l.outerWidth(),k=b.getPopupPosition(g,h,j,i,d),k}var c={},d=100,e=165;return c.getPopupRect=function(b){var c=a.getObjType(b),d;return c==="Menu"?d=i(b):c==="MenuHierarchie"?d=j(b):d=k(b),d},c.getPopupRectByPos=function(b,c){var d,e=a.getObjType(b);return e==="MenuHierarchie"&&(d=j(b,c)),d},c}),define("popupkeyeventhandler",["jquery","events/eventid","keycodes","properties"],function(a,b,c,d){function i(a,b){b.addClass(h),d.setLastSelectedItem(a,b)}function j(b){return a(".arcMenuItemSelected:first",b)}function k(a,b,c){b.removeClass(h),i(a,c)}function l(b,c){function o(a){return a+h<m.top?!0:!1}function p(a){return a>m.top+n?!0:!1}function q(){var b;return a("li",f).each(function(c){var d=a(this).offset().top-m.top;d<0&&(d*=-1);if(d<h/2)return b=a(this),!1}),b}function r(){var a=g.offset().top,b=g.next();if(o(a)||p(a))b=q();return b}function s(){var a=g.offset().top,b=g.prev();if(o(a)||p(a))b=q();return b}function t(){var a;g.length>0?(a=r(),a&&a.length>0&&(k(e,g,a),p(a.offset().top+h)&&f.scrollTop(l+h))):(a=q(),a&&i(e,a))}function u(){var a;g.length>0?(a=s(),a&&a.length>0&&(k(e,g,a),o(a.offset().top-h)&&f.scrollTop(l-h))):(a=q(),a&&i(e,a))}var e=b.data.ref,f=a(".arcPopupContent",e),g=j(f),h=d.getRowHeight(e),l=f.scrollTop(),m=f.offset(),n=f.height();b.preventDefault(),b.stopImmediatePropagation(),c?t():u()}function m(c){var e,h,i,k,l,m;c.data&&(e=c.data.ref,h=a(".arcPopupContent",e),i=j(h),i.length>0&&(k=parseInt(i.prop("value"),10),l=d.getDocName(e),m=d.getID(e),g(),a(":first",e).focus(),f(l,m,b.EID_SWITCH,k),c.preventDefault(),c.stopImmediatePropagation()))}function n(a){switch(a.keyCode){case c.ESC:g();break;case c.UpArrow:l(a,!1);break;case c.DownArrow:l(a,!0);break;case c.Enter:m(a)}}var e={},f,g,h="arcMenuItemSelected";return e.setHideCurrentPopupCallback=function(a){g=a},e.setDoSendEventCallback=function(a){f=a},e.registerKeyEvents=function(b,c){a("body").on("keydown.popupkeyeventhandler",b,n)},e.unregisterKeyEvents=function(b){var c=a(".arcPopupContent",b);a("body").off("keydown.popupkeyeventhandler"),a(".arcMenuItem",c).removeClass(h),d.setLastSelectedItem(b,undefined)},e.resetSelectedItemInDOM=function(a){var b=d.getLastSelectedItem(a);b&&(b=a.find(".arcMenuItem[value='"+b.attr("value")+"']"),i(a,b))},e}),define("arcplandocuments/documentsettings",["properties","stringtools"],function(a,b){var c={};return c.createPropertyBasedDocSettings=function(c){var d,e;return d=b.makeID(c,0),e=$("#"+d),{docName:c,hasTabOrderObjects:function(){return a.isDocWithTabOrderObjects(e)===!0},isDialog:function(){return a.getDocType(e)==="Dialog"},isLayoutManaged:function(){return a.isDocLayoutManaged(e)}}},c}),define("components/button/buttonviewfactory",["assert/assert","datavirtualization/celltypes","colortools","stringtools","components/button/buttonbordercssgenerator","components/cssgenerators/backgroundcolorcssgenerator","components/cssgenerators/backgroundimagecssgenerator","components/cssgenerators/fontcssgenerator","components/cssgenerators/fontcolorcssgenerator","components/cssgenerators/horizontalalignmentcssgenerator","components/cssgenerators/sizecssgenerator","components/cssgenerators/verticalalignmentcssgenerator","components/cssgenerators/wordwrapcssgenerator","components/common/contentsizecalculator"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){return function(p){function s(){var a="";return a+=f.createCss(p.backgroundColor),a+=g.createCss(p.backgroundImage),a+=e.createCss(p.border,p.isPressed),a+=h.createCss(p.font),a+=i.createCss(p.fontColor),a+=j.createCss(p.alignment),typeof p.active=="object"&&typeof p.active.isActive=="boolean"&&(a=a+"cursor:"+(p.active.isActive?"pointer":"auto")+";"),'style = "'+a+'"'}function t(){var a="",b=e.calculateBorderWidths(p.border);return a+=k.createCss(p.size,b),a+=l.createCss(p.alignment),a+=m.createCss(p.wordWrap),'style = "'+a+'"'}function u(){var a="",b=e.calculateBorderWidths(p.border),c=n.getContentSize(p.size,b);return typeof c.width=="number"&&(a=a+" width='"+c.width+"px'"),typeof c.height=="number"&&(a=a+" height='"+c.height+"px'"),a}function v(){var c="&nbsp;",e,f;a(typeof p.content=="object"),a(p.content!==null),a(typeof p.content.type=="number"),e=t(p);switch(p.content.type){case b.EText:case b.ETextLink:case b.ENumber:a(typeof p.content.text=="string"),p.content.text!==""&&(c=d.escapeTextForHtml(p.content.text));break;case b.EImage:case b.EImageLink:if(typeof p.content.imageUrl=="string")return f="<img ",f+=u(p),f+=" src='"+p.content.imageUrl+"'",f+=">",f;break;case b.EHtml:c=p.content.htmlSource;break;default:throw new Error("Unsupported content type "+p.content.type+" in buttonView.buildContent")}return"<span class='arcButtonContent' "+e+">"+c+"</span>"}function w(){return typeof p.backgroundColor=="object"&&p.backgroundColor.color1===c.c_transparentColor?!0:!1}function x(){var a="";return typeof p.tabOrder=="object"&&typeof p.tabOrder.value=="number"&&(a+=" tabindex='"+p.tabOrder.value+"'"),typeof p.tooltip=="object"&&typeof p.tooltip.text=="string"&&(a+=" title='"+p.tooltip.text+"'"),a}function y(){var b,c,d,e,f="arcButton";a(typeof p=="object"),b=v(),c=s(),e=x(),typeof p.tabOrder=="object"&&typeof p.tabOrder.cssClassForHighlightWhenFocussed=="string"&&(typeof p.active!="object"||p.active.isActive!==!1)&&(f+=" "+p.tabOrder.cssClassForHighlightWhenFocussed),q.html("<button "+c+" class='"+f+"' "+e+">"+b+"</button>"),d=q.find("button"),typeof p.setAsSelectedObject=="function"&&d.on("mousedown.setAsSelectedObject",p.setAsSelectedObject),typeof p.eventCallbacks=="object"&&typeof p.eventCallbacks.onClick=="function"&&(d.on("mousedown.interactionFeedback touchstart.interactionFeedback",function(){w()?d.addClass("arcTransparentButtonClicked"):d.addClass("arcButtonClicked")}),d.on("mouseup.interactionFeedback mouseout.interactionFeedback touchend.interactionFeedback touchcancel.interactionFeedback",function(){w()?d.removeClass("arcTransparentButtonClicked"):d.removeClass("arcButtonClicked")}),d.click(function(a){var b=a.pageX,c=a.pageY;b===0&&c===0&&(b=d.offset().left,c=d.offset().top),p.eventCallbacks.onClick(b,c,a.shiftKey,a.ctrlKey)}))}function z(){var a=q.find("button");return document.activeElement===a[0]?!0:!1}function A(){q.find("button").focus()}var q,r={};return r.renderIntoContainer=function(b){a(typeof q=="undefined","button.renderIntoContainer called for a button which is already in another container. This is not supported."),q=b,y()},r.reRender=function(){var a=!1;typeof q!="undefined"&&(a=z(),y(),a&&A())},r}}),define("components/field/fieldcontentgenerator",["stringtools","datavirtualization/celltypes","components/cssgenerators/bordercssgenerator","components/cssgenerators/fontcolorcssgenerator","components/cssgenerators/sizecssgenerator","components/cssgenerators/verticalalignmentcssgenerator","components/cssgenerators/wordwrapcssgenerator","components/common/contentsizecalculator","keycodes"],function(a,b,c,d,e,f,g,h,i){function k(a){var b="",d=c.calculateBorderWidths(a.border);return b+=e.createCss(a.size,d),b+=f.createCss(a.cell.properties.alignment),b+=g.createCss(a.wordWrap),b}function l(a,c,d){if(typeof a.tabOrder=="object"&&typeof a.tabOrder.value=="number"){if(a.cell.content.type===b.EImage&&a.tabOrder.value===0)return;c.attr("tabindex",a.tabOrder.value),typeof a.tabOrder.cssClassForHighlight=="string"&&(typeof a.active!="object"||a.active.isActive!==!1)&&(c.on("focus",function(b){d.addClass(a.tabOrder.cssClassForHighlight)}),c.on("blur",function(b){d.removeClass(a.tabOrder.cssClassForHighlight)}))}}function m(a){return typeof a.editCallbacks=="object"&&typeof a.editCallbacks.textEdited=="function"?!0:!1}function n(a){return a.length>0?"########":""}function o(a,b){var c="",d;return c+='<input type="password" ',c+='value="'+n(a.cell.content.text)+'"',c+=">",d=$(c),l(a,d,b),m(a)?(d.on("keydown",function(a){a.which===i.Enter&&(a.preventDefault(),d.blur()),a.which===i.ESC&&d.trigger("blur",!0)}),d.on("focus",function(b){d.attr("value",a.cell.content.text)}),d.on("blur",function(b,c){var e=a.cell.content.text;c!==!0&&(e=d.attr("value"),a.editCallbacks.textEdited(e,b.shiftKey,b.ctrlKey)),d.attr("value",n(e))})):d.prop("disabled",!0),d}function p(b,c){var d,e="",f,g=!1;return d=k(b),e+='<span style="'+d+'" ',e+=">",e+=a.escapeTextForHtml(b.cell.content.text),e+="</span>",f=$(e),l(b,f,c),m(b)&&(f.attr("contenteditable","true"),f.on("mousedown",function(a){$(this).is(":focus")||(g=!0)}),f.on("focus",function(a){var c,d;typeof b.cell.content.unformatted=="string"&&f.text(b.cell.content.unformatted),g===!1&&(c=document.createRange(),c.selectNodeContents(f[0]),d=window.getSelection(),d.removeAllRanges(),d.addRange(c)),g=!1}),f.on("keydown",function(a){a.which===i.Enter&&(a.preventDefault(),f.blur()),a.which===i.ESC&&(f.text(b.cell.content.text),f.trigger("blur",!0))}),f.on("blur",function(a,c){c!==!0&&(b.editCallbacks.textEdited(f.text(),a.shiftKey,a.ctrlKey),typeof b.cell.content.unformatted=="string"&&f.text()===b.cell.content.unformatted&&f.text(b.cell.content.text)),window.getSelection().removeAllRanges()})),f}function q(a,b){return typeof a.password=="object"&&a.password.isPassword===!0?o(a,b):p(a,b)}function r(a,b){var d,g,i,j="",k,m,n;return typeof a.cell.content.imageUrl=="string"?(a.cell.properties.scaleToObject&&(n=0),d=c.calculateBorderWidths(a.border,n),a.cell.properties.scaleToObject===!0?g=e.createCss(a.size,d):(i=h.getContentSize(a.size,d),i.height=Math.min(i.height,a.cell.content.height),i.width=Math.min(i.width,a.cell.content.width),g="height:"+i.height+"px;width:"+i.width+"px;",g+=f.createCss(a.cell.properties.alignment)),j+='<div class="arcFieldCenterImage"></div>',j+='<img src="'+a.cell.content.imageUrl+'" style="'+g+'">',k=$(j),m=k.next("img"),l(a,m,b),k):$("")}function s(a){var b,d,f="";return d=c.calculateBorderWidths(a.border),b=e.createCss(a.size,d),f+='<span style="'+b+'">',f+=a.cell.content.htmlSource,f+="</span>",$(f)}function t(b,c){var e,f="",g,h;return e=k(b),f+='<span style="'+e+'">',f+="<a",f+=' href="'+b.cell.content.url.replace(/"/g,"&#x0022;")+'"',f+=' style="'+d.createCss(b.cell.properties.fontColor||b.fontColor)+'"',f+=' target="_blank"',f+=">",f+=a.escapeTextForHtml(b.cell.content.text),f+="</a>",f+="</span>",g=$(f),h=g.find("a"),l(b,h,c),g}function u(a,b){var d="",e,g,i,j,k="";return d+='<div class="arcFieldCenterImage"></div>',d+="<a",d+=' href="'+a.cell.content.url.replace(/"/g,"&#x0022;")+'"',d+=' target="_blank"',d+=">",typeof a.cell.content.imageUrl=="string"&&(i=c.calculateBorderWidths(a.border),j=h.getContentSize(a.size,i),j.height=Math.min(j.height,a.cell.content.height),j.width=Math.min(j.width-2,a.cell.content.width),k+="height:"+j.height+"px;width:"+j.width+"px;",k+=f.createCss(a.cell.properties.alignment),d+="<img",d+=' src="'+a.cell.content.imageUrl+'"',d+=' style="'+k+'"',d+=">"),d+="</a>",e=$(d),g=e.next("a"),l(a,g,b),e}var j={};return j.buildContent=function(a,c){var d;switch(a.cell.content.type){case b.EText:case b.ENumber:d=q(a,c);break;case b.EImage:d=r(a,c);break;case b.EHtml:d=s(a);break;case b.ETextLink:d=t(a,c);break;case b.EImageLink:d=u(a,c)}return d},j}),define("components/field/fieldviewfactory",["assert/assert","components/field/fieldcontentgenerator","components/cssgenerators/backgroundcolorcssgenerator","components/cssgenerators/backgroundimagecssgenerator","components/cssgenerators/bordercssgenerator","components/cssgenerators/fontcssgenerator","components/cssgenerators/fontcolorcssgenerator","components/cssgenerators/horizontalalignmentcssgenerator"],function(a,b,c,d,e,f,g,h){return function(j){function m(){var a="",b;return j.cell.properties.scaleToObject&&(b=0),a+=c.createCss(j.cell.properties.backgroundColor||j.backgroundColor),a+=d.createCss(j.backgroundImage),a+=e.createCss(j.border,b),a+=f.createCss(j.cell.properties.font||j.font),a+=g.createCss(j.cell.properties.fontColor||j.fontColor),a+=h.createCss(j.cell.properties.alignment),a}function n(){return typeof j.tooltip=="object"&&typeof j.tooltip.text=="string"?" title='"+j.tooltip.text+"'":""}function o(){a(typeof j.eventCallbacks.onClick=="function");var b=k.children().first();b.click(function(a){j.eventCallbacks.onClick(a.pageX,a.pageY,a.shiftKey,a.ctrlKey)})}function p(){var a=m(),c=n(),d,e;d=$('<div class="arcField" style="'+a+'"'+c+"/></div>"),e=b.buildContent(j,d),d.append(e),k.append(d),typeof j.eventCallbacks=="object"&&typeof j.eventCallbacks.onClick=="function"&&o()}var k,l={};return l.renderIntoContainer=function(b){a(typeof k=="undefined","button.renderIntoContainer called for a button which is already in another container. This is not supported."),k=b,p()},l.reRender=function(){k.empty(),p()},l}}),define("textinput",["jquery","logger","events/eventdatafactory","properties","stringtools","ui","events/globalmousedownhandler","keycodes"],function(a,b,c,d,e,f,g,h){function q(b){var c=d.getTabOrder(b);c>0&&a(":first",b).attr("tabindex",c)}function r(c){var e,f,k,p,r,s;c.shiftKey=n,c.ctrlKey=o,q(c.data.ref),e=c.data.target.attr("data-unformatted")||a(".arcTextInputSizeTarget",c.data.ref).text(),e===a(c.currentTarget).val()&&(c.data.initialValue=a(".arcTextInputSizeTarget",c.data.ref).text()),g.didAnObjectWithClickEventGetMouseDown()||i?(b.info("eventhandling - textinput: set pending blur event"),j.setPendingBlurEvent(function(){return l(c)},m.removeForm)):(b.info("eventhandling - textinput: executing blur event"),k=a(g.mouseDownTarget()),p=k.closest(".objContainer"),c.keyCode!==h.Enter&&p.closest(m.constants.scrollWrapperID).length===0&&(r=a("#"+c.data.id).closest(".arcContainer"),s=k.closest(".arcContainer"),f=d.getDocSelectedObjectManager(r),p.length>0&&s.is(r)&&d.isActive(p)?f.setSelectedObject(p[0].id):f.setSelectedObject(undefined)),m.removeForm(),l(c)),g.stopListening(),i=!1}function s(c){var d,e,f;c.shiftKey=n,c.ctrlKey=o,q(c.data.ref),d=c.data.target.attr("data-unformatted")||a(".arcTextInputSizeTarget",c.data.ref).text(),d===a(c.currentTarget).val()&&(c.data.initialValue=a(".arcTextInputSizeTarget",c.data.ref).text()),b.info("eventhandling - textinput: executing blur event"),m.removeForm(),f=l(c),f!==!0&&k.expectedBlurEventCancelled()}function t(a){n=a.shiftKey,o=a.ctrlKey}function u(a,b){var c=d.getObjType(b);return!d.isDocWithTabOrderObjects(a)||c!=="Field"&&c!=="Text"?!0:!1}function v(b){var c=a("#"+b.data.id),e,f;n=b.shiftKey,o=b.ctrlKey;switch(b.keyCode){case h.Tab:e=c.closest(".arcContainer"),f=d.getDocSelectedObjectManager(e),u(e,c)?(b.preventDefault(),p(b)):(i=!0,f.setSelectedObject(undefined));break;case h.ESC:q(b.data.ref),m.removeForm(),ARCPLAN.useEventOrder===!0&&k.expectedBlurEventCancelled(),b.data&&(b.data.clickPos=undefined,d.getNumRows(c)===0&&a("tr:first",c).addClass("invisibleInitialInputRow"),c.find(".arcTextInputSizeTarget").removeClass("arcTextInputSizeTarget"),c.removeClass("arcTextInputActive"),c.children(":first").focus(),e=c.closest(".arcContainer"),f=d.getDocSelectedObjectManager(e),f.setSelectedObject(undefined))}}function w(b){b.preventDefault(),b.keyCode=h.Enter,b.target=a("#"+m.constants.inputId)[0],p(b)}function x(a,b){return parseInt(a,10)+b}function y(a,b,c){var d,e,f={};return d=-Math.min(0,b),e=Math.max(0,b+c-a),f.len=d+e,f.start=Math.min(0,b),f}function z(b,c,f,g,h,i){var j=d.getScrollElem(b),k,l,m,n=a("#"+e.makeID(d.getDocName(b),0));k=j.offset(),k.top-=h.top+i.top,k.left-=h.left+i.left,m=y(j.height(),f.top-k.top-n.scrollTop(),f.height),l=y(j.width(),f.left-k.left-n.scrollLeft(),f.width),g.top=m.start,g.left=l.start,g.width=f.width-1,g.height=f.height-1,f.top-=m.start+1,f.left-=l.start+1,f.width=Math.max(0,f.width-l.len+1),f.height=Math.max(0,f.height-m.len+1)}function A(b){var d,e=b.data.id,f=a("#"+e);return d=c.createInstance(e,f),d.clickPos={x:-1,y:-1},b.data.clickPos&&(d.clickPos.x=typeof b.data.clickPos.x=="number"?b.data.clickPos.x:-1,d.clickPos.y=typeof b.data.clickPos.y=="number"?b.data.clickPos.y:-1),d.target=b.data.target,d}var i=!1,j,k,l,m={constants:{inputId:"arcTextInput",formId:"arcTextInputForm",scrollWrapperID:"arcTextInputScrollWrapper"}},n=!1,o=!1,p;return m.setPendingEventsHandler=function(a){j=a},m.setEventOrder=function(a){k=a},m.setOnInputCallback=function(a){l=a},m.removeForm=function(){var b=a("#"+m.constants.inputId);b.off("keydown.textinput",v),b.off("keyup.textinput",t),b.off("blur",p),a("#"+m.constants.formId).off("submit",w),a("#"+m.constants.scrollWrapperID).remove()},ARCPLAN.useEventOrder===!0?p=s:p=r,m.recalcInputPosition=function(b){var c,f,g,h,i,j,k,l,n,o;f={},j=e.makeID(d.getDocName(b),0),k=a("#"+j),l=k.parent().offset(),n=k.offset(),n.top-=l.top,n.left-=l.left,d.getObjType(b)==="Field"||d.getObjType(b)==="Text"?(c={left:x(d.getXPos(b),0),top:x(d.getYPos(b),0),width:x(d.getWidth(b),0),height:x(d.getHeight(b),0)},f={left:0,top:0,width:c.width-2,height:c.height-2}):(g=b.find(".arcTextInputSizeTarget"),g[0]&&(o=g.offset(),o.top-=l.top-k.scrollTop(),o.left-=l.left-k.scrollLeft(),c={top:o.top-n.top,left:o.left-n.left,width:g.width(),height:g.height()},z(b,g,c,f,l,n))),c&&(i=a("#"+m.constants.scrollWrapperID),i.css(c),h=a("#"+m.constants.inputId),h.css(f))},m.show=function(c){var h,i="text",j,l,q,r,s,u,x,y;return r=c.data.target,n=c.shiftKey,o=c.ctrlKey,x=r.find("input:first"),x.length>0&&x.attr("type")==="password"?(c.data.initialValue=x.attr("pass"),i="password"):c.data.isPassword===!0&&(i="password",r=a(c.currentTarget).children().first()),j={"font-size":r.css("font-size"),"font-style":r.css("font-style"),"font-weight":r.css("font-weight"),"font-family":r.css("font-family"),"font-variant":r.css("font-variant")},l=a("#"+c.data.id).addClass("arcTextInputActive"),u=d.getDocName(l),d.getObjType(c.data.ref)==="Text"?s="<textarea></textarea>":s="<input></input>",h=a(s,{type:i,id:m.constants.inputId}).css(j).css({width:"100%",height:"100%",position:"absolute"}).on("blur",A(c),p),h.val(c.data.initialValue),c.data.readonly&&h.attr("readonly","readonly"),y=d.getTabOrder(l),y>0&&(h.attr("tabindex",y),a(":first",l).attr("tabindex","-1")),a("#"+m.constants.formId).length!==0&&(b.warn("text input form already exists"),m.removeForm()),a('<div id="'+m.constants.scrollWrapperID+'"></div>').css({overflow:"hidden",position:"absolute"}).appendTo("#"+e.makeID(u,0)),a('<form autocomplete="off" id='+m.constants.formId+"></form>").append(h).appendTo("#"+m.constants.scrollWrapperID).on("submit",A(c),w),m.recalcInputPosition(l),f.select(h),a(h).on("keydown.textinput",A(c),v),a(h).on("keyup.textinput",t),ARCPLAN.useEventOrder===!0?k.blurEventExpected():g.startListening(a("#arcContainer")),h.trigger("focus"),c.data.clickPos=undefined,h},m}),define("textinputeventhandlerfactory",["assert/assert","properties","ui","textinput","events/eventdatafactory"],function(a,b,c,d,e){function f(f,g){function k(a){var c=b.getObjType(a.data.ref);o(a)&&d.show(a)}function l(a){var c,d=b.getObjType(a.data.ref),e,f;if(o(a)){c=$(a.data.target);switch(d){case"Field":case"Table":case"Column":case"Row":e=c.find(".arcTdInnerDiv"),e.length===1&&(f=e[0])}m(f),a.data.clickPos=undefined}}function m(a){var b,c,d=$(document.activeElement);a&&(document.selection&&document.selection.createRange?(b=document.selection.createRange(),b.moveToElementText(a),b.select()):document.createRange&&window.getSelection&&(b=document.createRange(),b.selectNode(a),c=window.getSelection(),c.removeAllRanges(),c.addRange(b),d.closest("td").focus()))}function n(a,b){var c,d="#"+b[0].id;if(!a.is("TD")&&!a.is(d)){c=a.parent();while(!c.is("TD")&&!c.is(d))c=c.parent();return c.is(d)?!1:$(".arcTdHtmlDiv",c).length===1}return!1}function o(a){var d=$("#"+a.data.id),e=b.getObjType(d),f=$(a.target),g,h=!0;if(e==="Text")a.data=j.createExtendedEventDataForInput(d,a.data.id);else{a.data.clickPos&&(f=q(d,a.data.id,a.data.clickPos.y,a.data.clickPos.x)),f.is("INPUT")&&f.attr("type")==="password"&&(f=f.parent()),!f.is("TD")&&!f.hasClass("arcTdInnerDiv")&&(f.length>0&&n(f,d)?h=!0:h=!1);if(h){if(!f.is("TD")){g=f.parent();while(!g.is("TD"))g=g.parent()}else g=f;$(".arcTextInputSizeTarget",d).removeClass("arcTextInputSizeTarget"),g.addClass("arcTextInputSizeTarget"),a.data.initialValue=f.attr("data-unformatted")||f.text(),a.data.target=f,a.data.clickPos=c.getCellPosition(g[0])}}return h}function p(a){var b=$('<input type="password" />');b.css({"font-size":a.css("font-size"),"font-style":a.css("font-style"),"font-weight":a.css("font-weight"),"font-family":a.css("font-family"),"font-variant":a.css("font-variant")}),a.append(b)}function q(a,c,d,e){var f,g,h,i=b.getDatavirtualizationProperties(a),j=0,k=0;return i&&ARCPLAN.datavirtualization!==!1&&(i.firstElementInDOM&&(j=i.firstElementInDOM),i.firstColumnInDOM&&(k=i.firstColumnInDOM)),d-=j,e-=k,f=a.find("table").first(),g=$("tr:nth-child("+(d+1)+")",f),h=$("td:nth-child("+(e+1)+")",g),h}function r(a){var c=$("#"+a.data.id),d=b.getNumRows(c),e=c.closest(".arcContainer"),g=b.getDocSelectedObjectManager(e),j=!1,l,m;d===0?(a.data.clickPos={x:0,y:0},$(".invisibleInitialInputRow",c).removeClass("invisibleInitialInputRow")):a.data.clickPos&&(m=b.getDatavirtualization(c),m&&(l=m.getPrimaryCellIndex(a.data.clickPos.x,a.data.clickPos.y)),l?b.setSelectedCell(c,{x:l.x,y:l.y}):b.setSelectedCell(c,{x:a.data.clickPos.x,y:a.data.clickPos.y}),g.setSelectedObject(a.data.id)),ARCPLAN.useEventOrder===!0?i.doUIEvent(function(d){var e,f,g;d===!0?(a.data.clickPos&&(a.data.clickPos=undefined),$(document.activeElement).blur(),e=a.data.ref.closest(".arcContainer"),f=b.getDocSelectedObjectManager(e),f&&f.setSelectedObject(undefined),b.setSelectedCell(a.data.ref,{x:-1,y:-1}),g=$(".selected",a.data.ref),g.length>0&&g.removeClass("selected")):k(a)}):(j=f.executePendingBlurEvent(),j||a.data.hasClickEvent===!0?h={event:a,callback:k}:k(a))}function s(a){if(ARCPLAN.useEventOrder===!0){i.doUIEvent(function(){l(a)});return}a.data.hasClickEvent===!0?h={event:a,callback:l}:l(a)}var h,i=g,j={};return j.selectCell=function(a,c,d,e){var f=b.getIsPassword(a),g=b.isActive(a),h=q(a,c,d,e),i=h,l=j.createExtendedEventDataForInput(a,c),m=a.closest(".arcContainer"),n=b.getDocSelectedObjectManager(m);if(!g)return;n.setSelectedObject(c),b.setSelectedCell(a,{x:e,y:d}),f&&(i.find("input").length>0?i=i.find("input").first():p(h)),k({target:i,data:l})},j.createExtendedEventDataForInput=function(a,c){var d=e.createInstance(c,a);return d.hasClickEvent=b.getHasClickEvent(a),d.isPassword=b.getIsPassword(a),b.getIsEditable(a)||(d.readonly=!0),b.getObjType(a)==="Field"?(d.initialValue=$("td",a).text(),d.target=$(".arcTdInnerDiv",a),d.clickPos={x:0,y:0}):b.getObjType(a)==="Text"&&(d.initialValue=$("textarea",a).text(),d.target=$("textarea",a),d.clickPos={x:0,y:0}),d},j.selectTextField=function(a,b){var c=j.createExtendedEventDataForInput(a,b),e=a.find("textarea");d.show({target:e,data:c})},j.showPendingEditCell=function(c,d){a(ARCPLAN.useEventOrder!==!0,"we should not be calling showPendingEditCell with the new eventOrder concept");var e=h,f,g,i,j;h=null,e&&e.event&&e.event.data&&(!c&&!d&&typeof e.event.data.clickPos!="undefined"&&(f=$.contains(document.documentElement,e.event.data.ref[0]),f&&e.callback(e.event)),e.event.data.clickPos&&(e.event.data.clickPos=undefined),d&&($(document.activeElement).blur(),g=e.event.data.ref.closest(".arcContainer"),j=b.getDocSelectedObjectManager(g),j&&j.setSelectedObject(undefined),b.setSelectedCell(e.event.data.ref,{x:-1,y:-1}),i=$(".selected",e.event.data.ref),i.length>0&&i.removeClass("selected")),b.setClickingOnFieldWithClickEvent(e.event.data.ref,undefined))},j.onClickUnformattedText=function(a){var c=$("#"+a.data.id),d=b.getIsEditable(c),e=b.isActive(c),f=e&&d,g;o(a),g=c.find(".arcTextInputSizeTarget .arcTdHtmlDiv").length===0,f&&g?r(a):s(a)},j}return{createInstance:f}}),define("userparam",["stringtools","logger"],function(a,b){var c={},d={};return c.setParam=function(a,c){!a||typeof a!="string"&&typeof a!="number"?b.error("Invalid UserParam Name: "+a):!c||typeof c!="string"&&typeof c!="number"?typeof c=="undefined"?d[a]&&delete d[a]:typeof c=="function"?b.error("Code Injection is not supported "+a):b.error("Parameter mismatch: "+a):d[a]=c},c.getParam=function(a){if(!a||typeof a!="string"&&typeof a!="number"){b.error("Invalid UserParam Name: "+a);return}return d[a]},c.getNumParams=function(){var a,b=0;for(a in d)d.hasOwnProperty(a)&&(b+=1);return b},c.clear=function(){var a;for(a in d)d.hasOwnProperty(a)&&delete d[a]},c.serialize=function(){var b,c="";for(b in d)d.hasOwnProperty(b)&&(isNaN(b)?c+="<Name>"+a.escapeForXml(b)+"</Name>":c+="<ID>"+a.escapeForXml(b)+"</ID>",c+="<Text>"+a.escapeForXml(d[b])+"</Text>");return c},c}),define("stringsres",["browserfeatures","require","stringsen","stringsde","stringtools"],function(a,b,c,d,e){var f={},g,h=!1;return f.parseStringsResourceFileContent=function(a){var b,c,d,e=a.match(/[^\r\n]+/g),f={};for(b=0;b<e.length;b+=1)c=e[b],d=c.split("|"),f[d[0]]=d[1];return f},f.loadCustomStringResources=function(a){var c;h===!1&&(c=b.toUrl("../res/strings."+a+".txt"),$.ajax({url:c,async:!1,type:"GET",success:function(a){g=f.parseStringsResourceFileContent(a)},error:function(a,b,d){window.console&&window.console.warn('Custom resource file not found "'+c+" "+a)}}),h=!0)},f.getMessageById=function(b,h){var i,j,k=ARCPLAN.language;k==="client"&&(k=e.browserLangToArcplanLang(a.clientLanguage)),k==="server"&&(k="en"),k=k?k.toLowerCase():"en",k!=="en"&&k!=="de"&&(g?j=g[b]:f.loadCustomStringResources(k));if(!j){k&&k.toLowerCase()==="de"?j=d[b]:j=c[b];if(!j)throw"Message id "+b+" does not exists"}if(h&&typeof h.length=="number")for(i=0;i<h.length;i+=1)j=j.replace("{"+i+"}",h[i]);return j},f.resetCustomStringResources=function(){g=undefined,h=!1},f}),define("tools",["jquery","properties","stringtools","stringsres","stringsid","keycodes"],function(a,b,c,d,e,f){function h(b,c){a.each(c,function(a,c){b(a,c)})}var g={};return g.formatError=function(a){var b={caption:d.getMessageById(e.UNKNOWN_ERROR_TITLE),text:d.getMessageById(e.UNKNOWN_ERROR),type:"error"},c={1722:d.getMessageById(e.ARCPLAN_SERVER_NOT_AVAILABLE)},f={51410:d.getMessageById(e.ARCPLAN_SERVER_EXCEPTION),6e4:d.getMessageById(e.ARCPLAN_MEMORY_OVERLOAD)},g={51300:d.getMessageById(e.SESSION_END)};return a.Type==="CgiError"&&(b.caption=d.getMessageById(e.CGI_ERROR_TITLE)),typeof a.Text=="string"&&(b.text=a.Text),a.ID&&c[a.ID]&&(b.text=c[a.ID]),typeof a=="string"&&f[a]&&(b.caption=d.getMessageById(e.SERVER_ERROR_TITLE),b.text=f[a]),typeof a=="string"&&g[a]&&(b.caption=d.getMessageById(e.SERVER_MESSAGE_TITLE),b.text=g[a],b.type="info"),b},g.hasAllProperties=function(a,b){var c;if(typeof a!="object")return!1;for(c=0;c<b.length;c+=1)if(!a.hasOwnProperty(b[c]))return!1;return!0},g.each=a.each,g.iterateArcplanArray=function(b,c){a.each(b.Elements,function(a,b){return h(c,b)})},g.toCamelCase=function(a){return a.replace(/-([a-z])/gi,function(a,b){return b.toUpperCase()})},g.toHTMLFont=function(a){var b={},c;return typeof a=="object"&&(b.fontFamily="'"+a.FaceName+"'",b.fontSize=""+Math.round(Math.abs(a.Height)*72/96)+"pt",b.lineHeight=Math.abs(a.Height),a.Height<0&&(b.lineHeight=b.lineHeight+2),b.lineHeight=b.lineHeight+"px",c=parseInt(a.Weight,10),c===400?b.fontWeight="normal":c===700?b.fontWeight="bold":b.fontWeight=c,parseInt(a.Italic,10)>0?b.fontStyle="italic":b.fontStyle="normal",b.textDecoration="none",a.Underline==="1"&&(b.textDecoration="underline"),a.StrikeOut==="1"&&(a.Underline==="1"?b.textDecoration="underline line-through":b.textDecoration="line-through")),b},g.makeNodeID=function(a,b,c,d,e,f){var g=a+"_"+b+"_"+c+"_"+d+"_"+e;return f&&(g=g+"_"+f),g},g.mergeObjects=function(a,b){var c,d,e=arguments.length,f;if(e>1)for(d=1;d<e;d+=1){f=arguments[d];for(c in f)a[c]=f[c]}return a},g.camelCaseToStyleAttribute=function(a){return typeof a=="string"?a.replace(/([A-Z])/g,function(a,b){return"-"+b.toLowerCase()}):""},g.styleAsStringFromObject=function(a){var b,c=[];if(typeof a=="object")for(b in a)c.push(g.camelCaseToStyleAttribute(b)+":"+a[b]+";");return c.join("")},g.isInputKeyAllowed=function(a,b,c){return b!==!0&&c!==!0&&a>=48&&a<=90||a===f.Backspace||a===f.Delete||a===f.Space||a===f.Semicolon||a===f.Equals||a===f.Slash||a===f.Point||a===f.Dash||a===f.DecimalPoint||a===f.Minus||a===f.Divide||a===f.OpenBracket||a===f.CloseBracket},g.getDocContainerForObject=function(d){var e,f;return e=b.getDocName(d),f=c.makeID(e,0),a("#"+f)},g.arrayContainsJQueryObject=function(a,b){var c=!1;return a.some(function(a){if(a.is(b))return c=!0,!0}),c},g.getAbsoluteUrlToCGI=function(a){var b,c;return a.indexOf("://")===-1?(c=document.createElement("a"),c.href=a,b=c.href):b=a,b},g}),define("arcplanobjects/arcplanobjectsmanagerfactory",["assert/assert","arcplandocuments/documentsettings","arcplanobjects/containerfactory","tools","stringtools"],function(a,b,c,d,e){function f(f){function i(a,b){h[a]=b}function j(a){return h.hasOwnProperty(a)?h[a]:undefined}function k(a,b){var c=Math.abs(b);return a+":"+c}function l(a,b){return a.indexOf(b+":")===0?!0:!1}function m(a,b){var c=k(a,b);return g.hasOwnProperty(c)}function n(b){a(b.isInDOM===!1),b.objectContainer.$container.appendTo(b.$docContainer),b.isInDOM=!0}function o(b){a(b.isInDOM===!0),b.objectContainer.$container.detach(),b.isInDOM=!1}function p(a,b,c,d){b.arcplanObject=a.createArcplanObject(c,d,f),b.arcplanObject.insertIntoContainer(b.objectContainer.$container),b.objectContainer.registerResponsiveDesignViewChangedCallback(b.arcplanObject.responsiveDesignViewChangedCallback),b.objectContainer.registerSizeChangedCallback(b.arcplanObject.containerSizeChangedCallback)}function q(e,h,i){var l=b.createPropertyBasedDocSettings(e);d.iterateArcplanArray(i,function(b,d){var i,m,o,q;if(!d||!d.ObjID)return;i=j(b),typeof i!="undefined"&&(a(typeof i.containerShouldHandleTabIndex=="boolean"),q=i.containerShouldHandleTabIndex,m={docName:e,arcplanObject:undefined,objectContainer:c.createObjectContainer(l,d,q,f),$docContainer:h,isInDOM:!1},m.objectContainer.isVisible()&&(p(i,m,l,d),n(m)),o=k(e,d.ObjID),a(typeof g[o]=="undefined"),g[o]=m)})}function r(a){return!a||!a.ObjID?!0:typeof a.BaseProperties=="undefined"&&typeof a.ObjectProperties=="undefined"&&typeof a.ObjectData=="undefined"?!0:!1}function s(c){d.iterateArcplanArray(c,function(c,d){var f,h,i,l,m;if(r(d)===!0)return;i=e.removeExtension(d.Worksheet),m=k(i,d.ObjID),h=g[m],typeof h=="object"&&(a(typeof h.objectContainer=="object"),typeof d.BaseProperties=="object"&&h.objectContainer.update(d),h.objectContainer.isVisible()?typeof h.arcplanObject=="object"?(h.isInDOM===!1&&n(h),h.arcplanObject.update(d)):(f=j(c),l=b.createPropertyBasedDocSettings(i),p(f,h,l,d),n(h)):h.isInDOM===!0&&o(h))})}function t(a){var b=[],c;f&&(c=Object.keys(g),c.forEach(function(b){var c=g[b];c.docName===a&&(c.objectContainer.render(),typeof c.arcplanObject=="object"&&c.arcplanObject.render())}))}function u(a){var b=[],c,d=Object.keys(g);return d.forEach(function(c){var d=g[c];d.docName===a&&b.push(d.objectContainer)}),b}function v(a,b){var c=k(a,b),d;d=g[c];if(typeof d=="object")return d.objectContainer}function w(a){var b=Object.keys(g);b.forEach(function(b){l(b,a)&&delete g[b]})}var g={},h={};return{registerArcplanObjectBuilder:i,createArcplanObjects:q,isArcplanObjectAlreadyCreated:m,updateArcplanObjects:s,getObjectContainersForDocument:u,getObjectContainer:v,removeArcplanObjects:w,renderDocument:t}}return{createInstance:f}}),define("components/datatranslators/eventdatatranslator",["assert/assert","tools"],function(a,b){function c(c){function f(a){var b;return c.some(function(c){c.arcplanEventNames.some(function(d){if(a===d)return b=c,!0});if(typeof b=="object")return!0}),b}function g(c){var d=[];return typeof c=="object"&&typeof c.Events=="object"&&(a(Array.isArray(c.Events.Elements)),b.iterateArcplanArray(c.Events,function(a,b){var c=f(b.Type);typeof c=="object"&&d.push(c)})),d}function h(a,b){a[b.viewModelCallbackName]=b.viewModelCallback}a(Array.isArray(c));var d,e={};return e.create=function(a,b){var c={},d;return d=g(b.ObjectProperties),d.forEach(function(a){h(c,a)}),c},e.update=function(a,b,d,e){var f=a[b],i,j=!1;return i=g(e.ObjectProperties),c.forEach(function(a){var b,c;b=i.indexOf(a)!==-1,c=typeof f[a.viewModelCallbackName]=="function",b!==c&&(b?h(f,a):delete f[a.viewModelCallbackName],j=!0)}),j},e}return{createEventDataTranslator:c}}),define("components/datatranslators/fontdatatranslator",["assert/assert","tools","components/common/dataobjects"],function(a,b,c){var d={};return d.create=function(c,d){return a(typeof d=="object"),a(typeof d.ObjectProperties=="object"),typeof d.ObjectProperties.Font!="object"?{}:b.toHTMLFont(d.ObjectProperties.Font)},d}),define("components/button/buttondatatranslatorfactory",["assert/assert","tooltip","tools","colortools","dmfieldtypes","components/datatranslators/celldatatranslator","components/datatranslators/activedatatranslator","components/datatranslators/alignmentdatatranslator","components/datatranslators/backgroundcolordatatranslator","components/datatranslators/backgroundimagedatatranslator","components/datatranslators/borderdatatranslator","components/datatranslators/eventdatatranslator","components/datatranslators/fontdatatranslator","components/datatranslators/foregroundcolordatatranslator","components/datatranslators/sizedatatranslator","components/datatranslators/taborderdatatranslator","components/datatranslators/tooltipdatatranslator","components/datatranslators/wordwrapdatatranslator","components/datatranslators/compositedatatranslatorfactory","stringtools"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){return function(c,d,e,t,u,v,w){function z(b){var c=!1,d=!1;return a(typeof b.ObjectProperties=="object"),b.ObjectProperties.YSetting&&b.ObjectProperties.YSetting.Value&&(b.ObjectProperties.YSetting.Value==="1"&&(d=!0),d!==x.isPressed&&(x.isPressed=d,c=!0)),c}function A(){x={},x.content=f.create(d.ObjectData,t,v),y.createInViewModel(x,c,d,t,v),z(d),x.setAsSelectedObject=function(){w(c.docName,d.ObjID)}}function B(a){var b=!1;f.update(x,"content",a.ObjectData,t,v)&&(b=!0),typeof a.ObjectProperties=="object"&&(y.updateViewModel(x,c,a,t,v)&&(b=!0),z(a)&&(b=!0)),b===!0&&u()}function C(b){a(typeof b=="object"),y.updateViewModelForResponsiveDesignViewChange(x,c,b)&&u()}function D(a,b){y.updateViewModelForContainerSizeChange(x,a,b)&&u()}function E(){var a=[{arcplanEventNames:["OnClick","OnCheck","OnUnCheck"],viewModelCallbackName:"onClick",viewModelCallback:function(a,b,f,g){e.onClick(c.docName,d.ObjID,a,b,f,g,x.isPressed?!1:!0)}}];return l.createEventDataTranslator(a)}a(typeof c=="object","docSettings parameter must be an object"),a(typeof d=="object","originalObjNode parameter must be an object"),a(typeof d.ObjectData=="object","originalObjNode.ObjectData must be an object"),a(typeof d.ObjectProperties=="object","originalObjNode.ObjectProperties must be an object"),a(typeof d.BaseProperties=="object","originalObjNode.BaseProperties must be an object"),a(typeof e=="object","buttonEventcallbacks must be an object"),a(typeof e.onClick=="function","buttonEventCallbacks.onClick must be a function"),a(typeof t=="object","imageLoader must be an object"),a(typeof u=="function","onViewModelChanged must be a function"),a(typeof v=="function","onImmediateReRenderRequired must be a function"),a(typeof w=="function","setSelectedObjectCallback must be a function");var x,y;return y=s.createCompositeDataTranslator(),y.addDataTranslator("active",g),y.addDataTranslator("alignment",h),y.addDataTranslator("backgroundColor",i),y.addDataTranslator("backgroundImage",j),y.addDataTranslator("border",k),y.addDataTranslator("font",m),y.addDataTranslator("fontColor",n),y.addDataTranslator("size",o),y.addDataTranslator("tooltip",q),y.addDataTranslator("tabOrder",p),y.addDataTranslator("wordWrap",r),y.addDataTranslator("eventCallbacks",E()),A(),{viewModel:x,updateViewModel:B,updateViewModelForResponsiveDesignViewChange:C,updateViewModelForContainerSizeChange:D}}}),define("components/button/buttonbuilderfactory",["assert/assert","components/button/buttondatatranslatorfactory"],function(a,b){return function(d,e,f,g){var h={onClick:e};return{createArcplanObject:function(c,e,i){function n(){i?m=!0:k.reRender()}function o(){k.reRender()}var j,k,l,m=!0;return a(typeof g=="object"),a(typeof g.loadImageForHash=="function"),j=b(c,e,h,g,n,o,f),k=d(j.viewModel),{insertIntoContainer:k.renderIntoContainer,update:function(a){j.updateViewModel(a)},render:function(){i&&m&&k.reRender(),m=!1},responsiveDesignViewChangedCallback:function(a,b){j.updateViewModelForResponsiveDesignViewChange(a,b)},containerSizeChangedCallback:function(a,b){j.updateViewModelForContainerSizeChange(a,b)}}},containerShouldHandleTabIndex:!1}}}),define("components/datatranslators/cellpropertytranslator",["assert/assert","components/datatranslators/alignmenthelper","tools","components/common/dataobjects"],function(a,b,c,d){function f(a){var b={top:0,left:0,right:0,bottom:0},c=parseInt(a.Type,10),d=parseInt(a.Width,10);(c&1)===1&&(b.top=d),(c&16)===16&&(b.left=d),(c&256)===256&&(b.right=d),(c&4096)===4096&&(b.bottom=d);if(d===0)return;return b}var e={};return e.create=function(d){var e={};return a(typeof d=="object","the cellNode must be an object"),d!==null&&(e.alignment={horizontalAlign:"right",verticalAlign:"middle"},e.scaleToObject=!1,typeof d.Justification=="string"&&(e.alignment.horizontalAlign=b.translateHorizontalAlignment(d.Justification)),typeof d.VerticalAlignment=="string"&&(e.alignment.verticalAlign=b.translateVerticalAlignment(d.VerticalAlignment)),typeof d.Font=="object"&&(e.font=c.toHTMLFont(d.Font)),typeof d.BackgroundColor=="string"&&(e.backgroundColor={color1:d.BackgroundColor}),typeof d.ForegroundColor=="string"&&(e.fontColor={color:d.ForegroundColor}),typeof d.ScaleToObject=="string"&&(e.scaleToObject=d.ScaleToObject==="true"),typeof d.Border=="object"&&(e.border=f(d.Border),typeof e.border=="object"&&(e.border.color=d.Border.Color)),typeof d.Margin=="object"&&(e.margin=f(d.Margin)),typeof d.Padding=="object"&&(e.padding=f(d.Padding))),e},e.update=function(a,b,c){var f=e.create(c);return d.update(a,b,f)},e}),define("components/field/fielddatatranslatorfactory",["assert/assert","components/datatranslators/celldatatranslator","components/datatranslators/cellpropertytranslator","components/datatranslators/activedatatranslator","components/datatranslators/alignmentdatatranslator","components/datatranslators/backgroundcolordatatranslator","components/datatranslators/backgroundimagedatatranslator","components/datatranslators/borderdatatranslator","components/datatranslators/eventdatatranslator","components/datatranslators/fontdatatranslator","components/datatranslators/foregroundcolordatatranslator","components/datatranslators/passworddatatranslator","components/datatranslators/sizedatatranslator","components/datatranslators/taborderdatatranslator","components/datatranslators/tooltipdatatranslator","components/datatranslators/wordwrapdatatranslator","components/field/fieldeditedcallbackdatatranslator","components/datatranslators/compositedatatranslatorfactory"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(b){return a(b.ObjectData.NumRows==="1"&&b.ObjectData.NumCols==="1"||b.ObjectData.NumRows==="0"&&b.ObjectData.NumCols==="0"),b.ObjectData.NumRows==="0"?null:b.ObjectData.Rows.Elements[0].Row.Elements[0].Cell}return function(u,v,w,x,y,z){function C(){var a=s(v);A={cell:{content:b.create(a,x,z),properties:c.create(a)}},B.createInViewModel(A,u,v,x,z)}function D(a){var d=!1,e;typeof a.ObjectData=="object"&&(e=s(a),b.update(A.cell,"content",e,x,z)&&(d=!0),c.update(A.cell,"properties",e)&&(d=!0)),typeof a.ObjectProperties=="object"&&B.updateViewModel(A,u,a,x,z)&&(d=!0),d===!0&&y()}function E(b){a(typeof b=="object"),B.updateViewModelForResponsiveDesignViewChange(A,u,b)&&y()}function F(a,b){B.updateViewModelForContainerSizeChange(A,a,b)&&y()}function G(){var a=[{arcplanEventNames:["OnClick"],viewModelCallbackName:"onClick",viewModelCallback:function(a,b,c,d){w.onClick(u.docName,v.ObjID,a,b,c,d)}}];return i.createEventDataTranslator(a)}function H(){return q.createDataTranslator(function(a,b,c){w.onTextEdited(u.docName,v.ObjID,a,b,c)})}a(typeof u=="object","docSettings parameter must be an object"),a(typeof v=="object","originalObjNode parameter must be an object"),a(typeof v.ObjectData=="object","originalObjNode.ObjectData must be an object"),a(typeof v.ObjectProperties=="object","originalObjNode.ObjectProperties must be an object"),a(typeof v.BaseProperties=="object","originalObjNode.BaseProperties must be an object"),a(typeof w=="object","fieldEventcallbacks must be an object"),a(typeof w.onClick=="function","fieldEventCallbacks.onClick must be a function"),a(typeof w.onTextEdited=="function","fieldEventCallbacks.onTextEdited must be a function"),a(typeof x=="object","imageLoader must be an object"),a(typeof y=="function","onViewModelChanged must be a function"),a(typeof z=="function","onImmediateReRenderRequired must be a function");var A,B;return B=r.createCompositeDataTranslator(),B.addDataTranslator("active",d),B.addDataTranslator("alignment",e),B.addDataTranslator("backgroundColor",f),B.addDataTranslator("backgroundImage",g),B.addDataTranslator("border",h),B.addDataTranslator("font",j),B.addDataTranslator("fontColor",k),B.addDataTranslator("password",l),B.addDataTranslator("size",m),B.addDataTranslator("tabOrder",n),B.addDataTranslator("tooltip",o),B.addDataTranslator("wordWrap",p),B.addDataTranslator("eventCallbacks",G()),B.addDataTranslator("editCallbacks",H()),C(),{viewModel:A,updateViewModel:D,updateViewModelForResponsiveDesignViewChange:E,updateViewModelForContainerSizeChange:F}}}),define("components/field/fieldbuilderfactory",["assert/assert","components/field/fielddatatranslatorfactory"],function(a,b){return function(d,e,f,g){var h={onClick:e,onTextEdited:f};return{createArcplanObject:function(c,e,f){function l(){f?k=!0:j.reRender()}function m(){j.reRender()}var i,j,k=!0;return a(typeof g=="object"),a(typeof g.loadImageForHash=="function"),i=b(c,e,h,g,l,m),j=d(i.viewModel),{insertIntoContainer:j.renderIntoContainer,update:function(a){i.updateViewModel(a)},render:function(){f&&k&&j.reRender(),k=!1},responsiveDesignViewChangedCallback:function(a,b){i.updateViewModelForResponsiveDesignViewChange(a,b)},containerSizeChangedCallback:function(a,b){i.updateViewModelForContainerSizeChange(a,b)}}},containerShouldHandleTabIndex:!1}}}),define("requesttools",["stringtools","tools","jquery"],function(a,b,c){function e(c){var d="";return b.each(c,function(b,c){d+="<"+b+">",c!==null&&c!==undefined&&(typeof c=="object"?c.serialize&&typeof c.serialize=="function"?d+=c.serialize():d+=e(c):d+=a.escapeForXml(c)),d+="</"+b+">"}),d}function f(a){return"<"+a+' xmlns="http://schemas.arcplan.com/arcplan/clientCommunication">'+"<"+a+"Param>"}function g(a){return"</"+a+"Param>"+"</"+a+">"}var d={};return d.wrapBody=function(a,b,c){var d='<?xml version="1.0" encoding="UTF-8" standalone="no" ?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">';return a&&(d+="<soap:Header><ServerName>"+a+"</ServerName>",c&&(c.networkDuration&&(d+="<NetworkDuration>"+c.networkDuration+"</NetworkDuration>"),c.clientProcessingDuration&&(d+="<ClientProcessingDuration>"+c.clientProcessingDuration+"</ClientProcessingDuration>")),d+="</soap:Header>"),d+="<soap:Body>"+b+"</soap:Body>"+"</soap:Envelope>",d},d.createSoapRequest=function(a,b,c,h){var i=f(a);return i+=e(b),i+=g(a),d.wrapBody(c,i,h)},d.createGetRequest=function(a,c,d,e){var f,g=c+"?ISINIT=%22"+d+"%22"+"&DYN="+a;return e&&b.each(e,function(a,b){g+="&"+a+"=",b!==undefined&&(g+=b)}),g+="    ",g},d.addSessionIdAndTokenToParams=function(a,c,d){var e={SessionID:c,SessionToken:d};return b.each(a,function(a,b){e[a]=b}),e},d.ajax=function(a){return c.ajax(a)},d.makeGetRequest=function(a,b){var c=new XMLHttpRequest,d=b!==!0;c.open("GET",a,d),c.send(null)},d.createCDataSerializer=function(a){var b=a;return{serialize:function(){return"<![CDATA["+b+"]]>"}}},d}),define("propertytools",["tools","properties","components/datatranslators/alignmenthelper"],function(a,b,c){var d={};return d.getColumnFromScrollPos=function(c,d){var e=0,f,g=0,h=b.getColumnWidth(d);return c!==0&&h&&(h.width?(f=b.getColumnWidth(d).width,e=Math.round(c/f)):a.iterateArcplanArray(h,function(a,b){if(a==="Width"){g+=b;if(g<c)e+=1;else return!1}})),e},d.getScrollPosFromColumn=function(c,d){var e=0,f=0,g=b.getColumnWidth(d);return c!==0&&a.iterateArcplanArray(g,function(a,b){if(a==="Width"){if(f<c)e+=b;else return!1;f+=1}}),e},d.setVerticalAlignment=function(a,d){var e=b.getVerticalAlignment(a);d.verticalAlign=c.translateVerticalAlignment(e)},d.setHorizontalAlignment=function(a,d){var e=b.getHorizontalAlignment(a);d.textAlign=c.translateHorizontalAlignment(e)},d.getLevelFromRowProp=function(a,b){var c=parseInt(a,10),d=99;return c>d&&(c=d),c===d&&b===!0&&(c=0),c},d.getAdjustedRowHeightForField=function(a){var c,d=b.getHeight(a);return b.getScaleToObject(a)?(c=b.getBorder(a),c.top&&(d-=1),c.bottom&&(d-=1)):d-=2,d},d.getAdjustedRowHeight=function(a,c){var e;if(c==="Field")return d.getAdjustedRowHeightForField(a);c==="Row"?e=b.getRowHeight(a)-1:e=Math.round(b.getRowHeight(a));switch(b.getGridType(a)){case"both":case"horizontal":if(c!=="Row")return e-1}return e},d.hasRowHoriScrollbar=function(c){var d=0,e=b.getColumnWidth(c);if(e){a.iterateArcplanArray(e,function(a,b){a==="Width"&&(d+=b)});if(e.numCols>1&&b.getHScrollBarAllowed(c)&&d>b.getWidth(c))return!0}return!1},d.hasColumnVertScrollbar=function(a){var c=b.getNumRows(a),d=b.getRowHeight(a),e=c*d,f=b.getHeight(a);return c>1&&b.getVScrollBarAllowed(a)&&e>f?!0:!1},d.getHierFormatByDim=function(a,c){var d=b.getHierFormat(a);return d&&d.length>=c?d[c-1]:{}},d}),define("scrollobserver",["tools","properties","propertytools"],function(a,b,c){function g(a,b){var c=0,d;if(a.numCols>0){d=a.Elements[0].Width;while(b>=d&&c<a.numCols)c+=1,c<a.numCols&&(d+=a.Elements[c].Width);return Math.min(c+1,a.numCols)}return-1}var d={},e=[],f=[];return d.correctScrollPositionOfScrollObjectsForIE=function(){var a,c,d,e,g=f.length;for(a=0;a<g;a+=1)c=f[a],e=b.getScrollElem(c),e&&(d=b.getScrollY(c),d>1&&e.scrollTop(d))},d.removeScrolledObjectsForIEFromDocument=function(a){var c,d,e,g=f.length;for(c=0;c<g;c+=1)d=f[c],e=b.getDocName(d),e===a&&(f.splice(c,1),c-=1,g-=1)},d.clearScrolledObjectsForIE=function(){f=[]},d.getScrolledObjectsForIE=function(){return f},d.removeScrolledObject=function(a){var b=e.indexOf(a);b>-1&&e.splice(b,1)},d.addScrolledObject=function(a){b.getWasScrolled(a)||(e.push(a),b.setWasScrolled(a,!0)),f.indexOf(a)===-1&&f.push(a)},d.getScrolledObjects=function(){var c=[];return a.each(e,function(a,d){var e=b.getScrollX(d),f=b.getScrollY(d),h=b.getColumnWidth(d),i=b.getRowHeight(d),j=Math.round(e/h.width+1),k=Math.round(f/i+1),l=b.getXSettingValue(d),m=b.getYSettingValue(d);isNaN(j)&&(j=g(h,e)),j===l&&(j=-1),k===m&&(k=-1),(j!==-1||k!==-1)&&c.push({ID:b.getID(d),Worksheet:b.getDocName(d),XSetting:j,YSetting:k})}),{scrollInfo:c,serialize:function(){var b="",c=this;return a.each(this.scrollInfo,function(a,c){b=b+"<Setting>"+"<ID>"+c.ID+"</ID>"+"<Worksheet>"+c.Worksheet+"</Worksheet>"+"<XSetting>"+Math.round(c.XSetting)+"</XSetting>"+"<YSetting>"+Math.round(c.YSetting)+"</YSetting>"+"</Setting>"}),b}}},d.clearScrolledObjects=function(){a.each(e,function(a,d){var e=b.getScrollX(d),f=b.getScrollY(d),g=b.getRowHeight(d),h=c.getColumnFromScrollPos(e,d),i=Math.round(f/g+1);h&&b.setXSettingValue(d,h),i&&b.setYSettingValue(d,i),b.setWasScrolled(d,!1)}),e=[]},d}),define("stylesheethandler",["jquery","tools","logger"],function(a,b,c){function f(a){return a.ownerNode||a.owningElement}function g(a){var b=document.createElement("style"),c=document.head||document.getElementsByTagName("head")[0];return b.type="text/css",b.rel="stylesheet",typeof a=="string"&&(b.title=a),c.appendChild(b),b.sheet}function h(){return e===undefined&&(e=g("sessionSheet")),e}function i(a,b){var d=a.cssRules||a.rules,e=d.length;return b.indexOf(",")>=0&&c.error("invalid ',' in CSS Selector: "+b),a.insertRule?a.insertRule(b+" { }",e):a.addRule&&a.addRule(b,null,e),{sheet:a,index:e,style:d[e].style,selector:b}}function j(a,b){var c=a.replace(b,"");return c+=b,c}function k(a,b,d){var e=[],f,g,h,i=!1,l=!1,m=!1,n=!1,o=!1;c.debug("get matching Rules for: "+b),b.indexOf("nth-child(even")>-1?i=!0:b.indexOf("nth-child(odd")>-1?l=!0:b.indexOf("::before")>-1?m=!0:b.indexOf(":checked")>-1?n=!0:b.indexOf(":active")>-1&&(o=!0);for(g=0;g<a.length;g+=1)if(a[g].styleSheet)f=a[g].styleSheet.cssRules||a[g].styleSheet.rules,f&&(e=e.concat(k(f,b,a[g].styleSheet)));else{h=a[g].selectorText;if(h)if(h===b||i&&h===b.replace("nth-child(even","nth-child(2n")||l&&h===b.replace("nth-child(odd","nth-child(2n+1")||m&&h===b.replace("::before",":before")||n&&h===b.replace(".arcHpCbox:not(:checked)",":not(:checked).arcHpCbox").replace("input.arcHpCbox:checked","input:checked.arcHpCbox")||o&&h===j(b,":active")){e.push({sheet:d,index:g,style:a[g].style,selector:b});break}}return c.debug("num matching rules found: "+e.length),e}function l(a,b){a.removeRule?a.removeRule(b):a.deleteRule&&a.deleteRule(b)}function m(a,b){var c,d,e,f=a.cssRules||a.rules;for(c=f.length-1;c>=0;c-=1)f[c].selectorText&&(d=f[c].selectorText.indexOf(".arcCont"),d>=0&&(e=f[c].selectorText,e=e.substring(e.indexOf(".")),d=e.indexOf(" "),d>0&&(e=e.substring(0,d)),d=e.indexOf("_"),d>0&&(e=e.substring(d+1),e===b&&l(a,c))))}function n(a,b){var c=[],d;return d=a.cssRules||a.rules,d&&(c=c.concat(k(d,b,a))),c}function o(a){var b=[],c;return a&&e&&(b=n(e,a)),b}function p(a,b,c){a[b]=c}var d={},e;return d.removeClassesForDocument=function(a){var b=h(),c;a=a.replace(/\s/g,""),m(b,a)},d.removeStyle=function(a,b){var c,d,e,f=h();c=n(f,a),c[0]&&(d=c[0],e=d.style,e[b]!==""&&(e.length===1?l(f,d.index):e[b]=""))},d.setStyle=function(a,c,e,f){var g,j,k,l,m=h();if(e===undefined){if(c&&typeof c=="object"){j=o(a),j.length===0&&(k=i(m,a),j.push(k));for(g in c){if(!c.hasOwnProperty(g))continue;d.setStyle(a,g,c[g],j)}}}else{f?j=f:j=o(a),j.length===0&&(k=i(m,a),j.push(k)),l=b.toCamelCase(c);for(g=0;g<j.length;g+=1)p(j[g].style,l,e)}},d.getStyle=function(a,c){var d,e=o(a),f,g,h;if(c!==undefined){f=b.toCamelCase(c);for(g=e.length-1;g>=0;g-=1)if(e[g].style[f]!==null&&e[g].style[f]!==""){d=e[g].style[f];break}}else{d={};for(g=0;g<e.length;g+=1)for(h=0;h<e[g].style.length;h+=1)f=e[g].style[h],d[f]=e[g].style[b.toCamelCase(f)]}return d},d.removeAllClasses=function(){var a,b;e!==undefined&&(a=f(e),b=a.parentNode,b.removeChild(a),e=undefined)},d}),define("styleborderprops",["jquery","logger","properties","colortools","stylesheethandler"],function(a,b,c,d,e){function g(a,b){var c={TopLeftStyle:"solid",bottomRightStyle:"solid",topLeftColor:b,bottomRightColor:b},d;switch(a){case"3D3":c.topLeftStyle="groove",c.bottomRightStyle="groove",c.topLeftColor="rgba(255, 255, 255, 0.4)",c.bottomRightColor="rgba(220, 220, 220, 0.4)";break;case"3D1":c.topLeftStyle="inset",c.bottomRightStyle="inset",c.topLeftColor="rgba(160, 160, 160, 0.75)",c.bottomRightColor="rgba(230, 230, 230, 0.75)";break;case"3D2":c.topLeftStyle="outset",c.bottomRightStyle="outset",c.topLeftColor="rgba(230, 230, 230, 0.75)",c.bottomRightColor="rgba(160, 160, 160, 0.75)";break;case"3D4":c.topLeftColor="rgba(160, 160, 160, 0.75)",c.bottomRightColor="rgba(160, 160, 160, 0.75)",c.bottomRightStyle="solid";break;default:c.topLeftStyle="solid",c.bottomRightStyle="solid"}return c}function h(a,b){if(b==="3D4"){if(a.right&&a.bottom)return"3px 3px 6px 0px rgba(0,0,0,0.5)";if(a.right)return"8px 0px 6px -6px rgba(0,0,0,0.5)";if(a.bottom)return"0 8px 6px -6px rgba(0,0,0,0.5)"}}function i(a,b){return a+"px "+b.topLeftStyle+" "+b.topLeftColor}function j(a,b){return a+"px "+b.bottomRightStyle+" "+b.bottomRightColor}function k(a){var b={},c=a.type,d,e={TopLeftStyle:"solid",bottomRightStyle:"solid",topLeftColor:a.color,bottomRightColor:a.color},k;d=f.getBorderWidth(c),e=g(c,a.color),b.boxShadow=h(a,a.type);if(a.top||a.left||a.bottom||a.right)b.border={},b.border["border-top"]=a.top?i(d.topLeft,e):"",b.border["border-left"]=a.left?i(d.topLeft,e):"",b.border["border-right"]=a.right?j(d.bottomRight,e):"",b.border["border-bottom"]=a.bottom?j(d.bottomRight,e):"";return b}var f={};return f.getBorderWidth=function(a){var b={};switch(a){case"3D4":b.topLeft=0,b.bottomRight=1;break;case"2Point":case"3D1":case"3D2":case"3D3":b.topLeft=2,b.bottomRight=2;break;default:b.topLeft=1,b.bottomRight=1}return b},f.setBorderStyle=function(a,b){var d,e="."+a,f=c.getBorder(b),g=k(f),h;g.boxShadow&&b.children().css("box-shadow",g.boxShadow),g.border&&b.children().css(g.border)},f.getTablePadding=function(a){var b={},d=c.getBorder(a);return d&&(d.top||(b.paddingTop="1px"),d.left||(b.paddingLeft="1px")),b},f.getBorderStyleObject=function(a){var b=c.getBorder(a);return k(b).border},window.jasmine&&(f.toHTMLBorder=k),f}),define("datavirtualization/tablehtmlgenerator",["properties","logger","tools","styleborderprops","patternapplier","tooltiptypes","tooltip","dmfieldtypes","propertytools","browserfeatures","stringtools"],function(a,b,c,d,e,f,g,h,i,j,k){function m(a){switch(a){case"Field":return"dynaCell";case"Column":case"Row":case"Table":return"dyna"+a}}function n(a,b,c,d){var e=$("<table></table>"),f,g,h=!1;return f=$('<tr><td style="width:'+c+';" >'+'<div class="arcTdWrapOuter"><div class="arcTdWrapInner">'+'<div class="arcTdInnerDiv"></div></div></div></td></tr>'),f.appendTo(e),g=$(".arcTdInnerDiv",e),b&&typeof b=="object"&&g.css(b),g[0].textContent=a,e.css({visibility:"hidden",height:d,position:"absolute",left:0,top:0,width:c}),e.appendTo("body"),h=g.height()<=d-1,e.remove(),h}function o(a,b,d){var e,f={},g=a.Font,h=g?c.toHTMLFont(g):"",i;f.textAlign="right",d&&(f.position="relative");if(a.Justification)switch(a.Justification){case"-1":f.textAlign="left";break;case"0":f.textAlign="center"}if(a.VerticalAlignment)switch(a.VerticalAlignment){case"401":f.vertcalAlign="top";break;case"301":f.verticalAlign="bottom"}a.BackgroundColor&&(f.backgroundColor=a.BackgroundColor),a.ForegroundColor&&(f.color=a.ForegroundColor);if(h&&typeof h=="object")for(e in h)e!=="length"&&(i=h[e],typeof i=="string"&&(i=i.replace(/'/g,"")),f[e]=i);return b&&b.Value==="SingleLine"&&(f.whiteSpace="nowrap"),f}function p(a,b,d){var e={textDecoration:d,color:b};return"<div class='arcTdWrapOuter'><div class='arcTdWrapInner'><div class='arcTdInnerDiv'><a style='"+c.styleAsStringFromObject(e)+"' "+" target='_blank' "+" href='"+a.URL.replace(/'/g,"&#x0027;")+"'>"+k.escapeTextForHtml(a.value)+"</a></div></div></div>"}function q(a,b,c){var d="",e="lang='dynaIMG:"+a.hash+"' ";return a.Image&&a.ImageType!=="noimage"&&(d="src='data:image/"+a.ImageType+";base64,"+a.Image+"' ",e=""),"<a target='_blank'  href='"+a.URL.replace(/'/g,"&#x0027;")+"'>"+"<img "+"class='arcImgScaleAllways' "+"name='OBJ' "+e+"align='top' "+"data-origSize='"+a.Width+","+a.Height+"' "+"height='"+c+"px' "+"width='"+b+"px' "+d+"></img></a>"}function r(a,b,c,d){var e="",f="lang='dynaIMG:"+a.hash+"' ",g;return g="style='width:"+d+"px;"+"height:"+c+"px;' ",a.Image&&a.ImageType!=="noimage"&&(e="src='data:image/"+a.ImageType+";base64,"+a.Image+"' ",f=""),"<img class='"+b+"' "+"name='OBJ' "+f+"align='top' "+"data-origSize='"+a.Width+","+a.Height+"' "+g+e+"></img>"}function s(a,b,d){var e=a.length>0?"########":"";if(!b||b.Value!=="SingleLine")a=a.replace(/\r\n/g,"<br />");return"<div class='arcTdWrapOuter'><div class='arcTdWrapInner'><div class='arcTdInnerDiv' style='"+c.styleAsStringFromObject(d)+"' "+">"+"<input type='password' "+"class='arcPassword' "+"value='"+e+"' "+"pass='"+a.replace(/'/g,"&#x0027;")+"' "+"></input>"+"</div></div></div>"}function t(a,b,d){var e="",f=a.value;while(f.indexOf(" ")===0)e+="&nbsp;",f=f.substr(1);f=k.escapeTextForHtml(f);if(!b||b.Value!=="SingleLine")f=f.replace(/\r\n/g,"<br />");return"<div class='arcTdWrapOuter'"+(a.Justification?"":" style='float:right;'")+">"+"<div class='arcTdWrapInner'>"+"<div class='arcTdInnerDiv' style='"+c.styleAsStringFromObject(d)+"' "+">"+e+f+"</div></div></div>"}function u(a,b){var d=a.HtmlSource;return"<div class='arcTdWrapOuter'><div class='arcTdWrapInner' ><div class='arcTdInnerDiv arcTdHtmlDiv' style='"+c.styleAsStringFromObject(b)+"' "+">"+d+"</div></div></div>"}function v(a,b){b=b||{};if(a.VerticalAlignment)switch(a.VerticalAlignment){case"301":b.verticalAlign="bottom";break;case"401":b.verticalAlign="top"}}function w(b,d,e,f,g,k,l,m){var n,w=o(d,k,m),x="",y,z,A,B,C="",D=d.ForegroundColor||a.getForegroundColor(b),E=a.getFont(b),F,G,H,I=a.getObjType(b),J;d.Font?G=c.toHTMLFont(d.Font):G=E,F=G.textDecoration;switch(d.Type){case h.VLink:typeof d.value=="string"?n=p(d,D,F):(I==="Row"?y=Math.min(a.getRowHeight(b),d.Height):y=Math.min(a.getRowHeight(b)-1,d.Height),z=Math.min(e-2,d.Width),n=q(d,z,y));break;case h.VEmfDib:case h.VImage:case h.VRTF:case h.VBlob:d.Type!==h.VBlob&&d.Type!==h.VRTF||!d.value?(J=i.getAdjustedRowHeight(b,I),I==="Row"?i.hasRowHoriScrollbar(b)&&(J-=j.scrollbarWidth):I==="Column"&&i.hasColumnVertScrollbar(b)&&(e-=j.scrollbarWidth),d.ScaleToObject||d.Type===h.VEmfDib?(x="arcImgScaleAllways",y=J,z=e):(y=Math.min(J,d.Height),z=Math.min(e-2,d.Width)),n=r(d,x,y,z)):a.getIsPassword(b)?n=s(d,k,{textDecoration:F}):n=t(d,k,{textDecoration:F});break;case h.VEmpty:case h.VDouble:case h.VChar:case h.VEnterprise:case h.VTime:case h.VSAP:case h.VMetadata:case h.VError:H={textDecoration:F},v(d,H),a.getIsPassword(b)?n=s(d.value,k,H):(d.value.indexOf(" ")===0&&!d.Data&&(d.Data=d.value),n=t(d,k,H)),B=d.Data;break;case h.VHTML:d.HtmlSource&&(I==="Field"&&d.FilterHtml==="true"&&(a.setVHTMLField(b,!0),a.setHtmlSource(b,d.HtmlSource)),n=u(d,{textDecoration:F}))}if(B){d.DecimalSeparator&&d.DecimalSeparator!=="."&&d.Type===h.VDouble&&(B=B.replace(".",d.DecimalSeparator)),B=B.replace(/'/g,"&#x0027;");if(!k||k.Value!=="SingleLine")B=B.replace(/\r\n/g,"<br />");C="data-unformatted='"+B+"'"}return A="<td draggable='true' tabindex='-1'"+(l?" title='"+l+"'":"")+" "+C+" style='"+c.styleAsStringFromObject(w)+"' >"+n+""+(m?"<span class='arcCellTooltipMarker'></span>":"")+"</td>",A}function x(a,b){var c=b?" title='"+b+"' ":"";return"<tr"+c+">"+a.join("")+"</tr>"}function y(b,c,d,e){var h=a.getToolTip(b),i=a.getToolTipType(b),j=a.getObjType(b),k=e;return k===""&&(i===f.EachRow?k=g.toolTipStringForRow(h,c):i===f.WholeObject&&j==="Field"?k=g.toolTipStringForObject(h):i===f.EachColumn?k=g.toolTipStringForColumn(h,d):i===f.EachCell&&(k=g.toolTipStringForCell(h,c,d))),a.getShowTooltipMarker(b)&&k!==""?!0:!1}var l={};return l.generateTableStub=function(b,h,i){var j=a.getTabOrder(b),k=$("<div tabindex='"+j+"' ></div>"),l=$("<div></div>"),n=$("<div></div>"),o=$("<table tabindex='-1' ></table>"),p=a.getZIndex(b),q={left:"0px",top:"0px",position:"relative"},r=a.getForegroundColor(b),s=a.getBackgroundColor(b),t=a.getPattern(b),u={},v=a.getFont(b),w={borderCollapse:"separate"},x=d.getBorderStyleObject(b),y,z,A=a.getObjType(b),B=a.getToolTipType(b),C=a.getToolTip(b);return z=m(A),o.append("<colgroup></colgroup><tbody></tbody>"),A==="Field"&&i&&i[0][0]&&i[0][0].properties.scaleToObject?(a.setScaleToObject(b,!0),y={}):(a.setScaleToObject(b,!1),y=d.getTablePadding(b)),n.append(o),l.append(n),k.append(l),$("div",k).addClass(z).css(q),k.addClass("arcDraggable "+z),x||(x={}),k.css(x).css({color:r}),k.css("z-index",p),l.css({"z-index":p}),t&&t.ImageReference?k.css({backgroundColor:s}):l.css({backgroundColor:s}),n.css("z-index",p+1),c.mergeObjects(u,q,y,v,w),$("table",k).attr("cellspacing",0).css("z-index",p+1).css(u).addClass("dynaTable"),a.getObjType(b)==="Field"&&$("table",k).attr("cellpadding",0),B===f.WholeObject&&k.attr("title",g.toolTipStringForObject(C)),b[0].innerHTML=k[0].outerHTML,e.loadPattern(b,b.children(),h),null},l.buildHtmlForRows=function(b,d,e,i){var j=[],k=0,l=!1,m,n=a.getWidth(b),o=a.getColumnWidth(b),p=a.getWrapMode(b),q=a.getNumCols(b),r=a.getNumRows(b),u=a.getObjType(b),v=a.getToolTip(b),z=a.getToolTipType(b),A="";o&&(c.iterateArcplanArray(o,function(a,b){a==="Width"&&(j.push(Math.max(0,b-1)),k+=b)}),k===0&&o.Width&&(k=q*parseInt(o.Width,10)),l=q>0&&u==="Table"||u==="Row",m=n-k),d.Rows?c.iterateArcplanArray(d.Rows,function(a,d){var k=0,n,o,s=[],t=!1;c.iterateArcplanArray(d,function(a,c){var d;A="",z===f.EachColumn?A=g.toolTipStringForColumn(v,k):z===f.EachCell&&(A=g.toolTipStringForCell(v,i,k)),t=y(b,i,k,A),d=w(b,c,j[k],q,r,p,A,t),k+=1,s.push(d)}),l&&(n={value:"",Type:h.VChar},A="",o=w(b,n,m,q,r,p,A),s.push(o)),A=z!==f.EachRow?"":g.toolTipStringForRow(v,i),e[i]=x(s,A),i+=1}):a.getIsPassword(b)?e[i]='<tr class="invisibleInitialInputRow"><td>'+s("")+"</td></tr>":e[i]='<tr class="invisibleInitialInputRow"><td>'+t({value:""})+"</td></tr>"},l}),define("datavirtualization/propertyproviderfactory",["properties","tooltip","tooltiptypes","styleborderprops","browserfeatures","scrollstates","stringtools","propertytools"],function(a,b,c,d,e,f,g,h){function k(b,c){var d=!1;return typeof b=="object"&&(d=b.hori.some(function(b){var d=a.getPropertyProvider(b)||i.createInstance(b);if(u(b)&&d.hasOwnVerticalScrollBar()&&a.getID(b)!==a.getID(c))return!0})),d}function l(b,c){var d=!1;return typeof b=="object"&&(d=b.vert.some(function(b){var d=a.getPropertyProvider(b)||i.createInstance(b);if(u(b)&&d.hasOwnHorizontalScrollBar()&&a.getID(b)!==a.getID(c))return!0})),d}function m(h,m){var n={};return n.getSelectedCell=function(){return a.getSelectedCell(h)||{x:-1,y:-1}},n.getScrollY=function(){var b=a.getScrollY(h)||0,c,d,e;return c=n.getNumRows()*n.getRowHeightWithGrid(),d=n.getHeightWithoutBorder(),e=Math.max(0,c-d),e<b&&(b=e,a.setScrollY(h,b)),b},n.getScrollX=function(){var b=a.getScrollX(h)||0,c,d,e;return c=n.getAccumulatedColumnWidth(),d=n.getWidthWithoutBorder(),e=Math.max(0,c-d),e<b&&(b=e,a.setScrollX(h,b)),b},n.getColumnWidth=function(b){var c=a.getColumnWidth(h),d;if(typeof c.Elements=="object"&&c.Elements.length>b+1){d=c.Elements[b];if(typeof d=="object"&&d.hasOwnProperty("Width"))return d.Width}return c.width},n.getColumnWidthWithoutGrid=function(a){return Math.max(0,n.getColumnWidth(a)-1)},n.getColumnWidthWithoutGridByColAndColSpan=function(a,b){var c,d=n.getColumnWidthWithoutGrid(a);if(b>1)for(c=a+1;c<a+b;c+=1)d+=n.getColumnWidth(c);return d},n.hasRowHeightChanged=function(){return a.hasRowHeightChanged(h)},n.hasColumnWidthChanged=function(){return a.hasColumnWidthChanged(h)},n.getAccumulatedColumnWidth=function(){return a.getColumnWidth(h).accumulatedColumnWidth},n.getIsPassword=function(){return a.getIsPassword(h)},n.getZIndex=function(){return a.getZIndex(h)},n.getFont=function(){return a.getFont(h)},n.getNumCols=function(){return a.getNumCols(h)},n.getNumRows=function(){return a.getNumRows(h)},n.getWrapMode=function(){return a.getWrapMode(h)},n.getHeight=function(){return a.getHeight(h)},n.getWidth=function(){return a.getWidth(h)},n.getForegroundColor=function(){return a.getForegroundColor(h)},n.getBackgroundColor=function(){return a.getBackgroundColor(h)},n.getBackgroundColor2=function(){return a.getBackgroundColor2(h)},n.getShowTooltipMarker=function(b,c){var d=a.getShowTooltipMarker(h),e=n.getToolTip(b,c);return d?e!=="":!1},n.getToolTip=function(d,e){var f="",g=a.getToolTip(h),i=a.getToolTipType(h);return i===c.EachRow?f=b.toolTipStringForRow(g,e):i===c.EachColumn?f=b.toolTipStringForColumn(g,d):i===c.EachCell?f=b.toolTipStringForCell(g,e,d):i===c.WholeObject&&(f=b.toolTipStringForObject(g)),f},n.getToolTipType=function(){return a.getToolTipType(h)},n.getObjType=function(){return a.getObjType(h)},n.getRowHeightWithGrid=function(){return a.getRowHeight(h)},n.getRowHeightWithoutGrid=function(){var b=a.getGridType(h),c=a.getRowHeight(h);return b==="both"||b==="horizontal"?c-1:c},n.getRowHeightForRowSpanGreaterThanOne=function(b){var c=a.getGridType(h),d=n.getRowHeightWithoutGrid(h);return c==="both"||c==="horizontal"?d+b:d},n.getNeedAdditionalColumn=function(){var a=n.getObjType();return n.getNumCols()>0},n.getVerticalAdjustment=function(){var b,c=0,e=0,f=a.getPattern(h),g=f&&f.ImageReference,i=a.getBorder(h);return b=d.getBorderWidth(i.type),i.top?c+=b.topLeft:e+=1,i.bottom?c+=b.bottomRight:e+=1,e>0&&!g&&(c+=e),c},n.getHorizontalAdjustment=function(){var b,c=0,e=a.getPattern(h),f=e&&e.ImageReference,g=a.getBorder(h);return b=d.getBorderWidth(g.type),g.left?c+=b.topLeft:f||(c+=1),g.right?c+=b.bottomRight:f||(c+=1),c},n.getWidthWithoutBorder=function(){var a=n.getWidth();return Math.max(1,a-n.getHorizontalAdjustment())},n.getHeightWithoutBorder=function(){var a=n.getHeight();return Math.max(1,a-n.getVerticalAdjustment())},n.isVScrollBarAllowed=function(){var b=a.getVScrollBarAllowed(h);return b},n.isHScrollBarAllowed=function(){var b=a.getHScrollBarAllowed(h);return b},n.hasOwnVerticalScrollBar=function(){var a=n.getHeightWithoutBorder(),b=n.getWidthWithoutBorder(),c=n.getAccumulatedColumnWidth(),d=n.getNumRows()*n.getRowHeightWithGrid(),f=n.isVScrollBarAllowed(),g=n.isHScrollBarAllowed();return f?a>=d-j&&b>=c-j?!1:a<d-j?!0:g?a<d-j+e.scrollbarWidth:!1:!1},n.hasOwnHorizontalScrollBar=function(){var a=n.getHeightWithoutBorder(),b=n.getWidthWithoutBorder(),c=n.getAccumulatedColumnWidth(),d=n.getNumRows()*n.getRowHeightWithGrid(),f=n.isVScrollBarAllowed(),g=n.isHScrollBarAllowed();return g?b>=c-j&&a>=d-j?!1:b<c-j?!0:f?b<c-j+e.scrollbarWidth:!1:!1},n.getHoriScrollState=function(){var a=n.getWidthWithoutBorder(),b=n.getAccumulatedColumnWidth(),c=n.isHScrollBarAllowed(),d=a<=b&&b<=a+j,g=a<b+e.scrollbarWidth&&b+e.scrollbarWidth<=a+j;return c?n.getNumCols()<=1||d&&!n.hasOwnVerticalScrollBar()||n.hasOwnVerticalScrollBar()&&g?f.EPrevented:f.EShowIfNeeded:f.EHidden},n.getVertScrollState=function(){var a=n.getHeightWithoutBorder(),b=n.getNumRows()*n.getRowHeightWithGrid(),c=n.isVScrollBarAllowed(),d=a<=b&&b<=a+j,g=a<b+e.scrollbarWidth&&b+e.scrollbarWidth<=a+j;return c?n.getNumRows()<=1||d&&!n.hasOwnHorizontalScrollBar()||n.hasOwnHorizontalScrollBar()&&g?f.EPrevented:f.EShowIfNeeded:f.EHidden},n.dependsOnAnotherObjectThatHasVerticalScrollBar=function(){var b=a.getScrollBarObjHori(h),c,d=!1,e;return typeof b=="object"&&b.length>0?(e=a.getPropertyProvider(b)||i.createInstance(b),u(b)&&e.hasOwnVerticalScrollBar()?d=!0:(c=a.getScrollRefs(b),d=k(c,h)),d):(c=a.getScrollRefs(h),d=k(c,h),d)},n.dependsOnAnotherObjectThatHasHorizontalScrollBar=function(){var b=a.getScrollBarObjVert(h),c,d=!1,e;return typeof b=="object"&&b.length>0?(e=a.getPropertyProvider(b)||i.createInstance(b),u(b)&&e.hasOwnHorizontalScrollBar()?d=!0:(c=a.getScrollRefs(b),d=l(c,h))):(c=a.getScrollRefs(h),d=l(c,h)),d},n.getClientAreaDimensions=function(){var a=n.getWidthWithoutBorder(),b=n.getHeightWithoutBorder();return n.hasOwnVerticalScrollBar()&&(a-=e.scrollbarWidth),n.hasOwnHorizontalScrollBar()&&(b-=e.scrollbarWidth),{width:a,height:b}},n.hasFocus=function(){var b=a.getDocSelectedObjectManager(m),c=b.getSelectedObject(),d=a.getDocName(h),e=a.getID(h),f=g.makeID(d,e);return c===f?!0:!1},n.needsToApplyColumnWidth=function(){return!0},n.getGridHoriOffset=function(){var b=a.getGridType(h);return b!=="both"&&b!=="vertical"?1:0},n.getGridVertOffset=function(){var b=a.getGridType(h);return b==="both"||b==="horizontal"?-1:0},n.getObjectCellFormat=function(){return{Border:a.getCellBorder(h),Margin:a.getCellMargin(h),Padding:a.getCellPadding(h)}},n}function n(a,b){var c=m(a,b);return c}function o(b,c){var g=m(b,c);return g.getRowHeightWithoutGrid=function(){var c=g.getHeightWithoutBorder(),d=1,f=a.getBorder(b);if(g.hasOwnHorizontalScrollBar()){if(f.type==="3D1"||f.type==="3D3")d=0;return Math.max(1,c-e.scrollbarWidth-d)}return c},g.getRowHeightWithGrid=function(){return g.getRowHeightWithoutGrid()},g.getVerticalAdjustment=function(){var c,e=0,f=a.getPattern(b),g=f&&f.ImageReference,h=a.getBorder(b);return c=d.getBorderWidth(h.type),h.top&&(e+=c.topLeft),h.bottom&&(e+=c.bottomRight),e},g.getHorizontalAdjustment=function(){var c,e=0,f=a.getBorder(b);return c=d.getBorderWidth(f.type),f.left&&(e+=c.topLeft),f.right&&(e+=c.bottomRight),e},g.hasOwnHorizontalScrollBar=function(){var a=g.getWidthWithoutBorder(),b=g.getAccumulatedColumnWidth(),c=g.isHScrollBarAllowed();return c?a>=b-j?!1:a<b-j?!0:!1:!1},g.hasOwnVerticalScrollBar=function(){return!1},g.isVScrollBarAllowed=function(){return!1},g.getVertScrollState=function(){return f.EPrevented},g.dependsOnAnotherObjectThatHasHorizontalScrollBar=function(){return!1},g.getGridVertOffset=function(){var c=a.getBorder(b),d;return!c.top&&!c.bottom?d=-1:d=0,d},g}function p(b,c){var d=m(b,c);return d.getNeedAdditionalColumn=function(){return!1},d.isHScrollBarAllowed=function(){return!1},d.hasOwnHorizontalScrollBar=function(){return!1},d.getHoriScrollState=function(){return f.EPrevented},d.hasOwnVerticalScrollBar=function(){var a=d.getHeightWithoutBorder(),b=d.getNumRows()*d.getRowHeightWithGrid(),c=d.isVScrollBarAllowed();return c?a>=b-j?!1:a<b-j?!0:!1:!1},d.getColumnWidth=function(){var c=1,f;if(d.hasOwnVerticalScrollBar()){f=a.getBorder(b);if(f.type==="3D1"||f.type==="3D3")c=0;return Math.max(1,d.getWidth()-e.scrollbarWidth-c)}return d.getWidthWithoutBorder()},d.getColumnWidthWithoutGrid=function(a){return d.getColumnWidth(a)},d.getAccumulatedColumnWidth=function(){return d.getColumnWidth()},d.dependsOnAnotherObjectThatHasVerticalScrollBar=function(){return!1},d.needsToApplyColumnWidth=function(){return!1},d.getGridVertOffset=function(){var c=a.getGridType(b);return c==="both"||c==="horizontal"?-1:0},d.getGridHoriOffset=function(){var c=a.getGridType(b);return c==="both"||c==="vertical"?-1:0},d}function q(b,c){var e=m(b,c);return e.getNeedAdditionalColumn=function(){return!1},e.getVerticalAdjustment=function(){var c,e=0,f=a.getBorder(b);return c=d.getBorderWidth(f.type),f.top&&(e+=c.topLeft),f.bottom&&(e+=c.bottomRight),e},e.getHorizontalAdjustment=function(){var c,e=0,f=a.getBorder(b);return c=d.getBorderWidth(f.type),f.left&&(e+=c.topLeft),f.right&&(e+=c.bottomRight),e},e.isHScrollBarAllowed=function(){return!1},e.isVScrollBarAllowed=function(){return!1},e.hasOwnHorizontalScrollBar=function(){return!1},e.hasOwnVerticalScrollBar=function(){return!1},e.getHoriScrollState=function(){return f.EPrevented},e.getVertScrollState=function(){return f.EPrevented},e.getColumnWidth=function(){return e.getWidth()-2},e.getColumnWidthWithoutGrid=function(a){return e.getColumnWidth(a)},e.getRowHeightWithGrid=function(){return h.getAdjustedRowHeightForField(b)},e.getRowHeightWithoutGrid=function(){return e.getHeight()-2},e.getAccumulatedColumnWidth=function(){return e.getWidth()-2},e.needsToApplyColumnWidth=function(){return!0},e.getColumnWidthWithoutGridByColAndColSpan=function(a,b){return e.getWidthWithoutBorder()},e.getGridVertOffset=function(){var c=a.getBorder(b),d;return!c.top&&!c.bottom?d=-1:d=0,d},e.getGridHoriOffset=function(){var c=a.getBorder(b),d;return!c.left&&!c.right?d=-1:d=0,d},e}function r(b,c){var d=m(b,c);return d.hasOwnHorizontalScrollBar=function(){return a.getHScrollBarAllowed(b)&&d.getAccumulatedColumnWidth()>a.getWidth(b)?!0:!1},d.hasOwnVerticalScrollBar=function(){return!1},d}function s(b,c){var d=m(b,c);return d.hasOwnVerticalScrollBar=function(){var c=d.getHeightWithoutBorder(),f=d.getWidthWithoutBorder(),g=a.getContentWidth(b),h=d.getNumRows()*d.getRowHeightWithGrid(),i=d.isVScrollBarAllowed(),k=d.isHScrollBarAllowed();return i?c>=h-j&&f>=g-j?!1:c<h-j?!0:k?c<h-j+e.scrollbarWidth:!1:!1},d.hasOwnHorizontalScrollBar=function(){var c=d.getHeightWithoutBorder(),f=d.getWidthWithoutBorder(),g=a.getContentWidth(b),h=d.getNumRows()*d.getRowHeightWithGrid(),i=d.isVScrollBarAllowed(),k=d.isHScrollBarAllowed();return k?f>=g-j&&c>=h-j?!1:f<g-j?!0:i?f<g-j+e.scrollbarWidth:!1:!1},d}function t(b,c){var d=m(b,c),e=a.getScrollElemWidth(b);return d.hasOwnHorizontalScrollBar=function(){return!1},d.hasOwnVerticalScrollBar=function(){return!1},d}function u(b){switch(a.getObjType(b)){case"Table":case"Row":case"Column":case"Field":case"CheckboxGroup":case"HorizontalHierarchie":case"VerticalHierarchie":case"SVGContainer":return!0;default:return!1}}var i={},j=2;return i.createInstance=function(b){var c=g.makeID(a.getDocName(b),0),d=$("#"+c),e;switch(a.getObjType(b)){case"Table":e=n(b,d);break;case"Row":e=o(b,d);break;case"Column":e=p(b,d);break;case"Field":e=q(b,d);break;case"CheckboxGroup":e=n(b,d);break;case"HorizontalHierarchie":e=r(b,d);break;case"VerticalHierarchie":e=s(b,d);break;case"SVGContainer":e=t(b,d)}return a.setPropertyProvider(b,e),e},i}),define("objectresizer",["jquery","browserfeatures","logger","properties","styleborderprops","textinput","layoutmanagement/chartresizerfactory","datavirtualization/propertyproviderfactory"],function(a,b,c,d,e,f,g,h){function n(){return typeof j=="undefined"&&(j=require("objectpropertyapplier")),j}function o(){return typeof l=="undefined"&&(l=require("scroll")),l}function p(a,b){var c=d.getObjType(a);if(d.isUseContentPaging(a)){if(c==="VerticalHierarchie")return d.getContentWidth(a);switch(c){case"Row":case"Table":return Math.max(d.getWidth(a),d.getColumnWidth(a).accumulatedColumnWidth);case"Field":case"Column":return d.getWidth(a)}}return b.children().width()}function q(a,b){var c=d.getObjType(a);if(d.isUseContentPaging(a)){if(c==="VerticalHierarchie")return d.getNumRows(a)*d.getRowHeight(a);switch(c){case"Column":case"Table":return Math.max(d.getHeight(a),d.getNumRows(a)*d.getRowHeight(a));case"Field":case"Row":return d.getHeight(a)}}return b.children().height()}function r(a){var b=d.getObjType(a)==="VerticalHierarchie"&&d.getDisplayStyle(a)==="BOX_STYLE";return b}function s(a){var b=d.getObjType(a);return!d.getHScrollBarAllowed(a)&&b!=="Column"&&b!=="Field"&&b!=="VerticalHierarchie"}function t(a){var b=i.getScrollableElement(a);b&&b[0]&&(d.setScrollElemWidth(b,null),d.setScrollElemHeight(b,null),i.adjustScrollDependentContentSize(a))}function u(b,c,d,e,f){var g=a("img",b),h,i,j;g.length>0&&(g.hasClass("arcImgScaleAllways")?g.css(e):f==="dynaCell"&&(h=g.attr("data-origSize"),typeof h=="string"&&(i=parseFloat(h.split(",")[0]),j=parseFloat(h.split(",")[1]),j>d&&i>c?g.css(e):(j>=d&&g.height(d),i>=c&&g.width(c),j<d&&g.height(j),i<c&&g.width(i)))))}function v(a){var b=d.getDropDownSymbolWidth(a);return b||(b=16),b}function w(b,c,e,f,g,h){var i=d.getContent(b),j=a("div[contenteditable]",b);typeof i=="object"||d.isFormattedTextInput(b)&&j.length>0?(c.css(f),j.parent().css({"min-height":f.height}),j.css({height:f.height,"padding-left":h+"px",overflow:"auto"})):(a("img",b).length>0?a("div",b).css(g):a("div",b).css(f),a("textarea",b).css(f)),a("div:first",b).css(e)}function x(b,c,d,e,f,g,h){var i=g===0?1:0,j=h===0?1:0;a("div",b).filter(":first").css(d),c.css({width:e+"px",height:f+"px"}),a("table",b).parent().parent().css({width:e+i+"px",height:f+j+"px"})}function y(b,c,e,f,g,h,i){var j=d.getWrapMode(b),l=j&&j.Value==="SingleLine"?g:parseInt(d.getFont(b).lineHeight,10),m=2,n={width:Math.max(f-(v(b,h)+m),0)+"px",height:g+"px"},o=a("div:first",b),p=a(".arcHierPopupSelectionOverflowContainer",o),q=a(".arcHierPopupContent",o);o.css({left:c,top:e,lineHeight:l+"px","max-height":g+"px","min-height":g+"px",width:f+"px",height:g+"px"}).children("div:first").css(i),p.css(n),q.css("min-width",Math.max(f,k)+"px"),a("select",b).css(i)}function z(b,e,f,h,i){var j=d.getChartResizer(b),k,l;a("div",b).css(h).first().css(i),a("embed",b).css(h);if(d.isVisible(b)&&d.isAvailableInView(b)){if(!j){try{k=a("embed",b)[0].getSVGDocument(),l=a(k).find("svg")}catch(m){c.debug("Could not access svg document yet. The exception is only thrown in IE")}if(typeof k!="undefined"&&typeof l!="undefined"&&l.length>0)try{j=g(l),d.setChartResizer(b,j)}catch(n){c.debug("Could not create chartresizer yet. The exception is only thrown in IE. e: "+n.message)}}typeof j=="object"&&(j.updateHeight(d.getHeight(b)),j.updateWidth(d.getWidth(b)))}}function A(c,e,f){var g,j,k,l,m=h.createInstance(c);l=d.getContentWidth(c),l&&(g=i.getVertHierHoriLineHeight(c),j=d.getWidth(c)-f+g,m.hasOwnVerticalScrollBar()&&(j-=b.scrollbarWidth),k=Math.max(j,l),a(e[1]).children(":first").css("width",k+"px"))}function B(c,e,g,h,j,k){var l=d.getBorder(c),m=i.getHorizontalAdjustment(l,c),o=i.getVerticalAdjustment(l,c),p,q,s,t,v,B,C,D={left:j,top:k},E=g,F=!0,G;F=d.hasXPosChanged(c)||d.hasYPosChanged(c)||d.hasWidthChanged(c)||d.hasHeightChanged(c)||typeof d.getContentWidth(c)!="undefined"&&d.hasContentWidthChanged(c);if(F){t={width:g+"px",height:h+"px"},g=g-m<0?g:g-m,h=h-o<0?h:h-o,s={width:g+"px",height:h+"px"},p=a("div:first",c),p=a.merge(p,p.children(":first")),c.hasClass("arcTextInputActive")&&(q=a("#arcTextInput"),q.length===1&&f.recalcInputPosition(c));switch(e){case"dynaTable":case"dynaRadio":p.css(s),a("div",c).filter(":first").css(D);break;case"dynaCheckbox":x(c,p,D,g,h,m,o);break;case"dynaText":w(c,p,D,s,t,o);break;case"dynaColumn":p.css(s),G=a("table:first",c),G.width(g+"px"),G.parent().width(g+"px"),a("div:first",c).css(D);break;case"dynaRow":p.css(s),n().applyTableRowHeight(c,"Row"),v=d.getWidth(c),B=d.getColumnWidth(c),d.getHScrollBarAllowed(c)&&B.accumulatedColumnWidth>v&&(h-=b.scrollbarWidth),G=a("table:first",c),G.height(h+"px"),G.parent().height(h+"px"),a("div:first",c).css(D);break;case"dynaCell":C=d.getDatavirtualization(c),C||u(c,g,h,s,e),p.css(s),a("tr,td",c).css(s),n().applyTableRowHeight(c,"Field"),a("div:first",c).css(D);break;case"dynaMenu":case"dynaHierMenu":y(c,j,k,g,h,l,s);break;case"dynaChart":z(c,g,h,s,D);break;case"dynaImage":a("div",c).css(s).first().css(D),d.getHasFrame(c)&&l&&(l.left||(g-=1),l.right||(g-=1),l.top||(h-=1),l.bottom||(h-=1),s={width:g+"px",height:h+"px"}),a("img",c).css(s);break;case"dynaVertHier":case"dynaHoriHier":a(p[0]).css(s).css(D),r(c)&&(s.height=h+1+"px"),e==="dynaVertHier"&&A(c,p,m),a(p[1]).css(s)}n().applyScrollBarAllowed(c),d.setXPosChanged(c,!1),d.setYPosChanged(c,!1),d.setWidthChanged(c,!1),d.setHeightChanged(c,!1),d.setContentWidthChanged(c,!1)}return F}function C(a){var b=["dynaColumn","dynaRow","dynaTable","dynaCell","dynaMenu","dynaChart","dynaVertHier","dynaHoriHier","dynaHierMenu","dynaRadio","dynaCheckbox","dynaText","dynaImage"],c;for(c in b)if(a.hasClass(b[c]))return b[c];return"unknown"}var i={},j,k=165,l,m=2;return i.getHorizontalAdjustment=function(a,b){var c,f=0,g=d.getObjType(b),h=a?a.type:null,i=d.getPattern(b),j=i&&i.ImageReference;return h&&(c=e.getBorderWidth(h),a.left?f+=c.topLeft:(g==="Table"||g==="Column")&&!j&&(f+=1),a.right?f+=c.bottomRight:(g==="Table"||g==="Column")&&!j&&(f+=1)),f},i.getVerticalAdjustment=function(a,b){var c,f=0,g=0,h=d.getObjType(b),i=a?a.type:null,j=d.getPattern(b),k=j&&j.ImageReference;if(i){c=e.getBorderWidth(i),a.top?f+=c.topLeft:g+=1,a.bottom?f+=c.bottomRight:g+=1;if(g>0&&!k)switch(h){case"Table":case"Column":case"CheckboxGroup":f+=g;break;case"VerticalHierarchie":f+=a.bottom?c.bottomRight:1,d.getDisplayStyle(b)!=="BOX_STYLE"&&(f+=a.top?0:1)}}return f},i.isScrollableObject=function(a){switch(a){case"Column":case"Row":case"Table":case"CheckboxGroup":case"VerticalHierarchie":case"HorizontalHierarchie":case"MenuHierarchie":return!0}return!1},i.getScrollableElement=function(a){var b,c=d.getObjType(a);return i.isScrollableObject(c)&&(b=a.children("div"),b&&(c==="MenuHierarchie"?b=b.children(".arcHierPopupContent").children("div").first():b=b.children("div"))),b},i.adjustScrollDependentContentSize=function(a){var c=i.getScrollableElement(a),e,f,g,h,j=!1,k=d.getBorder(a),l=i.getHorizontalAdjustment(k,a),n=i.getVerticalAdjustment(k,a),r=l===0?1:0,t=n===0?1:0,u=d.getObjType(a),v=o(),w;c&&c[0]&&(d.setScrollElem(a,c),u!=="MenuHierarchie"&&(f=d.getWidth(a),j=c.is(".arcHideYScrollbar"),e=p(a,c),e>f&&d.setScrollWidth(a,e),e=d.getScrollElemWidth(c),!e&&j&&(e=f,w=d.getContentHeight(a),typeof w=="undefined"&&(w=d.getNumRows(a)*d.getRowHeight(a)),w>d.getHeight(a)+m&&(e+=b.scrollbarWidth),c.css("width",e+r+"px"),d.setScrollElemWidth(c,e)),h=d.getHeight(a),g=q(a,c),g>h?d.setScrollHeight(a,g):d.setScrollHeight(a,undefined),g=d.getScrollElemHeight(c),g||(g=h-n,s(a)&&(g+=b.scrollbarWidth,c.css("overflow-x","scroll")),c.css("height",g+t+"px"),d.setScrollElemHeight(c,g)),(d.getScrollHeight(a)||d.getScrollWidth(a))&&v.updateScrollReferences(a)))},i.getVertHierHoriLineHeight=function(a){var b=d.getGridType(a),c=d.getDisplayStyle(a),e=c==="BOX_STYLE"&&b==="both"?"arcLine":"";return e==="arcLine"?1:0},i.applyObjectDimensionsWithoutScrollDepConUpdate=function(a){var b,c,e,f,g;if(a){b=parseInt(d.getXPos(a),10),c=parseInt(d.getYPos(a),10),e=d.getWidth(a),f=d.getHeight(a);if(a.children&&a.children(0))return g=C(a.children(0)),B(a,g,e,f,b,c)}return!1},i.applyObjectDimensions=function(a){var b=i.applyObjectDimensionsWithoutScrollDepConUpdate(a);b&&a&&a.children&&a.children(0)&&t(a)},i}),define("filterpanelpositioner-preserve-label-positions",["properties","objectresizer"],function(a,b){function i(b){function c(a){if(typeof a=="number")return a;if(typeof a=="string")return parseInt(a,10);throw"filterpanelpositioner - Property type '"+typeof a+"' not supported"}this.x=c(a.getXPos(b)),this.y=c(a.getYPos(b)),this.width=c(a.getWidth(b)),this.height=c(a.getHeight(b))}function j(a,b,c){this.filterObject=a,this.labelObject=b,this.xPosInDoc=c,this.yPosInDoc=c,this.labelXPosInDoc=c,this.labelYPosInDoc=c,this.boundingBoxInDoc=c,this.xPosInFilterPanel=c,this.yPosInFilterPanel=c,this.labelXPosInFilterPanel=c,this.labelYPosInFilterPanel=c}function k(a,b){var c,d,e,f;return c=Math.min(a.x,b.x),d=Math.max(a.x+a.width,b.x+b.width),e=Math.min(a.y,b.y),f=Math.max(a.y+a.height,b.y+b.height),{x:c,y:e,width:d-c,height:f-e}}function l(){var a,b,c,e,f;for(a=0;a<d.length;a+=1)b=d[a].filterObject,c=d[a].labelObject,e=new i(b),c===undefined?d[a].boundingBoxInDoc=e:(f=new i(c),d[a].boundingBoxInDoc=k(e,f))}function m(){d.sort(function(b,c){return b.boundingBoxInDoc.y<c.boundingBoxInDoc.y?-1:b.boundingBoxInDoc.y>c.boundingBoxInDoc.y?1:b.boundingBoxInDoc.x<c.boundingBoxInDoc.x?-1:b.boundingBoxInDoc.x>c.boundingBoxInDoc.x?1:0})}function n(){var a,b,c,j,k,l,m,n=f;e=0;for(a=0;a<d.length;a+=1)b=d[a].filterObject,c=d[a].labelObject,j=new i(b),d[a].xPosInDoc=j.x,d[a].yPosInDoc=j.y,c===undefined?(d[a].xPosInFilterPanel=f,d[a].yPosInFilterPanel=n,n+=j.height+f):(k=new i(c),d[a].labelXPosInDoc=k.x,d[a].labelYPosInDoc=k.y,l=f-d[a].boundingBoxInDoc.x,m=n-d[a].boundingBoxInDoc.y,d[a].xPosInFilterPanel=j.x+l,d[a].yPosInFilterPanel=j.y+m,d[a].labelXPosInFilterPanel=k.x+l,d[a].labelYPosInFilterPanel=k.y+m,n+=d[a].boundingBoxInDoc.height+f),e=Math.max(e,d[a].boundingBoxInDoc.width);g=n,e>0&&(e+=f+f,h>0&&(e+=h+f))}function o(a){l(),m(),n()}function p(a){var b,c;for(b=0;b<d.length;b+=1){if(a[0]===d[b].filterObject[0])return{x:d[b].xPosInFilterPanel,y:d[b].yPosInFilterPanel};c=d[b].labelObject;if(typeof c=="object"&&a[0]===d[b].labelObject[0])return{x:d[b].labelXPosInFilterPanel,y:d[b].labelYPosInFilterPanel}}}var c={},d,e,f=10,g=0,h=0;return c.clear=function(){d=[],e=0,g=0},c.addToolbar=function(a){h=a},c.addFilterObject=function(a){d.push(new j(a)),e=-1},c.addLabelledFilterObject=function(a,b){d.push(new j(a,b)),e=-1},c.panelWidth=function(){return e<0&&o(),e},c.getBoundsForSharedWidgetInfoElement=function(a){var b=-1,c=5;return g-c<a&&(b=e-h-f*3),{x:f,y:g,width:b}},c.moveObjectsIntoFilterPanel=function(c){var f,g,h;e<0&&o();for(f=0;f<d.length;f+=1)g=d[f].filterObject,h=d[f].labelObject,g.appendTo("#arcFilterPanel"),a.setXPos(g,d[f].xPosInFilterPanel),a.setYPos(g,d[f].yPosInFilterPanel),b.applyObjectDimensions(g),h!==c&&(h.appendTo("#arcFilterPanel"),a.setXPos(h,d[f].labelXPosInFilterPanel),a.setYPos(h,d[f].labelYPosInFilterPanel),b.applyObjectDimensions(h))},c.moveObjectsBackIntoDocument=function(c){var e,f,g;for(e=0;e<d.length;e+=1)f=d[e].filterObject,g=d[e].labelObject,a.setXPos(f,d[e].xPosInDoc),a.setYPos(f,d[e].yPosInDoc),f.appendTo(c),b.applyObjectDimensions(f),typeof g=="object"&&(a.setXPos(g,d[e].labelXPosInDoc),a.setYPos(g,d[e].labelYPosInDoc),g.appendTo(c),b.applyObjectDimensions(g))},c.updateAfterLoadingObject=function(c){var d=p(c);typeof d=="object"&&(a.setXPos(c,d.x),a.setYPos(c,d.y),b.applyObjectDimensions(c))},c}),define("datavirtualization/menuhtmlgenerator",["properties","assert/assert","propertytools","logger","tools","objectresizer","dmfieldtypes","menuseparatortypes","styleborderprops","patternapplier","browserfeatures","htmltemplates","stringtools"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function p(a,c,d,e){var f=parseInt(a.r,10);return k.nativeTouchControls||e?a.Type===g.VEmpty?"<option disabled></option>":'<option value="'+f+'" '+(c===f?"selected>":">")+m.escapeTextForHtml(a.value)+"</option>":d.type!==h.NoSeparator&&d.position===f?(b(typeof d!="undefined"),'<li class="arcMenuItem arcMenuSeparator"><div class="arcMenuSelectionDiv"><span></span></div><div class="arcMenuSeparator '+(d.type===h.LineSeparator?"arcMenuLineSeparator":"")+'">'+"</div></li>"):d.type===h.NoSeparator&&a.value===""?(b(typeof d!="undefined"),'<li class="arcMenuItem" value="'+f+'" >'+'<div class="arcMenuSelectionDiv">'+(c===f?'<input type="checkbox" checked="checked">':"<span></span>")+'</div><div class="arcMenuItemText">NULL</div></li>'):'<li class="arcMenuItem" value="'+f+'" >'+'<div class="arcMenuSelectionDiv">'+(c===f?'<input type="checkbox" checked="checked">':"<span></span>")+'</div><div class="arcMenuItemText">'+m.escapeTextForHtml(a.value)+"</div></li>"}function q(b){var c=a.getTabOrder(b);return c>0?'tabindex="'+c+'"':c<0?'tabindex="-1"':""}function r(b){var c;return a.getObjType(b)==="MenuHierarchie"?c=l.getHtmlTemplate("hierMenu"):k.nativeTouchControls?c=l.getHtmlTemplate("flatMenuNative"):a.isUseNativeMenu(b)?c=l.getHtmlTemplate("flatMenuNativeDesktop"):c=l.getHtmlTemplate("flatMenu"),c=c.replace(/\{tabIndex\}/g,q(b)),c}function s(a,b){var c=a.Rows.Elements.length,d,e;for(d=0;d<c;d+=1){e=parseInt(a.Rows.Elements[d].Row.Elements[0].Cell.r,10);if(e===b)return a.Rows.Elements[d].Row.Elements[0].Cell.value}return""}function t(a,b){var c=b.Selection;return c}function u(b,c){var d=a.getYSettingValue(b),e=s(c,d);return e}var n={},o={type:h.NoSeparator};return n.setCurrentSelection=function(b,c){if(typeof b!="object")return;var d,e=a.getWrapMode(b);a.getObjType(b)==="Menu"?d=u(b,c,e):d=t(b,c,e),d=m.escapeTextForHtml(d);if(!e||e.Value!=="SingleLine")d=d.replace(/\r\n/g,"<br />");$(".arcHierPopupSelection",b).html(d),e&&e.Value==="SingleLine"&&$(".arcHierPopupSelection",b).css("white-space","pre")},n.clearCurrentSelection=function(a){$(".arcHierPopupSelection",a).html("")},n.generateMenuStub=function(b,d){if(typeof b!="object")return;var g=r(b),h=$(g),i=a.getZIndex(b),k={left:"0px",top:"0px",position:"relative"},l=a.getForegroundColor(b),m=a.getBackgroundColor(b),n=a.getBackgroundColor2(b)||{},o=a.getForegroundColor2(b)||{},p={color:l?l:"transparent",backgroundColor:m},q={overflow:"visible","z-index":i},s=a.getFont(b),t=a.getPopupFont(b)||{},u={},v={color:o,backgroundColor:n},w={};e.mergeObjects(q,p,k,s),h.css(q),c.setVerticalAlignment(b,u),c.setHorizontalAlignment(b,u),u.textDecoration=s.textDecoration,a.getSelectType(b)==="HierMultiSelect"&&($(".arcHierPopup",h).addClass("arcHierPopupMultisel"),$(".arcHierPopupDlg",h).css({visibility:"visible","background-color":n})),$(".arcHierPopupSelection",h).css(u),e.mergeObjects(w,t,v),$(".arcHierPopupContent",h).css(w),a.isOneDimHasSumKnotLast(b)&&$(".arcHier",h).addClass("arcSumKnotLast"),b[0].innerHTML=h[0].outerHTML,j.loadPattern(b,b.children(),d),j.applyDropdownSymbol(b,d),f.applyObjectDimensionsWithoutScrollDepConUpdate(b),a.isUseNativeMenu(b)&&$("select",b).css("background-color",m)},n.buildHtmlForRows=function(b,c,d){if(typeof b!="object")return;var f=a.getYSettingValue(b),g=a.getMenuSeparator(b),h=a.isUseNativeMenu(b);c&&c.Rows&&typeof d=="object"&&e.iterateArcplanArray(c.Rows,function(a,b){var c;c=p(b.Elements[0].Cell,f,g,h),d[parseInt(b.Elements[0].Cell.r,10)-1]=c})},n.buildHtmlForRowsWithFilter=function(b,c,d,f){if(typeof b!="object")return;var g=a.getYSettingValue(b),h=a.getMenuSeparator(b),i=a.isUseNativeMenu(b),j=0;c&&c.Rows&&typeof d=="object"&&e.iterateArcplanArray(c.Rows,function(a,b){d[f+j]=p(b.Elements[0].Cell,g,h,i),j+=1})},n.buildHtmlForStringsArray=function(a,b){var c="";return a&&a.Elements&&e.iterateArcplanArray(a,function(a,d){var e,f={},g=-1;f.r=a,f.value=d,e=p(f,g,o,b),c+=e}),c},n}),define("datavirtualization/hierarchyhtmlgenerator",["properties","propertytools","logger","tools","objectresizer","styleborderprops","patternapplier","browserfeatures","stringtools"],function(a,b,c,d,e,f,g,h,i){function k(a,b){var c,d;return a.nextDim&&b.canApplyDimensionWidth?(d=b.showRootNode?a.level:a.level-1,c=b.dimensionWidth-j.c_textPadding-d*j.c_openCloseSymbolWidth,c<0&&(c=0)," class='arcTextOverflowEllipsis' style='width:"+c+"px'"):""}function l(c,d,e,f){var g="",h=a.getRowHeight(f),l=k(c,d);return e&&(g="<div class='arcLabelContainer ",g+=c.nextDim&&b.getHierFormatByDim(f,c.nextDim.dim).isSumKnotLast?" arcTableCellBottom'>":" arcTableCellTop'>"),g+="<div draggable='true'",c.nextDim&&(g+=" style='display:inline'"),c.isOpen&&(g+=" class='arcHierNodeOpen'"),g+=">",g+="<input type='checkbox' id='",g+=c.id,g+="' style='margin-top:"+Math.floor((h-j.c_openCloseSymbolWidth)/2)+"px;'",g+=c.isOpen?"checked>":">",g+="<label draggable='false' for='"+c.id+"'"+l+">",g+="<span class='SPAN_"+c.dim+"_"+c.level+"'></span>",g+=i.escapeTextForHtml(c.Value),g+="</label>",g+="</div>",e&&(g+="</div>"),g}function m(c,d,e,f){var g="",h=k(c,d),j=e&&a.getDimensionNumber(f)>1;return j&&(g="<div class='arcLabelContainer ",g+=c.nextDim&&b.getHierFormatByDim(f,c.nextDim.dim).isSumKnotLast?" arcTableCellBottom'>":" arcTableCellTop'>"),g+="<div draggable='true'"+(c.nextDim?" style='display:inline'":""),c.isOpen&&(g+=" class='arcHierNodeOpen'"),g+=">",g+="<a draggable='false' id='",g+=c.id,g+="' "+h+">",g+="<span class='SPAN_"+c.dim+"_"+c.level+"'></span>",g+=i.escapeTextForHtml(c.Value),g+="</a>",g+="</div>",j&&(g+="</div>"),g}function n(a){var b,d=a.hasChildrenSelected&&!a.isOpen,e=d?" arcHiddenSubtreeSelected":"";return d===!0&&c.log("hasHiddenChildrenSelected für Node= "+a.Value),b="<label class='arcSelectable'>",b+="<input type='checkbox' id='"+a.id+"_X"+"' class='arcHpCbox"+e+"'",b+=a.isSelected||d?' checked="checked">':" >",b+="<span class='arcMenuCheckbox'></span>",b+="</label>",b}function o(c,d,e,f,g,h){var i=!1,j=f.length,k=!1,r=g?a.isAllowOpenClose(g):!1,s=g?a.getObjType(g)==="MenuHierarchie":!1,t=g?a.getSelectType(g)!=="HierNoSelect":!0,u,v,w,x=!1,y=!1,z=!1,A=!1,B=b.getHierFormatByDim(g,c.dim),C=B.isSumKnotLast,D=a.isOneDimHasSumKnotLast(g)&&a.getDimensionNumber(g)>1;typeof h!="object"&&(h={value:!1});if(c.row>d)if(!C||!(c.children.length>0||c.nextDim))return e;if(j>0){if(c!==f[j-1])return e;f.pop(),f.length===0&&(k=!0)}return e||(e=""),c.parent||(i=!0),i&&(s&&(e+='<div class="arcMenuSelectionDiv"></div>'),e+="<ol",c.isFirstLevelOfDimension&&!c.parent.host?e+=" style='margin-left: 1px;margin-right: -1px;'":D&&c.dim>1&&(e+=" style='display:table-cell'"),B.canApplyDimensionWidth&&(e+=" class='arcDimensionWidth'"),e+=">"),typeof c.Value=="string"&&c.id?(e+="<li",e+=" id='"+c.id+"_LI'",v=p(g,c,C,h,s),e+=v?" style='"+v+"'":"",u=c.isSelected&&!s&&t?"arcHier-selected ":"",u+=k?"firstVisible":"",u+=u?" ":"",u+="LI_"+c.dim+"_"+c.level,e+=u?" class='"+u+"' >":">",s&&(C&&c.hasInput&&r?z=!0:e+=n(c)),c.hasInput&&r?C?x=!0:e+=l(c,B,D,g):C?y=!0:e+=m(c,B,D,g),c.nextDim&&(C?A=!0:e=o(c.nextDim,d,e,f,g)),c.children.length>0&&(e+="<ul>",e=q(c,d,e,f,g),e+="</ul>"),y&&(e+=m(c,B,D,g)),z&&(e+=n(c)),x&&(e+=l(c,B,D,g)),A&&(e=o(c.nextDim,d,e,f,g)),e+="</li>"):i&&(e=q(c,d,e,f,g)),i&&(e+="</ol>"),h.value=!1,e}function p(b,c,d,e,f){var g=a.getForegroundColors(b),h,i="";return c.isFirstLevelOfDimension&&(c.parent.host&&e.value?i="border-top-width:0px;border-left-width:1px;":d&&a.getDisplayStyle(b)==="BOX_STYLE"?i="border-left-width:1px;":i="border-top-width:1px;border-left-width:1px;"),g&&g.Elements.length>0?i:(f?h=a.getForegroundColor2(b):h=a.getForegroundColor(b),h?i+"color:"+h+";":i)}function q(a,b,c,d,e){if(typeof a.children=="object"){var f,g=a.children.length,h={value:!0};for(f=0;f<g;f+=1)c=o(a.children[f],b,c,d,e,h)}return c}var j={};return j.c_textPadding=4,j.c_openCloseSymbolWidth=13,j.writeToHtmlStartingHere=function(a,b,c,d,e){return d||(d=[]),a&&typeof a=="object"&&typeof a.row=="number"&&(d.push(a),a.parent?c=this.writeToHtmlStartingHere(a.parent,b,c,d,e):a.host?c=this.writeToHtmlStartingHere(a.host,b,c,d,e):c=o(a,b,c,d,e)),c},j.generateHierarchyStub=function(b,c){var h=$("<div></div>"),i=$("<div></div>"),j=$("<div></div>"),k=$("<div></div>"),l=$("<ol></ol>"),m=a.getZIndex(b),n={left:"0px",top:"0px",position:"relative"},o=a.getForegroundColor(b),p=a.getBackgroundColor(b),q={color:o,backgroundColor:p},r={},s={},t=a.getFont(b),u=f.getBorderStyleObject(b),v=a.getObjType(b),w=v==="HorizontalHierarchie"?"dynaHoriHier":"dynaVertHier",x=a.getDisplayStyle(b),y=x==="BOX_STYLE"?"arcBox":"arcTree",z=v==="HorizontalHierarchie"?"arcHori":"arcVert",A=a.isOrganigram(b)?"arcBeside":"",B=a.isAllowOpenClose(b)===!1?"arcVertNoExp":"",C=a.getGridType(b),D=x==="BOX_STYLE"&&C==="both"?"arcLine":"",E=e.getHorizontalAdjustment(a.getBorder(b),b),F=a.isOneDimHasSumKnotLast(b)?"arcSumKnotLast":"";return k.append(l),j.append(k),i.append(j),h.append(i),i.css(n),d.mergeObjects(s,n,{overflow:"hidden"}),j.css(s),h.addClass("arcDraggable "+w),u||(u={}),d.mergeObjects(r,n,t,u,q,{zIndex:m}),h.css(r),i.css(n),k.addClass("arcHier  "+z+" "+y+" "+A+" "+B+" "+D+" "+F),b[0].innerHTML=h[0].outerHTML,g.loadPattern(b,b.children(),c),e.applyObjectDimensionsWithoutScrollDepConUpdate(b),null},j}),define("datavirtualization/hiernode",["tools"],function(a){function c(a){var b=a.children.length,d;for(d=0;d<b;d+=1)a.children[d].isSelected=!1,c(a.children[d])}function d(a,b){var c=0,d=a.length;for(c=0;c<d;c+=1)if(a[c].row>b)break;return c}function e(a,b){var c=b.row,e=d(a,c);a.splice(e,0,b)}function f(a,b){var c=0,d=a.length;for(c=0;c<d;c+=1)if(a[c].id===b)break;return c>=d?!1:c}function g(a,c,d){var g,h,i,j;if(!d)return c;if(!c)return d;g=c.length,h=d.length;for(i=0;i<h;i+=1)j=f(c,d[i].id),j!==!1?b.mergeNodes(c[j],d[i]):(d[i].parent=a,e(c,d[i]));return c}function h(a,b){j(a,b)}function i(a,b){var c,d=a.length;for(c=0;c<d;c+=1)j(a[c],b)}function j(a,b){typeof a.row=="number"&&a.row>=0&&typeof b[a.row]!="object"&&(b[a.row]=a),a.nextDim&&h(a.nextDim,b),a.children&&i(a.children,b)}var b={};return b.HierNode=function(a){this.Value=a,this.children=[],this.nextDim=undefined,this.host=undefined,this.row=-1,this.hasInput=!1,this.isOpen=!0,this.isSelected=!1,this.parent=undefined,this.id=undefined,this.dim=undefined,this.level=undefined,this.isFirstLevelOfDimension=!1},b.mergeNodes=function(a,c){return c?a?(a.children=g(a,a.children,c.children),a.nextDim=b.mergeNodes(a.nextDim,c.nextDim),a):c:a},b.getRowIndex=function(a){var b=[];return a&&j(a,b),b},b.deSelectDescendantsOfNode=function(a,d){if(a.id===d)c(a);else{var e=a.children.length,f;for(f=0;f<e;f+=1)b.deSelectDescendantsOfNode(a.children[f],d)}},b.findNodeByDomNodeID=function(a,c){if(a.id===c)return a;var d=a.children.length,e,f;for(e=0;e<d;e+=1){f=b.findNodeByDomNodeID(a.children[e],c);if(f)return f}},b.findNodeByID=function(a,c){var d=a.id?a.id.split("_"):[],e=a.children.length,f,g;if(d.length>4&&d[3]===c)return a;for(f=0;f<e;f+=1){g=b.findNodeByID(a.children[f],c);if(g)return g}},b.getAncestors=function(a,c){a&&a.parent&&(a.parent.Value&&c.push(a.parent),b.getAncestors(a.parent,c))},b}),define("datavirtualization/htmltohiernodeparser",["datavirtualization/hiernode"],function(a){function c(d,e,f){var g,h,i,j,k,l,m,n,o,p,q;q=$(".arcHier",e).hasClass("arcVertBeside")||$(".arcHier",e).hasClass("arcHoriBeside"),o=d.children("label:first"),o[0]?(m=new a.HierNode(o[0].textContent),m.isSelected=d.hasClass("arcHier-selected"),p=d.children("input:first"),m.isOpen=p[0].checked,m.hasInput=!0,m.id=p.attr("id")):(o=d.children("a:first"),m=new a.HierNode(o[0].textContent),m.isSelected=d.hasClass("arcHier-selected"),m.isOpen=!0,m.hasInput=!1,m.id=o.attr("id")),m.row=parseInt(m.id.split("_")[0],10)-1,n=m.id.split("_"),m.dim=parseInt(n[2],10),m.level=parseInt(n[1],10),f[0]=m.row,g=d.children("ol:first"),h=d.children("ul:first"),g.length>0&&(i=$(g[0]),m.nextDim=b.buildHierarchyDimension(i,e,f),m.nextDim.host=m);if(h.length>0){j=h.children("li"),l=j.length;for(k=0;k<l;k+=1)m.children[k]=c($(j[k]),e,f),m.children[k].parent=m}return m}var b={};return b.buildHierarchyDimension=function(b,d,e){var f=b.children("li"),g=f.length,h=new a.HierNode(""),i,j;h.row=e[0];for(j=0;j<g;j+=1)i=$(f[j]),h.children[j]=c(i,d,e),h.children[j].parent=h,h.children[j].isFirstLevelOfDimension=!0;return h},b}),define("datavirtualization/hierdatatohiernodeparser",["datavirtualization/hiernode","tools"],function(a,b){function d(b,d,f){var g=new a.HierNode(b.value),h;return g.row=parseInt(b.r,10),g.id=b.nodeid,h=g.id.split("_"),g.dim=parseInt(h[2],10),g.level=parseInt(h[1],10),g.hasInput=b.Input==="true",g.isOpen=b.IsOpen==="true",g.isSelected=b.Selected==="true",typeof f!="undefined"&&(g.isFirstLevelOfDimension=f),d&&(g.parent=d),b.a&&(g.children=e(b.a,g)),b.Dimension&&(g.nextDim=c.buildHierarchyDimension(b.Dimension,g)),g}function e(a,c,e){var f=[];return b.iterateArcplanArray(a,function(a,b){f.push(d(b,c,e))}),f}var c={};return c.buildHierarchyDimension=function(b,c){var f=null;return b&&typeof b=="object"&&(typeof b.a!="undefined"||typeof b.Node!="undefined")&&(f=new a.HierNode(""),c?(f.host=c,f.dim=f.host.dim+1):f.dim=1,typeof b.a!="undefined"&&(f.children=e(b.a,f,!0)),typeof b.Node!="undefined"&&f.children.push(d(b.Node,f,!0))),f},c}),define("datavirtualization/horizontalhierarchydatavirtualizationfactory",["assert/assert","properties","datavirtualization/hierarchyhtmlgenerator","datavirtualization/hierdatatohiernodeparser"],function(a,b,c,d){return function(f,g,h){function l(){var a="";a=c.writeToHtmlStartingHere(k,b.getNumRows(f),a,null,f),g.insertRangeIntoDom(a,{})}function m(a){k=d.buildHierarchyDimension(a.ObjectData),l()}function n(a){c.generateHierarchyStub(f,h),m(a)}var i={},j,k=null;return i.init=function(c,d){j=d,a(typeof c=="object"),n(c)},i.update=function(b,c){j=c},i.updatePosition=function(){},i}}),define("datavirtualization/servertabledataparser",["tools","components/datatranslators/celldatatranslator","components/datatranslators/cellpropertytranslator","datavirtualization/celltypes"],function(a,b,c,d){function f(a,b,c){return function(){c(a,b)}}var e={};return e.parse=function(d,e,g,h){if(d===null)return[];var i=0,j=[];return a.iterateArcplanArray(d,function(d,k){var l=0;j[i]=[],a.iterateArcplanArray(k,function(a,d){var k;k=b.create(d,g,f(l,e+i,h)),k.properties=c.create(d),j[i][l]=k,l+=1}),i+=1}),j},e.createEmptyCells=function(){return[[{type:d.EText,text:"",unformatted:"",properties:{}}]]},e}),define("datavirtualization/tabledatavirtualizationfactory",["datavirtualization/datavirtualizationhelper","datavirtualization/tablehtmlgenerator","datavirtualization/servertabledataparser","servercommunication/imageloader","datavirtualization/divsizelimithandler","browserfeatures","assert/assert"],function(a,b,c,d,e,f,g){function h(g,h,i,j,k,l){function q(a){var b=0,c=0,d=j.getNumCols();for(c=0;c<d;c+=1){b+=j.getColumnWidth(c);if(b>=a)return c}return 0}function r(a){var b=0,c=0,d=j.getNumCols();for(c=0;c<d;c+=1){b+=j.getColumnWidth(c);if(b>=a)return c}return Math.max(0,d-1)}function s(a){var b={firstVisibleRow:0,lastVisibleRow:0},c=j.getWidth(),d=j.getHeight(),f=j.getRowHeightWithGrid(),g,h=C(),i=y();return g=e.domToLogicalPosition(a,h,i),b.firstVisibleColumn=q(g.x),b.lastVisibleColumn=r(g.x+c),f>0&&(b.firstVisibleRow=Math.floor(g.y/f),b.lastVisibleRow=Math.ceil((g.y+d)/f)),b}function t(a){var b={};return b.firstHoriPageNeeded=Math.floor(a.firstVisibleColumn/l.horizontal),b.lastHoriPageNeeded=Math.floor(a.lastVisibleColumn/l.horizontal),b.firstVertPageNeeded=Math.floor(a.firstVisibleRow/l.vertical),b.lastVertPageNeeded=Math.floor(a.lastVisibleRow/l.vertical),b}function u(a,b){var c;return c=m.firstColumnInDOM<=a&&a<=m.lastColumnInDOM&&m.firstElementInDOM<=b&&b<=m.lastElementInDOM,c}function v(a,b){var c;u(a,b)&&(c=h.buildHtmlForCell(n,a,b),i.updateCell(c,a-m.firstColumnInDOM,b-m.firstElementInDOM))}function w(a,b,e){var f=[],g=0;e&&e.Rows&&(f=c.parse(e.Rows,b,d,v)),f.forEach(function(a){n[b+g]=a,g+=1}),o.updatePosition()}function x(){m.firstElementInDOM=-1,m.lastElementInDOM=-1,m.firstColumnInDOM=-1,m.lastColumnInDOM=-1,m.checkedElements=[]}function y(){var a={width:j.getWidthWithoutBorder(),height:j.getHeightWithoutBorder()};if(j.dependsOnAnotherObjectThatHasVerticalScrollBar()||j.hasOwnVerticalScrollBar())a.width-=f.scrollbarWidth;if(j.dependsOnAnotherObjectThatHasHorizontalScrollBar()||j.hasOwnHorizontalScrollBar())a.height-=f.scrollbarWidth;return a}function z(a,b){var c=j.getRowHeightWithGrid(),d={left:0,top:0,width:0,height:c*a.numRows},f={left:0,top:a.startRow*c},g=a.startColumn,h,i=j.getClientAreaDimensions().width,k=C(),l=y(),m;for(h=0;h<g;h+=1)f.left+=j.getColumnWidth(h);m=e.determinePagePositionByDomScrollPosition(b,f,k,l),d.left=m.left,d.top=m.top;for(h=g;h<g+a.numColumns;h+=1)d.width+=j.getColumnWidth(h);return d.width=Math.max(d.width,i),d}function A(){var a=0,b,c=j.getNumCols(),d=j.getClientAreaDimensions().width;return a=j.getAccumulatedColumnWidth(),Math.max(a,d)}function B(){return j.getRowHeightWithGrid()*j.getNumRows()}function C(){var a={width:A(),height:B()};return a}function D(){var a=C(),b=y(),c={width:Math.min(a.width,f.c_DivSizeLimit-f.scrollbarWidth),height:Math.min(a.height,f.c_DivSizeLimit-f.scrollbarWidth)};return j.dependsOnAnotherObjectThatHasVerticalScrollBar()&&!j.hasOwnVerticalScrollBar()&&(c.width+=f.scrollbarWidth),j.dependsOnAnotherObjectThatHasHorizontalScrollBar()&&!j.hasOwnHorizontalScrollBar()&&(c.height+=f.scrollbarWidth),c}function E(a,b){function c(b,c){var d,e,f,g,h=b-m.firstColumnInDOM,i=c-m.firstElementInDOM,j;return b>-1&&c>-1&&n.length>c&&n[c]&&n[c].length>b&&(j=n[c][b],typeof j.rowSpan!="undefined"&&typeof j.colSpan!="undefined"&&(d=a.startRow-j.primaryRow,d>=0&&a.startRow<=j.rowSpan+j.primaryRow&&(i=0),e=a.startColumn-j.primaryCol,e>=0&&a.startColumn<=j.colSpan+j.primaryCol&&(h=0))),{x:h,y:i}}var d={},e,f=j.getSelectedCell(),l,o;if(a.startRow!==m.firstElementInDOM||m.lastElementInDOM!==a.startRow+a.numRows-1||a.startColumn!==m.firstColumnInDOM||m.lastColumnInDOM!==a.startColumn+a.numColumns-1||j.hasColumnWidthChanged()||j.hasRowHeightChanged())e=h.buildHtmlForRange(n,a,d),d.startRow!==undefined&&d.numRows>=0&&k.requestObjectData(g,p,d.startRow,d.numRows,w),i.insertRangeIntoDom(e),m.firstElementInDOM=a.startRow,m.firstColumnInDOM=a.startColumn,m.lastElementInDOM=m.firstElementInDOM+a.numRows-1,m.lastColumnInDOM=m.firstColumnInDOM+a.numColumns-1;o=D(),i.updateVirtualSizeAndScrollStates(o,j.getWidthWithoutBorder(),j.getHeightWithoutBorder(),j.getHoriScrollState(),j.getVertScrollState(),j.getHorizontalAdjustment()),l=c(f.x,f.y),i.applySelection(l.x,l.y),j.hasFocus()&&i.setFocus(),i.setTablePositionAndSize(z(a,b))}function F(a){a!==null&&a.Rows?n=c.parse(a.Rows,0,d,v):n=c.createEmptyCells()}function G(a){F(a),b.generateTableStub(g,k,n)}var m=a.getDatavirtualizationProperties(g),n=[],o={},p;return o.init=function(a,b){p=b,typeof k.removeHashFromObjectDataRequestList=="function"&&k.removeHashFromObjectDataRequestList(p),x(),typeof a=="object"&&G(a)},o.updatePosition=function(){var a=j.getHeight(),b=j.getWidth(),c=j.getRowHeightWithGrid(),d={y:j.getScrollY()?j.getScrollY():0,x:j.getScrollX()?j.getScrollX():0},e=s(d),f=t(e),g,h=j.getNumRows(),i=j.getNumCols(),k,m;b>0&&a>0&&(k=Math.max(0,f.firstVertPageNeeded*l.vertical),m=Math.max(0,f.firstHoriPageNeeded*l.horizontal),g={startRow:k,numRows:Math.min(l.vertical*(f.lastVertPageNeeded-f.firstVertPageNeeded+1),Math.max(h-k,1)),startColumn:m,numColumns:Math.min(l.horizontal*(f.lastHoriPageNeeded-f.firstHoriPageNeeded+1),Math.max(i-m,1))},E(g,d))},o.update=function(a,b){typeof k.removeHashFromObjectDataRequestList=="function"&&k.removeHashFromObjectDataRequestList(p),p=b,n=[],x(),F(a),i.updateTooltip(j.getToolTipType(),j.getToolTip())},o.updateInputValue=function(a,b,c){i.updateInputValue(a-m.firstColumnInDOM,b-m.firstElementInDOM,c,j.getRowHeightWithGrid())},o.getPrimaryCellIndex=function(a,b){var c;if(a>-1&&b>-1&&n.length>b&&n[b]&&n[b].length>a){c=n[b][a];if(typeof c.primaryCol!="undefined"&&typeof c.primaryRow!="undefined")return{x:c.primaryCol-1,y:c.primaryRow-1}}return undefined},o}return{createInstance:h}}),define("datavirtualization/tableviewhtmlgeneratorfactory",["tools","datavirtualization/celltypes","components/cssgenerators/cellbordercssgenerator","components/cssgenerators/margincssgenerator","components/cssgenerators/paddingcssgeneratory","components/datatranslators/cellpropertytranslator","tooltiptypes","stringtools"],function(a,b,c,d,e,f,g,h){var i={};return i.createInstance=function(i){function k(a,b,c,d,e){var f,g={},h=a.properties.font,j=h||"",k,l;g.textAlign="right",c&&(g.position="relative"),a.properties.alignment&&a.properties.alignment.horizontalAlign&&(g.textAlign=a.properties.alignment.horizontalAlign),u(a,g),a.properties.backgroundColor&&a.properties.backgroundColor.color1?g.backgroundColor=a.properties.backgroundColor.color1:typeof e!="undefined"&&(e?g.backgroundColor=i.getBackgroundColor2():g.backgroundColor=i.getBackgroundColor()),a.properties.fontColor&&a.properties.fontColor.color&&(g.color=a.properties.fontColor.color);if(j&&typeof j=="object")for(f in j)f!=="length"&&(k=j[f],typeof k=="string"&&(k=k.replace(/'/g,"")),g[f]=k);return b&&b.Value==="SingleLine"?g.whiteSpace="pre":g.whiteSpace="pre-wrap",d!==undefined&&i.needsToApplyColumnWidth()&&(l=Math.max(0,d),g.width=l+"px",l===0&&(g.padding="0px",g.borderRightWidth="0px")),g}function l(a){var b="<div class='arcTdWrapOuter' ";return a.outerDivStyle!==""&&(b+=" style='"+a.outerDivStyle+"'"),b+=" ><div class='arcTdWrapInner'",a.innerDivStyle!==""&&(b+=" style='"+a.innerDivStyle+"'"),b+=" >",b}function m(a,b,c,d,e,f){var g,h,j,k,l,m,n;if(e>1||d>1){j=0,k=0,l=i.getRowHeightWithGrid(c),m=l,e>1&&(g=c-a.primaryRow,g>0?(k=-(l*g),m=l*(g+e)):(k=0,m=l*e));if(d>1){h=b-a.primaryCol;if(h>0){if(!a.properties.alignment||!a.properties.alignment.horizontalAlign||a.properties.alignment.horizontalAlign!=="right")j=i.getColumnWidthWithoutGridByColAndColSpan(a.primaryCol,h),j=-j;f=i.getColumnWidthWithoutGridByColAndColSpan(b,d)}}n={top:k,left:j,width:f,height:m}}return n}function n(a,b,c){var d;return c.innerDivStyle!==""?(d=l(c),d+="<div class='arcTdInnerDiv' ",a.properties.alignment&&a.properties.alignment.verticalAlign&&(d+="style='vertical-align:"+a.properties.alignment.verticalAlign+";'"),d+=">",d+=b,d+="</div></div></div>"):d=b,d}function o(b,c,d,e){var f={textDecoration:d,color:c},g;return g=l(e)+"<div class='arcTdInnerDiv' ",b.properties.alignment&&b.properties.alignment.verticalAlign&&(g+="style='vertical-align:"+b.properties.alignment.verticalAlign+";'"),g+="><a style='"+a.styleAsStringFromObject(f)+"' "+" target='_blank' "+" href='"+b.url.replace(/'/g,"&#x0027;")+"'>"+h.escapeTextForHtml(b.text)+"</a></div></div></div>",g}function p(a,b,c,d){var e="",f="";return a.imageUrl&&(e="src='"+a.imageUrl+"' "),f="<a target='_blank'  href='"+a.url.replace(/'/g,"&#x0027;")+"'>"+"<img "+"class='arcImgScaleAllways' "+"name='OBJ' "+"align='top' "+"data-origSize='"+a.width+","+a.height+"' "+"height='"+c+"px' "+"width='"+b+"px' "+e+"></img></a>",n(a,f,d)}function q(a,b,c,d,e){var f="src='' ",g,h="";return a.imageUrl&&(f="src='"+a.imageUrl+"' "),g="style='width:"+d+"px;"+"height:"+c+"px;' ",h+="<img class='"+b+"' "+"name='OBJ' "+"align='top' "+"data-origSize='"+a.width+","+a.height+"' "+g+f+"></img>",n(a,h,e)}function r(b,c,d,e){var f=b.text,g=f.length>0?"########":"",h;if(!c||c.Value!=="SingleLine")f=f.replace(/\r\n/g,"<br />");return h=l(e),e.innerDivStyle!==""&&b.properties.alignment&&b.properties.alignment.verticalAlign&&(d.verticalAlign=b.properties.alignment.verticalAlign),h+="<div class='arcTdInnerDiv' style='"+a.styleAsStringFromObject(d)+"' "+">"+"<input type='password' ",e.innerDivStyle!==""&&(h+="style='vertical-align:inherit;text-align:inherit;width:auto;height:auto' "),h+="class='arcPassword' value='"+g+"' "+"pass='"+f.replace(/'/g,"&#x0027;")+"' "+"></input>"+"</div></div></div>",h}function s(b,c,d,e){var f="",g=b.text;while(g.indexOf(" ")===0)f+="&nbsp;",g=g.substr(1);g=h.escapeTextForHtml(g);if(!c||c.Value!=="SingleLine")g=g.replace(/\r\n/g,"<br />");return b.properties.alignment&&b.properties.alignment.horizontalAlign==="right"&&(e.innerDivStyle!==""?e.innerDivStyle+="float:right;":e.outerDivStyle+="float:right;"),l(e)+"<div class='arcTdInnerDiv' style='"+a.styleAsStringFromObject(d)+"' "+">"+f+g+"</div></div></div>"}function t(b,c,d){var e=b.htmlSource,f;return f=l(d),d.innerDivStyle!==""&&b.properties.alignment&&b.properties.alignment.verticalAlign&&(c.verticalAlign=b.properties.alignment.verticalAlign),f+="<div class='arcTdInnerDiv arcTdHtmlDiv' style='"+a.styleAsStringFromObject(c)+"' "+">"+e+"</div></div></div>",f}function u(a,b){b=b||{},a.properties.alignment&&a.properties.alignment.verticalAlign&&(b.verticalAlign=a.properties.alignment.verticalAlign)}function v(a,b,c,d,e){var f,g,h=i.getGridHoriOffset(),j=i.getGridVertOffset(),k=0,l=0,m;return k-=h,c?g={width:c.width+h,height:c.height+j}:g={width:d+h,height:i.getRowHeightWithGrid(e)+j},a&&(g.width-=a.left+a.right,g.height-=a.top+a.bottom,k+=a.left+a.right,l+=a.top+a.bottom),b&&(g.width-=b.left+b.right,g.height-=b.top+b.bottom,k+=b.left+b.right),m=k>0?"-":"+",g.calculatedWidthStyle="width:calc(100% "+m+" "+Math.abs(k)+"px);",m=l>0?"-":"+",g.calculatedHeightStyle="height:calc(100% "+m+" "+Math.abs(l)+"px);",g}function w(a,b,c){var d={width:b,height:c};return a&&(d.width-=a.left+a.right,d.height-=a.top+a.bottom),d}function x(a,b,f,g,h,i){return b&&(i.innerDivStyle+=e.createCss(b)),f&&(a?i.innerDivStyle+=c.createCss(f):i.outerDivStyle+=c.createCss(f)),g&&(i.outerDivStyle+=d.createCss(g),a?(a.left+=g.left,a.top+=g.top,i.innerDivStyle+="background-color:"+h.backgroundColor+";"):i.outerDivStyle+="background-color:"+h.backgroundColor+";",h.backgroundColor=undefined),a&&(h.position="relative",i.innerDivStyle+="position:absolute;left:"+a.left+"px;top:"+a.top+"px;"),i}function y(a,b,c,d,e,g,h,j){var k,l,n=i.getObjectCellFormat(),o=f.create(n),p=typeof a.properties.margin!="undefined"||typeof a.properties.border!="undefined"||typeof a.properties.padding!="undefined",q=!p&&b,r=a.properties.margin||(q?o.margin:undefined),s=a.properties.border||(q?o.border:undefined),t=a.properties.padding||(q?o.padding:undefined),u={outerDivStyle:"",innerDivStyle:"",contentDivSize:undefined},y;k=m(a,c,d,e,g,h);if(k||t||s||r)l=v(r,s,k,h,d),u.outerDivStyle+=l.calculatedWidthStyle+l.calculatedHeightStyle+"position:relative;",u.contentDivSize=w(t,l.width,l.height),y="calc(100% - "+(typeof t=="undefined"?0:t.left+t.right)+"px)",u.innerDivStyle+="height:100%;width:"+y+";",x(k,t,s,r,j,u);return u}function z(c,d,e,f,g,h,j,l,m,n,v){var w,x=k(c,e,j,d,v),z="",A,B,C,D,E="",F,G=i.getFont(),H,I,J,K,L=y(c,l,f,g,n,m,d,x);c.properties.fontColor&&c.properties.fontColor.color?F=c.properties.fontColor.color:F=i.getForegroundColor(),c.properties.font?I=a.toHTMLFont(c.properties.font):I=G,H=I.textDecoration;switch(c.type){case b.ETextLink:w=o(c,F,H,L);break;case b.EImageLink:L.contentDivSize?(d=L.contentDivSize.width,K=L.contentDivSize.height):K=i.getRowHeightWithoutGrid(g),A=Math.min(K,c.height),B=Math.min(d-2,c.width),w=p(c,B,A,L);break;case b.EImage:L.contentDivSize?(d=L.contentDivSize.width,K=L.contentDivSize.height):K=i.getRowHeightWithoutGrid(g),c.properties.scaleToObject?(z="arcImgScaleAllways",A=K,B=d):(A=Math.min(K,c.height),B=Math.min(d-2,c.width)),w=q(c,z,A,B,L);break;case b.ENumber:case b.EText:J={textDecoration:H},u(c,J),i.getIsPassword()?w=r(c,e,J,L):(c.text.indexOf(" ")===0&&!c.unformatted&&(c.unformatted=c.text),w=s(c,e,J,L)),D=c.unformatted;break;case b.EHtml:c.htmlSource&&(w=t(c,{textDecoration:H},L))}if(D){c.decimalSeparator&&c.decimalSeparator!=="."&&c.type===b.ENumber&&(D=D.replace(".",c.decimalSeparator)),D=D.replace(/'/g,"&#x0027;");if(!e||e.Value!=="SingleLine")D=D.replace(/\r\n/g,"<br />");E="data-unformatted='"+D+"'"}return C="<td draggable='true' tabindex='-1'"+(h?" title='"+h+"'":"")+(m?" rowspan='"+m+"'":"")+(n?" colspan='"+n+"'":"")+(c.isExtraColumn?" class='arcExtraColumn'":"")+" "+E+" style='"+a.styleAsStringFromObject(x)+"' "+">"+w+""+(j?"<span class='arcCellTooltipMarker'></span>":"")+"</td>",C}function A(a,b,c,d,e,f){var g,h=b.rowSpan,i=b.colSpan;return b.rowSpan===0&&d===f&&(h=b.remainRowSpan,g=b.primaryRow%2===0),b.colSpan===0&&c===e&&(i=b.remainColSpan),{rowSpan:h,colSpan:i,isPrimaryRowEven:g}}var j={};return j.buildHtmlForRange=function(a,c,d){var e,f,h="",k="",l={text:"",type:b.EText,properties:{},isExtraColumn:!0},m,n=i.getToolTipType();if(a.length>0&&a[0].length>0){if(c.numColumns>1){k+="<colgroup>";for(f=c.startColumn;f<c.startColumn+c.numColumns;f+=1)k+='<col style="width:'+i.getColumnWidth(f)+'px" />';k+="</colgroup>"}for(e=c.startRow;e<c.startRow+c.numRows;e+=1){if(typeof a[e]!="object"){d.startRow=e,d.numRows=c.numRows-(d.startRow-c.startRow),c.numRows=e-c.startRow;break}a[e].length===1&&a[e][0].rowSpan>1?h+="<tr style='height:"+i.getRowHeightForRowSpanGreaterThanOne(a[e][0].rowSpan)+"px;'>":h+="<tr>";for(f=c.startColumn;f<c.startColumn+c.numColumns;f+=1)h+=j.buildHtmlForCell(a,f,e,c.startColumn,c.startRow);i.getNeedAdditionalColumn()&&(m="",h+=z(l,undefined,i.getWrapMode(),f,e,m,!1,!1)),h+="</tr>"}}else d.startRow=c.startRow,d.numRows=c.numRows,c.startRow=0,c.numRows=0,m=n!==g.WholeObject?i.getToolTip(0,0):undefined,h+="<tr>",h+=z(l,i.getColumnWidth(0),i.getWrapMode(),0,e,m,i.getShowTooltipMarker(0,0),!0),h+="</tr>";return{colgroupHtml:k,rowHtml:h}},j.buildHtmlForCell=function(a,b,c,d,e){var f=i.getToolTipType(),h=f!==g.WholeObject?i.getToolTip(b,c):undefined,j=a[c][b],k,l;return l=A(a,j,b,c,d,e),l.colSpan===0||l.rowSpan===0?k="<td style='display:none'></td>":k=z(j,i.getColumnWidthWithoutGridByColAndColSpan(b,l.colSpan),i.getWrapMode(),b,c,h,i.getShowTooltipMarker(b,c),!0,l.rowSpan,l.colSpan,l.isPrimaryRowEven),k},j},i}),define("menuhierarchyviewmodel",["datavirtualization/hiernode","properties","tools"],function(a,b,c){function e(b,c){var d=[],e=a.findNodeByDomNodeID(b,c),f,g;a.getAncestors(e,d),f=d.length;for(g=0;g<f;g+=1)d[g].isSelected=!1}function f(a,b){var c;for(c=0;c<b;c+=1)if(a.Elements[c].VValue&&(c===b-1||!a.Elements[c+1].VValue))return a.Elements[c].VValue.v;return"noSelection"}function g(a,c){var d=b.getSelectionPath(a),e=parseInt(d.NumRows,10),g=parseInt(d.NumRows,10),h=parseInt(d.NumCols,10),i,j,k=0,l=m(c);for(i=e-1;i>=0;i-=1)j=d.Elements[i].Row,f(j,h)===l&&(k+=1,d.Elements.splice(i,1));g-=k,d.NumRows=g.toString()}function h(c,d){var e=[],f=b.getDatavirtualizationProperties(c),h=a.findNodeByDomNodeID(f.allRows.Root,d),i,j;a.getAncestors(h,e),j=e.length;for(i=0;i<j;i+=1)g(c,e[i].id)}function i(a){var c=b.getSelectionPath(a),d=parseInt(c.NumRows,10),e=parseInt(c.NumCols,10),f,g;for(f=d-1;f>=0;f-=1){g=c.Elements[f].Row;while(g.Elements.length<e)g.Elements.push({VValue:null})}}function j(c,d){var e=b.getSelectionPath(c),f=parseInt(e.NumRows,10),g=parseInt(e.NumCols,10),h=[],j=b.getDatavirtualizationProperties(c),k=a.findNodeByDomNodeID(j.allRows.Root,d),l,n,o={Row:{Elements:[]}};if(k){a.getAncestors(k,h),n=h.length;for(l=n-1;l>=0;l-=1)o.Row.Elements.push({VValue:{Type:"1",v:m(h[l].id)}});o.Row.Elements.push({VValue:{Type:"1",v:m(d)}});for(l=0;l<g-(n+1);l+=1)o.Row.Elements.push({VValue:null});f+=1,n+1>g&&(g=n+1,e.NumCols=g.toString(),i(c)),e.Elements.push(o),e.NumRows=f.toString()}}function k(a,b,c){var d;for(d=0;d<c-1;d+=1)if(a.Elements[d].VValue&&a.Elements[d].VValue.v===b&&a.Elements[d+1].VValue)return!0;return!1}function l(a,c,d){var e=b.getSelectionPath(a),f=parseInt(e.NumRows,10),g=parseInt(e.NumRows,10),h=parseInt(e.NumCols,10),i,j,l=0;for(i=f-1;i>=0;i-=1){j=e.Elements[i].Row;if(k(j,c,h)||d)l+=1,e.Elements.splice(i,1)}g-=l,e.NumRows=g.toString()}function m(a){var b=a.split("_");return b[3]}function n(b,c){var d=b.Root;a.deSelectDescendantsOfNode(d,c)}function o(b,c,d){var e=parseInt(c.NumRows,10),f=parseInt(c.NumCols,10),g=f,h,i,j,k=0,l,n;n=m(b.children[0].id);for(h=e-1;h>=0;h-=1){j=c.Elements[h].Row,d&&j.Elements.length>0&&j.Elements[0].VValue&&j.Elements[0].VValue.v!==n&&(j.Elements.unshift({VValue:{Type:"1",v:n}}),g=f+1,c.NumCols=g+"");for(i=0;i<g;i+=1)j.Elements[i].VValue&&j.Elements[i].VValue.v&&(l=a.findNodeByID(b,j.Elements[i].VValue.v),l&&(!j.Elements[i+1]||!j.Elements[i+1].VValue?l.isSelected=!0:l.hasChildrenSelected=!0))}}function p(a){var b=a.split("_");return b[1]==="0"}var d={};return d.deselectAncestors=function(a,c){var d,f;a&&c&&(d=m(c),f=b.getDatavirtualizationProperties(a),e(f.allRows.Root,c),h(a,d))},d.deselectDescendants=function(a,c){var d,e;a&&c&&(d=m(c),e=b.getDatavirtualizationProperties(a),n(e.allRows,c),l(a,d,p(c)))},d.selectNode=function(c,e){var f,g=b.getDatavirtualizationProperties(c),i;if(c&&e){f=m(e),h(c,e),i=a.findNodeByDomNodeID(g.allRows.Root,e);if(i){i.isSelected=!0;while(i.parent)i.parent.isSelected=!1,i=i.parent}d.deselectDescendants(c,e),j(c,e)}},d.deselectNode=function(c,d){var e,f=b.getDatavirtualizationProperties(c),h;c&&d&&(e=m(d),g(c,d),h=a.findNodeByDomNodeID(f.allRows.Root,d),h&&(h.isSelected=!1))},d.applySelectionsToHierarchy=function(c){var d=b.getDatavirtualizationProperties(c),e=b.getSelectionPath(c);d&&d.allRows&&d.allRows.Root&&(a.deSelectDescendantsOfNode(d.allRows.Root,d.allRows.Root.id),e&&o(d.allRows.Root,e,b.getShowRootNode(c)))},d.serializeSelection=function(){var a="",b=this,d=parseInt(this.NumCols,10);return c.iterateArcplanArray(b,function(b,c){var e;for(e=d-1;e>=0;e-=1)if(c.Elements[e].VValue)break;a=a+"<Row><nodeid>"+c.Elements[e].VValue.v+"</nodeid></Row>"}),a},d.setPopupVisible=function(a){var c=b.getDatavirtualizationProperties(a);$(".arcHier",a)[0].innerHTML=c.innerHTML},d.setPopupInvisible=function(a){$(".arcHier",a)[0].innerHTML=""},d}),define("datavirtualization/checkboxhtmlgenerator",["properties","htmltemplates","styleborderprops","dmfieldtypes","tools","objectresizer","tooltiptypes","tooltip","stringtools"],function(a,b,c,d,e,f,g,h,i){function k(b){var c=e.getDocContainerForObject(b);return a.isDocWithTabOrderObjects(c)===!0}function l(b){var c=e.getDocContainerForObject(b);return a.getDocType(c)==="Dialog"}function m(a){return a>0?'tabindex="'+a+'"':a<0?'tabindex="-1"':""}function n(a,b){return a?"tabindex=-1 ":!a&&b?"tabindex=1 ":""}function o(a,b,c){var e,f;return a.Type!==d.VDouble||a.value==="-1"?e="&nbsp;":(a.Type===d.VDouble&&parseInt(a.value,10)>0?f="checked ":f="",e="<input type='checkbox' "+n(b,c)+f+"/>"),e}function p(a){var b={};return a.BackgroundColor&&(b.backgroundColor=a.BackgroundColor),b}function q(a,b,c,d,f){var g=o(b,c,d),h=p(b);return h=h?" style='"+e.styleAsStringFromObject(h)+"'":"",f=f?" title='"+f+"'":"","<td draggable='true'"+f+" "+h+">"+g+"</td>"}function r(a,b){var c=b?" title='"+b+"' ":"";return"<tr"+c+">"+a.join("")+"</tr>"}var j={};return j.generateStub=function(d){var i=a.getZIndex(d),j=a.getForegroundColor(d),l=a.getFont(d),n=c.getBorderStyleObject(d),o=c.getTablePadding(d),p=a.getToolTipType(d),q=a.getToolTip(d),r=k(d)?a.getTabOrder(d):-1,s,t={color:j};s=b.getHtmlTemplate("checkBox"),p===g.WholeObject?s=s.replace(/\{title\}/g,'title="'+h.toolTipStringForObject(q)+'"'):s=s.replace(/\{title\}/g,""),s=s.replace(/\{tabIndex\}/g,m(r)),s=s.replace(/\{z-index\}/g,i),e.mergeObjects(t,n),s=s.replace(/\{borderDivStyle\}/g,e.styleAsStringFromObject(t)),e.mergeObjects(o,l),s=s.replace(/\{tableStyle\}/g,e.styleAsStringFromObject(o)),d[0].innerHTML=s,f.applyObjectDimensionsWithoutScrollDepConUpdate(d)},j.buildHtmlForRows=function(b,c,f,i){var j=0,m=!1,n=a.getWidth(b),o=a.getColumnWidth(b),p=a.getNumCols(b),s=a.getObjType(b),t=a.getToolTip(b),u=a.getToolTipType(b),v=k(b),w=l(b),x="";o&&(e.iterateArcplanArray(o,function(a,b){a==="Width"&&(j+=b)}),j===0&&o.Width&&(j=p*parseInt(o.Width,10)),m=n>j),c.Rows&&e.iterateArcplanArray(c.Rows,function(a,c){var j=0,k,l,n=[];e.iterateArcplanArray(c,function(a,c){var d;x="",u===g.EachColumn?x=h.toolTipStringForColumn(t,j):u===g.EachCell&&(x=h.toolTipStringForCell(t,i,j)),d=q(b,c,v,w,x),j+=1,n.push(d)}),m&&(k={value:"-1",Type:d.VDouble},l=q(b,k,v,w),n.push(l)),x=u!==g.EachRow?"":h.toolTipStringForRow(t,i),f[i]=r(n,x),i+=1})},j}),define("datavirtualization/radiobuttonhtmlgenerator",["assert/assert","properties","tools","propertytools","objectresizer","htmltemplates","tooltip","tooltiptypes","stringtools"],function(a,b,c,d,e,f,g,h,i){function k(a){var d=c.getDocContainerForObject(a);return b.isDocWithTabOrderObjects(d)===!0}function l(a){var d=c.getDocContainerForObject(a);return b.getDocType(d)==="Dialog"}function m(a,b,c){return b?'tabindex="'+a+'"':!b&&c?'tabindex="1"':""}function n(a,c,d){var e=b.getYSettingValue(a),f=e===d?" checked":"",g=i.makeClassName(a[0].id),h="radio_"+d+"_"+g,j=b.getTabOrder(a),n=k(a),o=l(a);return"<span><input type='radio' id='"+h+"' name='radio"+g+"' value='"+d+"'"+f+" "+m(j,n,o)+"></input>"+"<label for='"+h+"'>"+(c.value?i.escapeTextForHtml(c.value):"")+"</label>"+"</span>"}function o(a,b){var d=[],e=0;return c.iterateArcplanArray(b.Rows,function(b,f){c.iterateArcplanArray(f,function(b,c){c.value&&(d[e]="<td draggable='true'>"+n(a,c,e+1)+"</td>",e+=1)})}),d}function p(a){return"<tr class='arcRadioSingleLine'>"+a.join("")+"</tr>"}function q(a,b){var c=[],d=0,e=r(a);for(;d<b.length;d+=1)c[d%e]===undefined&&(c[d%e]="<tr>"),c[d%e]+=b[d];return c.join("</tr>")+"</tr>"}function r(a){var c=2,d=1.5,f=.2,g=b.getFont(a),h=b.getBorder(a),i=b.getHeight(a)-e.getVerticalAdjustment(h,a),j=t(g.fontSize),k=Math.round(j*d+c),l=Math.floor(i/k+f);return l<=0?1:l}function s(a,c){var d,f,g="radioMeasure",h,i,j=b.getBorder(a),k=b.getWidth(a)-e.getVerticalAdjustment(j,a),l=b.getFont(a);return i="<table class='dynaRadio'><tbody></tbody></table>",d=$("<span id='"+g+"'></span>").append(i).css({zIndex:-1e3,display:"none"}).css(l),$("tbody",d).append(c),$("body").append(d),f=$("#"+g).width(),$("#"+g).remove(),h=f<k,h}function t(a){var b,c="radioMeasure",d;return b=$("<span id='"+c+"'></span>").css({fontSize:parseInt(a,10)+"pt",zIndex:-1e3,display:"none"}),$("body").append(b),d=parseInt($("#"+c).css("fontSize"),10),$("#"+c).remove(),d}var j={};return j.generateStub=function(a){var c,d=b.getZIndex(a),e=b.getToolTipType(a),j=b.getToolTip(a),k=i.makeClassName(a[0].id);c=f.getHtmlTemplate("radioButton"),e===h.WholeObject?c=c.replace(/\{title\}/g,'title="'+g.toolTipStringForObject(j)+'"'):c=c.replace(/\{title\}/g,""),c=c.replace(/\{z-index\}/g,d),c=c.replace(/\{tableClass\}/g,k),a[0].innerHTML=c},j.buildHtmlContent=function(a,c){var d=[],e=-1,f=parseInt(b.getHorizontalAlignment(a),10)===e,g,h=!1,i;return c.Rows&&(d=o(a,c),f&&(i=p(d),h=s(a,i),h&&(g=i)),h||(g=q(a,d))),g},j.applyTabOrder=function(c,d){a(b.getObjType(c)==="RadioGroup"),a(typeof d=="number"),c.find("input").attr("tabindex",d)},j}),define("texthtmlgenerator",["assert/assert","properties","tools","objectresizer","styleborderprops"],function(a,b,c,d,e){function g(a,c){var d,e="dynaText",f="",g=b.getTabOrder(a);return g>0&&(f=' tabindex="'+g+'" '),g<0&&(f=' tabindex="-1" '),f!==""&&(d=c.indexOf(e)+e.length+1,c=c.substr(0,d)+f+c.substr(d)),c}function h(a){var b=a[0].id;return"editorContainerFor_"+b}function i(a){var c=$("<div></div>"),d=$("<div></div>"),f=$("<div></div>"),g=$("<div></div>"),i=b.getZIndex(a),j={left:"0px",top:"0px",position:"relative"},k=b.getForegroundColor(a),l=b.getBackgroundColor(a),m={color:k,backgroundColor:l},n=e.getBorderStyleObject(a),o,p=b.getTabOrder(a),q;return o="dynaText",f.append(g),d.append(f),c.append(d),$("div",c).addClass(o).css(j),c.addClass(o),n||(n={}),c.css(m).css(n),g.attr("id",h(a)),g.attr("contenteditable",b.getIsEditable(a)?"true":"false"),c.css("z-index",i),f.css("z-index",i+1),p>0&&g.attr("tabindex",p),p<0&&g.attr("tabindex","-1"),q=b.getFont(a),g.css({"font-size":q.fontSize,"font-family":q.fontFamily,"font-weight":q.fontWeight,"font-style":q.fontStyle}),c[0].outerHTML}function j(a,b){var c=$("#"+h(a));c.attr("tabindex",b)}function k(a,b){a.children("[tabindex]").attr("tabindex",b)}var f={};return f.buildHtml=function(a,c){if(typeof c!="object")return b.setContent(a,undefined),c=g(a,c),c;b.setContent(a,c),a[0].innerHTML=i(a),d.applyObjectDimensions(a)},f.buildHtmlForNotInitialHtmlText=function(a){a.prepend(i(a)),b.setXPosChanged(a,!0),b.setYPosChanged(a,!0),b.setWidthChanged(a,!0),b.setHeightChanged(a,!0),d.applyObjectDimensions(a)},f.wrapDataWithObjectFontStyle=function(a,b,c){return"<span style='font-size:"+b.fontSize+";font-family:"+b.fontFamily.replace(/'/g,"")+";font-weight:"+b.fontWeight+";font-style:"+b.fontStyle+";color:"+c+"'>"+a+"</span>"},f.convertTextToHtml=function(a,b,c){var d,e,g,h,i,j="",k=40,l;if(a==="")return"";d=a.replace(/\n\r/g,"\n"),d=d.replace(/\r/g,"\n"),e=d.split("\n"),h=e.length;for(g=0;g<h;g+=1){i=e[g],l=0;while(i.indexOf("\t")===0)i=i.substr(1),l+=k;l>0?(j+='<div style="margin-left:'+l+'px">',j+="<span>"+i+"</span></div>"):(i!==""&&(j+="<span>"+i+"</span>"),j+="<pre><br>")}return f.wrapDataWithObjectFontStyle(j,b,c)},f.applyTabOrder=function(c,d){a(b.getObjType(c)==="Text"),a(typeof d=="number"),j(c,d),k(c,d)},f}),define("taborderapplier",["assert/assert","properties","texthtmlgenerator","datavirtualization/radiobuttonhtmlgenerator"],function(a,b,c,d){var e={};return e.applyTabOrder=function(e){var f,g;a(b.isAvailableInView(e)),g=b.getTabOrder(e),f=b.getObjType(e);switch(f){case"Column":case"Field":case"Row":case"Table":case"CheckboxGroup":case"MenuHierarchie":e.children().first().attr("tabindex",g);break;case"Menu":b.isUseNativeMenu(e)?$("select",e).attr("tabindex",g):e.children().first().attr("tabindex",g);break;case"Text":c.applyTabOrder(e,g);break;case"RadioGroup":d.applyTabOrder(e,g)}},e}),define("objectpropertysetter",["assert/assert","properties","tools","propertytools","browserfeatures","stringtools","tooltiptypes","menuseparatortypes","colortools","components/datatranslators/taborderhelper"],function(a,b,c,d,e,f,g,h,i,j){function l(a,c){var d,e,f;c&&c.Symbol&&(d=c.Symbol.DropDownSymbolSingleSelection,e=c.Symbol.DropDownSymbolMultiSelection,e&&(typeof e.Width!="undefined"&&b.setDropDownSymbolWidth(a,parseInt(e.Width,10)),typeof e.Height!="undefined"&&b.setDropDownSymbolHeight(a,parseInt(e.Height,10)),e.ImageReference&&b.setMultiDropDownImageReference(a,e.ImageReference)),d&&(typeof d.Width!="undefined"&&b.setDropDownSymbolWidth(a,parseInt(d.Width,10)),typeof d.Height!="undefined"&&b.setDropDownSymbolHeight(a,parseInt(d.Height,10)),d.ImageReference&&b.setSingleDropDownImageReference(a,d.ImageReference)))}function m(a,d){var e=c.toHTMLFont(d.Font),f=d.LineSpacing.v*parseInt(e.lineHeight,10);b.setPopupFont(a,e),b.setRowHeight(a,f),b.setHotTrackingBackColor(a,d.HotTrackingBackColor.TrueColor),b.setHotTrackingFontColor(a,d.HotTrackingFontColor.TrueColor),b.setPopupGradientColorLeft(a,d.GradientColorLeft.TrueColor),b.setPopupGradientColorRight(a,d.GradientColorRight.TrueColor),d.ShowSelectionArea&&b.setShowSelectionArea(a,d.ShowSelectionArea.v==="true")}function n(a){var b=[];return a.Elements&&c.iterateArcplanArray(a,function(a,c){a==="Width"&&b.push(c)}),b}function o(a,b,c,d){var e=0;for(e=0;e<d;e+=1){if(e>=b)break;a[e]=c[e]}}function p(a,b){var c=0,d=0,e;if(a.Elements)for(e in a.Elements)a.Elements[e].Width&&(a.Elements[e].Width=b[d],c+=a.Elements[e].Width,d+=1);return c}function q(a,c){var d=b.getColumnWidth(a),e,f,g=[],h=[],i,j;e=k.getUnifiedColumnWidths(c),e&&d&&d&&d.Elements&&(e.numCols===d.numCols?d=e:(g=n(d),h=n(e),i=h.length,f=d.accumulatedColumnWidth,g.length>0&&(j=g.length,o(g,j,h,i),f=p(d,g)),d.Width=e.Width,d.accumulatedColumnWidth=f)),b.setColumnWidth(a,d)}function r(a){return a.HierProperties&&a.HierProperties.HierFormat&&a.HierProperties.HierFormat.Dimensions&&a.HierProperties.HierFormat.Dimensions.Elements&&a.HierProperties.HierFormat.Dimensions.Elements[0]&&a.HierProperties.HierFormat.Dimensions.Elements[0].Dimension?!0:!1}function s(a,b,c){var e=!1;r(a)&&a.HierProperties.HierFormat.Dimensions.Elements[0].Dimension.ShowMother==="true"&&(e=!0),b.sort(function(a,b){var f=d.getLevelFromRowProp(a[c].Range.Start.Row,e),g=d.getLevelFromRowProp(b[c].Range.Start.Row,e),h=parseInt(a[c].Range.Start.Column,10),i=parseInt(b[c].Range.Start.Column,10);return h-i===0?f-g:h-i})}function t(a,d,e){var f=[],g=0,h=!1,i=!1,j=!1;e&&e.Dimensions&&(c.iterateArcplanArray(e.Dimensions,function(a,b){g=parseInt(b.DimensionWidth,10),h=d==="VerticalHierarchie"&&g>-1&&b.SumStyle!=="ORGANIGRAM"?!0:!1,i=b.SumStyle==="SUM_LAST",f.push({isSumKnotLast:i,showRootNode:b.ShowMother==="true",dimensionWidth:g,canApplyDimensionWidth:h}),i&&(j=!0)}),b.setHierFormat(a,f),b.setDimensionNumber(a,f.length),d!=="HorizontalHierarchie"&&b.setOneDimHasSumKnotLast(a,j))}function u(a,c){a.VScrollbarAllowed&&b.setVScrollBarAllowed(c,a.VScrollbarAllowed.Value==="true"),a.HScrollbarAllowed&&b.setHScrollBarAllowed(c,a.HScrollbarAllowed.Value==="true")}var k={};return k.getUnifiedColumnWidths=function(a){var b,d=[],e=1,f;return a&&(a.Elements?(b=-1,f=0,c.iterateArcplanArray(a,function(a,c){a==="Width"?(c/=100,d.push({Width:c}),f+=c,c!==b&&(b===-1?b=c:b=undefined)):a==="NumCols"&&(e=parseInt(c,10))}),d.push({NumCols:e})):(b=parseInt(a.Width,10),f=b,a.NumCols&&a.NumCols>1&&(e=a.NumCols,f=e*b)),f=Math.floor(f)),{width:b,Elements:d,accumulatedColumnWidth:f,numCols:e}},k.setPropertiesByView=function(a,b){var c=$("#"+b);u(a,c),q(c,a.ColumnWidth)},k.setProperties=function(a,d,e){var j,n,o,p,q,r,v={},w,x,y,z,A,B=b.getObjType(d);a.Pattern&&b.setPattern(d,a.Pattern),a.Grid&&(a.Grid.Type&&b.setGridType(d,a.Grid.Type),a.Grid.GridColor&&b.setGridColor(d,a.Grid.GridColor.TrueColor1)),a.BackgroundColor&&(a.BackgroundColor.Transparency==="true"?(b.setBackgroundColor(d,i.c_transparentColor),B==="Menu"||B==="MenuHierarchie"?b.setBackgroundColor2(d,a.BackgroundColor.TrueColor2):b.setBackgroundColor2(d,undefined)):(b.setBackgroundColor(d,a.BackgroundColor.TrueColor1),b.setBackgroundColor2(d,a.BackgroundColor.TrueColor2))),a.BackgroundColors&&(a.BackgroundColors.Elements.length>0&&s(a,a.BackgroundColors.Elements,"BackgroundColor"),b.setBackgroundColors(d,a.BackgroundColors)),a.EditEnabled&&b.setIsEditable(d,a.EditEnabled==="true"&&b.isActive(d)),a.ForegroundColor&&(a.ForegroundColor.Transparency==="true"?b.setForegroundColor(d,"transparent"):b.setForegroundColor(d,a.ForegroundColor.TrueColor1),b.setForegroundColor2(d,a.ForegroundColor.TrueColor2)),a.ForegroundColors&&(a.ForegroundColors.Elements.length>0&&s(a,a.ForegroundColors.Elements,"ForegroundColor"),b.setForegroundColors(d,a.ForegroundColors)),a.Font&&(p=c.toHTMLFont(a.Font),b.setFont(d,p)),a.Fonts&&(a.Fonts.Elements.length>0&&s(a,a.Fonts.Elements,"Font"),b.setFonts(d,a.Fonts)),a.Frame&&(v.top=a.Frame.Top==="true"?!0:!1,v.left=a.Frame.Left==="true"?!0:!1,v.right=a.Frame.Right==="true"?!0:!1,v.bottom=a.Frame.Bottom==="true"?!0:!1,v.type=a.Frame.Type,v.color=a.Frame.FrameColor.TrueColor1),b.setBorder(d,v),b.setIsPassword(d,a.Password==="true");if(a.RowHeight){switch(B){case"Field":b.setRowHeight(d,a.RowHeight.Height/100-1);break;case"Row":b.setRowHeight(d,a.RowHeight.Height/100);break;case"MenuHierarchie":case"Menu":a.PopupProperties&&a.PopupProperties.LineSpacing?m(d,a.PopupProperties):b.setRowHeight(d,22),l(d,a),b.setMenuFilterEnabled(d,a.TypeDownFilterEnabled&&a.TypeDownFilterEnabled==="true"),b.setUseNativeMenu(d,a.UseNativeMenu==="true");break;default:b.setRowHeight(d,a.RowHeight.Height/100)}a.RowHeight.NumRows&&B!=="MenuHierarchie"&&b.setNumRows(d,parseInt(a.RowHeight.NumRows,10))}b.setColumnWidth(d,k.getUnifiedColumnWidths(a.ColumnWidth)),b.setShowIcons(d,!0),a.HierProperties&&a.HierProperties.HierFormat&&(a.HierProperties.HierFormat.DisplayStyle==="TREE_STYLE"&&a.HierProperties.HierFormat.Dimensions&&a.HierProperties.HierFormat.Dimensions.Elements&&a.HierProperties.HierFormat.Dimensions.Elements[0]&&a.HierProperties.HierFormat.Dimensions.Elements[0].Dimension&&a.HierProperties.HierFormat.Dimensions.Elements[0].Dimension.HideIcons!=="true"?b.setShowIcons(d,!0):b.setShowIcons(d,!1)),a.XSetting&&b.setXSettingValue(d,parseInt(a.XSetting.Value,10)),a.YSetting&&b.setYSettingValue(d,parseInt(a.YSetting.Value,10)),u(a,d);switch(B){case"MenuHierarchie":a.HierProperties&&a.HierProperties.HierFormat&&a.HierProperties.HierFormat.Dimensions&&a.HierProperties.HierFormat.Dimensions.Elements&&a.HierProperties.HierFormat.Dimensions.Elements[0]&&a.HierProperties.HierFormat.Dimensions.Elements[0].Dimension&&b.setSelectType(d,a.HierProperties.HierFormat.Dimensions.Elements[0].Dimension.SelectType),a.YSetting&&(b.getSelectType(d)!=="HierMultiSelect"||!b.getOrigSelectionPath(d))&&b.setSelectionPath(d,a.YSetting.Selections);break;case"VerticalHierarchie":case"HorizontalHierarchie":a.HierSelState&&a.HierSelState.Type&&b.setSelectType(d,a.HierSelState.Type),a.YSetting&&b.setSelectionPath(d,a.YSetting.Selections);break;case"Text":a.FormattedTextInput&&b.setFormattedTextInput(d,a.FormattedTextInput==="true")}switch(B){case"MenuHierarchie":case"VerticalHierarchie":case"HorizontalHierarchie":b.setShowRootNode(d,!1),a.HierProperties&&a.HierProperties.HierFormat?(z=a.HierProperties.HierFormat,t(d,B,z),z.Dimensions&&z.Dimensions.Elements&&z.Dimensions.Elements[0]&&z.Dimensions.Elements[0].Dimension&&(A=z.Dimensions.Elements[0].Dimension,A.ShowMother==="true"&&b.setShowRootNode(d,!0),A.HideLines==="true"?b.setGridType(d,"none"):b.setGridType(d,"both"),A.AllowOpenClose==="false"&&b.setAllowOpenClose(d,!1)),z.DisplayStyle&&b.setDisplayStyle(d,z.DisplayStyle),z.Organigram&&b.setOrganigram(d,z.Organigram==="true")):(b.setAllowOpenClose(d,!0),b.setOrganigram(d,!1),B==="HorizontalHierarchie"?(b.setGridType(d,"both"),b.setDisplayStyle(d,"BOX_STYLE")):(b.setGridType(d,"none"),b.setDisplayStyle(d,"TREE_STYLE")))}a.Invisible==="true"?b.setVisible(d,!1):b.setVisible(d,!0),a.IsBookmarkObject==="true"?b.setBookmarkObject(d,!0):b.setBookmarkObject(d,!1),a.Label&&(q=b.getDocName(d),r=f.makeID(q,a.Label),b.setLabelledByObjectID(d,r)),b.setToolTip(d,a.ToolTip),a.ToolTip&&a.ToolTip.Elements&&a.ToolTip.Elements[0]&&a.ToolTip.Elements[1]?(x=a.ToolTip.Elements[0].NumCols,y=a.ToolTip.Elements[1].NumRows,x>1&&y>1?b.setToolTipType(d,g.EachCell):x>1?b.setToolTipType(d,g.EachColumn):y>1?b.setToolTipType(d,g.EachRow):b.setToolTipType(d,g.WholeObject)):b.setToolTipType(d,g.None),a.ShowTooltipMarker&&b.setShowTooltipMarker(d,a.ShowTooltipMarker.v==="true"),b.setWrapMode(d,a.WordWrap),a.HorizontalAlignment&&b.setHorizontalAlignment(d,a.HorizontalAlignment.Value),a.VerticalAlignment&&b.setVerticalAlignment(d,a.VerticalAlignment.Value),a.LinesAndIcons&&B==="Menu"&&(a.LinesAndIcons.HideLines==="0"?b.setMenuSeparator(d,{type:h.NoSeparator}):parseInt(a.LinesAndIcons.HideLines,10)>0&&(a.LinesAndIcons.HideIcons==="1"?b.setMenuSeparator(d,{type:h.LineSeparator,position:parseInt(a.LinesAndIcons.HideLines,10)}):a.LinesAndIcons.HideIcons==="0"&&b.setMenuSeparator(d,{type:h.SpaceSeparator,position:parseInt(a.LinesAndIcons.HideLines,10)}))),a.HasFrame==="true"?b.setHasFrame(d,!0):a.HasFrame==="false"&&b.setHasFrame(d,!1),a.Cell&&(typeof a.Cell.Border=="object"&&b.setCellBorder(d,a.Cell.Border),typeof a.Cell.Margin=="object"&&b.setCellMargin(d,a.Cell.Margin),typeof a.Cell.Padding=="object"&&b.setCellPadding(d,a.Cell.Padding))},k.setBaseProperties=function(d,e,f,g,h){var i=!1,k,l,m;if(typeof d!="object"||d===null)return;if(c.hasAllProperties(d,["Width","Height","Position","ViewAvailability"])&&d.Width.hasOwnProperty("Value")&&d.Height.hasOwnProperty("Value")&&c.hasAllProperties(d.Position,["XPos","YPos"])){b.setOrigWidth(e,Math.abs(d.Width.Value)),b.setOrigHeight(e,Math.abs(d.Height.Value));if(!f||!g)b.setWidth(e,Math.abs(d.Width.Value)),b.setHeight(e,Math.abs(d.Height.Value));if(d.Width.Value<0||d.Height.Value<0){b.setVisible(e,!1),b.setOrigXPos(e,Math.abs(d.Position.XPos)),b.setOrigYPos(e,Math.abs(d.Position.YPos));if(!f||!g)b.setXPos(e,Math.abs(d.Position.XPos)),b.setYPos(e,Math.abs(d.Position.YPos))}else{b.setOrigXPos(e,parseInt(d.Position.XPos,10)),b.setOrigYPos(e,parseInt(d.Position.YPos,10));if(!f||!g)b.setXPos(e,parseInt(d.Position.XPos,10)),b.setYPos(e,parseInt(d.Position.YPos,10))}b.setAvailableInView(e,d.ViewAvailability==="true")}return d.Layout!==undefined&&(f&&(k=b.getLayoutBehavior(e)),b.setLayoutBehavior(e,parseInt(d.Layout,10)),f&&(i=k!==b.getLayoutBehavior(e))),l=b.isActive(e),a(typeof l=="boolean","isActive needs to be set before calling setBaseProperties"),m=j.translateTabOrder(l,d,h),typeof m!="undefined"&&b.setTabOrder(e,m),i},k.setScrollDependencies=function(a,d){var e={vert:[],hori:[]};a&&a.VertScrollDependencies&&c.iterateArcplanArray(a.VertScrollDependencies,function(a,b){b&&b.ID&&e.vert.push(b.ID)}),a&&a.HoriScrollDependencies&&c.iterateArcplanArray(a.HoriScrollDependencies,function(a,b){b&&b.ID&&e.hori.push(b.ID)}),e.vert.length>0||e.hori.length>0?b.setScrollDeps(d,e):b.setScrollDeps(d,undefined)},k}),define("fieldkeyboardhandler",["properties","keycodes","textinput","tools"],function(a,b,c,d){function f(b){var c=b.closest(".arcContainer"),d=a.getDocSelectedObjectManager(c);a.setSelectedCell(b,{x:0,y:0}),d.setSelectedObject(b[0].id)}function g(a,b,d){return b.data.target=a,b.data.clickPos={x:0,y:0},d===!0&&(b.data.initialValue=a.attr("data-unformatted")||a.text()),$(".arcTextInputSizeTarget",b.data.ref).removeClass("arcTextInputSizeTarget"),a.addClass("arcTextInputSizeTarget"),c.show(b)}function h(b){return a.getIsEditable(b)&&a.isActive(b)&&$(".arcTdHtmlDiv",b).length===0}function i(a,b,c){!a.hasClass("arcTextInputActive")&&h(a)&&(f(a),g(b,c,!0))}function j(a,c,e){var i;!c.hasClass("arcTextInputActive")&&h(c)&&d.isInputKeyAllowed(a.keyCode,a.ctrlKey,a.altKey)&&(f(c),i=g(e,a),a.keyCode===b.Delete&&i.trigger($.Event("blur",{keyCode:a.keyCode})))}function k(b){var c=b.closest(".arcContainer"),d=a.getDocSelectedObjectManager(c);d.setSelectedObject(undefined)}function l(b){return a.getIsEditable(b)&&a.isActive(b)}var e={};return e.handleKeyPressEvent=function(c){var d=$("#"+c.data.id),e=$("td:first",d),f;if(c.type!=="keypress"&&c.type!=="keydown")return;c.keyCode===b.Enter?(i(d,e,c),c.preventDefault(),c.stopImmediatePropagation()):c.keyCode===b.Tab?k(d):(!a.getHasClickEvent(d)||!a.isClickingOnFieldWithClickEvent(d))&&j(c,d,e)},e.handleTextObjectKeyPressEvent=function(c){var d=$("#"+c.data.id),e;c.keyCode===b.Enter?l(d)&&(f(d),d.trigger($.Event("click",{data:c.data})),c.preventDefault(),c.stopImmediatePropagation()):c.keyCode===b.Tab?k(d):a.isFormattedTextInput(d)||(e=$("textarea",d),j(c,d,e))},e.handleFieldFocused=function(b){var c=$("#"+b.data.id),d=c.closest(".arcContainer"),e=a.getDocSelectedObjectManager(d).getSelectedObject(),h;typeof e=="undefined"&&!b.data.isCancelInitInput&&a.getIsEditable(c)&&a.isActive(c)&&a.getTabOrder(c)>0&&(f(c),h=$("td:first",c),g(h,b,!0))},e.handleTextFocused=function(b){var c=$("#"+b.data.id),d=c.closest(".arcContainer"),e=a.getDocSelectedObjectManager(d).getSelectedObject();typeof e=="undefined"&&!b.data.isCancelInitInput&&a.getIsEditable(c)&&a.isActive(c)&&(f(c),c.trigger($.Event("click",{data:b.data})))},e}),define("userdialog",["jquery","keycodes","stringtools","logger","drivertype","guitypes","usertypes","stringsres","stringsid","jquery.simplemodal"],function(a,b,c,d,e,f,g,h,i){var j={};return j.createUserDialog=function(){var b={sendEvent:undefined,callback:undefined,gui:{Type:"0",UserLogin:{DriverType:0,UserName:"","Driver Name":"User Login"}}},j=function(b){var c=a("<div></div>");return typeof b=="string"&&c.addClass(b),c},k=function(b,c,d,e,f){var g=a("<input>");return g.addClass("loginField"),typeof b=="string"&&g.attr("name",b),typeof c=="string"&&g.addClass(c),typeof d=="string"&&g.val(d),typeof e=="string"&&g.attr("type",e),typeof f=="string"&&f!==""&&(g.prop("required","true"),g.on("invalid",function(a){a.target.validity.customError||a.target.setCustomValidity(""),!a.target.validity.valid&&a.target.validity.valueMissing&&a.target.setCustomValidity(f)}),g.on("input",function(a){a.target.setCustomValidity("")})),g},l=function(){var b={},c={containingLanguageValue:function(a){return b.language=a,this},containingClientValue:function(a){return b.client=a,this},andAppendTo:function(c){var d=a("<tr></tr>"),e=a("<tr></tr>"),f=a("<td></td>");d.append(a("<td></td>").text(h.getMessageById(i.CLIENT))),e.append(a("<td></td>").append(k("_client","loginFieldInColumn",b.client,"text"))),d.append(a("<td></td>").text(h.getMessageById(i.LANGUAGE))),e.append(a("<td></td>").append(k("_language","loginFieldInColumn",b.language,"text"))),d.appendTo(c),e.appendTo(c)}};return c},m=function(b,c){function d(b,c){return a("<input></input>",{id:b,value:c,name:"userOption",type:"radio","class":"arcUserOptionInput"})}function e(b,c){return a("<label></label>",{"for":b,text:c,"class":"arcUserOptionLabel"})}var f=a("<tr></tr>"),j=a("<td class='arcUserOptionRow'></td>"),k=d("_winUser","1"),l=d("_arcUser","2"),m=["windows","arcplan"],n=!0,o=!0;ARCPLAN.engage&&ARCPLAN.engage.server&&ARCPLAN.engage.server.allowedAuthenticationModes&&(m=ARCPLAN.engage.server.allowedAuthenticationModes),m.indexOf("windows")===-1&&m.length>0&&(o=!1),m.indexOf("arcplan")===-1&&m.length>0&&(n=!1),f.append(j),j.append(k),j.append(e("_winUser",h.getMessageById(i.WINDOWS_USER))),j.append(l),j.append(e("_arcUser",h.getMessageById(i.ARCPLAN_USER))),c&&c===g.windows?(o=!0,n=!1):c&&c===g.arcplan&&(o=!1,n=!0),k.prop("checked",!0);if(!o||!n)o||(k.prop("checked",!1),l.prop("checked",!0)),n||(k.prop("checked",!0),l.prop("checked",!1)),f.hide();f.append(j),b.append(f)},n=function(){var b={fieldClass:"loginFieldLong",inputType:"text",colSpan:1},c={withLabel:function(a){return b.label=a,this},and:function(){return this},andLong:function(){return b.fieldClass="loginFieldLong",this},andMedium:function(){return b.fieldClass="loginFieldMedium",this},andShort:function(){return b.fieldClass="loginFieldShort",this},textField:function(){return b.inputType="text",this},passwordField:function(){return b.inputType="password",this},checkboxField:function(){return b.inputType="checkbox",this},withName:function(a){return b.name=a,this},containingValue:function(a){return b.value=a,this},withColSpan:function(a){return b.colSpan=a,this},setRequiredValidationMessage:function(a){return b.requiredValidateMessage=a,this},andAppendTo:function(c){var d=a("<tr></tr>"),e=a("<tr></tr>"),f=a("<td></td>").attr("colSpan",b.colSpan);b.inputType==="checkbox"?(f.append(a("<input>").attr("type","checkbox").attr("name",b.name).attr("id","id"+b.name)),f.append(a("<label></label>").attr("for","id"+b.name).text(" "+b.label)),e.append(f)):(d.append(a("<td></td>").text(b.label)).attr("colSpan",b.colSpan),e.append(a("<td></td>").append(k(b.name,b.fieldClass,b.value,b.inputType,b.requiredValidateMessage)).attr("colSpan",b.colSpan))),d.appendTo(c),e.appendTo(c)}};return c},o=function(a){var b,d,e="",f=[10,22,14,9,27,2,28,19,7,16];for(d=0;d<a.length;d+=1)b=a.charCodeAt(d),b-=f[d%10],d===0?e=String.fromCharCode(b):e+=String.fromCharCode(b);return e=c.encodeUtf8(e),e=c.encodeBase64(e),e},p=function(a,b){var c=a.split("\\");return c.length===2?a:a.indexOf("@")!==-1?a:b.length>0?b+"\\"+a:a},q=function(a){var b=a.split("\\");return b.length===2?b[0]:""},r=function(a){var b=a.split("\\");return b.length===2?b[1]:a},s=function(a){n().withLabel(h.getMessageById(i.OLD_PASSWORD)).andLong().passwordField().withName("_oldpassword").setRequiredValidationMessage(h.getMessageById(i.ENTER_OLD_PASSWORD)).andAppendTo(a),n().withLabel(h.getMessageById(i.NEW_PASSWORD)).andLong().passwordField().withName("_newpassword").setRequiredValidationMessage(h.getMessageById(i.ENTER_NEW_PASSWORD)).andAppendTo(a),n().withLabel(h.getMessageById(i.CONFIRMATION)).andLong().passwordField().withName("_confirmation").setRequiredValidationMessage(h.getMessageById(i.ENTER_CONFIRM_NEW_PASSWORD)).andAppendTo(a)},t=function(a,c,d,e,f,g){b.sendEvent({UserInformation:{UserLogin:{UserName:p(a,d),Password:o(c),Client:e,Language:f,StoreCredentials:g}}},b.callback)},u=function(c,d,f){var g=e.isSAPDriver(b.gui);b.sendEvent({UserInformation:{UserLogin:{UserName:c,Password:o(d),Client:g?a("input[name=_client]").val():"",Language:g?a("input[name=_language]").val():"",Node:o(f)}}},b.callback)},v=function(b,c){b.append(a("<button></button>").attr("type","submit").attr("name","changePasswordOkButton").addClass("arcMsgBox-button").text(h.getMessageById(i.OK)).click(function(d){var e=a("input[name=_newpassword]",c).val(),f=a("input[name=_confirmation]",c),g=f.val(),j=a("input[name=_oldpassword]").val();b.closest("form")[0].checkValidity()&&(e!==g?f[0].setCustomValidity(h.getMessageById(i.CONFIRM_PASSWORD_NOT_MATCH)):(f[0].setCustomValidity(""),d.preventDefault(),u(a("input[name=_user]").val(),j,e),a.modal.close()))})),ARCPLAN.showCancelButton!==!1&&b.append(a("<button></button>").addClass("arcMsgBox-button").attr("name","changePasswordCancelButton").text(h.getMessageById(i.CANCEL)).click(function(b){b.preventDefault(),x(),a.modal.close()}))},w=function(){var c=a("input[name=_password]").val(),d=243,e=a("input[id=_arcUser]").is(":checked"),f=a("input[name=_storeCred]").length===1?a("input[name=_storeCred]").is(":checked"):0;e&&(d=244),b.sendEvent({UserInformation:{LoginUser:{AuthMode:d,UserName:a("input[name=_user]").val(),Password:o(c),StoreCredentials:f}}},b.callback)},x=function(){b.sendEvent({UserInformation:{UserLogin:{Cancel:!0}}},b.callback)},y={forUIRequest:function(a){return b.gui=a,this},withDoSendEvent:function(a){return b.sendEvent=a,this},withCallback:function(a){return b.callback=a,this},withChangeUserTypeForEngageLoginCallback:function(a){return b.changeUserTypeForEngageLoginCallback=a,this},andShowIt:function(){var c,g,k,o,p,u,y,z,A,B=1,C,D,E;if(typeof b.gui!="object"){d.warn("UserDialog: No GUI object.");return}if(typeof b.sendEvent!="function"){d.warn("UserDialog: No sendEvent function.");return}if(typeof b.callback!="function"){d.warn("UserDialog: No callback function.");return}c=j("arcMsgBox"),y=j("arcMsgBox-banner").appendTo(c),z=j("arcMsgBox-centerContent").appendTo(y),A=j("arcMsgBox-contentPanel").appendTo(z),u=a("<form></form>").attr("action","#").appendTo(A),ARCPLAN.disableAutocomplete===!0&&u.attr("autocomplete","off"),f.isLogonMixedKeepLogin(b.gui)?C=h.getMessageById(i.LOGIN):C=b.gui.UserLogin.Caption||b.gui.UserLogin.DriverName||h.getMessageById(i.USER_LOGIN),g=j("arcMsgBox-caption").text(C),u.append(g),typeof b.changeUserTypeForEngageLoginCallback=="function"&&(E=h.getMessageById(i.LOGIN_AS_ANOTHER_USER_TYPE),D=a("<a></a>").text(E),D.click(b.changeUserTypeForEngageLoginCallback),u.append(D)),k=j("arcMsgBox-content"),p=a("<table></table>").width("100%"),e.isSAPDriver(b.gui)&&(l().containingClientValue(b.gui.UserLogin.Client).containingLanguageValue(b.gui.UserLogin.Language).andAppendTo(p),B=2),f.isDomainLogin(b.gui)&&n().withLabel("Domain").andMedium().textField().withName("_domain").containingValue(q(b.gui.UserLogin.UserName)).withColSpan(B).andAppendTo(p),f.isLogonMixedKeepLogin(b.gui)&&m(p,b.gui.UserLogin.UserType),n().withLabel(h.getMessageById(i.USERNAME)).andLong().textField().withName("_user").containingValue(r(b.gui.UserLogin.UserName)).withColSpan(B).andAppendTo(p),n().withLabel(h.getMessageById(i.PASSWORD)).andLong().passwordField().withName("_password").withColSpan(B).andAppendTo(p),b.gui.UserLogin.ClientCredentialStorage==="true"&&n().withLabel(h.getMessageById(i.KEEP_LOGGEDIN)).and().checkboxField().withName("_storeCred").withColSpan(B).andAppendTo(p),k.append(p),u.append(k),o=j("arcMsgBox-buttonLine"),o.append(a("<button></button>").attr("type","submit").attr("name","loginOkButton").addClass("arcMsgBox-button").text(h.getMessageById(i.OK)).click(function(c){c.preventDefault(),f.isLogonMixedKeepLogin(b.gui)?w():t(a("input[name=_user]").val(),a("input[name=_password]").val(),f.isDomainLogin(b.gui)?a("input[name=_domain]").val():"",e.isSAPDriver(b.gui)?a("input[name=_client]").val():"",e.isSAPDriver(b.gui)?a("input[name=_language]").val():"",a("input[name=_storeCred]").is(":checked")),a.modal.close()})),ARCPLAN.showCancelButton!==!1&&o.append(a("<button></button>").addClass("arcMsgBox-button").attr("name","loginCancelButton").text(h.getMessageById(i.CANCEL)).click(function(b){b.preventDefault(),x(),a.modal.close()})),ARCPLAN.changePassword===!0&&e.isChangePasswordAllowed(b.gui)&&o.append(a("<button></button>").addClass("arcMsgBox-button").attr("name","changePasswordButton").text(h.getMessageById(i.CHANGE_PASSWORD)).click(function(b){b.preventDefault(),a("input[name=_user]",p).val()!==""&&(a("table tr",k).css("display","none"),a("button",o).remove(),s(p),v(o,p),g.text(h.getMessageById(i.CHANGE_PASSWORD)))})),u.append(o),a.modal.close(),c.modal({minWidth:400,overlayCss:{"background-color":"#222"},containerCss:{width:"100%",left:0},escClose:!1,zIndex:2000002,focus:!1,onShow:function(b){var c=a('input:text[value=""]',b.data)[0];c?c.focus():a("input",b.data)[0].focus()}})}};return y},j}),define("msgbox",["jquery","keycodes","stringtools","tools","logger","require","stringsres","stringsid","jquery.simplemodal"],function(a,b,c,d,e,f,g,h){var i={};return i.createMsgBox=function(){var b={options:{top:100,left:100,centered:!0,caption:g.getMessageById(h.INFORMATION_TITLE),text:g.getMessageById(h.INFORMATION_TEXT),fileUpload:{enabled:!1},comboBox:{enabled:!1,values:[]},indicator:"no-icon",modal:!0,log:!1,callback:{click:undefined,ok:undefined,yes:undefined,no:undefined,cancel:undefined,escCancel:undefined},withEscCancel:!0},result:{comboBoxSelection:-1},popupShown:!1,possibleIndicatorValues:["success","warning","info","error","question"]},i=function(a){var b="";a.log&&(b="MsgBox: "+a.caption+": "+a.text,a.indicator==="error"?e.error(b):a.indicator==="warning"?e.warn(b):e.info(b))},j=function(c){var d;c=c||{},d=c.data||{},b.options.comboBox.enabled===!0&&(b.result.comboBoxSelection=Number(a(".arcMsgBox-comboBox").find("option:selected").val())),b.popupShown=!1,a.modal.close(),typeof d=="function"&&d(b.result)},k=function(b,c,d){return a("<button></button>").addClass("arcMsgBox-button").addClass("arcToolbarMargin").addClass("arcMsgBox-buttonHeight").text(c).click(d,j)},l=function(b,c){var d,e,f,g;for(d=0;d<b.length;d+=1)b[d].text!==""&&(e=a("<a></a>",{target:"_blank",href:b[d].url,text:b[d].text,"class":"arcLink"}),b.length===1&&e.click(j),f=a("<div class='arcLinkContainer'></div>"),e.appendTo(f),c.append(f)),g=b[d].description,typeof g=="string"&&g!==""&&c.append(g)},m=function(b,c,d){var e,f=a("<a></a>",{target:"_blank",href:d[0].url,"class":"arcWordBreak"}),g=a("<button></button>",{text:c,"class":"arcMsgBox-button arcToolbarMargin arcMsgBox-buttonHeight"}).appendTo(f);return f.click(function(a){if(d.length>1)for(e=1;e<d.length;e+=1)window.open(d[e].url);j(a)}),f},n=function(b){var c=a("#fileUploadFrame"),d=a("<div id='arcUploadFailedContainer'></div>"),e=a("<div class='arcMsgBox-contentPanel'>"),f=a("<div></div>",{text:g.getMessageById(h.FILE_UPLOAD_FAILED),"class":"arcMsgBox-caption"}).appendTo(e),i=a("<div></div>",{text:c.contents().find("title").text()}).appendTo(e),j=a("<div class='arcMsgBox-buttonLine'></div>"),l=a("<button></button>",{text:g.getMessageById(h.SHOW_DETAILS),"class":"arcMsgBox-button arcToolbarMargin arcMsgBox-buttonHeight"});l.click(function(){a("#fileUploadFrame").css("display","block")}),i.prepend("</br>"),j.append(l),j.append(k("cancel",g.getMessageById(h.CANCEL),b.callback.cancel)),d.append(e),d.append(j),a("#arcFileUploadFrameContainer").prepend(d),a("#fileUploadFrame").css("display","none")},o=function(e){var o="",p={escClose:e.withEscCancel,onEscCloseCallback:e.callback.escCancel||e.callback.cancel,zIndex:2000002,overlayCss:{backgroundColor:"#000"},containerCss:{width:"100%",left:0}},q,r,s,t,u,v,w,x,y,z=f.toUrl("../res/import.html?"+ARCPLAN.version_argument),A=0;b.popupShown&&j(),b.popupShown=!0,e.log&&i(e),r=a("<div class='arcMsgBox-centerContent'></div>"),s=a("<div class='arcMsgBox-contentPanel'></div>"),b.options.fileUpload.enabled===!0?(q=a("<div></div>",{id:"arcFileUploadFrameContainer"}),x=a("<iframe></iframe>",{name:"fileUploadFrame",id:"fileUploadFrame","class":"arcFileUploadFrame","data-caption":e.caption,"data-text":e.text}).attr("src",z).load(function(){var c=a("#fileUploadFrame").contents();e.caption.length>0&&c.find("#importCaption").text(e.caption),e.text.length>0&&c.find("#importText").text(e.text),c.find("#importFileSelect").val(g.getMessageById(h.UPLOAD_BROWSE)),c.find("#importBtnOk").text(g.getMessageById(h.OK)),c.find("#importBtnCancel").text(g.getMessageById(h.CANCEL)),c.find("#uploadInProgress").text(g.getMessageById(h.UPLOAD_IN_PROGRESS)),typeof e.callback.cancel=="function"&&c.find("#importBtnCancel").click(e.callback.cancel),typeof e.callback.ok=="function"&&c.find("#importBtnOk").click(e.callback.ok),b.options.cgiUrl&&c.find("#importForm").attr("action",b.options.cgiUrl),x.on("load",function(a){n(e)})}),q.append(x)):(e.caption.length>0&&(v=a("<div class='arcMsgBox-caption'></div>"),v.text(e.caption),v.appendTo(s)),e.links?(w=a("<div class='arcMsgBox-contentPanel-openLink'></div>"),l(e.links,w)):(w=a("<div class='arcMsgBox-content arcWordBreak'></div>"),w.html(c.convertNewLineToHTMLBreaks(e.text))),w.appendTo(s),e.comboBox.enabled&&(w=a("<select class='arcMsgBox-comboBox'></select>"),d.iterateArcplanArray(e.comboBox.values,function(b,c){c!==""&&w.append(a("<option></option>").val(A).html(c)),A+=1}),w.appendTo(s)),t=a("<div class='arcMsgBox-buttonLine'></div>"),typeof e.callback.ok=="function"&&t.append(k("ok",g.getMessageById(h.OK),e.callback.ok)),typeof e.callback.yes=="function"&&t.append(k("yes",g.getMessageById(h.YES),e.callback.yes)),typeof e.callback.no=="function"&&t.append(k("no",g.getMessageById(h.NO),e.callback.no)),typeof e.callback.cancel=="function"&&t.append(k("cancel",g.getMessageById(h.CANCEL),e.callback.cancel)),e.links?(t.append(m("ok",g.getMessageById(h.OK),e.links)),t.append(k("cancel",g.getMessageById(h.CANCEL),e.callback.cancel)),a(".arcMsgBox-contentPanel-openLink > a").click(j)):a("button",t).length===0&&t.append(k("ok",g.getMessageById(h.OK),e.callback.click)),u=a("<div class='arcMsgBox-banner'></div>"),q=a("<div class='arcMsgBox'></div>"),s.css("max-height",a(window).height()*.8+"px"),s.appendTo(r),t.appendTo(r),r.appendTo(u),u.appendTo(q)),a.modal.close(),q.modal(p)},p={at:function(a,c){return typeof a=="number"&&(b.options.top=a,b.options.centered=!1),typeof c=="number"&&(b.options.left=c,b.options.centered=!1),this},withCaption:function(a){return typeof a=="string"&&(b.options.caption=a),this},withText:function(a){return typeof a=="string"&&(b.options.text=a),this},withFileUpload:function(a){return b.options.fileUpload.enabled=!0,b.options.cgiUrl=a,this},withComboBox:function(a){return b.options.comboBox.enabled=!0,b.options.comboBox.values=a,this},indicating:function(a){var c;if(typeof a=="string")for(c=b.possibleIndicatorValues.length-1;c>=0;c-=1)b.possibleIndicatorValues[c]===a&&(b.options.indicator=a);return this},withCallback:function(a){return typeof a=="function"&&(b.options.callback.click=a),this},withoutEscCancel:function(){return b.options.withEscCancel=!1,this},withEscCancelCallback:function(a){return b.options.callback.escCancel=a,this},withLink:function(a){return b.options.links=a,this},modeless:function(){return b.options.modal=!1,this},logIt:function(){return b.options.log=!0,this},onYes:function(a){return typeof a=="function"&&(b.options.callback.yes=a),this},onNo:function(a){return typeof a=="function"&&(b.options.callback.no=a),this},onCancel:function(a){return typeof a=="function"&&(b.options.callback.cancel=a),this},onOk:function(a){return typeof a=="function"&&(b.options.callback.ok=a),this},show:function(){o(b.options)},andShowIt:function(){this.show()},showInformation:function(){this.indicating("info").show()},showSuccess:function(){this.indicating("success").show()},showError:function(){this.indicating("error").show()},showWarning:function(){this.indicating("warning").show()}};return p},i}),define("openlinkaction",["msgbox","stringsres","stringsid","stringtools","require"],function(a,b,c,d,e){function h(a){return a==="171"?g.newWindow:a==="172"?g.sameWindow:g.noAction}function i(c,d,e){var f,g,h=c.length,i=a.createMsgBox();if(h>0)if(ARCPLAN.disableOpenLinkDialog)for(f=0;f<h;f+=1)window.open(c[f].url);else h===1?g=b.getMessageById(d):g=b.getMessageById(e),i.withCaption(g).withLink(c).andShowIt()}function j(a){var b,c,d="";if(a&&a.Elements){c=a.Elements.length;for(b=0;b<c;b+=1)d+="&userparam"+(b+1)+"="+a.Elements[b].Value}return d}function k(a,b){var c,f;return ARCPLAN.engage&&ARCPLAN.engage.server.defaultCgiUrl?(f="#arcplanClient?application="+a.Name+"&startDocName=application.apa&cgiUrl=",f+="&startDocName=application.apa&cgiUrl=",f+=encodeURIComponent(ARCPLAN.engage.server.defaultCgiUrl)):(c=d.removeRubbishFromClientBaseURL(window.require.toUrl("")),f=e.toUrl(c+"../res/start.html"),f.indexOf("?")!==-1?f+="&":f+="?",f+="startDocName=application.apa&application=",f+=a.Name,f+="&baseurl="+encodeURIComponent(c),f+="&cgiUrl="+encodeURIComponent(b)),f+=j(a.UserParameters),f}var f={},g={newWindow:"newWindow",sameWindow:"sameWindow",noAction:"noAction"};return f.executeOpenLinkAction=function(a){var b,d,e,f=a.Elements,j=[],k,l;if(f)for(b=0;b<f.length;b+=1)l=h(f[b].URL.Window),d=f[b].URL.v,e=d.toLowerCase().indexOf("mailto:")===0?!0:!1,l===g.newWindow||e===!0?j.push({text:d,url:d}):l===g.sameWindow&&e===!1&&(k=d);i(j,c.OPENLINK_TITLE,c.OPENLINK_ALL_TITLE),k&&(window.location.href=k)},f.executeOpenApplicationAction=function(a,d){var e=a.Elements,f=[];e&&e.length>0&&f.push({text:"",url:k(e[e.length-1].Application,d),description:b.getMessageById(c.OPEN_SPOTLIGHTLINK_DESCRIPTION)}),i(f,c.OPEN_SPOTLIGHTLINK_TITLE)},f}),define("filterpanel",["filterpanelpositioner-preserve-label-positions","objectresizer","properties","stringsres","stringsid"],function(a,b,c,d,e){function r(a){var b,c,d,e;e=$("<div class='arcFilterPanel-toolbar'></div> "),b=$("<button class='arcFilterPanel-button arcClickable arcFilterPanel-closeImage'></button>"),b.click(f.toggleFilterPanel),e.append(b),c=$("<button id='arcFilterPanel-pinButton' class='arcFilterPanel-button arcClickable arcFilterPanel-pinImage'></button>"),c.click(D),e.append(c),d=$("<button id='arcFilterPanel-saveButton' class='arcFilterPanel-button arcFilterPanel-saveImage disabled-image' disabled='true'></button>"),d.click(K),e.append(d),a.append(e)}function s(){var b=a.panelWidth(),c=parseInt(g.css("z-index"),10),d=$("<div id='arcFilterPanel'></div>");d.css("margin-left","-"+b+"px"),d.css("width",b+"px"),d.css("z-index",c+1),r(d),$("#arcContainer").append(d),o&&G(d)}function t(a){var b=c.getObjType(a);if(b==="Menu"||b==="MenuHierarchie"||b==="RadioGroup")if(c.isBookmarkObject(a)===!0)return!0;return!1}function u(a){var b=c.getLabelledByObjectID(a),d;if(b!==undefined){d=$("#"+b+".objContainer");if(d.length===1)return d}return undefined}function v(){var b,c,d=!1;return g.children().each(function(){b=$(this),t(b)&&(d=!0,c=u(b),c!==undefined?a.addLabelledFilterObject(b,c):a.addFilterObject(b))}),typeof i=="object"&&typeof i.hasFiltersChanged=="function"&&i.hasFiltersChanged(d),d}function w(){var b=a.panelWidth(),c,d,e,f;return c=h.outerWidth(),d=g.outerWidth(),e=(c-d)/2,f=b-e,f>0&&f>b&&(f=b),Math.max(0,f)}function x(){var a=$("#arcFilterPanel");a.get(0).scrollHeight>a.height()?a.find(".arcFilterPanel-toolbar:first").css("margin-right","2px"):a.find(".arcFilterPanel-toolbar:first").css("margin-right","10px")}function y(){h!==undefined&&k===!0&&m===!0&&(h.css("margin-left",w()+"px"),x())}function z(){h===undefined?g.css("margin-left",a.panelWidth()+"px"):h.css("margin-left",w()+"px")}function A(){h===undefined?g.css("margin-left","0px"):h.css("margin-left","0px")}function B(){$("#arcFilterPanel").on("click.hideFilterPanel",function(a){a.target===$("#arcFilterPanel")[0]&&J()})}function C(){$("#arcFilterPanel").off("click.hideFilterPanel")}function D(){m===!1?(z(),$("#arcFilterPanel").removeClass("arcFilterPanelNotPinned"),C(),m=!0):(A(),k&&$("#arcFilterPanel").addClass("arcFilterPanelNotPinned"),B(),m=!1),typeof i=="object"&&typeof i.changeDefaultIsPinned=="function"&&i.changeDefaultIsPinned(m)}function E(){a.moveObjectsIntoFilterPanel(),$("#arcFilterPanel").css("margin-left","0px"),x(),k=!0,m===!1&&$("#arcFilterPanel").addClass("arcFilterPanelNotPinned"),B()}function F(b){var c=b.find(".arcFilterPanel-toolbar:first").height(),d=a.getBoundsForSharedWidgetInfoElement(c),e="style='top: "+d.y+"px; left: "+d.x+"px;";return d.width===-1?e+="'":e+=" width: "+d.width+"px;'",e}function G(a){var b=F(a),c=$("<div id='sharedWidgetInfo' class='arcFilterPanel-text' "+b+"></div>");p===!0?c.html(H()):c.html(I()),c.appendTo("#arcFilterPanel")}function H(){var a=d.getMessageById(e.SHAREDWIDGET_OWNERINFO);return q===1?a+=d.getMessageById(e.SHAREDWIDGET_OWNERINFO_ONEUSER):q===0?a+=d.getMessageById(e.SHAREDWIDGET_OWNERINFO_NOUSERS):a+=d.getMessageById(e.SHAREDWIDGET_OWNERINFO_MANYUSERS).replace(/\{usercount\}/g,q),a}function I(){return d.getMessageById(e.SHAREDWIDGET_CONSUMERINFO).replace(/\{newline\}/g,"</br>")}function J(){var b=a.panelWidth();$("#arcFilterPanel").css("margin-left","-"+b+"px"),a.moveObjectsBackIntoDocument(g),k=!1,m===!0?D():$("#arcFilterPanel").removeClass("arcFilterPanelNotPinned"),C()}function K(){typeof i=="object"&&typeof i.changeDefaultBookmark=="function"&&j(function(b){i.changeDefaultBookmark(b.bookmark),$("#arcFilterPanel-saveButton").prop("disabled",!0),$("#arcFilterPanel-saveButton").addClass("disabled-image"),$("#arcFilterPanel-saveButton").removeClass("arcClickable")})}var f={},g,h,i,j,k=!1,l=!1,m=!1,n=30,o=!1,p=!0,q=0;return f.notifyDocumentLoaded=function(b){var c,d;if(typeof i!="object")return;k===!0&&J(),$("#arcFilterPanel").remove(),g=b,a.clear(),d=v(),d&&(c=b.closest($(".arcOuterDocContainerForWidgetHosting")),c.length===1?(h=c,h.addClass("arcFilterPanel-slidingLeftMargin")):(h=undefined,g.addClass("arcFilterPanel-slidingLeftMargin")),s(),l===!0&&(E(),setTimeout(function(){D()},0)))},f.setCreateBookmarkFunction=function(a){j=a},f.updateAfterLoadingObject=function(b){k===!0&&a.updateAfterLoadingObject(b)},f.toggleFilterPanel=function(){k===!1?E():J()},f.notifyFilterHasChanged=function(a){(p||o===!1)&&t($("#"+a))&&($("#arcFilterPanel-saveButton").prop("disabled",!1),$("#arcFilterPanel-saveButton").removeClass("disabled-image"),$("#arcFilterPanel-saveButton").addClass("arcClickable")),typeof i=="object"&&typeof i.filterChanged=="function"&&t($("#"+a))&&i.filterChanged(),k===!0&&m===!1&&J()},f.setEventListener=function(a){i=a},f.setIsInitiallyPinned=function(a){l=a},f.setIsSharedWidget=function(a){o=a},f.changeFilterPanelOnSharedWidgetToPrivate=function(){$("#sharedWidgetInfo").remove()},f.setSharedWidgetData=function(a){p=a.isOwner,q=a.consumerCount},$(window).resize(y),a.addToolbar(n),f}),define("splashscreen",["version","stringsres","stringsid"],function(a,b,c){function e(){var a=$("#arcSplashScreen");a.append('<div class="splash-Elem splash-wave"></div>')}function f(){var a=$("#arcSplashScreen");a.append('<div id="splash-arcplanText" class="splash-Elem"></div>'),a.append('<div id="splash-version" class="splash-Elem"></div>'),a.append('<div id="splash-arcplanLogo" class="splash-Elem"></div>')}function g(){var a,b;a=$("#arcSplashScreen"),a.append('<div id="splash-products" class="splash-Elem"></div>'),b=$("#splash-products"),b.append('<div id="splash-enterprise" class="splash-Elem splash-product"></div>'),b.append('<div class="splash-Elem splash-product splash-font-separator"></div>'),b.append('<div id="splash-engage" class="splash-Elem splash-product"></div>'),b.append('<div class="splash-Elem splash-product splash-font-separator"></div>'),b.append('<div id="splash-edge" class="splash-Elem splash-product"></div>')}function h(){var a,d;a=$("#arcSplashScreen"),a.append('<div id="splash-divider1" class="splash-Elem splash-Width"></div>'),a.append('<div id="splash-divider2" class="splash-Elem splash-Width splash-Font"></div>'),d=$("#splash-divider2"),d.append('<span id="splash-loading">'+b.getMessageById(c.SPLASHSCREEN_LOADING_APPLICATION)+"</span>"),d.append('<div id="splash-progressYellow" class="splash-Elem splash-progress"></div>'),d.append('<div id="splash-progressOrange" class="splash-Elem splash-progress"></div>'),d.append('<div id="splash-progressBlue" class="splash-Elem splash-progress"></div>')}function i(){var a,b;a=$("#arcSplashScreen"),a.append('<div id="splash-licenseArea" class="splash-Elem splash-Width splash-Font"></div>'),b=$("#splash-licenseArea"),b.append('<div id="splash-licenseType"></div>'),b.append('<div id="splash-licenseOwner"></div>'),b.append('<div id="splash-clientVersion"></div>')}function j(){$("#splash-clientVersion").append("HTML5 Client "+a.getReadableVersion())}function k(a){var b,c,d,e,f;b=Math.floor(a/16777216),c=Math.floor(a/65536)-b*256,d=Math.floor(a/256)-c*256-b*65536,e=a-d*256-c*65536-b*16777216,f=b+"."+c+"."+d+"."+e,$("#splash-clientVersion").append(" (arcplan Application Server: "+f+")")}function l(a){var b,c,d;b=a&1,c=a&16,d=a&65536,b&&$("#splash-enterprise").css("opacity",1),c&&$("#splash-engage").css("opacity",1),d&&$("#splash-edge").css("opacity",1)}function m(a,d){var e,f,g;e=$("#splash-licenseType"),f=!0,g=d&1048576,g&&e.append("OEM ");switch(a){case"301":e.append(b.getMessageById(c.EVALUATIONVERSION));break;case"302":f=!1;break;case"303":e.append(b.getMessageById(c.TESTORBACKUPVERSION));break;case"304":e.append(b.getMessageById(c.PARTNERVERSION))}f&&e.append(" - "+b.getMessageById(c.NOT_FOR_PR_USAGE))}function n(a){$("#splash-licenseOwner").append(b.getMessageById(c.LICENSEOWNER)),$("#splash-licenseOwner").append(a)}var d={};return d.show=function(){$("body").prepend('<div id="arcSplashContainer"><div id="arcSplashScreen" class="splash-Width"><div id="splash-top" class="splash-Elem splash-Width"></div></div></div>'),e(),f(),g(),h(),i(),j()},d.hide=function(){$("#arcSplashScreen").addClass("arcSplashSreenHide"),setTimeout(function(){$("#arcSplashContainer").remove()},500)},d.addLicenseInformation=function(a,b,c,d){k(a),l(b),n(d),m(c,b)},d}),define("menufilter",["jquery","ui","keycodes","properties"],function(a,b,c,d){function g(a){var b=d.getDatavirtualizationProperties(a);b&&b.isFilterResult&&(b.isFilterResult=!1,b.allRows=b.prevAllRows,b.firstElementInDOM=b.prevFirstElementInDOM,b.lastElementInDOM=b.prevLastElementInDOM,d.setNumRows(a,b.oriNumRows),d.setDatavirtualizationProperties(a,b))}function h(b){var c=a(b.currentTarget).val();c===""&&g(b.data.ref),e.requestMenuFilterResult(b.data.ref,c)}function i(b,c){var d=a("<div></div>",{"class":"arcMenuFilterInputContainer"}),e=b.width(),g=b.height(),h=a("<input></input>",{type:"text",id:f.constants.menuFilterInputId,value:c,"class":"arcMenuFilterInput"});return h.css({width:e-3+"px",height:g-2+"px"}),d.append(h),b.append(d),h}var e,f={constants:{menuFilterInputId:"arcMenuFilterTextInput"}};return require(["datavirtualization/datavirtualization"],function(a){e=a}),f.removeFilterInput=function(a){var b,c,d;a&&a.length>0&&(c=a.find(".arcHierPopupSelectionOverflowContainer").first(),d=c.find("#"+f.constants.menuFilterInputId),d.length>0&&(d.off("input.menufilter",h),d.parent().remove(),b=c.find(".arcHierPopupSelection").first(),b.show(),g(a)))},f.showMenuFilterInput=function(c){var g=c.ref,j=d.getDatavirtualizationProperties(g),k=g.find(".arcHierPopupSelectionOverflowContainer"),l=k.find(".arcHierPopupSelection").first(),m=k.find("#"+f.constants.menuFilterInputId),n,o=d.getNumRows(g);if(m.length>0||o===0)return;j.oriNumRows=o,j.prevAllRows=a.extend(!0,{},j.allRows),j.prevFirstElementInDOM=a.extend(!0,{},j.firstElementInDOM),j.prevLastElementInDOM=a.extend(!0,{},j.lastElementInDOM),l.hide(),e.updatePosition(g),m=i(k,l.text()),b.select(m),m.on("input.menufilter",c,h)},f}),function(a){typeof define=="function"&&define.amd?define("jquery-outside-events-plugin",["jquery"],a):a(jQuery)}(function(a,b,c){function d(d,e){function h(b){a(f).each(function(){var c=a(this);this!==b.target&&!c.has(b.target).length&&c.triggerHandler(e,[b.target])})}e=e||d+c;var f=a(),g=d+"."+e+"-special-event";a.event.special[e]={setup:function(){f=f.add(this),f.length===1&&a(b).bind(g,h)},teardown:function(){f=f.not(this),f.length===0&&a(b).unbind(g)},add:function(a){var b=a.handler;a.handler=function(a,c){a.target=c,b.apply(this,arguments)}}}}"$:nomunge",b=b||document,c=c||"outside",a.map("click dblclick mousemove mousedown mouseup mouseover mouseout change select submit keydown keypress keyup".split(" "),function(a){d(a)}),d("focusin","focus"+c),d("focusout","blur"+c),a.addOutsideEvent=d}),define("popuphandler",["jquery","events/eventid","tools","properties","logger","menufilter","menuhierarchyviewmodel","popupkeyeventhandler","popupcalculator","keycodes","jquery-outside-events-plugin","stringtools"],function(a,b,c,d,e,f,g,h,i,j,k,l){function t(b){var c=a("input",b),d;if(c.length>0){d=c[0].id.split("_");if(d&&d.length>4)return d[4]}}function u(a){return d.getSelectType(a)==="HierMultiSelect"?!1:!0}function v(b){a("#"+b).prop("checked")===!0?(a("#"+b).prop("checked",!1),a("#"+b).closest("li").removeClass("arcBoxHierSelected")):(a("#"+b).prop("checked",!0),a("#"+b).closest("li").addClass("arcBoxHierSelected"))}function w(b){a("#"+b).closest("li").find(".arcHpCbox").not("#"+b).each(function(){a(this).prop("checked",!1),a(this).closest("li").removeClass("arcBoxHierSelected")})}function x(b){a("#"+b).parents("li").children(".arcSelectable").each(function(){var c=a(this).children().first();c[0].id!==b&&(c.prop("checked",!1),c.closest("li").removeClass("arcBoxHierSelected"))})}function y(c,d){var f=d.split("_");return a("#"+c[0].id+" .arcHiddenSelected").remove(),a("#"+c[0].id+" .arcHpCbox").removeClass("arcHiddenSubtreeSelected").prop("checked",!1),a("#"+d).prop("checked",!0),e.log("switchNode "+d+" "+a("#"+d).prop("checked")),{stopPropagation:!0,sendEvent:!0,value:f[0],eventType:b.EID_SWITCH_HIERPOPUP}}function z(b){var c=a("#"+b[0].id+" .arcHpCbox:checked");return c=c.not(a(".arcHiddenSubtreeSelected")),e.log("getSelectedNodes "+b[0].id+" num:"+c.length),c}function A(b,c){var e=0,f;c?(f=d.getSelectionPath(b),f&&f.NumRows&&(e=parseInt(f.NumRows,10))):e=z(b).length,e===0?a("#"+b[0].id+" input[name='ok']").prop("disabled",!0):a("#"+b[0].id+" input[name='ok']").prop("disabled",!1)}function B(a){e.log("restoreCurrentSelection "+a[0].id),d.isUseContentPaging(a)?m.setSelectionFromPath(d.getSelectionPath(a),a):m.setSelectionFromPath(s.selectionPaths,a)}function C(a){var b;e.log("undoSelection "+a[0].id),d.isUseContentPaging(a)?(b=d.getOrigSelectionPath(a),d.setSelectionPath(a,b),g.applySelectionsToHierarchy(a),m.setSelectionFromPath(b,a),d.setOrigSelectionPath(a,undefined)):m.setSelectionFromPath(d.getSelectionPath(a),a)}function D(b){var c=a("#"+b),e=a("#"+b+" .arcHierPopupContent"),g=d.getZIndex(c);c.children().css("z-index",g),e.css({visibility:"hidden",display:"none","z-index":"auto",height:"10px"}),f.removeFilterInput(c),h.unregisterKeyEvents(c)}function E(){r&&(r(0),m.setCallBack(undefined))}function F(b){b.data&&n&&n[0]&&(C(b.data),D(b.data[0].id),a("#"+b.data[0].id+" .arcHierPopupContent").off("clickoutside",F),J(),n=undefined,o=undefined,E(),m.showPendingPopupPos())}function G(b,c){var e=d.getObjType(b),f=d.isUseContentPaging(b),h,i,j,k;f&&e==="MenuHierarchie"&&g.setPopupInvisible(b),m.unregisterOutSideEvent(b),J(),n=undefined,c!==!0&&(o=undefined),E(),b&&b.length>0&&(h=b.closest(".arcContainer"),h.length===0&&(j=d.getDocName(b),j&&(k=l.makeID(j,0),h=a("#"+k))),h.length>0&&h[0].id!=="arcContainer"&&(i=d.getDocSelectedObjectManager(h),i.setSelectedObject(undefined)))}function H(a,b,c){var e,f,g,h=d.getObjType(a),i,j,k;if(h==="Menu")e=b.find("input:checked:first-child");else if(h==="MenuHierarchie"){e=b.find("input .arcHpCbox[type=checkbox]:checked:first-child"),b=b.children().first();if(c){g=d.getScrollY(a),g&&b.scrollTop(g);return}}e&&e.length>0?(e=e.parent(),f=e.offset().top-b.offset().top+b.scrollTop(),b.scrollTop(f)):e&&ARCPLAN.datavirtualization!==!1&&(i=d.getRowHeight(a),k=d.getDatavirtualizationProperties(a),k&&(j=d.getDatavirtualizationProperties(a).checkedElements),f=-1,j&&j.length>0?f=i*j[0]:f=(d.getYSettingValue(a)-1)*Math.round(i),f!==-1&&(0===f&&b.scrollTop(1),b.scrollTop(f)))}function I(b){var c,d,e=b.parent();e.attr("id")==="arcFilterPanel"&&(d=b.children().first(),c=a(".arcInnerDocContainerForWidgetHosting",a("#arcContainer")),b.detach(),c.children().first().append(b),p={container:e,borderCss:d.css("border"),backgroundColorCss:d.css("background-color")},d.find(".arcHierPopup").css("display","none"),d.css({border:"none","background-color":"transparent"}))}function J(){var a;p&&(n.detach(),p.container.append(n),a=n.children().first(),a.css("border",p.borderCss),a.css("background-color",p.backgroundColorCss),a.find(".arcHierPopup").css("display","inline-block"),p=undefined)}function K(a){return a.hasClass("arcMenuSeparator")||a.parent().hasClass("arcMenuSeparator")||a.children().hasClass("arcMenuSeparator")||a.is("div")&&a.siblings().hasClass("arcMenuSeparator")}function L(a,b){var c=d.isMenuFilterEnabled(b),e=b.closest(".arcContainer"),g;m.isCurrentPopup(b)?c||G(n):(n&&G(n),n=b,c&&f.showMenuFilterInput(a.data),m.show(n,!1,a.data),e.length>0&&e[0].id!=="arcContainer"&&(g=d.getDocSelectedObjectManager(e),g.setSelectedObject(b[0].id)))}var m={},n,o,p,q=[],r,s={nodes:undefined,selectionPaths:{Elements:[]},getNodeGUID:function(a){var b;b=a.split("_");if(b&&b.length>4)return b[3]},setNodes:function(b){var f=this,g=d.isOneDimHasSumKnotLast(n);this.nodes=b,this.selectionPaths.Elements=[],e.log("setNodes start"),c.each(b,function(b,c){var d=[],e,h;d.push({VValue:{Type:"1",v:f.getNodeGUID(c.id)}}),e=a(c).closest("ul").closest("li");while(e[0])h=a(".arcHpCbox",e),h[0]&&(d.unshift({VValue:{Type:"1",v:f.getNodeGUID(h[0].id)}}),g?e=h.last().closest("ul").closest("li"):e=h.first().closest("ul").closest("li"));f.selectionPaths.Elements.push({Row:{Elements:d}})}),e.log("setNodes stop "+f.selectionPaths.Elements.length)},serialize:function(){var a="",b=this;return c.each(this.nodes,function(c,d){a=a+"<Row><nodeid>"+b.getNodeGUID(d.id)+"</nodeid></Row>"}),a}};return m.rememberSelection=function(a){s&&(e.log("rememberSelection"),s.setNodes(z(a)))},m.isCurrentPopup=function(a){return n&&n[0].id===a[0].id?!0:!1},m.setSelectionFromPath=function(b,f){function g(a){var b;if(a&&a.length>0){b=a.next();if(b.length>0)return b.prop("checked")}return!1}var h,i,j,k,l;b&&b.Elements&&(e.log("setSelectionFromPath "+f[0].id+" num: "+b.Elements.length),a(" .arcHiddenSelected",f).remove(),l=a(" .arcHpCbox",f),l.prop("checked",!1),l.removeClass("arcHiddenSubtreeSelected"),i=t(f),j=d.getShowRootNode(f),k=d.isOneDimHasSumKnotLast(f),c.iterateArcplanArray(b,function(b,d){var e=f,l,m=!1,n=!1,o=0,p;c.iterateArcplanArray(d,function(b,d){j||(o+=1),d&&d.v&&(h=c.makeNodeID("",o,1,d.v,i,"X"),e=a("li [id$='"+h+"']",e).parent().parent(),e.length>0?l=e:n=!0),j&&(o+=1)}),l&&(k?p=a("input.arcHpCbox",l).last():p=a("input",l).first(),m=g(p),n?n&&!m&&(p.prop("checked",!0),p.addClass("arcHiddenSubtreeSelected")):p.prop("checked",!0))}))},m.hideCurrentPopup=function(){n&&(C(n),G(n))},h.setHideCurrentPopupCallback(m.hideCurrentPopup),m.unregisterOutSideEvent=function(b){var c=b||n;c&&c[0]&&(D(c[0].id),a("#"+c[0].id+" .arcHierPopupContent").off("clickoutside",F))},m.setCallBack=function(a){r=a},m.showPendingPopupPos=function(){!n&&q.length>0&&m.showByPos(q)},m.show=function(a,b,c){var d,e;o?(d=i.getPopupRectByPos(a,o),e="auto"):d=i.getPopupRect(a),m.showByRect(a,b,d,c,e)},m.showByPos=function(a){var b,c=null,d="auto";q=a,q&&q.length>0&&(o={left:q[0].positionParams.x,top:q[0].positionParams.y,height:q[0].positionParams.height},b=q[0].objRef,q.splice(0,1),I(b),m.showByRect(b,!1,i.getPopupRectByPos(b,o),c,d))},m.showByRect=function(b,c,e,f,i){var j=1e6,k=b||n,l,o="",p="",q="auto",r,s="",t="",v=d.getObjType(b),w=d.isUseContentPaging(b);n&&n[0]&&b[0]&&n[0].id!==b[0].id&&G(n,!0);if(e.height===1){m.hideCurrentPopup();return}w&&v==="MenuHierarchie"&&g.setPopupVisible(b),l=a("#"+k[0].id+" .arcHierPopupContent"),o=e.left+"px",p=e.top+"px",e.width!=="auto"&&(q=e.width+"px"),r=e.height+"px",e.childrenHeight&&(t=e.childrenHeight+"px",l.children(":first").css("height",t)),l.off("clickoutside",F),l.on("clickoutside",b,F),i?b.children().css("z-index",i):b.children().css("z-index",j),u(b)&&(a("#"+k[0].id+" .arcHierPopupDlg").css("visibility","hidden"),s="1px solid #ddd"),c?B(k):d.setOrigSelectionPath(b,a.extend(!0,{},d.getSelectionPath(b))),A(k,w),n=b,l.css({left:o,top:p,visibility:"visible",display:"inline-block",width:q,height:r,"border-bottom":s,"z-index":j}),a(".arcHier .arcMenu",l).focus(),H(b,l,c),f&&h.registerKeyEvents(f,l)},m.getPopupRect=function(a){var b;return o?b=i.getPopupRectByPos(a,o):b=i.getPopupRect(a),b},m.onResize=function(){var b=n,c,d,e,f,g,h="";if(!b)return;c=a("#"+b[0].id+" .arcHierPopupContent"),m.getPopupRect(b);if(!d)return;e=d.left+"px",f=d.top+"px",g=d.height+"px",d.childrenHeight&&(h=d.childrenHeight+"px",c.children(":first").css("height",h)),c.css({left:e,top:f,height:g})},m.handlePopupFunctionEvent=function(b){var c=a(b),d=0;K(c)||(c.parent().hasClass("arcMenuItem")&&(c=c.parent()),c.is("li")&&(c.is("li")&&(d=c.prop("value")),d===0&&(d=c.text())),r(d),m.setCallBack(undefined),G(n))},m.handleMenuPopupEvent=function(c,d){var e=a("#"+c.data.id),f,g;return d.is("li")||d.parent().hasClass("arcMenuItem")?K(d)||(d.is("li")?f=d.val():f=d.parent().val(),G(n),g={value:f,eventType:b.EID_SWITCH}):d.hasClass("arcHierPopupSelection")||d.hasClass("arcHierPopup")||m.isCurrentPopup(c.data.ref)?L(c,e):G(n),g},m.handlePopupEvent=function(c,e){var f=a("#"+c.data.id),h,i={stopPropagation:!0,sendEvent:!1,value:undefined,eventType:b.EID_CLICK},j,k=d.isUseContentPaging(f),l;if(!m.isCurrentPopup(f))n&&(C(n),G(n)),n=f,m.show(n,!1);else if(e.hasClass("arcHierPopupSelection")||e.hasClass("arcHierPopup"))return u(f)||C(f),G(n),i;if(e.hasClass("arcHpCbox"))h=e[0].id,i.stopPropagation=!1;else if(e.hasClass("arcSelectable"))h=e.children(":first")[0].id,i.stopPropagation=!1;else if(e.is("LI"))h=e.attr("id"),h=h.replace(/_LI$/g,"_X"),v(h);else{l=e.is("SPAN");if(e.is("LABEL")||e.is("A")||l)l&&(e=e.parent()),h=e[0].id||e[0].htmlFor,h+="_X",v(h)}return h?u(f)?(i=y(f,h),s.setNodes(z(f)),d.setSelectionPath(f,s.selectionPaths),G(n)):(a("#"+h).prop("checked")===!0?(k&&g.selectNode(f,h.replace(/_X$/,"")),w(h),x(h)):a("#"+h).hasClass("arcHiddenSubtreeSelected")?(k&&g.deselectDescendants(f,h.replace(/_X$/,"")),w(h)):k&&g.deselectNode(f,h.replace(/_X$/,"")),k||s.setNodes(z(f)),A(f,k)):e.is("INPUT")&&!e.is(":disabled")&&e[0].type==="button"&&(e[0].name==="ok"?(k||(s.setNodes(z(f)),d.setSelectionPath(f,s.selectionPaths)),i.sendEvent=!0,k?(j=d.getSelectionPath(f),j.serialize=g.serializeSelection,i.value=j,d.setOrigSelectionPath(f,undefined)):i.value=s,i.eventType=b.EID_MULTISELECTION,G(f)):e[0].name==="cancel"&&(C(f),G(f))),i},m.handleMenuKeyPressEvent=function(b){var c=a("#"+b.data.id),e=c.closest(".arcContainer"),f=d.getDocSelectedObjectManager(e).getSelectedObject()===b.data.id;if(f){if(b.keyCode===j.ESC||b.keyCode===j.Tab)m.hideCurrentPopup(),a(":first",c).focus()}else if(b.keyCode===j.Enter||b.keyCode===j.Space)L(b,c),b.preventDefault(),b.stopImmediatePropagation()},window.jasmine&&(m.isSingleSelect=u,m.getNodeGUID=s.getNodeGUID,m.getObjID=t,m.toggleSelection=v,m.uncheckDescendants=w,m.uncheckAncestors=x,m.switchNode=y,m.getSelectedNodes=z,m.undoSelection=C),m}),define("datavirtualization/hierarchydatavirtualization",["properties","logger","tools","browserfeatures","datavirtualization/datavirtualizationhelper","datavirtualization/hierarchyhtmlgenerator","datavirtualization/htmltohiernodeparser","datavirtualization/hierdatatohiernodeparser","datavirtualization/hiernode","datavirtualization/menuhtmlgenerator","menuhierarchyviewmodel","popuphandler"],function(a,b,c,d,e,f,g,h,i,j,k,l){function s(a,b){var c,d,e;if(b){if(b.row===a)return b;if(b.nextDim&&typeof b.nextDim.row=="number"){c=s(a,b.nextDim);if(c)return c}if(b.children.length>0){d=b.children.length;for(e=0;e<d;e+=1){c=s(a,b.children[e]);if(c)return c}}}return c}function t(b,c,d,f,g,h,i){var j=Math.round(a.getRowHeight(b)),k,l,n,o,p,q=e.getDatavirtualizationProperties(b),r=a.getBorder(b),s={};return k=q.pageSize||m,l=Math.floor(k*j),n=f*l,g.height!==d&&(n-=(h.height-g.height)*g.top/(g.height-d),n=Math.max(n,0)),p=$(".firstVisible",c).position(),o=p?p.top:0,s={position:"relative",top:Math.max(Math.floor(n)-o,0)+"px",height:i*j+o+"px"},$("ol:first",b).css(s),s}function u(a,b,c,d,e){var g,h,i,j,k,l,m="";if(b.rowIndex){for(h=c;h<d;h+=1)i=b.rowIndex[h],typeof i=="object"?j||(j=i):(k=k!==undefined?k:h,l=h);typeof j=="object"&&(m=f.writeToHtmlStartingHere(j,d,m,null,a)),e.Start=k,e.End=l}else g=s(c,b.allRows.Root),typeof g=="object"&&(m=f.writeToHtmlStartingHere(g,d,m,null,a));return m}function v(b,c,d){var f=e.getDatavirtualizationProperties(b);d&&(f.allRows.Root=i.mergeNodes(f.allRows.Root,h.buildHierarchyDimension(d.ObjectData)),f.rowIndex=i.getRowIndex(f.allRows.Root),a.getObjType(b)==="MenuHierarchie"&&k.applySelectionsToHierarchy(b),c>0&&(p.updatePages(b,$(".arcHier",b),a.getScrollElem(b)),q.applyHierProperties(b,!0)))}function w(a,b,c){var d,e,f;typeof c.End!="undefined"&&typeof c.Start!="undefined"&&(f=c.End-c.Start+1,d=Math.floor(c.Start/n),e=Math.floor(c.End/n),b.requestProcessor&&b.requestProcessor.requestHierData(a,b.objectDataHash,c.Start,f,v))}function x(b,d,e,f,g,h){var i,j,k,n,o,p,q=Math.round(a.getRowHeight(b)),r,s=g.NumHierRows,v,x,y,z={},A=0,B=g.pageSize||m,C;j=B*q,v=Math.floor(h.top/j),x=Math.floor((h.top+f)/j),k=v*B,n=Math.min(s,(x+1)*B);if(k!==g.firstElementInDOM||n!==g.lastElementInDOM){i=u(b,g,k,n,z);if(a.getObjType(b)!=="MenuHierarchie"||l.isCurrentPopup(b))d[0].innerHTML=i;g.firstElementInDOM=k,g.lastElementInDOM=z.End!==undefined?z.End:n,w(b,g,z),A=z.End-z.Start+1,y=n-k-(A||0),C=t(b,d,f,v,e,h,y),g.innerHTML=i.replace(/^<ol>/,"<ol style='"+c.styleAsStringFromObject(C)+"'>")}}function y(a,b,c,d){a.checkedElements=[],a.allRows=[],a.firstElementInDOM=-1,a.lastElementInDOM=-1,a.rowIndex=null,a.requestProcessor=b,a.pageSize=d,b&&typeof b=="object"&&typeof b.removeHashFromObjectDataRequestList=="function"&&(b.objectDataHash?b.removeHashFromObjectDataRequestList(b.objectDataHash):b.removeHashFromObjectDataRequestList(c)),a.objectDataHash=c}function z(a,b,c){var d=document.createElement("div"),e,f=[0],h={};d.innerHTML=c,e=$(d.getElementsByTagName("ol")[0]),h.Root=g.buildHierarchyDimension(e,a,f),f[0]+=1,b.allRows=h,b.NumHierRows=f[0]}function A(b,c,d){var e,f={};f.Root=h.buildHierarchyDimension(d.ObjectData?d.ObjectData:d),c.allRows=f,c.NumHierRows=a.getNumRows(b),c.rowIndex=i.getRowIndex(f.Root),d.ObjectData&&d.ObjectData.Width?e=parseInt(d.ObjectData.Width,10):e=parseInt(d.Width,10),a.setContentWidth(b,e)}function B(b,c,d,e){var f,g,j=a.getPopupFont(b),k=parseInt(j.lineHeight,10);c.Root=h.buildHierarchyDimension(e.ObjectData?e.ObjectData:e),d.allRows=c,d.NumHierRows=a.getNumRows(b),d.rowIndex=i.getRowIndex(c.Root),e.ObjectData&&e.ObjectData.Width?f=parseInt(e.ObjectData.Width,10):f=parseInt(e.Width,10),g=f+p.c_sizeOfSelectionInput+k,d.menuContentWidth=Math.max(g,r)}function C(b,c){var d=a.getHeight(c)-1,f=Math.round(a.getRowHeight(c)),g=e.getDatavirtualizationProperties(c),h=g.pageSize||m,i=h*f;return a.getObjType(c)==="MenuHierarchie"&&(l.isCurrentPopup(c)?d=l.getPopupRect(c).height:d=h),d}var m=100,n=100,o=5,p={},q,r=165;return p.c_sizeOfSelectionInput=17,require(["objectpropertyapplier"],function(a){q=a}),p.updatePages=function(b,c,f){var g=e.getDatavirtualizationProperties(b),h=g.NumHierRows,i=Math.round(a.getRowHeight(b)),j=g.pageSize||m,k=j*i,l,n,o=c.hasClass("arcLine")?1:0,p={height:h*i+o},q,r;n=C(f,b),l={top:a.getScrollY(b)||0,height:Math.min(d.c_DivSizeLimit,p.height)},e.validateScrollPos(l,p,b),l.bottom=l.height-n-l.top,c.parent().height(l.height),e.convertScrollParams(l,p,n),k>0&&x(b,c,l,n,g,p)},p.init=function(c,d,g,h,i){var j,k,l;return k=e.getDatavirtualizationProperties(c),y(k,h,g,i),a.isAllowOpenClose(c)!==!1&&a.setAllowOpenClose(c,!0),typeof d=="string"?z(c,k,d):typeof d=="object"&&(A(c,k,d),f.generateHierarchyStub(c,h),d=null),l=Math.floor(a.getHeight(c)/a.getRowHeight(c)),l>=k.NumHierRows&&(a.setYSettingValue(c,0),a.setScrollY(c,0)),b.log("Initialized data virtualization (Hierarchy) for obj "+a.getID(c)),d},p.update=function(c,d,f,g,h){var i,j;return i=e.getDatavirtualizationProperties(c),y(i,g,f,h),a.isAllowOpenClose(c)!==!1&&a.setAllowOpenClose(c,!0),typeof d=="string"?z(c,i,d):typeof d=="object"&&(A(c,i,d),d=null),j=Math.floor(a.getHeight(c)/a.getRowHeight(c)),j>=i.NumHierRows&&(a.setYSettingValue(c,0),a.setScrollY(c,0)),b.log("Initialized data virtualization (Hierarchy) for obj "+a.getID(c)),d},p.initForHierarchyMenu=function(c,f,g,h,i){var k=e.getDatavirtualizationProperties(c),m,n={};return typeof f!="object"?f:(y(k,h,g,i),a.isAllowOpenClose(c)!==!1&&a.setAllowOpenClose(c,!0),j.generateMenuStub(c,h),j.setCurrentSelection(c,f),d.nativeTouchControls||(m=l.getPopupRect(c).height,$(".arcPopupContent",c).height(m)),B(c,n,k,f),b.log("Initialized data virtualization (menuhierarchy) for obj "+a.getID(c)+" with "+k.rowIndex.length+" entries"),null)},p.updateHierarchyMenu=function(c,f,g,h,i){var k=e.getDatavirtualizationProperties(c),l,m={};return typeof f!="object"?f:(y(k,h,g,i),a.isAllowOpenClose(c)!==!1&&a.setAllowOpenClose(c,!0),j.setCurrentSelection(c,f),l=C(c),d.nativeTouchControls||$(".arcPopupContent",c).height(l),B(c,m,k,f),b.log("Initialized data virtualization (menuhierarchy) for obj "+a.getID(c)+" with "+k.rowIndex.length+" entries"),null)},p}),define("datavirtualization/datavirtualization",["properties","logger","tools","datavirtualization/tablehtmlgenerator","datavirtualization/menuhtmlgenerator","browserfeatures","datavirtualization/hierarchydatavirtualization","datavirtualization/horizontalhierarchydatavirtualizationfactory","datavirtualization/horizontalhierarchydomupdaterfactory","datavirtualization/tabledatavirtualizationfactory","datavirtualization/propertyproviderfactory","datavirtualization/tabledomupdaterfactory","datavirtualization/tableviewhtmlgeneratorfactory","datavirtualization/datavirtualizationhelper","popupcalculator","popupkeyeventhandler","menuhierarchyviewmodel","datavirtualization/checkboxhtmlgenerator","datavirtualization/radiobuttonhtmlgenerator"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){function y(a,b,c,d){var e,f,g,h,i="";for(f=b;f<c;f+=1)e=a.allRows[f],typeof e=="string"?i+=a.allRows[f]:(g=g!==undefined?g:f,h=f);return d.Start=g,d.End=h,i}function z(b,c,d){var e,f,g;typeof d.End!="undefined"&&typeof d.Start!="undefined"&&(g=d.End-d.Start+1,e=Math.floor(d.Start/u),f=Math.floor(d.End/u),c.requestProcessor&&(a.getObjType(b)==="Menu"?c.isFilterResult||c.requestProcessor.requestObjectData(b,c.objectDataHash,d.Start,g,V):c.requestProcessor.requestObjectData(b,c.objectDataHash,d.Start,g,U)))}function A(b,c,d,e,f,g,h){var i=Math.round(a.getRowHeight(b)),j=n.getDatavirtualizationProperties(b),k=j.pageSize||t,l=Math.floor(k*i),m=c*l;e.height!==g&&(m-=(d.height-e.height)*e.top/(e.height-g),m=Math.max(m,0)),f.css({top:m+"px",height:Math.floor(h*i)+"px"})}function B(a,b,c){if(a.length>0){var d=$("tbody",c);d.length>0?f.canUseInnerHTMLOnTable?d[0].innerHTML=b:c[0].replaceChild($("<tbody>"+b+"</tbody>")[0],a[0]):a[0].innerHTML=b}}function C(b,c){var d=a.getHeight(c)-1;return a.getObjType(c)==="Menu"&&(d=o.getPopupRect(c).height),d}function D(b){return a.getObjType(b)==="Row"?a.getHeight(b)-1:Math.round(a.getRowHeight(b))}function E(b,c,d,e,g){var h,i,j,k,l={},m=0,o,p=a.getNumRows(b)||d.allRows.length,q,r,s,u,v=C(g,b),w,x=d.pageSize||t,E=a.getPattern(b),F=E&&E.ImageReference;o=D(b),i=Math.floor(x*o),s={height:Math.floor(p*o)+(a.getExtraScrollHeight(b)||0)},u={top:a.getScrollY(b)||0,height:s.height<f.c_DivSizeLimit?s.height:g.children(":first").height()||s.height},n.validateScrollPos(u,s,b),u.bottom=u.height-v-u.top,n.convertScrollParams(u,s,v),c.parent().height(s.height+(F?1:0)),q=Math.floor(s.top/i),r=Math.floor((s.top+v)/i),j=q*x,k=Math.min(p,(r+1)*x),h="";if(j!==d.firstElementInDOM||k!==d.lastElementInDOM)h=y(d,j,k,l),B(e,h,c),d.firstElementInDOM=j,d.lastElementInDOM=l.End!==undefined?l.End:k,z(b,d,l),m=l.End-l.Start+1;w=k-j-(m||0),A(b,q,s,u,c,v,w)}function F(b,c){var d,e,f=a.getDatavirtualizationProperties(b),g;d=$("tr:nth-child("+(c.y+1-f.firstElementInDOM)+")",b),$("td.selected",b).removeClass("selected"),b[0].id===a.getDocSelectedObjectManager(b.closest(".arcContainer")).getSelectedObject()&&(g=$("#arcTextInput").length===1,g||b.children(":first").focus(),d.length>0&&(e=$("td:nth-child("+(c.x+1)+")",d),e.length>0&&e.addClass("selected")))}function G(b,c,d,e){var f,g,h,i,j=a.getSelectedCell(b);f=n.getDatavirtualizationProperties(b),g=Math.round(a.getRowHeight(b)),i=f.pageSize||t,h=Math.floor(i*g),h>0?(E(b,d,f,c,e),j&&F(b,j)):(f.firstElementInDOM=-1,f.lastElementInDOM=-1,c.html(""))}function H(b,c,d){var e,f,g="",h,i,j=a.getSelectedCell(b);U(b,0,d,c.requestProcessor),i=c.allRows.length;for(e=0;e<i;e+=1)g+=c.allRows[e];B($("tbody",b),g,$("table",b)),i>0&&(c.firstElementInDOM=0,c.lastElementInDOM=i-1),j&&F(b,j)}function I(b,c,e){var f,g=a.getObjType(b);return g==="CheckboxGroup"?f=r.generateStub(b,c.requestProcessor):f=d.generateTableStub(b,c.requestProcessor),H(b,c,e),f}function J(a,b,c,d){a.allRows=[],a.firstElementInDOM=-1,a.lastElementInDOM=-1,a.checkedElements=[],b&&typeof b=="object"&&typeof b.removeHashFromObjectDataRequestList=="function"&&(b.objectDataHash?b.removeHashFromObjectDataRequestList(b.objectDataHash):b.removeHashFromObjectDataRequestList(c)),a.objectDataHash=c,a.requestProcessor=b,a.pageSize=d}function K(c,d,e,f,g){function u(a){h.allRows.push(a.outerHTML)}var h,i,o=a.getObjType(c),p,q,r,s,t={vertical:50,horizontal:16};if(ARCPLAN.use2ddatavirtualization!==!1&&o!=="CheckboxGroup"&&typeof d=="object")return r=k.createInstance(c),q=l.createInstance(c),s=m.createInstance(r),p=j.createInstance(c,s,q,r,f,t),a.setDatavirtualization(c,p),p.init(d,e),null;h=n.getDatavirtualizationProperties(c),J(h,f,e,g);if(typeof d=="object")i=I(c,h,d);else{i=S(d,"tbody","tr",u);if(i===null)return d}return b.log("Initialized data virtualization (table) for obj "+a.getID(c)+" with "+h.allRows.length+" rows"),i}function L(c,d,e,f,g){function j(a){h.allRows.push(a.outerHTML)}var h,i=null;return h=n.getDatavirtualizationProperties(c),J(h,f,e,g),typeof d=="object"&&H(c,h,d),b.log("Initialized data virtualization (table) for obj "+a.getID(c)+" with "+h.allRows.length+" rows"),i}function M(b,c){var d=b.clone(),f=a.isUseNativeMenu(b),g=e.buildHtmlForStringsArray(c,f),h,i=$("ul",d);return i.length>0&&c&&c.Elements&&c.Elements.length>0?(d.appendTo("body").css("visibility","hidden"),$(".arcPopupContent",d).css("display","inline-block"),$(".arcPopupContent",d).removeClass("arcMenu"),$(".arcPopupContent > div",d).removeClass("arcMenu"),i[0].innerHTML=g,h=i.width(),d.remove()):h=a.getWidth(b),h}function N(b,c,d){var g,h="",i,j,k=d.a,l,m=a.getNumRows(b);c.menuContentWidth=M(b,k),l=o.getPopupRect(b).height,!f.nativeTouchControls&&!a.isUseNativeMenu(b)&&$(".arcPopupContent",b).height(l);if(d.Rows&&d.Rows.Elements&&d.Rows.Elements.length>0){e.setCurrentSelection(b,d),j=parseInt(d.Rows.Elements[0].Row.Elements[0].Cell.r,10)-1,V(b,j,d,c.requestProcessor,!0),i=d.Rows.Elements.length;for(g=j;g<j+i;g+=1)h+=c.allRows[g];f.nativeTouchControls||a.isUseNativeMenu(b)?$("select",b)[0].innerHTML=h:$("ul",b)[0].innerHTML=h,i>0&&(c.firstElementInDOM=j,c.lastElementInDOM=j+i-1),(f.nativeTouchControls||a.isUseNativeMenu(b))&&(c.firstElementInDOM!==0||c.lastElementInDOM!==m-1)&&z(b,c,{Start:0,End:m})}else e.clearCurrentSelection(b)}function O(a,b,c){var d=e.generateMenuStub(a,b.requestProcessor);return N(a,b,c),d}function P(c,d,e,f){function j(a,b){var c,d;c=a.getElementsByClassName("arcMenuItemText")[0];if(!c)return;d=c.innerHTML.length,(h.length<100||d>h[0].textLength)&&h.push({textLength:d,html:b}),h.length>99&&d>h[0].textLength&&(h.sort(function(a,b){return a.textLength-b.textLength}),h.splice(0,1))}function k(){var a,b,c,d;c="";for(b in h)c+=h[b].html;return a=$(g),a.appendTo("body").css("visibility","hidden"),$(".arcPopupContent",a).css("display","inline-block"),$("ul",a).html(c),d=$("ul",a).width(),a.remove(),d}function l(a,b){var c,d;c=a.outerHTML,i.allRows.push(c),d=a.getElementsByTagName("input")[0],d&&d.checked&&i.checkedElements.push(b),j(a,c)}var g,h,i;h=[],i=n.getDatavirtualizationProperties(c),J(i,f,e);if(typeof d=="object")g=O(c,i,d);else{g=S(d,"ul","li",l);if(g===null)return d;i.menuContentWidth=k()}return a.setScrollY(c,0),b.log("Initialized data virtualization (menu) for obj "+a.getID(c)+" with "+i.allRows.length+" entries"),g}function Q(a,b,c,d){var e;e=n.getDatavirtualizationProperties(a),J(e,d,c),typeof b=="object"&&N(a,e,b)}function R(b,c,d,e){var f,g;return typeof c=="object"?(f=i(b),g=h(b,f,e),a.setDatavirtualization(b,g),g.init(c,d),null):c}function S(a,b,c,d){var e,f,g,h,i;e=document.createElement("div"),e.innerHTML=a,f=e.getElementsByTagName(b)[0];if(typeof f=="undefined")return null;g=f.getElementsByTagName(c),h=g.length;for(i=0;i<h;i+=1)d(g[i],i);return f.innerHTML="",e.innerHTML}function T(b){b.find(".arcPopupContent").css({"background-color":a.getBackgroundColor2(b)}),!f.nativeTouchControls&&!a.isUseNativeMenu(b)&&b.find(".arcMenu").css({height:Math.round(a.getRowHeight(b))*a.getNumRows(b)+"px"}),b.find(".arcMenu > ul").css({position:"absolute"})}function U(b,c,e){var f=n.getDatavirtualizationProperties(b),g=f.allRows,h=c,i=a.getObjType(b);e&&(i==="CheckboxGroup"?r.buildHtmlForRows(b,e,g,h):d.buildHtmlForRows(b,e,g,h),c>0&&x.updatePosition(b))}function V(b,c,d,g,h){var i=n.getDatavirtualizationProperties(b),j=i.allRows,k=c,l,m="",o;if(d){e.buildHtmlForRows(b,d,j,k);if(f.nativeTouchControls||a.isUseNativeMenu(b)){o=j.length;for(l=0;l<o;l+=1)m+=j[l];$("select",b)[0].innerHTML=m}else h||x.updatePosition(b)}}function W(a){$(".arcMenuFilterInput",a).addClass("loadingFilterResult")}function X(a){$(".arcMenuFilterInput",a).removeClass("loadingFilterResult")}function Y(b){var c=$(".arcHierPopupContent",b),d=o.getPopupRect(b),e={height:d.height+"px",top:d.top+"px"};d.height===1?(e.visibility="hidden",c.css(e)):(e.visibility="visible",c.css(e),a.setLastSelectedItem(b,undefined),c.scrollTop()>0?c.scrollTop(0):x.updatePosition(b),$(".arcMenuItem:first",c).addClass("arcMenuItemSelected"))}function Z(b,c,d,f,g){var h=n.getDatavirtualizationProperties(b),i=c;h.filterToken===""?Y(b):d&&(h.isFilterResult=!0,h.allRows=[],h.checkedElements=[],h.firstElementInDOM=-1,h.lastElementInDOM=-1,d.NumCols="1",d.NumRows=0,d.Rows&&d.Rows.Elements&&(d.NumRows=d.Rows.Elements.length),a.setNumRows(b,d.NumRows),e.buildHtmlForRowsWithFilter(b,d,h.allRows,i),Y(b)),X(b)}var t=100,u=100,v=130,w,x={};return require(["objectpropertyapplier"],function(a){w=a}),x.requestMenuFilterResult=function(b,c){var d=0,e=1e5,f=n.getDatavirtualizationProperties(b),g;f.filterToken=c,g=f.requestProcessor.requestObjectDataWithFilter(b,f.objectDataHash,d,e,c,Z),g&&a.getWidth(b)>=v&&W(b)},x.updatePosition=function(b){if(!n.isDatavirtualizationActiveForObject(b))return;var c=a.getObjType(b),d=n.getDatavirtualizationProperties(b),e=d.requestProcessor,f=a.getDatavirtualization(b);if(f){f.updatePosition();return}switch(c){case"Table":case"Row":case"Column":case"CheckboxGroup":G(b,$("tbody",b),$("table",b),a.getScrollElem(b)),w.adjustTableSize(b,c),w.applyTableRowHeight(b,c),w.applyTableColumnWidth(b,c),w.updateImageRefs(e,b);break;case"Menu":G(b,$("ul",b),$("ul",b),$(".arcPopupContent",b)),T(b),p.resetSelectedItemInDOM(b);break;case"MenuHierarchie":case"VerticalHierarchie":if(c!=="MenuHierarchie"||d.allRows)a.getObjType(b)==="MenuHierarchie"&&q.applySelectionsToHierarchy(b),g.updatePages(b,$(".arcHier",b),a.getScrollElem(b)),w.applyHierProperties(b,!0);break;default:}},x.init=function(b,c,d,e,f){if(!n.isDatavirtualizationActiveForObject(b))return c;var h=a.getObjType(b),i,j;switch(h){case"Table":case"Row":case"Field":case"Column":case"CheckboxGroup":if(h==="Field"&&typeof c=="string")return c;return typeof c=="object"&&a.setUseContentPaging(b,!0),i=K(b,c,d,e,f),i;case"Menu":return i=P(b,c,d,e,f),i;case"MenuHierarchie":if(typeof c=="string")return c;return a.setUseContentPaging(b,!0),i=g.initForHierarchyMenu(b,c,d,e,f),i;case"VerticalHierarchie":return typeof c=="object"&&a.setUseContentPaging(b,!0),i=g.init(b,c,d,e,f),i;case"HorizontalHierarchie":return typeof c=="object"&&a.setUseContentPaging(b,!0),i=R(b,c,d,e),i;case"RadioGroup":if(typeof c=="string")return c;return s.generateStub(b),j=s.buildHtmlContent(b,c),B($("tbody",b),j,$("table",b)),null;default:return c}},x.update=function(b,c,d,e,f){if(!n.isDatavirtualizationActiveForObject(b))return c;var h=a.getObjType(b),i,j,k=a.getDatavirtualization(b);if(k)return k.update(c,d),null;switch(h){case"Field":case"Table":case"Row":case"Column":case"CheckboxGroup":if(h==="Field"&&typeof c=="string")return c;return typeof c=="object"&&a.setUseContentPaging(b,!0),i=L(b,c,d,e,f),i;case"Menu":return i=Q(b,c,d,e,f),i;case"MenuHierarchie":if(typeof c=="string")return c;return a.setUseContentPaging(b,!0),i=g.updateHierarchyMenu(b,c,d,e,f),i;case"VerticalHierarchie":return typeof c=="object"&&a.setUseContentPaging(b,!0),i=g.update(b,c,d,e,f),i;case"RadioGroup":if(typeof c=="string")return c;return j=s.buildHtmlContent(b,c),B($("tbody",b),j,$("table",b)),null;default:return c}},x}),define("scroll",["jquery","tools","stringtools","logger","properties","browserfeatures","textinput","scrollobserver","datavirtualization/datavirtualization"],function(a,b,c,d,e,f,g,h,i){function n(b,c,f){var g,h,i,j=null,k;k=a("embed",f).get();if(k.length>0){try{g=k[0].getSVGDocument()}catch(l){d.log("scrollChart: SVG document does not exists "+l+e.getDocName(f)+":"+e.getID(f))}if(g){h=g.getElementsByTagName("g");if(h){b||(b="0"),c||(c="0");for(i=0;i<h.length;i+=1)if(h[i]){switch(h[i].getAttribute("Scroll")){case"vert":j="translate(0,-"+c+")";break;case"hor":j="translate(-"+b+",0)";break;case"both":j="translate(-"+b+",-"+c+")";break;default:j=null}j&&h[i].setAttribute("transform",j)}}}else e.setPendingScrollPos(f,{left:b,top:c})}}function o(a){a&&a.vScrollbar===!1&&(a.lastPos=undefined,a.refresh())}function p(a){var b,c,d,f;d=e.getScrollBarObjVert(a),d&&(c=e.getIScrollInstance(d),o(c)),f=e.getScrollRefs(d),f||(f=e.getScrollRefs(a));if(f&&f.vert.length>0)for(b=0;b<f.vert.length;b+=1)c=e.getIScrollInstance(f.vert[b]),o(c)}function q(a,b){var c,f=!b.hasClass("arcHide-scrollbar-hori"),g=!b.hasClass("arcHide-scrollbar-vert"),m=e.getScrollHeight(a),n=e.getScrollWidth(a),q=b.height(),r=b.width();d.log("adding Touch event handler to "+e.getDocName(a)+":"+e.getID(a)),b.addClass("wrapper"),b.children("div").addClass("scroller"),c=e.getIScrollInstance(a),c&&c.destroy(),c=new window.iScroll(b[0],{bounce:!1,hideScrollbar:!0,hScrollbar:f,vScrollbar:g,onBeforeScrollStart:function(b){this.vScrollbar===!1&&(o(this),p(a)),b.changedTouches&&b.changedTouches.length>1&&b.preventDefault()},onScrollStart:function(){k||h.addScrolledObject(a),this.isEventObj=!0,this.lastPos===undefined&&(this.lastPos={left:0,top:0},this.scrollBarObj={vert:null,hori:null},this.scrollRefs={vert:null,hori:null}),this.scrollBarObj.vert=e.getScrollBarObjVert(a)||a,this.scrollBarObj.hori=e.getScrollBarObjHori(a)||a,e.getScrollRefs(this.scrollBarObj.vert)&&(this.scrollRefs.vert=e.getScrollRefs(this.scrollBarObj.vert).vert),e.getScrollRefs(this.scrollBarObj.hori)&&(this.scrollRefs.hori=e.getScrollRefs(this.scrollBarObj.hori).hori)},onTouchEnd:function(){this.isEventObj=!1},onScrollEnd:function(){this.isEventObj=!1,e.setScrollX(a,-this.x),e.setScrollY(a,-this.y),i.updatePosition(a),l=!1},onScrollMove:function(b,c,d){var f,g={left:0-(c||0),top:0-(d||0)},h,k=d===0,l=0-d+q>=m,o=c===0,p=0-c+r>=n,s;b&&(m&&!k&&!l||n&&!o&&!p)&&b.preventDefault(),e.setScrollX(a,g.left),e.setScrollY(a,g.top),this.lastPos===undefined&&(this.lastPos={left:0,top:0},this.scrollBarObj={vert:null,hori:null},this.scrollRefs={vert:null,hori:null}),this.lastPos.top!==g.top?(h=this.scrollRefs.vert,this.scrollBarObj.vert&&(s=e.getIScrollInstance(this.scrollBarObj.vert))):this.lastPos.left!==g.left&&(h=this.scrollRefs.hori,this.scrollBarObj.hori&&(s=e.getIScrollInstance(this.scrollBarObj.hori))),this.lastPos=g,s&&s.isEventObj===!1&&s.scrollTo(c,d);if(h)for(f=0;f<h.length;f+=1)s=e.getIScrollInstance(h[f]),s&&s.isEventObj===!1?s.scrollTo(c,d):e.getObjType(h[f])==="SVGContainer"&&j.scrollTo(h[f],undefined,-c,-d);i.updatePosition(a)}}),e.setIScrollInstance(a,c)}function r(a,b,c){var d;for(d=0;d<a.length;d+=1)j.scrollTo(a[d],undefined,b,c)}function s(a,b){var c,d,f;d=e.getScrollRefs(b),d||(d=e.getScrollRefs(a));if(d&&d.vert.length>0)for(c=0;c<d.vert.length;c+=1){f=e.getScrollElem(d.vert[c]);if(f&&f[0].scrollWidth>f.width())return!0}return!1}function t(a,b){var c,d,g,h,i=e.getScrollBarObjVert(b);return i?(d=e.getNumRows(i),g=e.getRowHeight(i),h=e.getHeight(i),c=d*g-h+2,s(b,i)&&(c+=f.scrollbarWidth),c):-1}function u(b){var c=function(){var c,d,n,o,p,q;if(b.data.ref){k||h.addScrolledObject(b.data.ref),c=e.getScrollRefs(b.data.ref),d=e.getScrollElem(b.data.ref);if(d&&d[0]){f.mobile&&b.originalEvent.preventDefault(),o=d[0].scrollLeft,p=d[0].scrollTop,q=t(p,b.data.ref);if(q>0&&p>q){d[0].scrollTop=q,i.updatePosition(b.data.ref);return}e.setScrollX(b.data.ref,o),e.setScrollY(b.data.ref,p),c&&(r(c.vert,undefined,p),r(c.hori,o,undefined),c.vert.length===0&&(n=e.getScrollBarObjVert(b.data.ref),n&&j.scrollTo(n,undefined,undefined,p)),c.hori.length===0&&(n=e.getScrollBarObjHori(b.data.ref),n&&j.scrollTo(n,undefined,o,undefined))),a("#arcTextInput").length===1&&g.recalcInputPosition(b.data.ref),l||m.onScroll(),i.updatePosition(b.data.ref)}}l=!1},d=!1;d=typeof e.getScrollRequestId(b.data.ref)!="undefined"?e.getScrollRequestId(b.data.ref):!1,ARCPLAN.scrollDirectly?c():(d&&window.cancelAnimationFrame(d),d=window.requestAnimationFrame(c),e.setScrollRequestId(b.data.ref,d))}function v(b){var c;ARCPLAN.datavirtualization!==!1&&(e.getObjType(b)==="Menu"||e.isUseContentPaging(b))&&(e.getObjType(b)==="Menu"?c=a(".arcPopupContent",b):c=a(".arcHierPopupInnerDiv",b),c.off("scroll.menuscroll"),c.on("scroll.menuscroll",function(){e.setScrollY(b,a(this).scrollTop()),i.updatePosition(b)}))}function w(a){var b=e.getObjType(a);return b==="MenuHierarchie"||b==="Menu"}function x(a){var b;b=e.getScrollElem(a),w(a)?v(a):b&&b[0]&&e.getObjType(a)!=="SVGContainer"&&(e.getScrollHeight(a)||e.getScrollWidth(a))&&(f.mobile&&window.iScroll?q(a,b):(b.off("scroll",u),b.on("scroll",{ref:a},u)))}function y(d,f,g){var h=e.getDocName(d),i=e.getScrollDeps(d),j,k,l;if(i)for(j=0;j<i[g].length;j+=1)k=c.makeID(h,i[g][j]),l=a("#"+k),l.length!==0&&b.arrayContainsJQueryObject(f,l)===!1&&(C(l)&&f.push(l),y(l,f,g))}function z(a,b){y(a,b,"vert")}function A(a,b){y(a,b,"hori")}function B(a,c){function d(a){var b=e.getScrollElem(a),c=!1,d=e.getObjType(a),f=e.getColumnWidth(a),g=e.getWidth(a),h=e.getHScrollBarAllowed(a);if(!h)return!1;switch(d){case"Table":case"Row":if(f.accumulatedColumnWidth>g&&e.getNumCols(a)>1)return!0;return!1;case"Field":return!1;default:return b&&(c=b.css("overflow-x")==="auto"),c&&b[0].clientWidth<b[0].scrollWidth}}function g(a,b){var c=e.getScrollElem(a),d,g,h=e.getObjType(a);if(!c)return;d=e.getExtraScrollHeight(a)>0;switch(h){case"Table":case"Column":g=e.getNumRows(a)*e.getRowHeight(a),g>144e4?g=c.find(":first").height():d&&(g+=e.getExtraScrollHeight(a));break;default:g=c.find(":first").height()}!d&&b?(g+=f.scrollbarWidth,c.find(":first").height(g)):d&&!b&&(g-=f.scrollbarWidth,c.find(":first").height(g)),e.setScrollHeight(a,g),b?e.setExtraScrollHeight(a,f.scrollbarWidth):e.setExtraScrollHeight(a,0)}if(c.length>0){var h=d(a),i=!1,j={};b.each(c,function(a,b){j[a]=d(b),i=i||j[a]}),i?g(a,!h):g(a,!1),b.each(c,function(a,b){g(b,(i||h)&&!j[a])})}}function C(a){return typeof a!="undefined"&&e.isVisible(a)===!0&&e.isAvailableInView(a)===!0}var j={},k=!1,l=!1,m;return require(["draganddrop"],function(a){m=a}),window.iScroll&&(window.iScroll.prototype.isEventObj=!1,window.iScroll.prototype.scrollBarObj={vert:null,hori:null},window.iScroll.prototype.scrollRefs={vert:null,hori:null},window.iScroll.prototype.lastPos={left:0,top:0}),j.scrollTo=function(a,b,c,f){var g=e.getIScrollInstance(a),h=!1;if(g){c===undefined&&(c=e.getScrollX(a)||0),f===undefined&&(f=e.getScrollY(a)||0);if(!b||c!==b[0].scrollLeft||f!==b[0].scrollTop)g.options.onScrollStart(),g.options.onScrollMove(undefined,0-c,0-f),g.options.onScrollEnd()}else b=b||e.getScrollElem(a),b&&b[0]?(c!==undefined&&c!==b[0].scrollLeft&&(l=!0,h=!0,b.scrollLeft(c)),f!==undefined&&f!==b[0].scrollTop&&(l=!0,h=!0,b.scrollTop(f)),h&&i.updatePosition(a)):a.children().first().hasClass("dynaChart")?n(c,f,a):d.log("No scrollElem in "+e.getObjType(a)+" "+e.getID(a))},j.updateScrollReferences=function(a){var b,c={vert:[],hori:[]},d=e.getDocName(a),f=e.getScrollDeps(a),g,h;if(C(a)){x(a);if(f){z(a,c.vert),A(a,c.hori),g=e.getScrollBarObjVert(a),h=e.getScrollBarObjHori(a),C(g)||(g=a),C(h)||(h=a);for(b=0;b<c.vert.length;b+=1)e.setScrollBarObjVert(c.vert[b],g),c.vert[b].addClass("arcHide-scrollbar-vert"),x(c.vert[b]);for(b=0;b<c.hori.length;b+=1)e.setScrollBarObjHori(c.hori[b],h),c.hori[b].addClass("arcHide-scrollbar-hori"),x(c.hori[b]);B(a,c.vert)}e.setScrollRefs(a,c)}},j.setIgnoreJavaScriptEvents=function(a){k=a},window.jasmine&&(j.onScroll=u),j.getScrolledObjects=h.getScrolledObjects,j.clearScrolledObjects=h.clearScrolledObjects,j.removeScrolledObjectsThatBelongToDocument=function(b,c){a.each(b.children(),function(a,b){h.removeScrolledObject(b)}),h.removeScrolledObjectsForIEFromDocument(c)},j.correctScrollPositionOfScrollObjectsForIE=function(a){h.correctScrollPositionOfScrollObjectsForIE()},j.clearScrolledObjectsForIE=function(){h.clearScrolledObjectsForIE()},j}),define("objectpropertyapplier",["jquery","assert/assert","properties","logger","tools","propertytools","stylesheethandler","styleborderprops","stringtools","tooltiptypes","browserfeatures","scroll","objectresizer","taborderapplier","colortools","layoutmanagement/layoutbehavior"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function t(a){return c.getBackgroundColor(a)==="rgba(255,255,255,0.01)"||c.getBackgroundColor(a)===o.c_transparentColor}function u(b,d){var e,f,g,h,i=!1;e=c.getBorder(b),e.type==="1Point"?f=1:f=2,g=Number(e.top)*f+Number(e.bottom)*f,h=Number(e.left)*f+Number(e.right)*f,g>c.getHeight(b)&&(e.top=!1,e.bottom=!1,c.setBackgroundColor(b,e.color),c.setBorder(b,e),c.setHeight(b,Math.max(c.getHeight(b),f)),c.setHeightChanged(b,!0),i=!0),h>c.getWidth(b)&&(e.left=!1,e.right=!1,c.setBackgroundColor(b,e.color),c.setBorder(b,e),c.setWidth(b,Math.max(c.getWidth(b),f)),c.setWidthChanged(b,!0),i=!0),i&&(m.applyObjectDimensions(b),d==="Field"?a("#"+b[0].id+" > div table").css("backgroundColor",c.getBackgroundColor(b)):a("#"+b[0].id+" div").css("backgroundColor",c.getBackgroundColor(b)))}function v(b){var d=a("div:first",b);c.isActive(b)===!1?d.addClass("arcInactive"):d.removeClass("arcInactive")}function w(a){var b=c.getBorder(a);return b.left||b.right?!0:!1}function x(a){var b=c.getContentHeight(a);return typeof b=="undefined"&&(b=c.getNumRows(a)*c.getRowHeight(a)),b>c.getHeight(a)+s?!0:!1}function y(b){var d,e=c.getForegroundColor(b),f="."+i.makeClassName(b[0].id),h=c.getFont(b),j=c.getBorder(b),k={"text-decoration":h.textDecoration},l=a(f+" tr",b).hasClass("arcRadioSingleLine");g.setStyle(f,"color",e),g.setStyle(f,h),g.setStyle(f+" span > label",k),l&&(d=c.getHeight(b)-m.getVerticalAdjustment(j,b),g.setStyle(f,"height",d+"px"))}function z(b){var d=c.getPattern(b);a("#"+b[0].id+" > div:first"+(d&&d.ImageReference?"":" > div:first")).css("backgroundColor",c.getBackgroundColor(b))}function A(b){var d,e;c.hasFontChanged(b)&&(d=c.getFont(b),a("div:first",b).css(d)),c.setFontChanged(b,!1),c.hasPopupFontChanged(b)&&(e=c.getPopupFont(b)||null,e&&a(".arcHierPopupContent",b).css(e)),c.setPopupFontChanged(b,!1)}function B(b){var d;d=c.hasForegroundColorChanged(b),d&&a("div:first",b).css("color",c.getForegroundColor(b)),c.setForegroundColorChanged(b,!1)}function C(b){var d;c.hasFontChanged(b)&&(d=c.getFont(b),a("div:first",b).css(d)),c.setFontChanged(b,!1)}function D(b){var d;c.hasFontChanged(b)&&(d=c.getFont(b),a("table",b).css(d)),c.setFontChanged(b,!1)}function E(b){var d;d=c.hasForegroundColorChanged(b),d&&a("table",b).css("color",c.getForegroundColor(b)),c.setForegroundColorChanged(b,!1)}function F(a){return c.hasColumnWidthChanged(a)||(c.getObjType(a)==="Column"||c.getObjType(a)==="Field")&&c.hasWidthChanged(a)}function G(b){a("table",b).removeClass("arcHideVertGrid").removeClass("arcShowVertGrid").removeClass("arcHideHoriGrid").removeClass("arcShowHoriGrid")}function H(a){return a>r||ARCPLAN.datavirtualization!==!1}function I(b,d){var e=c.getGridColor(b),f=c.getGridType(b),h=c.getNumRows(b),j=i.makeClassName(b[0].id),k="."+j,l;if(f){G(b);switch(f){case"none":a("table",b).addClass("arcHideVertGrid"),a("table",b).addClass("arcHideHoriGrid");break;case"both":a("table",b).addClass(c.getObjType(b)==="Column"?"arcHideVertGrid":"arcShowVertGrid"),a("table",b).addClass("arcShowHoriGrid");break;case"horizontal":a("table",b).addClass("arcHideVertGrid"),a("table",b).addClass("arcShowHoriGrid");break;case"vertical":a("table",b).addClass(c.getObjType(b)==="Column"?"arcHideVertGrid":"arcShowVertGrid"),a("table",b).addClass("arcHideHoriGrid");break;default:}}a("table",b).addClass(j),D(b),E(b),q.adjustTableSize(b,d),K(b,d),q.applyTableRowHeight(b,d),q.applyTableColumnWidth(b,d);switch(d){case"Column":case"Table":if(c.getBackgroundColor2(b)){l=c.getPattern(b);if(!l||!l.PatternFormat)H(h)?(g.setStyle("table"+k+" tr:nth-child(even)","background-color",c.getBackgroundColor2(b)),g.setStyle("table"+k+" tr:nth-child(odd)","background-color",c.getBackgroundColor(b))):(a("tr:nth-child(even)",b).css("background-color",c.getBackgroundColor2(b)),a("tr:nth-child(odd)",b).css("background-color",c.getBackgroundColor(b)))}}d!=="Field"&&(H(h)?g.setStyle("table"+k+" td",{"border-right-color":e,"border-bottom-color":e}):a("td",b).css({"border-right-color":e,"border-bottom-color":e}))}function J(a){var b=!0,d=c.getObjType(a),e,f;return d==="Table"?(e=c.getBackgroundColor(a),f=c.getBackgroundColor2(a),e!==f&&c.getNumRows(a)!==0):!0}function K(b,d){var e,f=J(b),g="1px solid "+(f?o.c_transparentColor:c.getBackgroundColor(b)),h={},i={},j=c.getPattern(b),k=j&&j.ImageReference;if(!k)switch(d){case"Table":case"Column":case"CheckboxGroup":e=c.getBorder(b);if(e){e.top||(h["border-top"]=g,i["padding-top"]=""),e.bottom||(h["border-bottom"]=g),e.left||(h["border-left"]=g,i["padding-left"]=""),e.right||(h["border-right"]=g);if(!e.top||!e.right||!e.bottom||!e.left)b.children().first().css(h),a("table",b).css(i)}}}function L(b,c){var d=b.length,e,f,g,h;if(d>0)for(e=0;e<d;e+=1)f=a(b[e]),g=f.attr("data-origSize"),f.hasClass("arcImgScaleAllways")?f.height(c):typeof g=="string"&&(h=parseFloat(g.split(",")[1]),h>=c?f.height(c):f.height(h))}function M(a,b){a&&(b.overflowX&&a.css("overflow-x",b.overflowX),b.overflowY&&a.css("overflow-y",b.overflowY))}function N(a,b){var d=c.getColumnWidth(a),e,f=c.getRowHeight(a)*c.getNumRows(a),g,i,j,k,l,m;return d?(e=d.accumulatedColumnWidth,b!=="Table"&&b!=="Column"&&b!=="Row"&&b!=="CheckboxGroup"?{width:e,height:f}:(g=parseInt(c.getWidth(a),10),i=parseInt(c.getHeight(a),10),j=c.getBorder(a),k=h.getBorderWidth(j.type),j.left&&(g-=k.topLeft),j.right&&(g-=k.bottomRight),j.top&&(i-=k.topLeft),j.bottom&&(i-=k.bottomRight),e-g>=1&&e-g<=2&&b!=="Column"&&(e=g,l="hidden"),f=Math.floor(f),f-i>=-1&&f-i<=2&&b!=="Row"&&(f=i,m="hidden"),{width:e,height:f,overflowX:l,overflowY:m})):{}}function O(b){var d=a(".arcHier",b),e=c.getBorder(b),f=c.getGridType(b);d.hasClass("arcBox")&&f==="both"&&(e.left&&d.parent().css("margin-left","-1px"),e.top&&d.parent().css("margin-top","-1px"))}function P(b){var d=c.getObjType(b),e=a(".arcHier",b).parent(),f=c.getScrollElem(b),g,h,i,j=c.getBorder(b),l=m.getHorizontalAdjustment(j,b),n=m.getVerticalAdjustment(j,b);switch(d){case"VerticalHierarchie":O(b),!e.parent().is(".arcHideYScrollbar")&&f.css("overflow-y")==="auto"&&(g=c.getScrollWidth(b),g===undefined&&e.height()>e.parent().height()&&(i=m.getVertHierHoriLineHeight(b),g=Math.max(e.width()-k.scrollbarWidth,c.getWidth(b)-l-k.scrollbarWidth+i),e.css("width",g+"px"),c.setScrollWidth(b,g)));break;case"HorizontalHierarchie":f.css("overflow-x")==="auto"&&(h=c.getScrollHeight(b),h===undefined&&e.width()>e.parent().width()&&(h=Math.max(e.height()-k.scrollbarWidth,c.getHeight(b)-n-k.scrollbarWidth),e.css("height",h+"px"),c.setScrollHeight(b,h)))}}function Q(b,d){var e=d,f=c.getNumRows(b),g=c.getRowHeight(b),h=c.getBorder(b),i=m.getHorizontalAdjustment(h,b),j=m.getVerticalAdjustment(h,b),l=c.getHeight(b),n=c.getScrollElem(b),o=0;return ARCPLAN.datavirtualization!==!1&&c.isUseContentPaging(b)&&(n&&(o=f>0&&c.getVScrollBarAllowed(b)&&a(".arcHideYScrollbar",b).length===0&&f*g>l-j?k.scrollbarWidth:0),e=Math.max(d,c.getWidth(b)-i-o)),e}function R(a,b){var c;if(a.Elements){c=0;if(c+b<a.Elements.length)return a.Elements[c+b].Width-1}return typeof a.Width=="number"?a.Width:69}function S(b,c){var d=b.length,e,f,g,h,i,j,k;if(d>0)for(e=0;e<d;e+=1)g=a(b[e]),h=g.parent(),f=h.parent().children().index(h),i=R(c,f),j=g.attr("data-origSize"),g.hasClass("arcImgScaleAllways")?g.width(i):typeof j=="string"&&(k=parseFloat(j.split(",")[0]),k>=i-2?g.width(i-2):g.width(k))}function T(a,b){var c=a;return typeof c=="object"&&(typeof c.FaceName=="string"&&(c=e.toHTMLFont(c)),c=c[b]),c}function U(a,b,c,d){var e=a+" .LI_"+c+"_"+d;return b&&(b==="span"?e+=" .SPAN_"+c+"_"+d:e+='> div[draggable="true"] > '+b),e}function V(a,b,c,d,e){a[b]||(a[b]={prop:{},dim:0}),a[b].prop[d]=e,a[b].dim=c,a.maxDim=Math.max(a.maxDim,c)}function W(a,b,c){var d,f,g,h=c.postFix||"",i=e.toCamelCase(c.property);f=a-1,d=U(c.className,c.tagName,a,b),g=c.defaultProp,g instanceof Array&&(f<g.length?g=g[f]:g.length>0&&(g=g[g.length-1])),g=T(g,i),g&&V(c.levelPropertyBag,d,a,c.property,g+h)}function X(a,b,c,d){var f,g=d.postFix||"",h=e.toCamelCase(d.property),i=U(d.className,d.tagName,b,c);f=T(a[d.propName],h),V(d.levelPropertyBag,i,b,d.property,f+g)}function Y(a){var b,d=0,g=[],h=0,i=!1;if(a.propValArray){i=c.getShowRootNode(a.objRef),e.iterateArcplanArray(a.propValArray,function(a,b){var c,e,h,j,k,l;if(b.Range){e=parseInt(b.Range.Start.Column,10),h=parseInt(b.Range.End.Column,10);for(c=e;c<=h;c+=1){j=f.getLevelFromRowProp(b.Range.Start.Row,i),k=f.getLevelFromRowProp(b.Range.End.Row,i),d=Math.max(d,c);for(l=0;l<d;l+=1)g[l]||(g[l]=0);g[c-1]=Math.max(g[c-1],Math.max(j,k))}}}),e.iterateArcplanArray(a.propValArray,function(b,c){var d,e,j,k,l,m;if(c.Range){e=parseInt(c.Range.Start.Column,10),j=parseInt(c.Range.End.Column,10);for(d=e;d<=j;d+=1){k=f.getLevelFromRowProp(c.Range.Start.Row,i),l=f.getLevelFromRowProp(c.Range.End.Row,i);for(m=k;m<=l;m+=1)X(c,d,m,a);h=0;for(m=0;m<Math.min(g.length,d-1);m+=1)h=Math.max(h,g[m]);if(h>l)for(m=l+1;m<=h;m+=1)W(d,m,a);else W(d,l+1,a);h=g[d-1]}}});if(h>0)for(b=1;b<=h+1;b+=1)W(d+1,b,a)}}function Z(a,b){var c,d;if(!b)for(c=1;c<=a.maxDim;c+=1)for(d in a)a.hasOwnProperty(d)&&a[d].dim===c&&g.setStyle(d,a[d].prop)}function $(b,d,e){var f=c.getFont(b),h=c.getForegroundColor(b),i=c.getGridColor(b),j={maxDim:0},k;c.getObjType(b)==="MenuHierarchie"&&(f=c.getPopupFont(b),h=c.getForegroundColor2(b)),k=a("#"+b[0].id+" .arcHier"),k.hasClass("arcBox")?(e||(k.hasClass("arcLine")&&g.setStyle(d+" li","border-color",i),c.getObjType(b)==="HorizontalHierarchie"&&g.setStyle(d+" label","overflow","hidden")),Y({levelPropertyBag:j,objRef:b,className:d,property:"background-color",propName:"Color",propValArray:c.getBackgroundColors(b),defaultProp:c.getBackgroundColor(b)})):Y({levelPropertyBag:j,objRef:b,className:d,property:"background-color",propName:"Color",propValArray:c.getBackgroundColors(b),defaultProp:["#ffff00","#00ff00","#0000ff","#ff0000"],tagName:"span"}),Y({levelPropertyBag:j,objRef:b,className:d,property:"color",propName:"Color",propValArray:c.getForegroundColors(b),defaultProp:h}),Y({levelPropertyBag:j,objRef:b,className:d,property:"font-family",propName:"FontDescription",propValArray:c.getFonts(b),defaultProp:f}),Y({levelPropertyBag:j,objRef:b,className:d,property:"font-size",propName:"FontDescription",propValArray:c.getFonts(b),defaultProp:f}),Y({levelPropertyBag:j,objRef:b,className:d,property:"font-style",propName:"FontDescription",propValArray:c.getFonts(b),defaultProp:f}),Y({levelPropertyBag:j,objRef:b,className:d,property:"font-weight",propName:"FontDescription",propValArray:c.getFonts(b),defaultProp:f}),Y({levelPropertyBag:j,objRef:b,className:d,property:"text-decoration",propName:"FontDescription",propValArray:c.getFonts(b),defaultProp:f,tagName:"a"}),Y({levelPropertyBag:j,objRef:b,className:d,property:"text-decoration",propName:"FontDescription",propValArray:c.getFonts(b),defaultProp:f,tagName:"label"}),Z(j,e)}function _(b,d){var f,g,h,i,j,k=c.getDisplayStyle(b)==="BOX_STYLE";f=c.getSelectionPath(b),f&&c.getSelectType(b)!=="HierNoSelect"&&c.getObjType(b)!=="MenuHierarchie"&&(c.getDimensionNumber(b)>1?a("label, a, li:not(li ol label, li ol a, li ol li)",d).removeClass("arcHier-selected"):a("label, a, li",d).removeClass("arcHier-selected"),e.iterateArcplanArray(f,function(b,c){var f,l;g||(g=a("ol",d),h=g.children(":first").children("div[draggable='true']:first").children("input, a"),h[0]&&(l=h[0].id.split("_"),j=l[4])),h=g,i=undefined,f=0,e.iterateArcplanArray(c,function(b,c){var d;f+=1;if(c&&c.v){d=e.makeNodeID("",f,1,c.v,j),h=a("li [id$='"+d+"']",h).closest("li");if(h&&h.length>0)i=h;else return i=undefined,!1}}),i&&(k?i.addClass("arcBoxHierSelected"):i.addClass("arcHier-selected"))}))}function ba(a,b){var d=c.getPopupFont(a);d&&g.setStyle(b,{"font-family":d.fontFamily,"font-size":d.fontSize,"font-style":d.fontStyle,"font-weight":d.fontWeight,"text-decoration":d.textDecoration,color:c.getForegroundColor2(a)})}function bb(a,b){var d=c.getPopupGradientColorLeft(a),e=c.getPopupGradientColorRight(a),f=d+", "+e+")",h="linear-gradient(to right, "+f,i="-webkit-linear-gradient(left, "+f;g.setStyle(b,"background",i),g.setStyle(b,"background",h)}function bc(b){var d,e,f=i.makeClassName(b[0].id);t(b)&&a("#"+b[0].id+" .arcHierPopup").css("background-image","none"),a("ul",b).length>0&&(b.children().addClass(f),ba(b,"."+f+" li"),d=Math.round(c.getRowHeight(b)),g.setStyle("."+f+" li",{"line-height":d+"px","background-color":c.getBackgroundColor2(b)}),g.setStyle("."+f+" li:not(.arcMenuSeparator):hover",{"background-color":c.getHotTrackingBackColor(b),color:c.getHotTrackingFontColor(b)}),c.getShowSelectionArea(b)?(e="."+f+" .arcMenuSelectionDiv",g.setStyle(e,"height",d+"px"),bb(b,e)):a(".arcHierPopupContent",b).addClass("hideSelectionArea")),A(b)}function bd(a){var b,d,e,g,h=c.getObjType(a);e=m.getScrollableElement(a),e&&e[0]&&h!=="MenuHierarchie"&&(b=c.getYSettingValue(a),d=c.getRowHeight(a),g=Math.max(b-1,0)*d,0===g&&l.scrollTo(a,e,undefined,1),l.scrollTo(a,e,undefined,g),c.getColumnWidth(a)&&(b=c.getXSettingValue(a),c.getColumnWidth(a).width?(d=c.getColumnWidth(a).width,l.scrollTo(a,e,(b-1)*d,undefined)):(g=f.getScrollPosFromColumn(b-1,a),l.scrollTo(a,e,g,undefined))))}function be(b,c){this.update=function(d){var e;b.tagName==="EMBED"&&b.parentNode?(b.src=c,b.type="image/svg+xml",e=b.outerHTML,b.parentNode.replaceChild(a(e).get(0),b)):b.src=d}}function bf(b,c){var d,e,f,g,h,i=b.length,j,k;for(f=0;f<i;f+=1)g=b[f],g.lang&&(g.onerror="",d=g.lang.split(":"),d.length>1&&d[1]!=="-1-1"&&(g.tagName==="EMBED"?(j=a(g),j.attr("name",j.attr("name")+"_load"),e=c.buildChartRequest(d[1]),h=new be(g,e),h.update()):(e=c.buildObjectPictRequest(d[1]),h=new be(g,e),c.downloadPictToBrowserCache(e,h.update))))}function bg(a){var b=c.getToolTip(a),d=c.getObjType(a);if(b&&b.Elements&&b.Elements.length>=3&&a.children().length>=1)switch(d){case"Table":case"Row":case"Column":case"Field":bh(b,a);break;default:a.children(":first").prop("title",b.Elements[2].ToolTip)}}function bh(b,d){if(ARCPLAN.datavirtualization===!1){var e=d.children(":first"),f=0,g=0,h,i,k=c.getToolTipType(d),l=a("table",d),m,n,o,p,q;k===j.WholeObject?e.attr("title",b.Elements[2].ToolTip):e.attr("title",""),m=a("tr",l),h=m.length;for(f=0;f<h;f+=1){o=m[f],n=a("td",o),i=n.length;for(g=0;g<i;g+=1){p=a(n[g]);switch(k){case j.EachCell:q=2+(f*b.Elements[0].NumCols+g);break;case j.EachRow:q=2+f;break;case j.EachColumn:q=2+g;break;case j.WholeObject:q=b.Elements.length}q<b.Elements.length?p.attr("title",b.Elements[q].ToolTip).children().attr("title",b.Elements[q].ToolTip):p.attr("title",undefined).children().attr("title",undefined)}}}}var q={},r=100,s=2;return q.applyViewAvailability=function(b){c.isAvailableInView(b)?(b.css("display","inline"),a(":first",b).css("display","")):b.css("display","none")},q.applyBorderProperties=function(a,b){if(b==="Text"&&a.find("img").length>0)return;var c=i.makeClassName(a[0].id);u(a,b),h.setBorderStyle(c,a)},q.applyTabOrder=function(a){b(c.isAvailableInView(a)),n.applyTabOrder(a)},q.applyScrollBarAllowed=function(a){var b,d=c.getNumRows(a),e=c.getColumnWidth(a),f=e?e.numCols:1,g=c.getObjType(a),h=!0,i=!0,j,l,n,o,p=c.getBorder(a),r=c.getDatavirtualization(a),s;if(r)r.updatePosition();else{b=m.getScrollableElement(a),c.setScrollElem(a,b);if(b){switch(g){case"Menu":case"MenuHierarchie":return;case"Field":case"Column":case"Row":case"Table":case"CheckboxGroup":d<=1&&(h=!1),f<=1&&(i=!1)}o=N(a,g),g==="Row"||g==="Field"?b.css("overflow-y","hidden"):h&&c.getVScrollBarAllowed(a)?(j=m.getHorizontalAdjustment(p,a),l=c.getWidth(a)-j,l<=k.scrollbarWidth&&(l=k.scrollbarWidth+1,n=-j/2,b.css("left",n+"px")),b.css("overflow-y","auto"),b.removeClass("arcHideYScrollbar"),M(b,o),b.width(w(a)?l:c.getWidth(a))):(b.addClass("arcHideYScrollbar").css("overflow-y","auto"),x(a)&&(l=c.getWidth(a)+k.scrollbarWidth,b.width(l)),M(b,o),q.correctScrollElemWidthByOverflowYHidden(b,o,a)),i&&c.getHScrollBarAllowed(a)?b.css("overflow-x","auto"):b.css("overflow-x","hidden")}}},q.applyProperties=function(a){var b=!1;q.applyViewAvailability(a),b=m.applyObjectDimensionsWithoutScrollDepConUpdate(a),c.hasVisibleChanged(a)&&(c.isVisible(a)||a.html(""),c.setVisibleChanged(a,!1));if(c.isVisible(a)){bg(a);switch(c.getObjType(a)){case"VerticalHierarchie":case"HorizontalHierarchie":q.applyScrollBarAllowed(a),q.applyHierProperties(a),C(a);break;case"MenuHierarchie":q.applyHierProperties(a),A(a),B(a);break;case"Menu":bc(a),B(a);break;case"Field":case"Column":case"Row":case"Table":case"CheckboxGroup":q.applyScrollBarAllowed(a),I(a,c.getObjType(a));break;case"RadioGroup":y(a)}q.applyBorderProperties(a,c.getObjType(a)),z(a),v(a)}return c.setNumRowsChanged(a,!1),b},q.applyTableColumnWidth=function(b,d){var h=c.getColumnWidth(b),j=0,l=-1,n,o=c.getBorder(b),p=m.getHorizontalAdjustment(o,b),q,r,s,t,u=1,v="."+i.makeClassName(b[0].id),w,x,y=c.getDatavirtualization(b);if(y)y.updatePosition(),c.setColumnWidthChanged(b,!1);else if(F(b)){n=a("table:first",b);switch(d){case"Column":if(f.hasColumnVertScrollbar(b)){t=c.getWidth(b);if(o.type==="3D1"||o.type==="3D3")u=0;l=t-u-k.scrollbarWidth,n.css("width",l+"px")}break;case"Row":case"Table":case"CheckboxGroup":h.Elements&&(s=a("img",n),S(s,h),e.iterateArcplanArray(h,function(a,b){var c,d;a==="Width"&&(x=v+" tr:nth-child(1) td:nth-child("+(j+1)+")",c=Math.max(0,b-1),d={width:c+"px"},c===0?(d["border-width"]="0px",d.padding="0px"):(d["border-width"]="",d.padding=""),g.setStyle(x,d),j+=1)}),x=v+" tr:nth-child(1) td:nth-child("+(j+1)+")",w=g.getStyle(x,"width"),typeof w!="undefined"&&g.removeStyle(x,"width"),h.accumulatedColumnWidth<c.getWidth(b)&&(p=0),l=h.accumulatedColumnWidth-p,l=Q(b,l),isNaN(l)||(ARCPLAN.datavirtualization!==!1&&c.isUseContentPaging(b)&&c.getObjType(b)!=="CheckboxGroup"?n.css("width",l+"px"):n.css("width",h.accumulatedColumnWidth+"px"),n.parent().css("width",l+"px")));break;case"RadioGroup":break;default:l=h.accumulatedColumnWidth/h.numCols,l>0&&(l-=1,q=a("td",n),q.length>0&&(r=a("img",q),r.length>0&&(r.hasClass("arcImgScaleAllways")||r.width()>l)&&r.width(l)),n.is(".arcHideVertGrid")&&(l-=1),q.css("width",""),x=v+" tr:nth-child(1) td:nth-child(1)",g.setStyle(x,{width:Math.max(0,l)+"px"}))}c.setColumnWidthChanged(b,!1)}},q.applyTableRowHeight=function(b,d){var e=c.getBorder(b),h=f.getAdjustedRowHeight(b,d),j=h,l=c.getNumRows(b),m=c.getGridType(b),n,o=h,p,q,r,s,t,u="."+i.makeClassName(b[0].id),v=c.getDatavirtualization(b);if(typeof h=="number"&&h>=0){c.getFont(b)&&(o=Math.min(parseInt(c.getFont(b).lineHeight,10),j)),d==="Row"&&(p=a("table:first",b),f.hasRowHoriScrollbar(b)&&(h-=k.scrollbarWidth,j=h,p.height(j+"px")));if(d==="Row"||d==="Field"||c.hasRowHeightChanged(b)){d!=="Row"&&d!=="Field"&&H(l)?(m==="both"||m==="horizontal"?j+=k.zoomOffsetTableTdHeightWithBorder:j+=k.zoomOffsetTableTdHeightWithoutBorder,g.setStyle("table"+u+" tr",{height:j+"px","line-height":o+"px"}),g.setStyle("table"+u+" td > div",{height:j+"px","max-height":j+"px"}),g.setStyle("table"+u+" td",{height:j+"px"})):(a("table.dynaTable > tbody > tr",b).css({height:h+"px","line-height":o+"px"}),a("table.dynaTable > tbody > tr > td > div",b).css({"max-height":j+"px"}),a("table.dynaTable > tbody > tr > td",b).css({height:j+"px"})),n=Math.floor(l*h);switch(d){case"Column":case"Table":case"CheckboxGroup":p=a("table:first",b),ARCPLAN.datavirtualization===!1&&p.css("height",n+"px"),p.parent().css("height",n+"px"),v||(t=a("img",p),L(t,j));break;case"Row":ARCPLAN.datavirtualization===!1&&(n-=k.scrollbarWidth,a("table:first",b).height(n+"px"));break;case"Field":v||(p=a("table:first",b),s=a("td:first",p),r=a("img",s),r.length>0&&L(r,n))}}c.setRowHeightChanged(b,!1)}},q.correctScrollElemWidthByOverflowYHidden=function(a,b,c){a&&b.overflowY&&a.hasClass("arcHideYScrollbar")&&(a.removeClass("arcHideYScrollbar"),x(c)&&a.width(a.width()-k.scrollbarWidth))},q.adjustTableSize=function(b,d){var e,f,g,h=c.getBorder(b),i,j=c.getScrollElem(b),l,n;switch(d){case"Column":case"Row":case"Table":case"CheckboxGroup":n=N(b,d),e=n.width,e>=0&&d!=="Column"&&(l=Q(b,e),a("table:first",b).width(l+"px"),a("table:first",b).parent().width(l+"px")),c.hasNumRowsChanged(b)&&q.applyScrollBarAllowed(b),M(j,n),q.correctScrollElemWidthByOverflowYHidden(j,n,b)}d==="Row"&&c.getHScrollBarAllowed(b)&&e>=0&&e>c.getWidth(b)&&(g=c.getHeight(b),g-=m.getVerticalAdjustment(h,b),g-=k.scrollbarWidth,i=a("table:first",b),i.height(g+"px"),i.parent().height(g+"px"))},q.setOverflowForResizableHierarchy=function(a){var b=e.getDocContainerForObject(a),d=c.getObjType(a),f;if(c.isDocLayoutManaged(b)&&c.getLayoutBehavior(a)===p.EAdjustToContent){f=c.getScrollElem(a);switch(d){case"VerticalHierarchie":f.css("overflow-x","hidden");break;case"HorizontalHierarchie":f.css("overflow-y","hidden"),q.correctScrollElemWidthByOverflowYHidden(f,{overflowY:"hidden"},a)}}},q.applyHierProperties=function(b,d){var e,f,h,j,l,m,n=i.makeClassName(b[0].id),o,p,r,s,u=14,v,w,x=3,y=1,z=c.getObjType(b),A;p=b.children(),p.addClass(n),o=a("#"+b[0].id+" .arcHier"),e=Math.round(c.getRowHeight(b)),m=Math.ceil((e-14)/2),w=o.hasClass("arcLine"),w&&(e-=1),h=e,w&&(h+=k.zoomOffsetHeightWithBorder),_(b,o);if(o.hasClass("arcLine")){s=c.getBorder(b);if(!s.left||!s.top)j={},s.left||(j["border-left-width"]="1px"),!s.top&&!c.isOneDimHasSumKnotLast(b)&&(j["border-top-width"]="1px"),o.children().children().css(j)}j={height:e+"px"},l="."+n,d||(v=c.getFont(b),j.textDecoration=v.textDecoration,o.hasClass("arcBox")||(c.getShowIcons(b)?g.setStyle(l+" div span",{width:u/2+"px","border-width":y+"px","margin-right":x+"px"}):g.setStyle(l+" span","margin-right",u/2+x+y+"px")),g.setStyle(l+" span","margin-top",m+2+"px"),g.setStyle(l+" label",j),g.setStyle(l+" a",j),g.setStyle(l+" a::before",j),g.setStyle(l+" li",{"line-height":h+"px",textDecoration:v.textDecoration}),z==="HorizontalHierarchie"&&o.hasClass("arcBox")&&(r=c.getColumnWidth(b).width,o.hasClass("arcLine")?r-=1:g.setStyle(l+" div > ol > li > ul","margin-left",r-1+"px"),!o.hasClass("arcHoriBeside")&&!o.is(".arcHori.arcBeside")&&g.setStyle(l+" li > ul","margin-left",r+"px")),m=Math.round((c.getRowHeight(b)-14)/2),g.setStyle(l+" li > input","margin-top",m+"px")),$(b,l,d),z==="MenuHierarchie"&&(t(b)&&a("#"+b[0].id+" .arcHierPopup").css("background-image","none"),m=(h-u)/2,j={"margin-top":Math.round(m)+"px"},c.getSelectType(b)!=="HierMultiSelect"&&(j.opacity=0),g.setStyle(l+" input.arcHpCbox:not(:checked)",j),g.setStyle(l+" input.arcHpCbox:checked","margin-top",Math.round(m)+"px"),g.setStyle(l+" li > input:not(.arcHpCbox)","margin-top",Math.round(m)+"px"),k.compatibilityModeForCssPointerEvents()&&(g.setStyle(l+" label.arcSelectable:hover",{"background-color":c.getHotTrackingBackColor(b)}),g.setStyle(l+' label.arcSelectable:hover + div[draggable="true"] > input + label',{color:c.getHotTrackingFontColor(b)}),g.setStyle(l+' label.arcSelectable:hover + div[draggable="true"] > a',{color:c.getHotTrackingFontColor(b)})),c.getShowSelectionArea(b)===!0&&(A="."+n+" .arcMenuSelectionDiv",bb(b,A)),c.getShowSelectionArea(b)===!1&&a(".arcHierPopupContent",b).addClass("hideSelectionArea")),P(b),q.setOverflowForResizableHierarchy(b)},q.updateImageRefs=function(b,c){var d=a("img",c).not("[src]"),e=a("embed",c).not("[src]");bf(d,b),bf(e,b)},q.updateReferences=function(b,d,f,g){var h=[],j=f;if(!d||!d.Elements||d.Elements.length===0)return;e.iterateArcplanArray(d,function(b,d){var e,f;if(!d||!d.ObjID)return;d.Worksheet!==undefined&&(j=i.removeExtension(d.Worksheet)),e=i.makeID(j,d.ObjID),f=a("#"+e),m.adjustScrollDependentContentSize(f),l.updateScrollReferences(f),bd(f),d.ObjectData&&(d.ObjectProperties||(c.getScrollBarObjVert(f)&&h.push(c.getScrollBarObjVert(f)),c.getScrollBarObjHori(f)&&h.push(c.getScrollBarObjHori(f))))}),e.each(h,function(a,b){l.updateScrollReferences(b)}),q.updateImageRefs(g,a("#arcContainer"))},q}),define("arcplanobjects/propertybasedcontainer",["assert/assert","properties","objectresizer","components/datatranslators/taborderhelper","objectpropertyapplier","objectpropertysetter","tools","layoutmanagement/layoutbehavior","propertytools"],function(a,b,c,d,e,f,g,h,i){function j(a){return a.ViewAvailability==="true"}function k(c,e,g,h,j){var k,l,m,n,o,p,q,r=b.getObjType(j);a(typeof c=="object"),a(typeof e=="object"||typeof e=="undefined"),a(typeof g=="boolean"),k=Math.abs(parseInt(c.Position.XPos,10)),l=Math.abs(parseInt(c.Position.YPos,10)),m=Math.abs(parseInt(c.Width.Value,10)),n=Math.abs(parseInt(c.Height.Value,10)),o=b.isActive(j),p=d.translateTabOrder(o,c,h),typeof p!="undefined"&&b.setTabOrder(j,p),b.setOrigXPos(j,k),b.setXPos(j,k),b.setOrigYPos(j,l),b.setYPos(j,l),b.setOrigWidth(j,m),b.setWidth(j,m),b.setOrigHeight(j,n),b.setHeight(j,n),r==="Row"&&b.setRowHeight(j,n-1),r==="Field"&&b.setRowHeight(j,i.getAdjustedRowHeightForField(j)),b.setAvailableInView(j,c.ViewAvailability==="true"),e&&(q=j,f.setPropertiesByView(e,q))}function l(g,h,i,k,l){var m,n,o,p,q,r,s;a(typeof g=="object"),a(typeof h=="object"||typeof h=="undefined"),a(typeof i=="boolean"),m=Math.abs(parseInt(g.Position.XPos,10)),n=Math.abs(parseInt(g.Position.YPos,10)),o=Math.abs(parseInt(g.Width.Value,10)),p=Math.abs(parseInt(g.Height.Value,10)),q=b.isActive(l),r=d.translateTabOrder(q,g,k),typeof r!="undefined"&&b.setTabOrder(l,r),b.setOrigXPos(l,m),b.setXPos(l,m),b.setOrigYPos(l,n),b.setYPos(l,n),b.setOrigWidth(l,o),b.setWidth(l,o),b.setOrigHeight(l,p),b.setHeight(l,p),b.setAvailableInView(l,g.ViewAvailability==="true"),e.applyViewAvailability(l),h&&(s=l[0].id,f.setPropertiesByView(h,s),b.isVisible(l)&&j(g)&&(e.applyScrollBarAllowed(l),i||e.applyTableColumnWidth(l,b.getObjType(l)))),j(g)&&(c.applyObjectDimensions(l),e.applyTabOrder(l))}function m(a,b,c,d){e.applyScrollBarAllowed(d)}function n(a){b.getObjType(a)==="VerticalHierarchie"&&e.applyHierProperties(a)}function o(a){var c=b.getObjType(a);if(c==="Column"||c==="Table")b.setRowHeightChanged(a,!0),e.applyTableRowHeight(a,c)}function p(a,b){a.adjustObjectSizeIfNecessary(b)}function q(d,f){return{isVisible:function(){return b.isVisible(f)},isAvailableInView:function(){return b.isAvailableInView(f)},getXPos:function(){return parseInt(b.getXPos(f),10)},getYPos:function(){return parseInt(b.getYPos(f),10)},getWidth:function(){return parseInt(b.getWidth(f),10)},getHeight:function(){return parseInt(b.getHeight(f),10)},getOrigXPos:function(){return parseInt(b.getOrigXPos(f),10)},getOrigYPos:function(){return parseInt(b.getOrigYPos(f),10)},getOrigWidth:function(){return parseInt(b.getOrigWidth(f),10)},getOrigHeight:function(){return parseInt(b.getOrigHeight(f),10)},setXPos:function(c){a(typeof c=="number"),b.setXPos(f,c)},setYPos:function(c){a(typeof c=="number"),b.setYPos(f,c)},setWidth:function(c){a(typeof c=="number"),b.setWidth(f,c)},setHeight:function(c){a(typeof c=="number"),b.setHeight(f,c)},getLayoutBehavior:function(){return parseInt(b.getLayoutBehavior(f),10)},isResizeable:function(){return b.isResizeable(f)},setResizeable:function(c){a(typeof c=="boolean"),b.setResizeable(f,c)},moveToOriginalPosition:function(){b.setXPos(f,this.getOrigXPos()),b.setYPos(f,this.getOrigYPos()),b.setWidth(f,this.getOrigWidth()),b.setHeight(f,this.getOrigHeight())},resetForViewChange:function(a,c,e){k(a,c,e,b.getDocType(d)==="Dialog",f)},applyScrollBars:function(a,b,c){var d=$("#"+f);m(a,b,c,d)},applyHierProperties:function(){n(f)},applyTableRowHeight:function(){o(f)},adjustToContentIfNecessary:function(a){p(a,f)},render:function(){var a=$("#"+f),d=b.getObjType(a),i=g.getDocContainerForObject(a),j;if(a.length>0){e.applyViewAvailability(a);if(b.isAvailableInView(a)){c.applyObjectDimensions(a),e.applyTabOrder(a);if(b.isDocLayoutManaged(i)&&b.getLayoutBehavior(a)===h.EAdjustToContent){j=b.getScrollElem(a);switch(d){case"VerticalHierarchie":j.css("overflow-x","hidden");break;case"HorizontalHierarchie":j.css("overflow-y","hidden"),e.correctScrollElemWidthByOverflowYHidden(j,{overflowY:"hidden"},a)}}}}}}}function r(d,e){return{isVisible:function(){return b.isVisible(e)},isAvailableInView:function(){return b.isAvailableInView(e)},getXPos:function(){return parseInt(b.getXPos(e),10)},getYPos:function(){return parseInt(b.getYPos(e),10)},getWidth:function(){return parseInt(b.getWidth(e),10)},getHeight:function(){return parseInt(b.getHeight(e),10)},getOrigXPos:function(){return parseInt(b.getOrigXPos(e),10)},getOrigYPos:function(){return parseInt(b.getOrigYPos(e),10)},getOrigWidth:function(){return parseInt(b.getOrigWidth(e),10)},getOrigHeight:function(){return parseInt(b.getOrigHeight(e),10)},setXPos:function(d){a(typeof d=="number"),b.setXPos(e,d),c.applyObjectDimensions(e)},setYPos:function(d){a(typeof d=="number"),b.setYPos(e,d),c.applyObjectDimensions(e)},setWidth:function(d){a(typeof d=="number"),b.setWidth(e,d),c.applyObjectDimensions(e)},setHeight:function(d){a(typeof d=="number"),b.setHeight(e,d),c.applyObjectDimensions(e)},getLayoutBehavior:function(){return parseInt(b.getLayoutBehavior(e),10)},isResizeable:function(){return b.isResizeable(e)},setResizeable:function(c){a(typeof c=="boolean"),b.setResizeable(e,c)},moveToOriginalPosition:function(){b.setXPos(e,this.getOrigXPos()),b.setYPos(e,this.getOrigYPos()),b.setWidth(e,this.getOrigWidth()),b.setHeight(e,this.getOrigHeight()),c.applyObjectDimensions(e)},resetForViewChange:function(a,c,f){l(a,c,f,b.getDocType(d)==="Dialog",e)},applyScrollBars:function(a,b,c){m(a,b,c,e)},applyHierProperties:function(){n(e)},applyTableRowHeight:function(){o(e)},adjustToContentIfNecessary:function(a){p(a,e)}}}function s(a,b,c){var d,e;return c?(e=b,q(a,e)):(d=b,r(a,d))}return{createObjectContainerAdapter:s}}),define("arcplanobjects/objectcontainers",["assert/assert","stringtools","properties","arcplanobjects/propertybasedcontainer"],function(a,b,c,d){function e(a){return a.ViewAvailability==="true"}function f(a,b){var e=[],f=c.getDocObjects(a),g;return b?f&&f.length>0&&f.forEach(function(c){var f=d.createObjectContainerAdapter(a,c[0].id,b);e.push(f)}):(g=a.find(".objContainer"),g.each(function(c,f){var g=$(f),h=d.createObjectContainerAdapter(a,g,b);e.push(h)})),e}function g(a,d,e){var f=b.makeID(d,e),g,h=!1,i;return g=c.getDocObjects(a),g?h=g.some(function(a){if(a[0].id===f)return!0}):(i=a.find("#"+f),i.length!==0&&(h=!0)),h}function h(a,b,d){var e=c.getDocName(a),g;return g=b.getObjectContainersForDocument(e),g.concat(f(a,d))}function i(a,b,d){var e=c.getDocName(a);return b.isArcplanObjectAlreadyCreated(e,d)===!0?!0:g(a,e,d)}function j(a,e,f,g){var h=c.getDocName(a),i,j;return j=e.getObjectContainer(h,f),typeof j!="object"&&(g?j=d.createObjectContainerAdapter(a,b.makeID(h,f),g):(i=$("#"+b.makeID(h,f)),j=d.createObjectContainerAdapter(a,i,g))),j}return{getObjectContainersForDocument:h,doesObjectContainerExist:i,getObjectContainer:j}}),define("documentpositioner",["properties","stringtools","rect/rectfactory","arcplanobjects/objectcontainers"],function(a,b,c,d){function h(a,b){var c="<div class='arcOuterDocContainerForWidgetHosting'><div class='arcVerticalCenteredForWidgetHosting'><div class='arcInnerDocContainerForWidgetHosting'style='width: "+b.width+"px; "+"height: "+b.height+"px'>"+"</div>"+"</div>"+"</div>";a.wrap(c)}function i(a){return"arcContainerWrapper_"+a[0].id}function j(a,b,c){var d=i(a),e="<div class='arcDialogCenterOuter'> <div class='arcVerticalCentered'> <div id='"+d+"' class='arcHorizontalCentered'></div>"+"</div>"+"</div>",f,g={left:"0px",top:"0px",width:b+"px",height:c+"px"},h=$("#arcDialogCenter");h.length===0&&m(),$("#arcDialogCenter").append(e),f=$("#"+d),a.detach(),f.innerHtml="",f.append(a),f.css(g),$("#arcDialogCenter").css("display","block")}function k(a){var b=i(a),c=$("#arcDialogCenter"),d=$("#"+b,c),e=d.children(":last");e.length===1?(d.width(e.width()),d.height(e.height()),e.css("display","block"),c.css("display","block")):c.css("display","none")}function l(a){var b=$("#arcContainer");a.detach(),b.append(a),k(a)}function m(){var a="<div id='arcDialogCenter'></div>";$("#arcContainer").append(a)}var e={},f="3",g;return e.setArcplanObjectsManager=function(a){g=a},e.getDocContainer=function(a){var c=b.makeID(a,0);return $("#"+c)},e.createDocContainer=function(c){var d=b.makeID(c,0),e="#"+d,f=$(e);f.length===0&&($("#arcContainer").append("<div id='"+d+"' class='arcContainer'></div>"),f=$(e),a.setID(f,"0"),a.setDocName(f,c))},e.calculateObjectsRect=function(a,b){var e=c.createInstance(),f=d.getObjectContainersForDocument(a,g,b);return f.forEach(function(a){var b,c,d,f;a.isVisible()&&a.isAvailableInView()&&(b=a.getWidth(),c=a.getHeight(),f=a.getXPos(),d=a.getYPos(),b+f>e.width&&(e.width=b+f),c+d>e.height&&(e.height=c+d))}),e},e.calculateDocumentsRect=function(a){var b=c.createInstance(),d,e,f,g,h,i,j;return a&&a.children&&(h=a.children(),typeof h=="object"&&h.length>0&&$.each(h,function(a,c){c.style.display!=="none"&&(i=$(c),d=parseFloat(i.width()),e=parseFloat(i.height()),j=i.position(),f=j.left,g=j.top,d+f>b.width&&(b.width=d+f),e+g>b.height&&(b.height=e+g))})),b},e.closeDocumentDialog=function(a){var c=$("#arcDialogCenter"),d=b.makeID(a,0),e="#arcContainerWrapper_"+d,f=$(e,c),g,h;h=f.closest(".arcDialogCenterOuter"),h.remove(),c.children(":last").length===0&&c.css("display","none")},e.setDocumentPositionAndSizeStylesInCssMap=function(a,b,c,d,e,g){if(e)d.position="absolute",d.left=-g.left+"px",d.top=-g.top+"px";else if(c){if(b.WorksheetType!=="Dialog"||c.CenterState!==f)c.PositionX>0&&(d.left=c.PositionX+"px"),c.PositionY>0&&(d.top=c.PositionY+"px");c.Width>0&&(d.width=c.Width+"px",d.overflow="auto"),c.Height>0&&(d.height=c.Height+"px",d.overflow="auto"),d.position="absolute"}},e.setDocumentPositionAndSizeInProperties=function(b,c,d,e,g,h,i){d?(a.setDocFixedSize(b,!0),a.setDocHeight(b,e.bottom-e.top),a.setDocWidth(b,e.right-e.left)):c&&(c.CenterState===f&&a.setDocAutoCenter(b,!0),c.Width>0?(a.setDocFixedSize(b,!0),a.setDocWidth(b,parseInt(c.Width,10))):a.setDocWidth(b,h-g.left),c.Height>0?(a.setDocFixedSize(b,!0),a.setDocHeight(b,parseInt(c.Height,10))):a.setDocHeight(b,i-g.top))},e.createDocumentDiv=function(a,b,c,d,g){var i;return e.createDocContainer(a),i=e.getDocContainer(a),c?h(i,b):d&&d.CenterState===f&&g==="Dialog"&&($("#arcDialogCenter").length===0&&m(i),j(i,d.Width,d.Height)),i},e.updateDocumentContainer=function(b,c){var d=i(b),g=b.parent()[0].id===d,h={left:"",top:"",width:"100%",height:"100%"};c.CenterState!==f&&g&&l(b),c.CenterState===f&&!g&&a.getDocType(b)==="Dialog"&&j(b,c.Width,c.Height),c.Width>0&&c.Height>0?(c.PositionX>0&&(c.CenterState!==f||a.getDocType(b)!=="Dialog")&&(h.left=c.PositionX+"px"),c.PositionY>0&&(c.CenterState!==f||a.getDocType(b)!=="Dialog")&&(h.top=c.PositionY+"px"),h.width=c.Width+"px",h.height=c.Height+"px",b.css(h)):e.setDocSize(b,parseFloat($(window).width()),parseFloat($(window).height()))},e.getDocHeight=function(b){return a.getDocHeight(b)},e.getDocWidth=function(b){return a.getDocWidth(b)},e.setDocSizeInDataAttribute=function(a,b){var c,d,f=e.calculateObjectsRect(a,b);c=f.width+f.x,d=f.height+f.y,a.attr("data-doc-size",""+c+" "+d)},e.setDocSize=function(b,c,d,f){var g,h,i,j,k=b.css("display")!=="none"?b.offset():b.parent().offset();b&&!a.hasDocFixedSize(b)&&(g=e.calculateObjectsRect(b,f),h=g.width+g.x,i=g.height+g.y,c-parseFloat(k.left)>h?(b.width("100%"),a.setDocWidth(b,c-parseFloat(k.left))):(b.width(h),a.setDocWidth(b,h)),j=d-parseFloat(k.top),i=Math.max(j,i),b.height(i),a.setDocHeight(b,i))},e}),define("layoutmanagement/layoutmanagementfactory",["jquery","assert/assert","stringtools","properties","layoutmanagement/resizelinefactory","objectresizer","layoutmanagement/layoutbehavior","objectpropertyapplier","documentpositioner","arcplanobjects/objectcontainers","datavirtualization/propertyproviderfactory","rect/rectfactory","browserfeatures"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(l,n){function q(a,b,c,f,g,h){var i,k,m,n=d.getDocResizeLineMap(a);n===undefined&&(n={},d.setDocResizeLineMap(a,n)),m=j.getObjectContainersForDocument(a,p.arcplanObjectsManager,l),i=e.createResizeLine(m,c,f,g,h),n[b]!==undefined?k=n[b]:(k=[],n[b]=k),k.push(i)}function r(a){var b=d.getDocResizeLineMap(a);typeof b=="object"&&(Object.keys(b).forEach(function(b){var c=j.getObjectContainer(a,p.arcplanObjectsManager,b,l);c.setResizeable(!1)}),b={},d.setDocResizeLineMap(a,b))}function s(a,b){var c;r(a),c=j.getObjectContainer(a,p.arcplanObjectsManager,b,l),c.setResizeable(!0),q(a,b,e.constants.horizontal,c.getYPos()+c.getHeight(),c.getOrigYPos()+c.getOrigHeight(),c.getYPos()+c.getOrigHeight()),q(a,b,e.constants.vertical,c.getXPos()+c.getWidth(),c.getOrigXPos()+c.getOrigWidth(),c.getXPos()+c.getOrigWidth())}function t(a,b,c){var e=d.getDocInitialRect(a),f=d.isDocLayoutManaged(a),g=d.getDocResizeLineMap(a),h={width:b,height:c};f&&e&&e.height>0&&e.width>0&&Object.keys(g).forEach(function(a){var b=g[a];b.forEach(function(a){a.moveLine(h,e),a.adjustObjectSizesAndPositions()})})}function u(b){var c,e,f,g;c=d.getDocLayoutObjectID(b),typeof c=="string"&&j.doesObjectContainerExist(b,p.arcplanObjectsManager,c)&&(s(b,c),p.isFixedWindowSize?(e={left:0,top:0},f=p.fixedSizeForWidget.width,g=p.fixedSizeForWidget.height):(e=b.offset(),f=a(window).width(),g=a(window).height()),t(b,f-e.left,g-e.top))}function v(b){var c=0;return b.children().each(function(){var b=a(this).height();c=Math.max(c,b)}),c}function w(a){var b=i.calculateObjectsRect(a,l);d.setDocInitialRect(a,b)}function x(a,b,c){w(a),d.setDocLayoutInitialized(a,!0),o.updateLayout(a,b,c)}function y(a){b(typeof a=="object"&&typeof a.forEach=="function"),a.forEach(function(a){m.useChrome&&a.applyTableRowHeight(),a.applyScrollBars(),a.applyHierProperties()})}function z(a){var c=j.getObjectContainersForDocument(a,p.arcplanObjectsManager,l);b(typeof c=="object"&&typeof c.forEach=="function"),c.forEach(function(a){a.adjustToContentIfNecessary(o)})}function A(a,b,c){var e=d.getID(b),g=d.getOrigHeight(b),h=d.isVisible(b),i=h?Math.max(g,c):g,j,l,n=d.getBorder(b),o=h?f.getVerticalAdjustment(n,b):0,p=d.isDocLayoutManaged(a),q=k.createInstance(b);if(!p)return;h&&q.hasOwnHorizontalScrollBar()&&(c+=m.scrollbarWidth,i=Math.max(g,c));if(i!==d.getHeight(b)-o/2){s(a,e),j=d.getDocResizeLineMap(a)[e];for(l=0;l<j.length;l+=1){if(j[l].orientation===1)continue;j[l].setLocation(parseInt(d.getXPos(b),10),parseInt(d.getYPos(b),10)+parseInt(i,10)+o/2),j[l].adjustObjectSizesAndPositions()}}}function B(a,b,c){var e=d.getID(b),g=d.getOrigWidth(b),h=d.isVisible(b),i=h?Math.max(g,c):g,j,l,n=d.getBorder(b),o=h?f.getHorizontalAdjustment(n,b):0,p=d.isDocLayoutManaged(a),q=k.createInstance(b);if(!p)return;h&&q.hasOwnVerticalScrollBar()&&(c+=m.scrollbarWidth,i=Math.max(g,c));if(i!==d.getWidth(b)-o/2){s(a,e),j=d.getDocResizeLineMap(a)[e];for(l=0;l<j.length;l+=1){if(j[l].orientation===0)continue;j[l].setLocation(parseInt(d.getXPos(b),10)+i+o/2,parseInt(d.getYPos(b),10)),j[l].adjustObjectSizesAndPositions()}}}function C(b,c,e){var f,i,j;if(e!==g.EAdjustToContent)return;if(d.getObjType(b)==="VerticalHierarchie"){j=d.getContentWidth(b);if(typeof j=="undefined"){f=a("ol:first",b);if(f.length===0)return;j=f[0].scrollWidth}B(c,b,j)}else{i=d.getContentHeight(b);if(typeof i=="undefined"){f=a("ol:first",b);if(f.length===0)return;i=v(f)}A(c,b,i)}l||h.setOverflowForResizableHierarchy(b)}function D(a,b,c){var e=d.getObjType(a),f,h;switch(e){case"Row":if(c===g.EAdjustToContent||c===g.EAdjustToContentHorizontally)f=d.getColumnWidth(a).accumulatedColumnWidth,B(b,a,f);break;case"Column":if(c===g.EAdjustToContent||c===g.EAdjustToContentVertically)h=d.getRowHeight(a)*d.getNumRows(a),A(b,a,h);break;case"CheckboxGroup":case"Table":if(c===g.EAdjustToContent||c===g.EAdjustToContentHorizontally)f=d.getColumnWidth(a).accumulatedColumnWidth,B(b,a,f);if(c===g.EAdjustToContent||c===g.EAdjustToContentVertically)h=d.getRowHeight(a)*d.getNumRows(a),A(b,a,h)}}var o={},p={isFixedWindowSize:!1,fixedSizeForWidget:{},pendingDocuments:[],arcplanObjectsManager:undefined};return o.updateOnPageZoomAndScrollbarWidthChanged=function(a){var b=j.getObjectContainersForDocument(a,p.arcplanObjectsManager);y(b)},o.setArcContainerDivExtend=function(){var b=i.calculateDocumentsRect(a("#arcContainer"),l);a("#arcContainer").css("width",b.width).css("height",b.height)},o.updateLayout=function(c,e,f){b(c instanceof a);var g,h,j=c?d.getDocLayoutObjectID(c):undefined,k,q,r=a("#arcContainer"),s=r.css("display")!=="none"?r.offset():r.parent().offset(),t,v,x;d.isDocLayoutInitialized(c)&&(n.doViewsExist()||d.isDocLayoutManaged(c))&&(p.isFixedWindowSize?(k=p.fixedSizeForWidget.width,q=p.fixedSizeForWidget.height):(x=m.getWindowSize(),g=x.width,h=x.height,t=a("body"),v=t.get(0).scrollHeight>h&&t.css("overflow-y")!=="hidden",k=g-s.left+(v?m.scrollbarWidth:0),q=h-s.top),n.applyViewByClientSize(c,k,q,e,f)&&(o.resetLayoutManagement(c),w(c)),z(c),typeof j=="string"&&u(c),p.isFixedWindowSize||(typeof j=="string"&&(x=m.getWindowSize(),i.setDocSize(c,x.width,x.height,l),o.setArcContainerDivExtend(c)),i.setDocSizeInDataAttribute(c,l)))},o.addToPendingLayoutDocuments=function(a){var b=!1,c;for(c=0;c<p.pendingDocuments.length;c+=1)if(p.pendingDocuments[c]===a){b=!0;break}return b||p.pendingDocuments.push(a),p.pendingDocuments},o.updatePendingLayoutDocuments=function(c){var d,e=!0;b(typeof c=="object");for(d=0;d<p.pendingDocuments.length;d+=1)o.updateLayout(a("#"+p.pendingDocuments[d]),c,e);p.pendingDocuments.length=0},o.resetPendingLayoutDocuments_forUnitTests=function(){p.pendingDocuments.length=0},o.initialize=function(a,b){var c=!0;p.isFixedWindowSize=!1,x(a,b,c)},o.initializeWithFixedWindowSize=function(a,b,c){var d=!1;p.isFixedWindowSize=!0,p.fixedSizeForWidget=c,x(a,b,d)},o.resetLayoutManagement=function(a){var b;d.isDocLayoutManaged(a)&&(b=j.getObjectContainersForDocument(a,p.arcplanObjectsManager,l),b.forEach(function(a){a.moveToOriginalPosition()}))},o.adjustObjectSizeIfNecessary=function(b){var e=c.makeID(d.getDocName(b),0),f=a("#"+e),g=d.isDocLayoutManaged(f),h;if(!g)return;h=d.getLayoutBehavior(b),d.getObjType(b)==="VerticalHierarchie"||d.getObjType(b)==="HorizontalHierarchie"?C(b,f,h):D(b,f,h)},o.applyLayoutToUpdatedObject=function(a){f.applyObjectDimensions(a)},o.setArcplanObjectsManager=function(a){p.arcplanObjectsManager=a,i.setArcplanObjectsManager(a)},o.updateDomAfterLayoutManagementUpdate=function(a){if(l){var b=j.getObjectContainersForDocument(a,p.arcplanObjectsManager,l);b.forEach(function(a){a.render()})}},o}return{createInstance:n}}),define("responsivedesign/viewmanagementfactory",["jquery","assert/assert","logger","stringtools","properties","objectpropertyapplier","events/eventid","tools","documentpositioner","arcplanobjects/objectcontainers","responsivedesign/viewupdater"],function(a,b,c,d,e,f,g,h,i,j,k){function l(l){function o(a,b){return r(b,a).Name?!0:!1}function p(a,b){return q(a,b)}function q(a,b,c){var d=parseInt(a,10),f=c?e.getDocViews(c):undefined,g,i,j,k=!1,l,m,p,q=-1,r="";return n.viewRules!==""&&h.iterateArcplanArray(n.viewRules,function(a,b){b.IsStandard==="true"&&(r=b.Name);if(!c||o(b.Name,f)){j=parseInt(b.Width,10);if(q===-1||j<q)q=j,p=b.Name;j<=d&&(!c||o(b.Name,f))&&(!k||l<j)&&(k=!0,l=j,m=b.Name)}}),k||(!c||o(p,f)?m=p:m=r),m}function r(a,b){var c=0;if(typeof a=="object")for(c in a.Elements)if(a.Elements[c].View.Name===b)return a.Elements[c].View;return{}}function s(a,b){var c,d,e,f;e=typeof b.BaseProperties=="undefined",e?(c=b.TableProperties.BaseProperties,d=b.TableProperties.ObjectProperties):(c=b.BaseProperties,d=b.ObjectProperties),f=j.getObjectContainer(a,n.arcplanObjectsManager,b.ObjID,l),f.resetForViewChange(c,d,e)}function t(a,b){a.Layers&&a.Layers.Layer&&a.Layers.Layer.Layout&&i.updateDocumentContainer(b,a.Layers.Layer.Layout)}function u(b,d,g,h){var i=e.getDocViews(b),j=r(i,d),k,l=0,m;c.log("applying view: "+d);if(j&&j.arcplanDocument){k=j.arcplanDocument.Objects,a(".arcHideYScrollbar",b).css("overflow-y","auto").removeClass("arcHideYScrollbar");for(l in k.Elements)for(m in k.Elements[l])s(b,k.Elements[l][m]);!h&&g&&f.updateReferences(b,j.arcplanDocument.Objects,e.getDocName(b),g),t(j.arcplanDocument,b)}c.log("done applying view: "+d)}function v(a,b,c){var d=new Date,e=n.currentView===b;e&&c&&c.doSendEvent&&c.doChangeViewEventWithRetryIfWaiting(a,g.EID_ONVIEWCHANGED,b)}function w(a,b,c){var d;b!==n.currentView&&(n.currentView=b,d=e.getDocName(a),window.setTimeout(function(){v(d,b,c)},300))}function x(a,b,c,d){var f=!1;if(b!==e.getDocCurrentView(a)||d===!0)u(a,b,c,d),e.setDocCurrentView(a,b),f=!0;return f}function y(a,b,c){var d,e=a.Elements.length,f,g,h,i,j;for(d=0;d<e;d+=1){h=a.Elements[d];if(h.hasOwnProperty("View")&&h.View.Name===b){f=h.View.arcplanDocument.Objects.Elements.length;for(g=0;g<f;g+=1){i=h.View.arcplanDocument.Objects.Elements[g];for(j in i)if(i[j].hasOwnProperty("ObjID")&&i[j].ObjID===c)return i}}}return null}function z(b,c,f,g,h){var i=a("#"+d.makeID(d.removeExtension(c),0)),j,l;typeof i=="object"&&(l=e.getDocViews(i),j=y(l,f,b),typeof g=="object"&&j!==null&&k.updateViewBaseProperties(j,g),typeof h=="object"&&j!==null&&k.updateViewObjectProperties(j,h))}var m={},n={viewRules:"",currentView:"",arcplanObjectsManager:undefined};return m.setArcplanObjectsManager=function(a){b(typeof a=="object"),n.arcplanObjectsManager=a},m.applyViewByClientSize=function(a,b,c,d,e){var f=q(b,c,a),g=p(b,c),h=!1;return d.hasPendingUserinformation()||(h=x(a,f,d,e),w(a,g,d)),h},m.setViewRules=function(a,b,c){n.viewRules=a,n.currentView=p(b,c)},m.setInitialViewForDocument=function(a,b,c){var d=q(a,b,c);e.setDocCurrentView(c,d)},m.doViewsExist=function(){return n.viewRules!==""&&n.viewRules.Elements.length>0},m.updateViewProperties=function(a){m.doViewsExist()&&z(a.ObjID,a.Worksheet,a.View,a.BaseProperties,a.ObjectProperties)},m}return{createInstance:l}}),define("tablekeyboardhandler",["properties","keycodes","scroll","textinput","browserfeatures","datavirtualization/propertyproviderfactory","tools"],function(a,b,c,d,e,f,g){function i(a,b){var c=f.createInstance(a),d=c.getColumnWidth(b);return d<=0?!0:!1}function j(b,d){c.scrollTo(b,null,undefined,a.getRowHeight(b)*d.y)}function k(b,d){c.scrollTo(b,null,undefined,a.getRowHeight(b)*(d.y+1)-a.getHeight(b))}function l(a,b){var c=f.createInstance(a),d=0,e,g=c.getNumCols();if(b.x<g)for(e=0;e<b.x;e+=1)d+=c.getColumnWidth(e);return d}function m(a,b){var c=f.createInstance(a),d=0,e,g=c.getNumCols();if(b.x+1<=g)for(e=0;e<b.x+1;e+=1)d+=c.getColumnWidth(e);return d}function n(a,b){var d=l(a,b);c.scrollTo(a,null,d,undefined)}function o(b,d){var e=m(b,d);c.scrollTo(b,null,e-a.getWidth(b),undefined)}function p(b,c,d,e,f){var g,h,i,j,k,l=a.getDatavirtualizationProperties(b),m=d.x;l&&l.firstColumnInDOM&&(m-=l.firstColumnInDOM),j=s(b,e,f),g=j.x-d.x,h=j.y-d.y;if(g<=e&&h<=f){k=$("tr:nth-child("+(f-h+1)+")",c.parent()),i=$("td:nth-child("+(m+1)+")",k);if(i.length>0)return i}return undefined}function q(a,b,c,d){var e,f,g,h,i,j,k=b.index(),l=c.index();return d=d?d:1,d>1?g=$("tr:nth-child("+(l+d+1)+")",c.parent()):g=$(c[0].nextSibling),g.length>0&&(f=s(a,k,l+d),e=t(a,f.x,f.y),e?(h=e,i=p(a,g,e,k,l)):(i=$("td:nth-child("+(k+1)+")",g),h={x:f.x,y:f.y}),j={cell:i,cellIndex:h}),j}function r(a,b,c,d){var e,f,g,h,i,j=b.index(),k=c.index();return d=d?d:1,d>1?h=$("td:nth-child("+(j+d+1)+")",c):h=$(b[0].nextSibling),h.length>0&&(f=s(a,j+d,k),e=t(a,f.x,f.y),e?(g=e,h=p(a,c,e,j,k)):g={x:f.x,y:f.y},i={cell:h,cellIndex:g}),i}function s(b,c,d){var e=a.getDatavirtualizationProperties(b);return e&&(e.firstElementInDOM&&(d=e.firstElementInDOM+d),e.firstColumnInDOM&&(c=e.firstColumnInDOM+c)),{x:c,y:d}}function t(b,c,d){var e=a.getDatavirtualization(b);if(e)return e.getPrimaryCellIndex(c,d)}function u(a,b,c,d,e){var f,g,h,i,j,k,l,m,n;if(d||e)h=d?-1:0,i=e?-1:0,j=b.index(),k=c.index(),g=s(a,j,k),f=t(a,g.x+h,g.y+i),f?(l=f,m=p(a,c,f,j,k)):(m=$("td:nth-child("+(j+h+1)+")",e||c),l={x:g.x+h,y:g.y+i}),n={cell:m,cellIndex:l};return n}function v(a,b,c){return u(a,b,c,undefined,c[0].previousSibling)}function w(a,b,c){return u(a,b,c,b[0].previousSibling,undefined)}function x(b,c){var d,e,f,g,h,i,j=a.getNumRows(b),l=a.getSelectedCell(b);c.length>0&&(f=c.closest("tr"),i=c.closest("tr").index(),e=c[0].rowSpan,f.length>0&&(d=q(b,c,f,e),d?(l.x=d.cellIndex.x,l.y=d.cellIndex.y,c.removeClass("selected"),d.cell?(c=d.cell.addClass("selected").focus(),h=c.closest("tr").index(),h===i&&typeof l=="object"&&l.y<j&&(n(b,l),k(b,l))):(n(b,l),k(b,l))):(g=e>1?e:1,typeof l=="object"&&l.y+g<j&&(l.y+=g,k(b,l)))))}function y(b,c){var d,e,f,g,h;c.length>0&&(e=c.closest("tr")[0],g=c.closest("tr").index(),e&&(h=a.getSelectedCell(b),d=v(b,c,c.closest("tr")),d?(h.x=d.cellIndex.x,h.y=d.cellIndex.y,c.removeClass("selected"),d.cell?(c=d.cell.addClass("selected").focus(),f=c.closest("tr").index(),f===g&&typeof h=="object"&&h.y>0&&(n(b,h),j(b,h))):(n(b,h),j(b,h))):typeof h=="object"&&h.y>0&&(h.y-=1,j(b,h))))}function z(b,c){var d,e,f,g,h,k=a.getDatavirtualizationProperties(b),l=a.getSelectedCell(b),m=a.getNumCols(b),n=k.lastColumnInDOM||m-1,p=k.firstColumnInDOM||0,q=!0;if(c.length>0){g=c.closest("tr"),f=c[0].colSpan;if(g.length>0){d=r(b,c,g,f);if(d){h=d.cellIndex.x,l.y=d.cellIndex.y,e=d.cell;if(e){while(i(b,h)&&h<m){if(h===m-1){h=c.index();return}h+=1,e=$(e[0].nextSibling)}h<=n-p&&e.length>0&&e.index()<m&&(l.x=h,c.removeClass("selected"),e.addClass("selected").focus(),q=!1)}}q&&(h=l.x+(f>1?f:1),typeof l=="object"&&h<m&&(l.x=h,o(b,l),j(b,l)))}}}function A(b,c){var d,e,f,g;if(c.length>0){f=a.getSelectedCell(b),g=w(b,c,c.closest("tr"));if(g){e=g.cellIndex.x,f.y=g.cellIndex.y,d=g.cell;if(d){while(i(b,e)&&e>=0){if(e===0){e=c.index();return}e-=1,d=$(d[0].previousSibling)}f.x=e,c.removeClass("selected"),d.addClass("selected").focus()}else f.x=e,n(b,f),j(b,f)}else typeof f=="object"&&f.x>0&&(f.x-=1,n(b,f))}}function B(b){var c=a.getScrollElem(b),d=a.getExtraScrollHeight(b)>0,f=a.getColumnWidth(b),g=a.getWidth(b),h=a.getHeight(b),i=a.getRowHeight(b),j=a.getNumRows(b),k=a.getHScrollBarAllowed(b),l=a.getVScrollBarAllowed(b)&&j*i>h,m=k&&f.accumulatedColumnWidth>g-(l?e.scrollbarWidth:0),n=a.getHeight(b)-(d||m?e.scrollbarWidth:0);return n}function C(b,c){var d,e=a.getSelectedCell(b),f=a.getNumCols(b);c.length>0&&(d=$("td:nth-child("+f+")",c.closest("tr")),d.length>0&&d.index()<f&&(c.removeClass("selected"),d.addClass("selected").focus(),e.x=f-1))}function D(b,c){var d,e=a.getSelectedCell(b),f=a.getNumCols(b);c.length>0&&(d=$("td:nth-child(1)",c.closest("tr")),d.length>0&&d.index()<f&&(c.removeClass("selected"),d.addClass("selected").focus(),e.x=0))}function E(b,c){var d=b.closest(".arcContainer"),e=a.getDocSelectedObjectManager(d);c.length>0&&(c.removeClass("selected"),e.setSelectedObject(undefined),$(":first",b).focus())}function F(b,c){var d=a.getDatavirtualizationProperties(b),e=a.getSelectedCell(b),f=B(b),g=Math.floor(f/Math.max(a.getRowHeight(b),1)),h=a.getNumRows(b),i=c.closest("tr").index()+d.firstElementInDOM,k,l=a.getScrollY(b),m=Math.ceil(l/Math.max(a.getRowHeight(b),1)),n=i-m;if(h<=g)return;i+g<h?(k={x:e.x,y:e.y+g-n},j(b,k),e.y+=g):(k={x:e.x,y:h-g},j(b,k))}function G(b,c){var d=a.getDatavirtualizationProperties(b),e=a.getSelectedCell(b),f=B(b),g=Math.floor(f/Math.max(a.getRowHeight(b),1)),h=a.getNumRows(b),i=c.closest("tr").index()+d.firstElementInDOM,k,l=a.getScrollY(b),m=Math.ceil(l/Math.max(a.getRowHeight(b),1)),n=i-m;if(h<=g)return;i-g>=0?(k={x:e.x,y:Math.max(e.y-g-n,0)},j(b,k),e.y-=g):(k={x:e.x,y:0},j(b,k))}function H(a,c){return a>=48&&a<=90||a===b.Delete||a===b.Space||a===b.Semicolon||a===b.Equals||a===b.Slash||a===b.Point||a===b.Dash||a===b.DecimalPoint||a===b.Minus||a===b.Divide||a===b.OpenBracket||a===b.CloseBracket}function I(b){var c=a.getSelectedCell(b),d=a.getNumRows(b),e=a.getNumCols(b),f=a.getDatavirtualizationProperties(b);if(c){if(c.y<f.firstElementInDOM||f.lastElementInDOM<c.y)c.y<f.firstElementInDOM?j(b,c):k(b,c);if(c.x<f.firstColumnInDOM||f.lastColumnInDOM<c.x)c.x<f.firstColumnInDOM?n(b,c):o(b,c)}}function J(b,c){var e=a.getSelectedCell(c.data.ref);return c.data.target=b,c.data.clickPos={x:e.x,y:e.y},$(".arcTextInputSizeTarget",c.data.ref).removeClass("arcTextInputSizeTarget"),b.addClass("arcTextInputSizeTarget"),d.show(c)}function K(a){return $("td.selected",a).length>0}function L(b,c){var d=b.closest(".arcContainer"),e=a.getDocSelectedObjectManager(d);c.length>0&&(K(b)||(a.setSelectedCell(b,{x:0,y:0}),$(c).addClass("selected").focus()),e.setSelectedObject(b[0].id))}function M(c){var d=$("#"+c.data.id),e=$("td:first",d),f=d.closest(".arcContainer"),g=a.getDocSelectedObjectManager(f),h=!0;switch(c.keyCode){case b.Enter:case b.Space:L(d,e);break;case b.Tab:case b.Shift:h=!1;break;default:K(d)&&(g.setSelectedObject(d[0].id),N(c,d,e)),h=!1}h&&(c.preventDefault(),c.stopImmediatePropagation())}function N(c,d,e){var f,i,j=a.getIsEditable(d),k=a.isActive(d),l=k&&j&&e.length>0&&$("td.selected .arcTdHtmlDiv",d).length===0&&$("td.selected.arcExtraColumn",d).length===0,m=!0,n;if(c.type==="keypress"||c.type==="keydown"){l&&I(d);switch(c.keyCode){case b.Tab:h.handleTab(d,e,c.shiftKey);break;case b.Enter:h.handleEnter(d,e,c.shiftKey);break;case b.LeftArrow:A(d,e);break;case b.UpArrow:y(d,e);break;case b.RightArrow:z(d,e);break;case b.DownArrow:x(d,e);break;case b.PageDown:F(d,e);break;case b.PageUp:G(d,e);break;case b.End:C(d,e);break;case b.Pos1:D(d,e);break;case b.ESC:E(d,e);break;default:m=!1,d.hasClass("arcTextInputActive")||l&&g.isInputKeyAllowed(c.keyCode,c.ctrlKey,c.altKey)&&(n=J(e,c),c.keyCode===b.Delete&&n.trigger($.Event("blur",{keyCode:c.keyCode})))}m&&e.length>0&&(c.preventDefault(),c.stopImmediatePropagation())}}function O(c,d,e){var f=a.getSelectedCell(d);switch(c.keyCode){case b.LeftArrow:case b.RightArrow:case b.UpArrow:case b.DownArrow:case b.Enter:case b.PageDown:case b.PageUp:if(e.length===0&&!f)return L(d,$("td:first",d)),j(d,{x:0,y:0}),c.preventDefault(),c.stopImmediatePropagation(),!0}return!1}var h={};return h.handleTab=function(a,b,c){c?A(a,b):z(a,b)},h.handleEnter=function(a,b,c){c?y(a,b):x(a,b)},h.handleKeyPressEvent=function(b){var c=$("#"+b.data.id),d=$("td.selected",c),e,f;if(O(b,c,d))return;e=c.closest(".arcContainer"),f=a.getDocSelectedObjectManager(e).getSelectedObject()===b.data.id,f?N(b,c,d):M(b)},h}),define("checkboxkeyboardhandler",["properties","scroll","keycodes"],function(a,b,c){function e(c,d){b.scrollTo(c,null,undefined,a.getRowHeight(c)*d)}function f(c,d){b.scrollTo(c,null,undefined,a.getRowHeight(c)*(d+1)-a.getHeight(c))}function g(a){return $("td.selected",a).length>0}function h(b,c){var d=b.closest(".arcContainer"),e=a.getDocSelectedObjectManager(d);c.length>0&&(g(b)||(a.setSelectedCell(b,{x:0,y:0}),$(c).addClass("selected").find("input").focus()),e.setSelectedObject(b[0].id))}function i(b){var c=$("input:first",b),d=$(".selected",b),f=a.getSelectedCell(b);c.length>0&&(d.removeClass("selected"),!f||d.length===0?(h(b,c.closest("td")),f=a.getSelectedCell(b)):d.length>0&&h(b,d),e(b,f.y))}function j(b){var c=$(".selected",b),d=b.closest(".arcContainer"),e=a.getDocSelectedObjectManager(d);c.removeClass("selected"),e.setSelectedObject(undefined),a.setSelectedCell(b,undefined),$(":first",b).focus()}function k(b,c){var d=$(".selected",c),e=a.getSelectedCell(c),g;if(d.length>0){g=d.closest("tr").next();if(g.length>0)return d.removeClass("selected"),g.find("td:first").addClass("selected").find("input").focus(),e.x=0,e.y+=1,!0;if(e.y+1<a.getNumRows(c))return d.removeClass("selected"),e.x=0,e.y+=1,f(c,e.y),!0}return!1}function l(b,c){var d=$(".selected",c),f=a.getSelectedCell(c),g,h;if(d.length>0){g=d.closest("tr").prev();if(g.length>0)return d.removeClass("selected"),h=g.find("input:last"),h.closest("td").addClass("selected"),h.focus(),f.x=a.getNumCols(c)-1,f.y-=1,!0;if(f.y>0)return d.removeClass("selected"),f.x=a.getNumCols(c)-1,f.y-=1,e(c,f.y),!0}return!1}function m(a,b){var c=$(".selected",b);return c.length===0?!0:(a.shiftKey?q(b,c)||l(a,b):p(b,c)||k(a,b),!0)}function n(b,c){var d,e,g,h,i,j=a.getDatavirtualizationProperties(b),k=a.getNumRows(b),l=a.getSelectedCell(b);if(c.length>0){e=c.closest("tr")[0],i=c.closest("tr").index(),g=c.closest("td").index();if(e){d=e.nextSibling;if(d)return c.removeClass("selected"),c=$("td:nth-child("+(g+1)+")",d).addClass("selected").find("input").focus(),g=c.closest("td").index(),h=c.closest("tr").index(),l.y+=1,h===i&&typeof l=="object"&&l.y<k&&f(b,l.y),!0;if(typeof l=="object"&&l.y<k-1)return l.y+=1,f(b,l.y),!0}}return!1}function o(b,c){var d,f,g,h,i,j=a.getDatavirtualizationProperties(b),k=a.getSelectedCell(b);if(c.length>0){f=c.closest("tr")[0],i=c.closest("tr").index(),g=c.closest("td").index();if(f){d=f.previousSibling;if(d)return c.removeClass("selected"),c=$("td:nth-child("+(g+1)+")",d).addClass("selected").find("input").focus(),g=c.closest("td").index(),h=c.closest("tr").index(),k.y-=1,h===i&&typeof k=="object"&&k.y>0&&e(b,k.y),!0;if(typeof k=="object"&&k.y>0)return k.y-=1,e(b,k.y),!0}}return!1}function p(b,c){var d,e,f=a.getDatavirtualizationProperties(b),g=a.getSelectedCell(b),h=a.getNumCols(b),i=f.lastColumnInDOM||h-1,j=f.firstColumnInDOM||0,k;if(c.length>0){e=c[0];if(e){d=$(e.nextSibling),k=d.index();if(k<=i-j&&d.length>0&&d.index()<h)return c.removeClass("selected"),d.addClass("selected").find("input").focus(),g.x+=1,!0}}return!1}function q(b,c){var d,e,f=a.getDatavirtualizationProperties(b),g=a.getSelectedCell(b),h,i;if(c.length>0){e=c[0],h=c.closest("td").index();if(e){d=$(e.previousSibling),i=d.index();if(i!==h&&d.length>0&&d.index()>=0)return c.removeClass("selected"),d.addClass("selected").find("input").focus(),g.x-=1,!0}}return!1}function r(a,b){b.find("input").click()}function s(a,b){var d=!1,e=$(".selected",b);switch(a.keyCode){case c.Enter:a.shiftKey?d=o(b,e):d=n(b,e);break;case c.ESC:j(b,e),d=!0;break;case c.Tab:d=m(a,b);break;case c.DownArrow:d=n(b,e);break;case c.UpArrow:d=o(b,e);break;case c.RightArrow:d=p(b,e);break;case c.LeftArrow:d=q(b,e)}d===!0&&(a.preventDefault(),a.stopImmediatePropagation())}function t(a,b){switch(a.keyCode){case c.LeftArrow:case c.RightArrow:case c.UpArrow:case c.DownArrow:case c.Enter:case c.Space:i(b),a.preventDefault(),a.stopImmediatePropagation()}}function u(a,b){var d=$(".selected",b);switch(a.keyCode){case c.LeftArrow:case c.RightArrow:case c.UpArrow:case c.DownArrow:case c.Enter:case c.Space:if(d.length===0)return i(b),a.preventDefault(),a.stopImmediatePropagation(),!0}return!1}var d={};return d.handleKeyPressEvent=function(b){var c=$("#"+b.data.id),d,e;d=c.closest(".arcContainer"),e=a.getDocSelectedObjectManager(d).getSelectedObject()===b.data.id;if(e){if(u(b,c))return;s(b,c)}else t(b,c)},d}),define("layoutmanagement/chartloadedhandler",["objectresizer","properties","scroll"],function(a,b,c){var d={};return d.notifyChartLoaded=function(d,e){var f=b.getPendingScrollPos(d),g=$("embed:last",d);e.length>0&&e!==g&&(e.attr("name").indexOf("_load")>-1?(e.css("opacity","1"),e.attr("name",e.attr("name").replace("_load","")),$("embed",d).length>1&&g.remove()):e.attr("name").indexOf("_obsolete")>-1&&e.remove()),b.setChartResizer(d,undefined),b.setWidthChanged(d,!0),b.setHeightChanged(d,!0),a.applyObjectDimensions(d),f&&(c.scrollTo(d,undefined,f.left,f.top),b.setPendingScrollPos(d,undefined))},d}),define("showhiermenuaction",["properties","logger","popuphandler","stringtools","ui","documentpositioner","assert/assert","arcplanobjects/objectcontainers"],function(a,b,c,d,e,f,g,h){function j(a){return{x:a.getXPos(),y:a.getYPos(),width:a.getWidth(),height:a.getHeight()}}function k(a,b){return a.x>=b.x&&a.x<=b.x+b.width&&a.y>=b.y&&a.y<=b.y+b.height}function l(a,c,d,f,h){g(c);var i,l,m,n;return l=e.getCellRect(a,f,h),l&&(i=j(c),m=d.offset(),l.x-=m.left,l.y-=m.top,k({x:l.x,y:l.y},i)&&k({x:l.x+l.width,y:l.y+l.height},i)&&(n={x:l.x,y:l.y,height:l.height})),n||b.log("ShowHierarchyMenuPopup: The cell element to show menu is not visible.  Column:"+f+" Row: "+h),n}function m(a,c,g,i,k){var m,n,o,p,q,r;return m=f.getDocContainer(c),n=h.getObjectContainer(m,k,a),n&&n.isVisible()&&n.isAvailableInView()?(!isNaN(g)&&g>0&&!isNaN(i)&&i>0?(r=$("#"+d.makeID(c,a),m),o=l(r,n,m,g,i)):(q=j(n),o={x:q.x,y:q.y,height:q.height}),o&&(p=e.getPositionToArcContainer(m,o.x,o.y),o.x=p.x,o.y=p.y)):b.warn("ShowHierarchyMenuPopup: The target object with ID: "+a+" does not exists"),o}var i={};return i.executeShowHierMenu=function(a,b,e,f){var g,h,i,j,k=[],l,n,o,p;if(a&&a.length>0){h=$("#arcContainer");for(j=0;j<a.length;j+=1)g=a[j].HierMenuObjID,i=$("#"+d.makeID(b,g),h),i&&i.length>0&&(l=parseInt(a[j].ObjID,10),n=parseInt(a[j].Column,10),o=parseInt(a[j].Row,10),isNaN(l)?k.push({objRef:i,positionParams:{x:e.x,y:e.y,height:undefined}}):(p=m(l,b,n,o,f),p&&k.push({objRef:i,positionParams:p})));k.length>0&&c.showByPos(k)}},i}),define("events/eventcallbacks",["assert/assert","events/eventid","logger","ui","stringtools","nodetypes","properties","popuphandler","browserfeatures","tablekeyboardhandler","checkboxkeyboardhandler","keycodes","events/eventdatafactory","fieldkeyboardhandler","requesttools"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function u(a){var b={docName:undefined,objID:undefined,ref:a.data.ref};return a.data.ref&&(b.docName=g.getDocName(a.data.ref),b.objID=g.getID(a.data.ref)),b}function v(b,c){a(typeof b=="function");var d,e;return d=function(a){typeof c.data=="object"&&(c.data.isCancelInitInput=a===!0),b(c)},e=s.processPendingBlurEvent(d),e}function w(a){switch(a.type){case"checkbox":return $(a).is("li > div[draggable='true'] > input")||$(a).is(".arcLabelContainer > div[draggable='true'] > input")?d.getNodeInfo(a).row:a.checked?"1":"0";case"text":case"textarea":case"password":return a.value;default:return""}}function x(a,b,c){var d,e;c!==undefined&&b!==undefined&&(g.getNumRows(a)===0&&(e=$("table:first",a),e.length>0&&e.parent().height()===0&&(e.parent().height(g.getRowHeight(a)),b.css("text-align","left"))),b.children().length>0?(d=b.find("input:first"),d.length>0?d.attr("value",c):b.find(".arcTdInnerDiv").text(c)):b.text(c))}function y(a){var b;return a&&(b=a.srcElement,b||(b=a.target)),b}function z(a,b,c,d){var e,f;if(b&&typeof b.tagName=="string"&&b.tagName.toLowerCase()==="g")for(e=0;e<b.childNodes.length;e+=1)f=b.childNodes.item(e),z(a,f,c,d);else b&&b.id!==c&&typeof b.tagName=="string"&&b.tagName.toLowerCase()!=="effect"&&b.tagName.toLowerCase()!=="pattern"&&b.style&&b.id.indexOf("zeroline")!==0&&!a.test(b.id)&&b.getAttribute("pointer-events")!=="none"&&(b.style.opacity=d)}function A(a,b,c){if(a){var d=a.getElementById("content"),e,f,g=b,h,i;if(!d)return;i=new RegExp("^[0-9]{3}(_[0-9]{3}_[0-9]{3}_)[0-9]{3}.*"),g=i.exec(g),h=new RegExp("^[0-9]{3}"+g[1]+"[0-9]{3}.*");for(e=0;e<d.childNodes.length;e+=1)f=d.childNodes.item(e),z(h,f,b,c)}}function B(a,b,c){function k(){i=$("td.selected",a),i.length===0&&(i=d.getTableCellElement(a,e.x,e.y))}if(g.getObjType(a)==="Field")return;var e=g.getSelectedCell(a),f=g.getNumRows(a),h=g.getNumCols(a),i;if(e)switch(b){case l.Tab:k(),j.handleTab(a,i,c);break;case l.Enter:k(),j.handleEnter(a,i,c)}}function C(a){var b=a,c,d,e,f,g,h,j,k,l;h=b.closest(".arcHier").length>0,j=b.prop("tagName")==="LI"&&h,k=b.prop("tagName")==="LABEL"&&h,l=b.prop("tagName")==="A"&&h;if(b.hasClass("arcTdInnerDiv")){while(!b.is("td")&&!b.is("body")&&b.length>0)b=b.parent();if(b.is("body"))return undefined}else if(j)b=b.find("div[draggable=true]").first();else if(k||l)b=b.parent();else{c=b.hasClass("dynaTable")||b.hasClass("dynaRow")||b.hasClass("dynaColumn"),d=i.mobile&&(b.is("input")||b.hasClass("arcHpCbox")),e=b.is(":disabled"),f=b.parent().hasClass("dynaVertHier"),g=b.parent().hasClass("dynaHoriHier");if(c||d||e||f||g)return undefined}return b}function D(a,b){var c;a&&(c=a.getPrimaryCellIndex(b.x,b.y),c&&(b.x=c.x,b.y=c.y))}function E(a,b,d,e,f,g,h,i){var j=0,k=0,l,m;m=function(){E(a,b,d,e,f,g,h,i)};if(s.processPendingBlurEvent(m))return;r({pageX:d,pageY:e}),c.log("click for doc:"+a+" and id: "+b),t.doArcplanEvent(a,b,i,h,j,k,l,f,g)}var p={},q=!1,r,s,t;return p.setLastMouseDownPosSetter=function(a){r=a},p.setEventOrder=function(a){t=a},p.setPendingEventsHandler=function(a){s=a},p.getTarget=function(a){var b=a.target,c;b.nodeType===f.TEXT_NODE&&(b=b.parentNode);if(b.tagName==="IMG"&&a.data.ref){c=g.getObjType(a.data.ref);switch(c){case"Field":case"Column":case"Row":case"Table":case"Menu":case"CheckboxGroup":case"RadioGroup":case"Switch":case"VerticalHierarchie":case"HorizontalHierarchie":case"MenuHierarchie":b=b.parentNode}}return b.tagName==="NOBR"&&(b=b.parentNode),b.tagName==="SPAN"&&b.parentNode.tagName==="BUTTON"&&(b=b.parentNode),b.tagName==="DIV"&&b.draggable===!0&&b.parentNode.tagName==="LI"&&(b=b.parentNode),b.ownerSVGElement&&(b=b.ownerSVGElement),b},p.getClickPos=function(a,b){var c,e,f,h;switch(a.tagName.toUpperCase()){case"IMG":if($(a).is("td > img")||$(a).is("td > a > img"))return d.getCellPosition($(a).closest("td")[0]);return b.offsetX===undefined?(f=b.pageX-$(a).offset().left,h=b.pageY-$(a).offset().top):(f=b.offsetX,h=b.offsetY),{x:f,y:h};case"SVG":return f=b.pageX-parseInt(g.getXPos(b.data.ref),10),h=b.pageY-parseInt(g.getYPos(b.data.ref),10),{x:f,y:h};case"DIV":if($(a).hasClass("arcTdInnerDiv")||$(a).hasClass("arcTdInnerDivFixedHeight")){while(a.parentElement&&a.parentElement.tagName!=="TD")a=a.parentElement;if(a.parentElement&&a.parentElement.tagName==="TD")return d.getCellPosition(a.parentElement)}else{if(a.draggable===!0&&a.parentNode.tagName==="LI")return d.getCellPosition(a.parentNode);if($(a).hasClass("dynaTable")||$(a).hasClass("dynaRow")||$(a).hasClass("dynaColumn"))if(g.getNumCols(b.data.ref)===0||g.getNumRows(b.data.ref)===0)return{x:0,y:0}}break;case"TD":return d.getCellPosition(a);case"LABEL":case"A":case"INPUT":c=a.parentNode,$(c).hasClass("arcLabelContainer")&&(c=$(c).parent()[0]),$(c).is("div[draggable='true']")&&(c=c.parentNode),e=d.getCellPosition(c);if(e.x!==-1)return e;break;case"LI":e=d.getCellPosition(a);if(e.x!==-1)return e;break;case"BUTTON":return{x:0,y:0};case"SPAN":return e=d.getCellPosition($(a).closest("li")[0]),e}return{x:-1,y:-1}},p.getValue=function(a,b){var c;switch(a.tagName){case"LABEL":case"A":if($(a).is("li > div[draggable='true'] > "+a.tagName))return d.getNodeInfo(a).row;break;case"LI":return d.getNodeInfo(a).row;case"SPAN":if($(a).is("li > div[draggable='true'] > label > span")||$(a).is("li > div[draggable='true'] > a > span"))return d.getNodeInfo(a.parentNode.parentNode.parentNode).row;break;case"INPUT":case"TEXTAREA":return w(a);case"BUTTON":return"";case"DIV":if(a.draggable===!0&&a.parentNode&&a.parentNode.tagName==="LI")return d.getNodeInfo(a.parentNode).row;return;default:return'"null"'}},window.highlight=function(a,b){var c=y(a);A(c.ownerDocument,b,.5)},window.reverthighlight=function(a,b){var c=y(a);A(c.ownerDocument,b,1)},p.resetSelectedCell=function(a){var b=$(p.getTarget(a)),c=b.closest("tr").index(),d=b.closest("td").index(),e=a.data.ref.closest(".arcContainer"),f=g.getDatavirtualizationProperties(a.data.ref),h=g.getDatavirtualization(a.data.ref),i={x:d+f.firstColumnInDOM,y:c+f.firstElementInDOM};D(h,i),g.setSelectedCell(a.data.ref,i),$(".selected",a.data.ref).removeClass("selected"),b.closest("td").addClass("selected")},p.setSelectedObjectCallback=function(a,b){var c,d=e.makeID(a,0),f=$("#"+d),h=$("#arcContainer > .arcContainer");h.each(function(a,d){f.is(d)?(c=g.getDocSelectedObjectManager(f),c.setSelectedObject(b)):(c=g.getDocSelectedObjectManager($(d)),c.setSelectedObject(undefined))})},p.resetDocSelectedObject=function(a){a.data.ref&&p.setSelectedObjectCallback(g.getDocName(a.data.ref),a.data.ref[0].id)},p.highlightOnInteractionStart=function(a){var b=p.getTarget(a),c=u(a),d=$(b),e;d=C(d),typeof d!="undefined"&&(d.css("background-color")==="rgba(255, 255, 255, 0)"?d.addClass("arcClickedOnTransparentObject"):d.addClass("arcClicked"),e=m.createInstance(c.objID,c.ref),d.on("mouseout.interactionFeedback",e,p.highlightOnInteractionEnd))},p.highlightOnInteractionEnd=function(a){var b=p.getTarget(a),c=$(b);c=C(c),typeof c!="undefined"&&(c.removeClass("arcClicked"),c.removeClass("arcClickedOnTransparentObject"))},p.onMenuClick=function(a){if(v(p.onMenuClick,a))return;var b=u(a),c=p.getTarget(a),d;a.preventDefault(),a.stopImmediatePropagation(),c&&(d=h.handleMenuPopupEvent(a,$(c)),d&&t.doArcplanEvent(b.docName,b.objID,d.eventType,d.value))},p.onTableKeyDown=function(a){if(v(p.onTableKeyDown,a))return;var b=p.getTarget(a);b&&a.type==="keydown"&&j.handleKeyPressEvent(a)},p.onTableKeyPress=function(a){if(v(p.onTableKeyPress,a))return;var b=p.getTarget(a);b&&a.type==="keypress"&&j.handleKeyPressEvent(a)},p.onFieldKeyDown=function(a){if(v(p.onTableKeyDown,a))return;var b=p.getTarget(a);b&&a.type==="keydown"&&n.handleKeyPressEvent(a)},p.onFieldKeyPress=function(a){if(v(p.onTableKeyPress,a))return;var b=p.getTarget(a);b&&a.type==="keypress"&&n.handleKeyPressEvent(a)},p.onCheckboxKeyDown=function(a){if(v(p.onCheckboxKeyDown,a))return;p.getTarget(a)&&a.type==="keydown"&&k.handleKeyPressEvent(a)},p.onCheckboxKeyPress=function(a){if(v(p.onCheckboxKeyPress,a))return;p.getTarget(a)&&a.type==="keypress"&&k.handleKeyPressEvent(a)},p.onRadioButtonKeyDown=function(a){var b;if(v(p.onRadioButtonKeyDown,a))return;p.getTarget(a)&&a.type==="keydown"&&a.keyCode===l.Tab&&(b=g.getDocSelectedObjectManager($("#"+a.data.id).closest(".arcContainer")),b.setSelectedObject(undefined))},p.onMenuKeyDown=function(a){if(v(p.onCheckboxKeyDown,a))return;p.getTarget(a)&&a.type==="keydown"&&h.handleMenuKeyPressEvent(a)},p.onMenuKeyPress=function(a){if(v(p.onCheckboxKeyPress,a))return;p.getTarget(a)&&a.type==="keypress"&&h.handleMenuKeyPressEvent(a)},p.onTextKeyDown=function(a){if(v(p.onTextKeyDown,a))return;p.getTarget(a)&&a.type==="keydown"&&n.handleTextObjectKeyPressEvent(a)},p.onTextKeyPress=function(a){if(v(p.onTextKeyPress,a))return;p.getTarget(a)&&a.type==="keypress"&&n.handleTextObjectKeyPressEvent(a)},p.onFieldFocused=function(a){if(v(p.onFieldFocused,a))return;n.handleFieldFocused(a)},p.onFieldMouseDown=function(a){g.setClickingOnFieldWithClickEvent(a.data.ref,!0)},p.onTextFocused=function(a){if(v(p.onTextFocused,a))return;n.handleTextFocused(a)},p.onHierClick=function(a){var d=u(a),e=p.getTarget(a),f,i=p.getClickPos(e,a),j=p.getValue(e,d.ref),k=b.EID_CLICK,l=!0,m,n,o;if(e){f=$(e);if(f.is("input")&&f.is(":checkbox")&&!f.hasClass("arcHpCbox"))f.is(":checked")?k=b.EID_OPENNODE:k=b.EID_CLOSENODE;else if((f.is("label")||f.is("span")||f.is("li")||f.is("a")&&f.text()!=="Too much data")&&g.getObjType(a.data.ref)!=="MenuHierarchie")k=b.EID_SELECTNODE,a.preventDefault(),a.stopImmediatePropagation();else if(f.is("a")&&f.text()==="Too much data")l=!1;else if(f.hasClass("arcHierPopup")||f.hasClass("arcHierPopupSelection")||h.isCurrentPopup(a.data.ref)){if(v(p.onHierClick,a))return;m=h.handlePopupEvent(a,f),typeof m=="object"&&(i.x=undefined,i.y=undefined,l=m.sendEvent,j=m.value,k=m.eventType,m.stopPropagation&&(a.preventDefault(),a.stopImmediatePropagation()))}}if(k===b.EID_CLICK||k===b.EID_SELECTNODE)n=a.shiftKey,o=a.ctrlKey;l&&(r(a),c.log("clickOnHierNode für doc:"+d.docName+" and id: "+d.objID),t.doArcplanEvent(d.docName,d.objID,k,j,i.y,i.x,undefined,n,o)),h.showPendingPopupPos()},p.onButtonClickCallback=function(a,c,d,e,f,g){var h="";E(a,c,d,e,f,g,h,b.EID_CLICK)},p.onSwitchClickCallback=function(a,c,d,e,f,g,h){var i=h?"1":"0";E(a,c,d,e,f,g,i,b.EID_SWITCH)},p.onFieldClickCallback=function(a,c,d,e,f,g){var h="";E(a,c,d,e,f,g,h,b.EID_CLICK)},p.onFieldTextEditedCallback=function(a,d,e,f,g){var h=0,i=0,j;c.log("Field Input for doc: "+a+" and id: "+d),t.doArcplanEvent(a,d,b.EID_INPUT,e,h,i,j,f,g)},p.onClick=function(a){if(v(p.onClick,a))return;c.info("eventhandling - eventcallbacks: executing onClick event");var d=u(a),e=p.getTarget(a),f=a.data.clickPos||p.getClickPos(e,a),g=p.getValue(e,d.ref);d.objID&&(r(a),c.log("click für doc:"+d.docName+" and id: "+d.objID),t.doArcplanEvent(d.docName,d.objID,b.EID_CLICK,g,f.y,f.x,undefined,a.shiftKey,a.ctrlKey))},p.onDocumentClick=function(a){var b,c,d=g.getDocSelectedObjectManager(a.data.container);a.eventPhase===Event.AT_TARGET&&(d.getSelectedObject()&&(c=$("#"+d.getSelectedObject(),a.data.container),$(".dynaCheckbox td.selected",c).removeClass("selected")),d.setSelectedObject(undefined)),a.data.activationCallback&&a.data.getTopDocNameCallback&&(b=g.getDocName(a.data.container),b!==a.data.getTopDocNameCallback()&&a.data.activationCallback(b,a.data.container))},p.onChange=function(a){if(v(p.onChange,a))return;var d=u(a);c.log("Event change for doc: "+d.docName+" and id: "+d.objID),t.doArcplanEvent(d.docName,d.objID,b.EID_SWITCH,a.target.value)},p.onInput=function(a){var d=u(a),e=p.getTarget(a),f=p.getValue(e,d.ref),h=a.data.clickPos||p.getClickPos(e,a),i=a.keyCode,j=g.getObjType(a.data.ref),k,l;return B(d.ref,i,a.shiftKey),c.info("eventhandling - eventcallbacks: executing onInput event"),a.data.ref&&j==="CheckboxGroup"&&e&&e.tagName!=="INPUT"?!1:e.tagName==="TEXTAREA"&&f===a.data.ref.text()?(c.log("Input canceled for doc: "+d.docName+" and id: "+d.objID),!1):(c.log("Event Input for doc: "+d.docName+" and id: "+d.objID),l=g.getDatavirtualization(d.ref),a.data.initialValue!==f&&(l?l.updateInputValue(h.x,h.y,f):x(d.ref,a.data.target,a.data.initialValue||f)),D(l,h),t.doArcplanEvent(d.docName,d.objID,b.EID_INPUT,f,h.y,h.x,a.keyCode,a.shiftKey,a.ctrlKey),!0)},p.onHTMLInput=function(a,c,d){d=d.replace(/\|/g,"||"),d=o.createCDataSerializer(d),t.doArcplanEvent(a,c,b.EID_INPUT,d)},p.onPopupFunction=function(a){var b=p.getTarget(a);h.handlePopupFunctionEvent(b)},p.onDrop=function(a){var c=u(a),d=p.getTarget(a),e=a.data.text,f=p.getClickPos(d,a),h,i,j;a.preventDefault(),q&&(q=!1,j=g.getObjType(c.ref),j==="VerticalHierarchie"||j==="HorizontalHierarchie"?(h=p.getValue(d),i=f.x):(h=f.y+1,i=f.x+1),t.doArcplanEvent(c.docName,c.objID,b.EID_DROP,e,h,i))},p.onDragStart=function(a){var b=$(a.target).closest(".objContainer"),c=p.getClickPos(a.target,a),d;g.getObjType(b)==="VerticalHierarchie"?d=b[0].id+" "+(c.x-1)+"_"+(parseInt(p.getValue(a.target),10)-1):g.getObjType(b)==="HorizontalHierarchie"?d=b[0].id+" "+(parseInt(p.getValue(a.target),10)-1)+"_"+(c.x-1):d=b[0].id+" "+c.x+"_"+c.y,q=!0,a.dataTransfer?a.dataTransfer.setData("text",d):a.originalEvent.dataTransfer.setData("text",d)},p.cancelDrag=function(){q=!1},p}),define("draganddrop",["events/eventcallbacks","events/eventdatafactory","properties"],function(a,b,c){function o(a){a.addClass("arcNoUserSelect").on("selectstart.draganddrop",function(a){if(f===!0)return!1})}function p(a){a.removeClass("arcNoUserSelect").off("selectstart.draganddrop")}var d={},e=!1,f=!1,g,h,i,j,k,l,m,n;return k=function(){f=!1,n=undefined,$(document).off("mouseup.draganddrop",k),p($("body")),p($(".arcNoUserSelect")),a.cancelDrag()},d.makeDraggable=function(b){var c=b.children(),d=b.children("div").children("div");c.addClass("arcDraggable"),c.attr("draggable",!0),c.off("dragstart"),c.off("selectstart"),c.on("dragstart",function(b){a.onDragStart(b),$(document).off("mouseup.draganddrop"),$(document).on("mouseup.draganddrop",b.data,k)}),c.on("selectstart",function(a){a.target.id!=="arcMenuFilterTextInput"&&(a.preventDefault(),a.stopImmediatePropagation(),$(a.target).closest("[draggable]")[0].dragDrop())})},d.makeDropable=function(d){var e=b.createInstance(d[0].id,d);d.addClass("arcDropArea"),d.off("dragover.draganddrop"),d.off("drop.draganddrop"),d.on("dragover.draganddrop",function(a){a.preventDefault(),$(a.target).css("cursor","copy")}),d.on("drop.draganddrop",function(b){b.preventDefault();var d,e,f,g,h,i,j,k,l;b.dataTransfer?i=b.dataTransfer.getData("text"):i=b.originalEvent.dataTransfer.getData("text"),j=i.split(" "),j.length===2&&(f=j[0],k=j[1],l=k.split("_"),e=$("#"+f),g=c.getDocName(e),h=c.getID(e),d="["+g+";OBJ"+h+";COLUMN"+(1+parseInt(l[0],10))+";ROW"+(1+parseInt(l[1],10))+"]",b.data={ref:$(b.target).closest(".objContainer"),text:d},a.onDrop(b))})},d.onScroll=function(){k()},d}),define("events/resizehandlerfactory",["browserfeatures","popuphandler","documentpositioner","properties","stringtools"],function(a,b,c,d,e){var f={};return f.createInstance=function(f,g,h){function l(a){var b=-1,c,f;for(c=0;c<j.length;c+=1){f=j[c];if(f[0].id===e.makeID(d.getDocName(a),0)){b=c;break}}return b}var i={},j=[],k;return i.handleResize=function(e){var i,l,m=a.getWindowSize(),n=!1;b.onResize(),window.devicePixelRatio!==k&&(i=a.scrollbarWidth,a.scrollbarWidth=a.measureScrollbarWidth(),a.zoomOffsetHeightWithBorder=a.measureZoomOffsetHeightWithBorder(),a.zoomOffsetTableTdHeightWithBorder=a.measureZoomOffsetTdHeightWithBorder(),a.zoomOffsetTableTdHeightWithoutBorder=a.measureZoomOffsetTdHeightWithoutBorder(),l=a.scrollbarWidth!==i),j.forEach(function(a){f.updateLayout(a,e,!1),l&&f.updateOnPageZoomAndScrollbarWidthChanged(a),h&&f.updateDomAfterLayoutManagementUpdate(a),c.setDocSize(a,parseFloat(m.width),parseFloat(m.height),h);if(d.hasDocWidthChanged(a)||d.hasDocHeightChanged(a))d.setDocWidthChanged(a,!1),d.setDocHeightChanged(a,!1),n=!0}),n&&typeof g=="function"&&g()},i.registerDocument=function(a){var b=l(a);b===-1&&j.push(a)},i.unregisterDocument=function(a){var b=l(a);b!==-1&&j.splice(b,1)},i},f}),define("htmleditor",["jquery","properties","events/eventcallbacks","events/globalmousedownhandler","keycodes","popuphandler","texthtmlgenerator"],function(a,b,c,d,e,f,g){function m(){d.stopListening(),j=!1}function n(c){var d=b.getTabOrder(c);d>0&&a(":first",c).attr("tabindex",d)}function o(c){var d=b.getTabOrder(c);d>0&&a(":first",c).attr("tabindex","-1")}function p(a){window.setTimeout(function(){a.destroy(!0)},0)}function q(a){var b;typeof CKEDITOR!="undefined"&&CKEDITOR.instances&&(b=CKEDITOR.instances[l+a[0].id],b&&p(b))}function r(c,g,k,m,o){var p=b.getHTMLEditor(c),r=c[0].id,t={},u;g.off("click.htmleditor"),g.on("click.htmleditor",function(a){a.preventDefault(),a.stopImmediatePropagation()}),q(c),require([window.require.toUrl("../lib/ckeditor/ckeditor.js")],function(){s(t,b.getFont(c)),t.startupFocus=m,p=CKEDITOR.inline(l+r,t),p.setData(k),u=b.getIsEditable(c)&&b.isActive(c),g.attr("contenteditable",u?"true":"false"),u?(b.setHTMLEditor(c,p),ARCPLAN.useEventOrder===!0?p.on("blur",o):(g.on("blur",function(){d.didAnObjectWithClickEventGetMouseDown()&&p.checkDirty()&&h.setPendingBlurEvent(function(){return o(),!0}),d.stopListening()}),p.on("blur",function(){d.didAnObjectWithClickEventGetMouseDown()||o(),d.stopListening()})),p.on("key",function(d){var f,h=2228233;d.data.keyCode===e.ESC?(j=!0,g.trigger("blur")):d.data.keyCode===h&&(f=b.getTabOrder(c),f>0&&a(":first",c).focus())}),p.on("focus",function(e){var g=a(document);n(c),b.setHtmlSource(c,k),f.hideCurrentPopup(),ARCPLAN.useEventOrder===!0?i.CKEditorInputEventExpected():d.startListening(a("#arcContainer"))})):p.on("instanceReady",function(e){var f=p.getData();b.setHTMLEditor(c,undefined),p.destroy(),a("#"+l+r).html(f)})})}function s(a,b){a.contentCss="",a.customConfig="",a.browserContextMenuOnCtrl=!0,a.removePlugins="contextmenu,tabletools,liststyle",a.enterMode=window.CKEDITOR.ENTER_BR,a.title=!1,a.toolbar=[["Cut","Copy","Paste","-","Undo","Redo"],["Bold","Italic","Underline"],["Font","FontSize","TextColor","BGColor"],["Outdent","Indent"],["NumberedList","BulletedList"]],a.allowedContent={br:{attributes:!1,classes:!1,styles:!1},span:{attributes:!1,classes:!1,styles:"font-family,font-size,color,background-color"},strong:{attributes:!1,classes:!1,styles:!1},em:{attributes:!1,classes:!1,styles:!1},u:{attributes:!1,classes:!1,styles:!1},"div ul ol":{attributes:!1,classes:!1,styles:"margin-left"},li:{attributes:!1,classes:!1,styles:!1},font:{attributes:!0,classes:!1,styles:!1}},a.fontSize_sizes="8/8pt;9/9pt;10/10pt;11/11pt;12/12pt;13/13pt;14/14pt;16/16pt;18/18pt;20/20pt;22/22pt;24/24pt;26/26pt;28/28pt;36/36pt;48/48pt;72/72pt",a.font_names="Arial/Arial;Comic Sans MS/Comic Sans MS;Courier New/Courier New;Georgia/Georgia;Lucida Sans Unicode/Lucida Sans Unicode;Tahoma/Tahoma;Times New Roman/Times New Roman;Trebuchet MS/Trebuchet MS;Verdana/Verdana",a.font_defaultLabel=b.fontFamily.replace(/'/g,""),a.fontSize_defaultLabel=b.fontSize.replace("pt",""),ARCPLAN.AnswersImageUpload&&(a.toolbar.push(["addImage"]),a.allowedContent.img={attributes:"src",classes:!1,styles:!1},a.extraPlugins="simpleuploads",a.filebrowserUploadUrl=ARCPLAN.engage.server.baseUrl+"ImageHandler.aspx",a.simpleuploads_imageExtensions="jpe?g|gif|png|bmp",a.simpleuploads_convertBmp=!0)}function t(a){var d=b.getHTMLEditor(a),e=b.getHtmlSource(a),f,h,k,l,m,n=!1;j?d.setData(e):d.checkDirty()&&(f=d.getData(),e===""&&(h=b.getFont(a),k=b.getForegroundColor(a),f=g.wrapDataWithObjectFontStyle(f,h,k),d.setData(f)),l=b.getDocName(a),m=b.getID(a),c.onHTMLInput(l,m,f),n=!0),ARCPLAN.useEventOrder===!0&&n===!1&&i.expectedCKEditorInputEventCancelled()}var h,i,j=!1,k={},l="editorContainerFor_";return k.setPendingEventsHandler=function(a){h=a},k.setEventOrder=function(a){i=a},k.removeAllHtmlEditorInstances=function(){var a,b;if(typeof CKEDITOR!="undefined"){for(b in CKEDITOR.instances)a=CKEDITOR.instances[b],a.destroy(!0),a=null;m()}},k.initializeEditor=function(a,b,c){function e(){t(a),o(a),j&&a.children().first().focus(),m()}var d=!1;r(a,b,c,d,e)},k.initializeEditorForNotInitialHtmlText=function(a,b,c){function e(){t(a),a.children().first().remove(),a.children().first().css("display","block"),j&&a.children().first().focus(),m(),q(a)}var d=!0;q(a),r(a,b,c,d,e)},k}),define("events/eventsetterfactory",["events/eventcallbacks","events/eventdatafactory","draganddrop","logger","properties","tools","htmleditor","texthtmlgenerator"],function(a,b,c,d,e,f,g,h){function i(){function j(c,d){c.off("mousedown.interactionFeedback touchstart.interactionFeedback"),c.off("mouseup.interactionFeedback mouseout.interactionFeedback touchend.interactionFeedback touchcancel.interactionFeedback"),c.on("mousedown.interactionFeedback touchstart.interactionFeedback",b.createInstance(d,c),a.highlightOnInteractionStart),c.on("mouseup.interactionFeedback touchend.interactionFeedback touchcancel.interactionFeedback",b.createInstance(d,c),a.highlightOnInteractionEnd)}function k(c){switch(e.getObjType(c)){case"RadioGroup":break;case"VerticalHierarchie":case"HorizontalHierarchie":case"MenuHierarchie":break;case"Menu":break;default:c.on("click",b.createInstance(c[0].id,c),a.onClick).addClass("arcClickable"),j(c,c[0].id)}}function l(c){c.off("mousedown.resetDocSelectedObject",a.resetDocSelectedObject),c.on("mousedown.resetDocSelectedObject",b.createInstance(c[0].id,c),a.resetDocSelectedObject)}function m(b){switch(e.getObjType(b)){case"RadioGroup":case"VerticalHierarchie":case"HorizontalHierarchie":case"MenuHierarchie":case"Menu":break;default:b.off("click",a.onClick).removeClass("arcClickable")}}function n(a){switch(e.getObjType(a)){case"Field":case"Row":case"Column":case"Table":case"Menu":case"MenuHierarchie":case"HorizontalHierarchie":case"VerticalHierarchie":c.makeDropable(a)}}function o(c,d){c.off("click",a.onMenuClick),$("select",c).length>0?($("select",c).off("change",a.onChange),$("select",c).on("change",b.createInstance(d,c),a.onChange).addClass("arcChangeable")):c.on("click",b.createInstance(d,c),a.onMenuClick).addClass("arcClickable")}function p(c,d){if(e.isUseNativeMenu(c))return;var f=c.children(":first"),g=b.createInstance(d,c),h=b.createInstance(d,c);f.length>0&&(f.off("keypress"),f.on("keypress",g,a.onMenuKeyPress),f.off("keydown"),f.on("keydown",h,a.onMenuKeyDown))}function q(c,d){var e=c.children(":first"),f=b.createInstance(d,c),g=b.createInstance(d,c);f.eventCallbacks=a,g.eventCallbacks=a,e.length>0&&(e.on("click",b.createInstance(d,c),a.resetSelectedCell),e.off("keypress"),e.on("keypress",f,a.onTableKeyPress),e.off("keydown"),e.on("keydown",g,a.onTableKeyDown))}function r(c,d){var e=c.children(":first"),f=b.createInstance(d,c),g=b.createInstance(d,c);e.length>0&&(e.off("keypress"),e.on("keypress",f,a.onFieldKeyPress),e.off("keydown"),e.on("keydown",g,a.onFieldKeyDown))}function s(c,d){var e=c.children(":first"),f=b.createInstance(d,c),g=b.createInstance(d,c);e.length>0&&(e.off("keypress"),e.off("keydown"),e.on("keypress",f,a.onCheckboxKeyPress),e.on("keydown",g,a.onCheckboxKeyDown))}function t(c,d){var e=c.find("input"),f=b.createInstance(d,c);e.length>0&&(e.off("keydown"),e.on("keydown",f,a.onRadioButtonKeyDown))}function u(c,d){var e=c.children(":first"),f=b.createInstance(d,c),g=b.createInstance(d,c);e.length>0&&(e.off("keypress"),e.off("keydown"),e.on("keypress",f,a.onTextKeyPress),e.on("keydown",g,a.onTextKeyDown))}function v(c,d){var e=c.children(":first"),f=b.createInstance(d,c);e.length>0&&(e.off("focus"),e.on("focus",f,a.onFieldFocused))}function w(c,d){var e=c.children(":first"),f=b.createInstance(d,c);e.length>0&&(e.off("mousedown.fieldWithClickEvent"),e.on("mousedown.fieldWithClickEvent",f,a.onFieldMouseDown))}function x(c,d){var e=c.children(":first"),f=b.createInstance(d,c);e.length>0&&(e.off("focus"),e.on("focus",f,a.onTextFocused))}function y(b){b.off("click",a.onMenuClick),$("select",b).off("change",a.onChange)}function z(b){var c=a.getTarget(b),d=$(c).closest("tr").index(),f=$(c).closest("td").index(),g=b.data.ref.closest(".arcContainer"),h=e.getDocSelectedObjectManager(g);typeof h!="undefined"&&h.setSelectedObject(b.data.id),e.setSelectedCell(b.data.ref,{x:f,y:d}),a.onChange(b)}function A(b){var c=a.getTarget(b),d=$(c).closest("tr").index(),f=$(c).closest("td").index(),g=b.data.ref.closest(".arcContainer"),h=e.getDocSelectedObjectManager(g),i=e.getDatavirtualizationProperties(b.data.ref);h.setSelectedObject(b.data.id),e.setSelectedCell(b.data.ref,{x:f,y:d+i.firstElementInDOM}),a.onInput(b)}function B(a,b,c){var d;a.off("click.eventsetter",c.onClickUnformattedText),a.removeClass("arcTextInputActive"),a.find(".arcTextInputSizeTarget").removeClass("arcTextInputSizeTarget"),d=c.createExtendedEventDataForInput(a,b),a.on("click.eventsetter",d,c.onClickUnformattedText)}function C(a){var b=$("#"+a.data.id),c=e.getFont(b),d=$("textarea",b).html(),f=e.getForegroundColor(b),i=h.convertTextToHtml(d,c,f);b.children().first().css("display","none"),h.buildHtmlForNotInitialHtmlText(b),g.initializeEditorForNotInitialHtmlText(b,$("div[contenteditable]",b),i)}function D(a,b,c,d){var e;a.off("click.eventsetter",C),e=c.createExtendedEventDataForInput(a,b),d&&a.on("click.eventsetter",e,C)}var i={};return i.setEvents=function(b,c){var g=c[0].id;l(c),b&&b.Events&&e.isActive(c)&&(c.off("click",a.onClick),c.off("click",a.onInput),f.iterateArcplanArray(b.Events,function(a,b){switch(b.Type){case"OnClick":k(c),e.setHasClickEvent(c,!0);break;case"OnDrop":n(c);break;case"OnChange":case"OnExit":case"OnSwitch":case"OnCheck":case"OnUnCheck":case"OnComment":case"OnInput":break;default:d.warn('Unhandled event type: "'+b.Type+'" for object: '+g)}}))},i.setDragEvents=function(a){switch(e.getObjType(a)){case"Field":case"Row":case"Column":case"Table":case"Menu":case"MenuHierarchie":case"HorizontalHierarchie":case"VerticalHierarchie":c.makeDraggable(a)}},i.setTypeSpecificEvents=function(c){var d=c[0].id;if(e.isActive(c))switch(e.getObjType(c)){case"Menu":o(c,d),p(c,d);break;case"RadioGroup":$("input",c).on("click",b.createInstance(d,c),z).addClass("arcClickable"),t(c,d);break;case"CheckboxGroup":c.off("click",A),c.on("click",b.createInstance(d,c),A),e.setHasInputEvent(c,!0),s(c,d);break;case"VerticalHierarchie":case"HorizontalHierarchie":case"MenuHierarchie":p(c,d),c.off("click",a.onHierClick),c.on("click",b.createInstance(d,c),a.onHierClick),(e.getHasClickEvent(c)||e.getObjType(c)==="MenuHierarchie")&&c.addClass("arcClickable"),e.getObjType(c)!=="MenuHierarchie"&&j(c,d);break;case"Table":case"Column":case"Row":q(c,d);break;case"Field":r(c,d);break;case"Text":u(c,d)}},i.setEventForInput=function(a,b,c){var d=e.getIsEditable(a),f=e.isActive(a),h=f&&d,i=e.getObjType(a),j,k=e.isFormattedTextInput(a);switch(i){case"Field":case"Column":case"Row":case"Table":B(a,b,c),i==="Field"&&h&&(v(a,b),e.getHasClickEvent(a)&&w(a,b));break;case"Text":j=e.getContent(a),a.off("click.eventsetter",C),typeof j=="object"?g.initializeEditor(a,$("div[contenteditable]",a),j.HtmlSource):k?D(a,b,c,h):B(a,b,c),h&&x(a,b);break;default:}},i.removeAllEvents=function(b){function c(a){var b=a.find("input");b.length>0&&b.off("keydown")}function d(a){var b=a.children(":first");b.length>0&&(b.off("keypress"),b.off("keydown"))}function f(){$(":first",b).off("focus")}if(b.length===0)return;switch(e.getObjType(b)){case"Menu":y(b),d(b);break;case"RadioGroup":$("input",b).off("click",A).removeClass("arcClickable"),c(b);break;case"VerticalHierarchie":case"HorizontalHierarchie":case"MenuHierarchie":b.off("click",a.onHierClick),b.removeClass("arcClickable"),b.off("mousedown.interactionFeedback touchstart.interactionFeedback"),b.off("mouseup.interactionFeedback mouseout.interactionFeedback touchend.interactionFeedback touchcancel.interactionFeedback"),e.getObjType(b)==="MenuHierarchie"&&d(b);break;case"Table":case"Column":case"Row":case"CheckboxGroup":d(b);break;case"Field":case"Text":d(b),f()}e.getHasClickEvent(b)&&(m(b),e.setHasClickEvent(b,!1),b.off("mousedown.interactionFeedback touchstart.interactionFeedback"),b.off("mouseup.interactionFeedback mouseout.interactionFeedback touchend.interactionFeedback touchcancel.interactionFeedback"),b.off("mousedown.fieldWithClickEvent")),e.getHasInputEvent(b)&&(b.off("click",a.onInput),e.setHasInputEvent(b,!1)),b.off("click.eventsetter"),b.removeClass("arcTextInputActive"),b.find(".arcTextInputSizeTarget").removeClass("arcTextInputSizeTarget"),b.off("mousedown.resetDocSelectedObject")},i}return{createInstance:i}}),define("waitingtypes",{NotWaiting:0,RequestWaiting:1,ApplicationWaiting:2}),define("userinformation",["ui","guitypes","stringtools","logger","msgbox","popuppositioner","userdialog","tools","replytypes","clientcredentials","properties","events/eventcallbacks","popuphandler","stringsres","stringsid","waitingtypes"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function s(){return window}function t(a,b,e){var f,g,h=a.Parameter.Elements[0].Text,j=[],k,l,m,n;f={UserInformation:{Reply:{Type:i.startJS,Blob:""}}},m=h.split("."),g=s();while(m.length>0&&g)n=m.splice(0,1),g=g[n];for(k=1;k<a.Parameter.Elements.length;k+=1)a.Parameter.Elements[k].Text!==undefined?j.push(a.Parameter.Elements[k].Text):a.Parameter.Elements[k].Double!==undefined?j.push(parseFloat(a.Parameter.Elements[k].Double)):(d.error("Unexpected Parameter type at index: "+k),j.push(undefined));d.log("startjs: "+h+"() with "+j.length+" parameter(s)");if(typeof g=="function")try{l=g.apply(s(),j)}catch(o){d.error("Exception in "+h+"(): "+o)}else d.error(h+" is not a function");f.UserInformation.Reply.Blob=c.encodeBase64(l),b(f,e)}function u(a,b,c){function k(){var a={UserInformation:{Reply:{Type:i.msgbox,Result:1}}};b(a,c),j instanceof HTMLElement&&j.focus()}var d=a.MessageBox||a,f,g={16:"error",48:"warning",64:"info"},h=g[d.Flags],j=document.activeElement;f=e.createMsgBox().withCaption(d.Caption||"Information").withText(d.Text).withCallback(k).withEscCancelCallback(k),h&&f.indicating(h),f.andShowIt()}function v(a,b,c){var d=a.MessageBox||{},f=parseInt(d.Flags||"0",10),g=e.createMsgBox().withCaption(d.Caption).withText(d.Text).indicating("question"),h=document.activeElement,j=function(a){var d={UserInformation:{Reply:{Type:i.question,Result:a}}};b(d,c),h instanceof HTMLElement&&h.focus()};f===r.okcancel?(g.onOk(function(){j(1)}),g.onCancel(function(){j(0)})):f===r.yesno?(g.onYes(function(){j(1)}),g.onNo(function(){j(0)}),g.withoutEscCancel()):f===r.yesnocancel&&(g.onYes(function(){j(1)}),g.onNo(function(){j(2)}),g.onCancel(function(){j(0)})),g.show()}function w(a,b,c,d){g.createUserDialog().forUIRequest(a).withDoSendEvent(b).withCallback(c).withChangeUserTypeForEngageLoginCallback(d).andShowIt()}function x(a,b,d,e,g,i){var j,n,o,p,q=null,r,s,t,u,v,w=0,x=e.Elements?e.Elements.length:1,y=30,z=d?d.x:0,A=d?d.y:0,B,C,D,E=[],F=function(a){function e(){var d=0,e=999999,f=0;for(f=0;f<a;f+=1){if(typeof b[f]!="string")return f;c[f]<e&&(d=f,e=c[f])}return d}function f(a){var d=e();b[d]=a.html,c[d]=a.content.length}var b=[],c=[],d=0;return{push:function(a){var b=0;typeof a.html=="string"&&a.content.length>d&&f(a)},getArray:function(){return b}}}(4);$("#arcPopupObject").remove(),j=$("#arcDialogCenter");if(j.length===0||!j.is(":visible"))j=$("#arcContainer");o="<div id='arcPopupObject' style='position:absolute;'><div class='arcpopup'><div><div></div><div class='arcPopupContent arcHierPopupContent'><div class='arcMenu'><ul></ul></div></div><div></div></div>",r=$(o),s=$(o).appendTo(j),p=c.makeID(g,0),q=$("#"+p).offset(),n=j.offset(),q&&i&&(q.left-=n.left,q.top-=n.top,r.offset(q),s.offset(q)),t=$(".arcMenu ul",r),u=$(".arcMenu ul",s),!e.Elements&&e.Row&&(e.Elements=[{Row:e.Row}]),h.iterateArcplanArray(e,function(a,b){var c,d,e;w+=1;switch(a){case"PrinterName":c=b,d=0;break;case"Row":c=b.Text,d=w}c==="----------"?e="<li class='arcMenuItem arcMenuSeparator' value='"+d+"'>"+"<div class='arcMenuSelectionDiv'>"+"<span></span>"+"</div>"+"<div class='arcMenuSeparator arcMenuLineSeparator'></div>"+"</li>":e="<li class='arcMenuItem' value='"+d+"'>"+"<div class='arcMenuSelectionDiv'>"+"<span></span>"+"</div>"+"<div class='arcMenuItemText'>"+c+"</div>"+"</li>",F.push({html:e,content:c}),E.push(e)}),u.append(F.getArray().join("")),t.append(E.join("")),k.setSelectType(r,"HierSingleSelect"),k.setNumRows(r,x),k.setRowHeight(r,y),k.setXPos(r,z),k.setYPos(r,A),v={requestProcessor:undefined,id:"arcPopupObject",ref:r},B=x*y,C=u.outerWidth(),D=f.getPopupPosition(z,A,C,B,j.offset()),$("#arcPopupObject",j).remove(),r.appendTo(j),r.on("click",v,l.onPopupFunction).addClass("arcClickable"),m.showByRect(r,null,D)}function y(a,b,c,d,e){var f=typeof a.PopUp.PositionX!="undefined"&&typeof a.PopUp.PositionY!="undefined",g={x:a.PopUp.PositionX||d.x,y:a.PopUp.PositionY||d.y},h=document.activeElement;x(a,c,g,a.PopUp.Rows,e,f),m.setCallBack(function(a){var d={UserInformation:{Reply:{Type:i.popupmenu,Value:a}}};$("#arcPopupObject").remove(),b(d,c),h instanceof HTMLElement&&document.activeElement instanceof HTMLBodyElement&&h.focus()})}function z(a,b,c,d){function f(a){var d={UserInformation:{Reply:{Type:i.printerAlias,PrinterName:a}}};b(d,c)}a.UserPrinters.Elements.length>2?e.createMsgBox().withCaption("Printing").withText("Please choose the printer you would like to use:<br><br>").withComboBox(a.UserPrinters).onOk(function(b){f(a.UserPrinters.Elements[b.comboBoxSelection].PrinterName)}).onCancel(function(a){f("0")}).andShowIt():a.UserPrinters.Elements.length===2&&f(a.UserPrinters.Elements[1].PrinterName)}function A(a,b,c,d,f,g){function i(){h instanceof HTMLElement&&h.focus()}var h=document.activeElement;ARCPLAN.cameBackWith=function(a){var b=f;a.GetUserInformation?typeof b=="function"&&b(a):(c(a,!1),$.modal.close()),delete ARCPLAN.cameBackWith},e.createMsgBox().withFileUpload(g).withCaption(n.getMessageById(o.UPLOAD_TITLE)).withText(n.getMessageById(o.UPLOAD_SELECT_FILE)).onCancel(function(a){var d=a||window.event,e={UserInformation:{Reply:{Result:-1}}};return d.cancelBubble=!0,d.stopPropagation&&d.stopPropagation(),b(e,c),i(),!1}).onOk(function(a){var b=a||window.event,c=window.frames.fileUploadFrame.document,e=$("#importFile",c),f=e?e.val().split("\\").pop():"",g="",h={UserInformation:{Reply:{Value:"1",FileName:"",Blob:""}}};$("#importFile",c).css("display","none"),$("#importFileSelect",c).prop("disabled",!0),$("#importBtnOk",c).prop("disabled",!0),$("#importBtnCancel",c).prop("disabled",!0),$("#uploadInProgress",c).css("display","block");if(f||!$("#soapMessage",c).val())h.UserInformation.Reply.FileName=f,typeof d=="function"&&(g=d(h)),$("#soapMessage",c).val(g);window.setTimeout(function(){var a=$("#importForm",c);return function(){a.submit()}}(),100),b.cancelBubble=!0,b.stopPropagation&&b.stopPropagation(),i(),b.preventDefault()}).andShowIt()}function B(a,b,c){function d(a){var d={UserInformation:{Reply:{Type:i.longviewGroup,Text:a}}};b(d,c)}e.createMsgBox().withCaption(n.getMessageById(o.LONGVIEW_GROUP)).withText(n.getMessageById(o.LONGVIEW_GROUP_DESCRIPTION)).withComboBox(a.Groups).onOk(function(b){d(a.Groups.Elements[b.comboBoxSelection].Group)}).andShowIt()}function C(a,b,c,d){var e=j.getKeychain(d);b(e,c)}function D(a,b,c,d){var f=j.storeKey(d,a.UserName,a.ClientCredential);f&&f.UserInformation&&f.UserInformation.Reply&&f.UserInformation.Reply.Result===0?e.createMsgBox().withCaption(n.getMessageById(o.CONFIGURATION_ERROR_TITLE)).withText(n.getMessageById(o.PASSWORDNOTSAVED)).indicating("error").onOk(function(a){b(f,c)}).logIt().andShowIt():b(f,c)}function E(a){var b;return h.each(a,function(a){a!=="Type"&&(b=a)}),b}var q={},r={okcancel:1,yesno:4,yesnocancel:3};return q.handleUserInformation=function(a,c){if(a.Type===b.StartJS)return t(a.UserFunction,c.doSoapRequest,c.callback);if(a.Type===b.GetKeychain)return C(a,c.doSoapRequest,c.callback,c.application);if(a.Type===b.ClientStoreKey)return D(a,c.doSoapRequest,c.callback,c.application);c.setWaitingState(p.NotWaiting),a.Type===b.Message?u(a,c.doSoapRequest,c.callback):a.Type===b.Question?v(a,c.doSoapRequest,c.callback):b.isLoginGUIType(a)?w(a,c.doSoapRequest,c.callback,c.changeUserTypeForEngageLoginCallback):a.Type===b.Popupmenu?y(a,c.doSoapRequest,c.callback,c.mouseDownPos,c.topDocumentName):a.Type===b.UserPrinter?z(a,c.doSoapRequest,c.callback,c.mouseDownPos):a.Type===b.FileFromApplet?A(a,c.doSoapRequest,c.callback,c.getSoapCallback,c.secondUICallback,c.cgiUrl):a.Type===b.LongviewGroup?B(a,c.doSoapRequest,c.callback):e.createMsgBox().withCaption(n.getMessageById(o.NOT_IMPLEMENTED_TITLE)).withText(n.getMessageById(o.NOTIMPLEMENTED_UNSERINFOSTYPE,[a.Type,E(a)])).indicating("error").andShowIt()},q}),define("requestprocessorfactory",["clienttype","stringtools","tools","requesttools","userinformation","version","events/eventid","msgbox","browserfeatures","userparam","keepalive","scroll","filterpanel","objectpropertyapplier","stringsres","stringsid","openlinkaction","splashscreen","properties","showhiermenuaction","timinginfofactory","waitingtypes"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){function w(w,x,y,z,A){function B(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=Math.random()*16|0,c=a==="x"?b:b&3|8;return c.toString(16)})}function C(){var a=$("#arcContainer"),b=a?a.position():null;return x&&x.getFixedWindowSizeForWidget()?x.getFixedWindowSizeForWidget().width:$(window).width()-(b?b.left:0)}function D(){var a=$("#arcContainer"),b=a?a.position():null;return x&&x.getFixedWindowSizeForWidget()?x.getFixedWindowSizeForWidget().height:$(window).height()-(b?b.top:0)}function E(){return typeof x.getDocAreaRectForWidget()!="undefined"}function bF(a,b){function c(){delete F.pendingPictRequests[a]}function e(b){var d=F.pendingPictRequests[a],e=d.length,f;for(f=0;f<e;f+=1)d[f](b);c()}function f(d,e,f){if(F.isSessionClosing===!0)return;b+=1,b<10?setTimeout(function(){bF(a,b)},F.timeoutBetweenRetries):(Z(d,e,f),c())}d.ajax({url:a,type:"GET",success:e,error:f,beforeSend:function(a){a.setRequestHeader("arcSessionToken",I())}})}var F={application:x?x.getApplication():undefined,cgiSite:w,clientParams:{clientType:x.getClientType(),platformName:"Windows Desktop",browserVersion:navigator.appVersion,language:navigator.language,width:C(),height:D(),leftMargin:"0",topMargin:"0",printMode:"4",titleBar:"0",passwordChange:"0"},changedView:undefined,openDocList:[],closeDocList:[],showHierMenuList:[],keepAliveIntervalId:undefined,isSessionClosing:!1,operationNames:{ClosePresentation:"ClosePresentation",CreateBookmark:"CreateBookmark",GetAreaImage:"GetAreaImage",InitPresentation:"InitPresentation",KeepAlive:"KeepAlive",OpenDocument:"OpenDocument",OpenStartDoc:"OpenStartDoc",SendAppletProps:"SendAppletProps",SendEvent:"SendEvent"},runningRequestList:[],serverName:"",sessionContext:x,sessionID:0,sessionToken:"",startdoc:x?x.getStartDoc():undefined,view:undefined,isUserinformationPending:!1,inboxAction:undefined,timeoutBetweenRetries:5e3,openingStartDoc:!1,lastEventForWidget:undefined,pendingPictRequests:{},timingInfoInstance:u.createInstance(),lastMouseDownPos:{x:undefined,y:undefined}},G=[],H,I=function(){return"arcSessionToken="+window.escape(F.serverName)+"|"+F.sessionID},J=function(a){F.timeoutBetweenRetries=a},K=function(a,b,c,d,e){var f=o.getMessageById(b),g=o.getMessageById(c);L(a,f,g,"error",d,e)},L=function(a,b,c,d,e,f){var g;a&&a({caption:b,text:c});if(f===!0){e&&d==="error"&&F.sessionContext.logger.error(b+" "+c);return}g=h.createMsgBox(),g.withText(c).withCaption(b).indicating(d),e&&g.logIt(),F.sessionContext.setWaitingState(v.NotWaiting),F.openingStartDoc=!1,g.andShowIt()},M=function(a){F.view=a},N=function(a){F.executePendingEventCallback=a},O=function(){var a=F.serverName+F.sessionID,b=[];return b[a.length]="x",b.join("x")},P=function(a){var b=d.createGetRequest("Presentation",F.cgiSite,"",{PARAM1:0,PARAM2:"GETOBJECTPICTFROMCACHE",PARAM3:0,PARAM4:'"'+a+'"',SPACE:'"'+O()+'"'});return b},Q=function(a){var b=d.createGetRequest("Presentation",F.cgiSite,window.escape(F.serverName),{PARAM1:0,PARAM2:"GETOBJECTPICTFROMCACHE",PARAM3:F.sessionID,PARAM4:'"'+a+'"',SPACE:'"'+O()+'"'});return b},R=function(a,b,c){var e=d.createGetRequest("Presentation",F.cgiSite,F.serverName,{PARAM1:0,PARAM2:"GETHIERDATAFROMCACHE",PARAM3:F.sessionID,PARAM4:'"'+a+'"',PARAM5:b,PARAM6:c,SPACE:'"'+O()+'"'});return e},S=function(a,b,c){var e=d.createGetRequest("Presentation",F.cgiSite,F.serverName,{PARAM1:0,PARAM2:"GETOBJECTDATAFROMCACHE",PARAM3:F.sessionID,PARAM4:'"'+a+'"',PARAM5:b,PARAM6:c,SPACE:'"'+O()+'"'});return e},T=function(a,b,c,e){var f=d.createGetRequest("Presentation",F.cgiSite,F.serverName,{PARAM1:0,PARAM2:"GETOBJECTDATAFROMCACHEWITHFILTER",PARAM3:F.sessionID,PARAM4:'"'+a+'"',PARAM5:b,PARAM6:c,PARAM7:'"'+encodeURIComponent(e)+'"',SPACE:'"'+O()+'"'});return f},U=function(a){var b;if(G[a]){for(b in G[a])G[a][b].abort();G[a]=undefined}},V=function(a,b,c,e,f,g,h){var i,j;if(G[b]){if(G[b][f])return F.sessionContext.logger.log("request already send to server hash: "+b+" startRow: "+c+" numRows:"+e),!1;for(j in G[b])G[b][j].abort();G[b]=[]}return i=d.ajax({url:g,type:"GET",success:function(d){G[b]&&h(a,c,d,H)},error:function(a,c,d){G[b][f]=undefined,Z(a,c,d)},beforeSend:function(a){a.setRequestHeader("arcSessionToken",I())}}),G[b]||(G[b]=[]),G[b][f]=i,!0},W=function(a,b,c,d,e){var f=R(b,c,d),g=""+c+"_"+d;V(a,b,c,d,g,f,e)},X=function(a,b,c,d,e){var f=S(b,c,d),g=""+c+"_"+d;V(a,b,c,d,g,f,e)},Y=function(a,b,c,d,e,f){var g=T(b,c,d,e),h=e+c+"_"+d;return U(b),V(a,b,c,d,h,g,f)},Z=function(a,c,d,e){if(d==="abort"||F.isSessionClosing&&d==="")return;F.sessionContext.logger.error(a),b.hasUrlWrongProtocol(F.cgiSite,window.location.protocol)?K(e,p.CONFIGURATION_ERROR_TITLE,p.PROTOCOL_MISMATCH,!1):K(e,p.NETWORK_ERROR_TITLE,p.NETWORK_ERROR,!1)},_=function(a,b){var c;F.pendingPictRequests.hasOwnProperty(a)?(c=F.pendingPictRequests[a],c.push(b)):(F.pendingPictRequests[a]=[b],bF(a,0))},ba=function(a,b,c){var e;try{F.timingInfoInstance.setRequestStartTime(Date.now()),e=d.ajax(a),F.isSessionClosing===!1&&F.runningRequestList.push(e)}catch(f){throw K(b,p.NETWORK_ERROR_TITLE,p.NETWORK_ERROR,!0,c),f}},bb=function(a,b,e,f,g,h){function n(){ba(m,g,h)}function o(a,b){if(F.isSessionClosing===!0&&a.statusText==="abort")return;F.timingInfoInstance.setNetworkDuration(a);var d,f,i,o,q=F.runningRequestList.indexOf(a);if(!j){q>-1&&F.runningRequestList.splice(q,1);if(a)try{ARCPLAN.logFullResponseText?f=a.responseText:f=a.responseText.substring(0,500),d=jQuery.parseJSON(a.responseText),f=null,d&&d.WaitForServer==="true"?(setTimeout(n,F.timeoutBetweenRetries),j=!0):d&&d.Error?(d.Error.Type==="CgiError"&&d.Error.ID===-5&&(k+=1,k<8?(j=!0,J(500),K(m.error,p.NETWORK_ERROR_TITLE,p.DATA_ERROR_NO_BODY,!0,!0)):(J(l),j=!1)),j||(o=c.formatError(d.Error),L(g,o.caption,o.text,o.type,!0,h),i=!0)):J(l)}catch(r){throw F.sessionContext.logger.error(r),f&&F.sessionContext.logger.error("responseText: "+f),K(g,p.DATA_ERROR_TITLE,p.READING_SERVER_ANSWER_ERROR,!1,h),i=!0,r}}if(!j)try{i||e(d)}catch(s){throw F.sessionContext.logger.error(s),K(g,p.INTERNAL_ERROR_TITLE,p.INTERNAL_ERROR,!0,h),s}}function q(){F.timingInfoInstance.setRequestEndTime(Date.now()),j=!1}function r(a,b,c){if(F.isSessionClosing===!0)return;k+=1,k<10?(j=!0,setTimeout(n,k===1?1:F.timeoutBetweenRetries)):Z(a,b,c,g)}var i=d.createSoapRequest(a,b,F.serverName,F.timingInfoInstance.getTimingInfo()),j=!1,k=0,l=F.timeoutBetweenRetries,m;m={url:F.cgiSite,type:"POST",contentType:"text/xml",dataType:"xml",data:i,accepts:{xml:"application/json"},converters:{"text xml":function(a){return a}},complete:o,error:r,success:q},n()},bc=function(a){return function(b){var c=a;return d.createSoapRequest(c,d.addSessionIdAndTokenToParams(b,F.sessionID,F.sessionToken),F.serverName,F.timingInfoInstance.getTimingInfo())}},bd=function(){return F.isUserinformationPending},be=function(b,c){var d=function(a,c){F.isUserinformationPending=!1,bf(b,a,c,"userInformationCallback")};return function(f){if(f.GetUserInformation){var g=be(b,c),h={doSoapRequest:d,callback:c,mouseDownPos:bA(),setWaitingState:F.sessionContext.setWaitingState,getSoapCallback:bc(b),secondUICallback:g,application:F.application,cgiUrl:F.cgiSite,topDocumentName:F.view.getTopDocumentName()};F.clientParams.clientType===a.E_HTML5LOGONCLIENT&&(h.changeUserTypeForEngageLoginCallback=F.sessionContext.getChangeUserTypeForEngageLoginCallback()),F.isUserinformationPending=!0,e.handleUserInformation(f.GetUserInformation,h)}else c(f)}},bf=function(a,b,c,d,e,f){var g;return g=be(a,c),F.sessionContext.setWaitingState(v.RequestWaiting),bg(a,b,g,d,e,f)},bg=function(a,b,c,e,f,g){var h=d.addSessionIdAndTokenToParams(b,F.sessionID,F.sessionToken);return bb(a,h,c,e,f,g)},bh=function(a){var b,d,e=!1;F.view.loadDocument(a),F.closeDocList.length>0&&(c.each(F.closeDocList,function(a,b){F.view.closeDocument(b)}),F.closeDocList=[]),F.openDocList.length>0?(ARCPLAN.hideContentWhileLoadingDocuments!==!1&&$("#arcContainer").css("display","none"),b=F.openDocList.shift(),F.openDocList.length===0&&ARCPLAN.hideContentWhileLoadingDocuments!==!1&&(e=!0),bj(b,e)):(F.changedView?(d=F.changedView,F.changedView=undefined,bs(d.docName,0,d.evID,d.viewName)):F.sessionContext.setWaitingState(v.NotWaiting),F.sessionContext.onDocumentLoaded(),F.openingStartDoc=!1),F.inboxAction&&(F.view.executeInputBoxAction(F.inboxAction),F.inboxAction=undefined),F.timingInfoInstance.setClientProcessingDuration(Date.now())},bi=function(a){var c,d;h.createMsgBox().withCaption(o.getMessageById(p.INFORMATION_TITLE)).withText(o.getMessageById(p.WIDGET_OPEN_ANOTHER_DOCUMENT_QUESTION)).indicating("question").onCancel(function(e){if(ARCPLAN.isFrameSet)window.location.reload();else if(F.closeDocList.length>0)for(c=0;c<F.closeDocList.length;c+=1){d=b.removeExtension(F.closeDocList[c]);if(a===d){window.location.reload();break}}}).onOk(function(a){F.sessionContext.onOpenDocumentFromWidget(F.lastEventForWidget),ARCPLAN.isFrameSet&&window.location.reload()}).andShowIt()},bj=function(a,c){var d=b.removeExtension(a),e=b.removeExtension(F.startdoc);d!==e&&E()?bi(e):(F.sessionContext.logger.log("doOpenDoc: "+d),bf(F.operationNames.OpenDocument,{Worksheet:d,Width:F.clientParams.width,Height:F.clientParams.height,"PrintState ":!1},function(a){bh(a),c&&$("#arcContainer").css("display","block")},"doOpenDoc"))},bk=function(a,b){var c=d.createGetRequest("Presentation",F.cgiSite,F.serverName,{PARAM1:0,PARAM2:"DownloadFile",PARAM3:'"'+a+'"',PARAM4:0,SPACE:".pdf"});b.open(c,"PDF "+B())},bl=function(a,b,c){var e,f,g,h=a;typeof b=="string"&&b.length>0&&(g=b.lastIndexOf("\\"),g!==-1?h=b.substring(g+1):h=b),f={PARAM1:0,PARAM2:"DownloadFile",PARAM3:'"'+encodeURIComponent(a)+'"',PARAM4:0,PARAM5:'"'+encodeURIComponent(h)+'"'},e=d.createGetRequest("Presentation",F.cgiSite,F.serverName,f),c.open(e,"Export "+B())},bm=function(a){var b=[],d,e;c.iterateArcplanArray(a,function(f,g){g.ObjID&&(d=g,e={},e[f]=d,b.push(e),c.iterateArcplanArray(a,function(a,b){if(f===a&&b.ObjID&&g.ObjID===b.ObjID&&g.Worksheet===b.Worksheet&&g!==b&&d.ObjectData)return d.BaseProperties=b.BaseProperties,d.ObjectProperties=b.ObjectProperties,d.View=b.View,delete b.ObjID,!1}))}),a.Elements=b},bn=function(a,b){var d={Elements:[]},e=a.Actions||{Elements:[]},f=b,g=!1,h=!1,i=!1,j=!1,k=[],l;a.GetUserInformation||(F.isUserinformationPending=!1),F.openingStartDoc===!0&&!a.Actions&&(F.openingStartDoc=!1,typeof ARCPLAN.onStartDocLastAction=="function"&&ARCPLAN.onStartDocLastAction()),c.iterateArcplanArray(e,function(a,b){switch(a){case"UpdateObjPropAction":case"UpdateObjContAction":b.UpdateObjects&&(d.Elements=d.Elements.concat(b.UpdateObjects.Elements),b.UpdateObjects.Elements.length=0),j=!0}}),c.iterateArcplanArray(e,function(a,b){switch(a){case"OpenDocAction":f?F.openDocList.push(b.Worksheet):bj(b.Worksheet),f=!0;break;case"UpdateObjPropAction":case"UpdateObjContAction":j&&(bm(d),A?F.view.updateObjects(d):(y.updateArcplanObjects(d),k=F.view.oldTransferObjects(null,d)),j=!1);break;case"CloseDocumentAction":f?F.closeDocList.push(b.Worksheet):F.view.closeDocument(b.Worksheet);break;case"OpenDownloadFileAction":bl(b.FileName,b.Export,window);break;case"OpenPrintDocumentAction":bk(b.Worksheet,window);break;case"SetViewRulesAction":z.setViewRules(b.Views,$(window).width(),$(window).height());break;case"CancelAction":g=!0;break;case"InputBoxAction":f?F.inboxAction=b:F.view.executeInputBoxAction(b),h=!0;break;case"FinishAction":F.view.cleanOnSessionEnd(),window.history.back();break;case"URLListAction":F.sessionContext.setWaitingState(v.NotWaiting),q.executeOpenLinkAction(b);break;case"NotifyLoginAction":F.sessionContext.onNotifyLogin();break;case"OpenApplicationAction":F.sessionContext.setWaitingState(v.NotWaiting),q.executeOpenApplicationAction(b,F.cgiSite);break;case"ShowHierarchyMenuPopupAction":F.showHierMenuList.push(b)}}),n.updateReferences(null,d,undefined,H),F.view.doPostUpdate(),f||(F.changedView?(l=F.changedView,F.changedView=undefined,bs(l.docName,0,l.evID,l.viewName)):F.sessionContext.setWaitingState(v.NotWaiting)),i=F.executePendingEventCallback(h||g),ARCPLAN.useEventOrder!==!0&&(i===!1||g)&&F.view.showPendingEditCell(f,g),F.showHierMenuList.length>0&&(t.executeShowHierMenu(F.showHierMenuList,F.view.getTopDocumentName(),bA(),y),F.showHierMenuList.length=0),F.timingInfoInstance.setClientProcessingDuration(Date.now())},bo=function(){F.sessionContext.logger.log("doOpenStartDoc: "+F.startdoc),F.openingStartDoc=!0,bf(F.operationNames.OpenStartDoc,{Worksheet:F.application+"\\"+F.startdoc,ObjID:0,EventID:g.EID_OPENSTARTDOC,ClientType:F.clientParams.clientType},bn,"doOpenStartDoc")},bp=function(){var a,d;a="smil "+i.smil+",svg "+i.svg+",nativeTouchControls "+i.nativeTouchControls+",datavirtualization "+(ARCPLAN.datavirtualization!==!1),d=function(a){a&&(bn(a,!0),bo())},F.sessionContext.logger.log("doAppletProps("+F.sessionID+")"),bf(F.operationNames.SendAppletProps,{Worksheet:"",ObjID:"0",EventID:g.EID_SENDAPPLETPROPS,ClientType:F.clientParams.clientType,PrintMode:F.clientParams.printMode,TitleBar:F.clientParams.titleBar,Width:F.clientParams.width,Height:F.clientParams.height,PasswordChangeEnabled:F.clientParams.passwordChange,LocalSaveEnabled:0,BrowserFeatures:a,ClientBaseUrl:b.removeRubbishFromClientBaseURL(window.require.toUrl("")),ClientPlatformType:i.platformType,cgiurl:c.getAbsoluteUrlToCGI(F.cgiSite)},d,"doAppletProps")},bq=function(){var a=function(){j.clear(),bp()};F.sessionContext.logger.log("doUserParams("+F.sessionID+")"),bf(F.operationNames.SendEvent,{Worksheet:"",ObjID:"0",EventID:g.EID_SENDUSERPARAM,Text:"0",UserParameters:j},a,"doUserParams")},br=function(a,b,c,d,e,f){var h;E()&&(c===g.EID_SWITCH?h="SWITCH":c===g.EID_CLICK?h="CLICK":c===g.EID_INPUT&&(h="INPUT"),h&&(F.lastEventForWidget={docName:a,objID:b,eventName:h,value:d,row:e+1,column:f+1}))},bs=function(a,c,d,e,f,h,i,j,k){if(F.isUserinformationPending){F.sessionContext.logger.warn("SendEvent, ignoring sendEvent because UserInformation is pending");return}var n,o,p,q={Worksheet:a,ObjID:c,EventID:d};o=b.makeID(a,c),p=$("#"+o);if(s.isActive(p)===!1){F.sessionContext.logger.log("SendEvent, Trying to send an event to the inactive object "+c+", document="+a+", eventID="+d);return}br(a,c,d,e,f,h),F.view.isLayoutManagedInDoc(a)&&(q.Size=F.view.getCurrentDocSize(a)),F.sessionContext.logger.log("SendEvent, eventID="+d);switch(d){case g.EID_SWITCH:q.Value=e,n=!0;break;case g.EID_CLICK:q.Text=e;break;case g.EID_INPUT:q.Text=e;break;case g.EID_ONVIEWCHANGED:q.Text=e;break;case g.EID_SWITCH_HIERPOPUP:q.Text=e,n=!0;break;case g.EID_OPENNODE:case g.EID_CLOSENODE:q.Row=e;break;case g.EID_SELECTNODE:q.Node=e;break;case g.EID_MULTISELECTION:q.Selections=e,n=!0;break;case g.EID_DOCACTIVATE:case g.EID_DROP:q.Text=e}f!==undefined&&(q.PositionY=f),h!==undefined&&(q.PositionX=h),d===g.EID_SELECTNODE?q.Shift=j===!0||k===!0:d===g.EID_INPUT?(q.Key=i||0,q.Shift=j===!0,q.Ctrl=k===!0):d===g.EID_CLICK&&(q.Shift=j===!0,q.Ctrl=k===!0),q.Settings=l.getScrolledObjects(),l.clearScrolledObjects(),bf(F.operationNames.SendEvent,q,bn,"doSendEvent"),n===!0&&m.notifyFilterHasChanged(o)},bt=function(a){bs(a,0,g.EID_DOCACTIVATE,"0")},bu=function(a,b,c){if(!F.sessionContext.isWaitingState()&&!bd())bs(a,0,b,c);else{if(F.isSessionClosing)return;F.changedView={docName:a,evID:b,viewName:c}}},bv=function(a,b){function c(a){bn(a),b()}F.sessionContext.logger.log("doOpenBookmark("+F.sessionID+")"),bf(F.operationNames.SendEvent,{Worksheet:F.startdoc,ObjID:"0",EventID:g.EID_OPENBOOKMARK,Text:a},c,"doOpenBookmark")},bw=function(a,b){function c(b){F.sessionContext.setWaitingState(v.NotWaiting),a({application:F.application,document:F.view.getTopDocumentName(),bookmark:b.Bookmark})}F.sessionContext.logger.log("CreateBookmark("+F.sessionID+")"),bf(F.operationNames.CreateBookmark,{Element:0,ObjID:0,Worksheet:F.view.getTopDocumentName()},c,"doCreateBookmark",b)},bx=function(a,b,c){function d(a){F.sessionContext.setWaitingState(v.NotWaiting),b({imageString:a.Image.v})}F.sessionContext.logger.log("GetAreaImage("+F.sessionID+")"),bf(F.operationNames.GetAreaImage,{Worksheet:F.view.getTopDocumentName(),x:a.x,y:a.y,width:a.width,height:a.height},d,"doGetAreaImage",c)},by=function(a){var b=d.createGetRequest("closepresentation",F.cgiSite,F.serverName,{PARAM1:F.sessionID});F.isSessionClosing||(F.sessionContext.logger.log("closeSession("+F.sessionID+")"),k.stopKeepAlives(F.keepAliveIntervalId),F.isSessionClosing=!0,$.each(F.runningRequestList,function(a,b){b.abort()}),d.makeGetRequest(b,a),F.runningRequestList=[],F.view.cleanOnSessionEnd(),$.modal.close())},bz=function(a){var b=$("#arcContainer").offset();F.lastMouseDownPos.x=a.pageX-b.left,F.lastMouseDownPos.y=a.pageY-b.top},bA=function(){return{x:F.lastMouseDownPos.x,y:F.lastMouseDownPos.y}},bB=function(a){a==="-112"?K(null,p.LICENCE_ERROR_TITLE,p.LICENCE_EXCEEDED,!0):a==="-113"?K(null,p.LICENCE_ERROR_TITLE,p.LICENCE_EXPIRED,!0):a==="-116"?K(null,p.LICENCE_ERROR_TITLE,p.NOMOBILE_CLIENT_LICENSE,!0):a==="-118"?K(null,p.LICENCE_ERROR_TITLE,p.NOHTML5_MOBILEUSAGE,!0):a==="-119"?K(null,p.LICENCE_ERROR_TITLE,p.NOTHML5_USAGE,!0):K(null,p.DATA_ERROR_TITLE,p.SESSION_END,!0)},bC=function(a,b){var c="";return d.addSessionIdAndTokenToParams(b,F.sessionID,F.sessionToken),c=d.createSoapRequest(a,b,F.serverName,F.timingInfoInstance.getTimingInfo()),c},bD=function(){function b(a){var b="Error on send KeepAliveRequest:";typeof a!="undefined"&&(typeof a.caption!="undefined"&&(b+=" Details:"+a.caption),typeof a.text!="undefined"&&(b+=" - "+a.text)),F.sessionContext.logger.log(b),k.stopKeepAlives(F.keepAliveIntervalId)}var a=!0;bg(F.operationNames.KeepAlive,{},function(){},"keepAlive",b,a)},bE=function(){var a=ARCPLAN.language||"server",c={server:"0",en:"1",de:"2"};a.toLowerCase()==="client"&&(a=b.browserLangToArcplanLang(i.clientLanguage));switch(a.toLowerCase()){case"en":return c.en;case"de":return c.de;default:return c.server}};return H={doInitPresentation:function(){var a=function(a){a&&(F.sessionID=a.SessionID,F.sessionToken=a.SessionToken,F.serverName=a.SelectedServerName,F.serverVersion=a.ServerVersion,F.licenseFlag=a.License,F.licenseType=a.Type,F.licenseOwnerName=a.OwnerName,r.addLicenseInformation(F.serverVersion,F.licenseFlag,F.licenseType,F.licenseOwnerName),F.sessionID>0?(j.getNumParams()>0?bq():bp(),F.keepAliveIntervalId=k.startKeepAlives(bD)):bB(F.sessionID))};F.sessionContext.setWaitingState(v.RequestWaiting),F.sessionContext.logger.log("InitPresentation "+(new Date).toLocaleString()),bb(F.operationNames.InitPresentation,{ClientType:F.clientParams.clientType,AppName:F.application+"\\"+F.startdoc,ClientVersion:f.getVersion(),LangId:bE(),arcplanClient:null,Value:0,Type:0,ClientPlatformTyp:"",TenantName:ARCPLAN.tenantName?ARCPLAN.tenantName:"",ProcessNr:F.sessionContext.getProcessNr()},a,"doInitPresentation")},hasPendingUserinformation:bd,doSendEvent:bs,doChangeViewEventWithRetryIfWaiting:bu,doDocActivateEvent:bt,doOpenDoc:bj,doOpenBookmark:bv,doCreateBookmark:bw,doGetAreaImage:bx,doOpenPDF:bk,doOpenFile:bl,buildObjectPictRequest:P,buildChartRequest:Q,downloadPictToBrowserCache:_,setView:M,setExecutePendingEventCallback:N,requestObjectData:X,requestHierData:W,requestObjectDataWithFilter:Y,closeSession:by,setLastMouseDownPos:bz,getSoapMessage:bC,setTimeOutInMilliseconds:J,removeHashFromObjectDataRequestList:U},H}return{createInstance:w}}),define("view",["jquery","assert/assert","events/eventcallbacks","events/eventdatafactory","logger","stringtools","tools","textinput","properties","stylesheethandler","popuphandler","scroll","filterpanel","objectpropertysetter","objectpropertyapplier","datavirtualization/datavirtualization","patternapplier","events/eventsetterfactory","events/pendingeventshandlerfactory","textinputeventhandlerfactory","texthtmlgenerator","documentpositioner","htmleditor","arcplanobjects/objectcontainertools","components/datatranslators/taborderhelper","arcplandocuments/selectedobjectmanagerfactory","events/selectedobjectchangedhandlerfactory","waitingtypes"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B){return function(C,D,E,F,G,H,I,J,K,L){function S(a,b,c){return{container:a,activationCallback:b,getTopDocNameCallback:c}}function T(b){return b[0].style.width==="100%"||!i.hasDocFixedSize(a(b))}function U(b){var c=a("embed",b);c.css({opacity:"0.001",position:"absolute",left:"0px",top:"0px"})}function V(b,c,d){var e=a(b),f=a("embed",e),g=f.attr("name"),h=f.attr("lang");h.indexOf(":-1-1")!==-1?(d.parent().prepend(f),d.remove()):f.length>0?(f.css({opacity:"0.001",position:"absolute",left:"0px",top:"0px"}),d.css({position:"absolute",left:"0px",top:"0px"}),d.parent().prepend(f),a("embed[name='"+g+"_load']",c).attr("name",g+"_obsolete")):(c[0].innerHTML=b,U(c))}function W(b,c,d,e){var f,g,h;!e||typeof c!="object"||i.hasVisibleChanged(b)?(i.setXPosChanged(b,!0),i.setYPosChanged(b,!0),i.setWidthChanged(b,!0),i.setHeightChanged(b,!0),i.setColumnWidthChanged(b,!0),i.setNumRowsChanged(b,!0),i.setChartResizer(b,undefined),c=p.init(b,c,d,C,J),i.setVisibleChanged(b,!1)):c=p.update(b,c,d,C,J);if(i.getObjType(b)==="Text"||i.isVHTMLField(b))i.setXPosChanged(b,!0),i.setYPosChanged(b,!0),i.setWidthChanged(b,!0),i.setHeightChanged(b,!0),c=u.buildHtml(b,c);c&&(h=a("embed",b),e&&i.getObjType(b)==="SVGContainer"&&h.length>0?V(c,b,h):(b[0].innerHTML=c,i.getObjType(b)==="SVGContainer"&&U(b)))}function X(a){var b,c=v.getDocContainer(a),d=i.isDocWithTabOrderObjects(c);c&&(b=c.hasClass("arcDocumentHasTabableObjects"),d===!0&&!b?c.addClass("arcDocumentHasTabableObjects"):b&&d===!1&&c.removeClass("arcDocumentHasTabableObjects"))}function Y(b){var c=i.getDocSelectedObjectManager(b).getSelectedObject(),d=a("#"+c),e,f,g,h,j=0,k=0;d.length>0&&(h=i.getDatavirtualizationProperties(d),e=i.getSelectedCell(d),h&&(h.firstElementInDOM&&(j=h.firstElementInDOM),h.firstColumnInDOM&&(k=h.firstColumnInDOM)),e?(d.children(":first").focus(),f=a("tr:nth-child("+(e.y+1-j)+")",d),f.length>0&&(g=a("td:nth-child("+(e.x+1-k)+")",f),g.length>0&&(i.getObjType(d)==="CheckboxGroup"||i.getObjType(d)==="RadioGroup"?(g.find("input").focus(),g.addClass("selected")):g.addClass("selected")))):d.children("div:first").focus())}function Z(a,b,c,d,e){var h=!1,j=!1;return g.iterateArcplanArray(a,function(a,g){var k,l,m,o=[{}],p,q,r;if(!g||!g.ObjID)return[];g.Worksheet!==undefined&&(c=f.removeExtension(g.Worksheet)),d.indexOf(c)===-1&&d.push(c);if(E.isArcplanObjectAlreadyCreated(c,g.ObjID))return[];o[0].id=f.makeID(c,g.ObjID),k=e||v.getDocContainer(c),i.isObjectAlreadyCreated(o)?j=!0:(p=i.getDocObjects(k),p||(p=[],i.setDocObjects(k,p)),p.push(o),i.setObjType(o,a),i.setDocName(o,c),i.setID(o,g.ObjID),i.setActive(o,!0),j=!1),typeof g.View=="string"&&G.updateViewProperties(g),g.Data&&(m=g.Data,i.setCacheIDHash(o,m)),g.ObjectProperties&&(i.setActive(o,g.ObjectProperties.SelectionEnabled!=="false"),i.setVisible(o,typeof g.ObjectProperties.Invisible!="undefined"&&g.ObjectProperties.Invisible==="false"),i.setObjectProperties(o,g.ObjectProperties)),g.Position&&i.setZIndex(o,x.positionToZIndex(g.Position)),g.BaseProperties&&(h=n.setBaseProperties(g.BaseProperties,o,j,i.isDocLayoutManaged(k),i.getDocType(k)==="Dialog")),g.ObjectProperties&&(n.setScrollDependencies(g.ObjectProperties,o),n.setProperties(g.ObjectProperties,o)),g.ObjectData&&(g.ObjectData.NumRows&&i.setNumRows(o,parseInt(g.ObjectData.NumRows,10)),g.ObjectData.NumCols&&i.setNumCols(o,parseInt(g.ObjectData.NumCols,10)),typeof g.ObjectData.Width!="undefined"&&(q=parseInt(g.ObjectData.Width,10)),typeof g.ObjectData.Height!="undefined"&&(r=parseInt(g.ObjectData.Height,10)),typeof g.Width!="undefined"&&(q=parseInt(g.Width,10)),typeof g.Height!="undefined"&&(r=parseInt(g.Height,10)),typeof q!="undefined"&&i.setContentWidth(o,q),typeof r!="undefined"&&i.setContentHeight(o,r),i.setScrollWidth(o,undefined),i.setScrollHeight(o,undefined),i.setObjectData(o,g.ObjectData)),b.push(o)}),h}function _(b,c,d){var f=d,g,h,i=[],j=[],k=parseFloat(a(window).width()),m=parseFloat(a(window).height());return!c||!c.Elements?[]:(l.setIgnoreJavaScriptEvents(!0),Z(c,j,f,i,b),l.clearScrolledObjects(),l.setIgnoreJavaScriptEvents(!1),e.log("done transferObjects ("+i+")"),j)}function ba(b,c,d){var e=i.getObjType(b),g=i.getObjectData(b),h=!0,j=i.getCacheIDHash(b),l=!1;i.isObjectAlreadyCreated(b)?b=a("#"+f.makeID(i.getDocName(b),i.getID(b))):(h=!1,b=a('<div id="'+f.makeID(i.getDocName(b),i.getID(b))+"\" tabindex='-1' class='objContainer'></div>").appendTo(c),i.setObjectAlreadyCreated(b,!0)),k.isCurrentPopup(b)&&(k.rememberSelection(b),k.unregisterOutSideEvent(b)),g&&(W(b,g,j,h),i.setObjectData(b,undefined)),l=o.applyProperties(b),m.updateAfterLoadingObject(b),b.children().css("position","absolute"),k.isCurrentPopup(b)?k.show(b,!0):e==="MenuHierarchie"&&!i.isUseContentPaging(b)&&k.setSelectionFromPath(i.getSelectionPath(b),b),(l||bc(d,b))&&p.updatePosition(b),a("input, select",b).attr("disabled",!i.isActive(b)),i.getIsPassword(b)&&a("input",b).attr({readonly:i.isActive(b)?"false":"true",tabindex:"-1"}),q.loadPattern(b,b.children(),C),(e==="Menu"||e==="MenuHierarchie")&&q.applyDropdownSymbol(b,C)}function bb(b){b.forEach(function(b){var c=f.makeID(i.getDocName(b),i.getID(b)),d=a("#"+c);i.isActive(d)?(P.setTypeSpecificEvents(d),i.getObjectProperties(d)&&P.setEvents(i.getObjectProperties(d),d),P.setEventForInput(d,c,R),P.setDragEvents(d)):((i.getObjType(d)==="Text"||i.isVHTMLField(d))&&P.setEventForInput(d,c,R),P.removeAllEvents(d))})}function bc(a,b){var c=!1;return a?(c=a.some(function(a){return a[0].id===b[0].id}),c):!0}function bd(b,c){var d=i.getDocObjects(b),e=parseFloat(a(window).width()),f=parseFloat(a(window).height());return E.renderDocument(i.getDocName(b)),d&&d.length>0&&d.forEach(function(a){ba(a,b,c)}),v.setDocSizeInDataAttribute(b,K),v.setDocSize(b,e,f,K),i.hasDocWidthChanged(b)||i.hasDocHeightChanged(b)?(i.setDocWidthChanged(b,!1),i.setDocHeightChanged(b,!1),!0):!1}function be(){var b=a(document);b.scrollTop(0),b.scrollLeft(0)}function bf(a,b){g.iterateArcplanArray(b,function(b,c){c.Worksheet=a})}function bg(a){g.iterateArcplanArray(a,function(a,b){delete b.Worksheet})}function bh(a,b,c){var d=b,e,g=!1,h=!1,j=!1;a.Elements.some(function(a){var b,k=Object.keys(a);if(k.length>0){b=a[k[0]],b.Worksheet!==undefined&&(d=f.removeExtension(b.Worksheet)),b.ObjectProperties&&(g=b.ObjectProperties.SelectionEnabled!=="false");if(b.BaseProperties){e=y.translateTabOrder(g,b.BaseProperties,j);if(e>0)return i.setDocWithTabOrderObjects(c,!0),h=!0,!0}}}),h||i.setDocWithTabOrderObjects(c,!1)}function bi(){j.removeAllClasses()}function bj(){var a;for(a=0;a<M.length;a+=1)H.unregisterDocument(M[a])}function bk(){var b;for(b=0;b<M.length;b+=1)a(M[b]).off("click."+M[b].name)}function bl(a){var b=(a.ownerSVGElement||a).id,c,d,e,g=new RegExp("^OBJ"),h=new RegExp(":.*$"),i=new RegExp("^OBJ[0-9]*:");return d=b.replace(g,"").replace(h,""),e=b.replace(i,""),c=f.makeID(e,d),c}function bm(){h.removeForm()}var M=[],N={},O="",P=r.createInstance(),Q=s.createInstance(),R=t.createInstance(Q,I);return c.setPendingEventsHandler(Q),h.setPendingEventsHandler(Q),w.setPendingEventsHandler(Q),w.removeAllHtmlEditorInstances(),h.setOnInputCallback(c.onInput),N.activateDocument=function(b,c){var d=-1,e,f,g=!1,h,j=0,k=0,m;for(e=0;e<M.length;e+=1)f=M[e],f.name===b&&(d=e);d!==-1&&M.splice(d,1),M.push({name:b,containerDiv:c});for(e=M.length-1;e>=0;e-=1)M[e].containerDiv.css("z-index",e),g?M[e].containerDiv.css("display","none"):(M[e].containerDiv.css("display","block"),g=T(M[e].containerDiv),D.onActivateDocument({docProps:N.getCurrentDocProperties()})),j=Math.max(j,v.getDocHeight(M[e].containerDiv)),k=Math.max(k,v.getDocWidth(M[e].containerDiv));i.getDocType(c)==="Dialog"&&(D.setWaitingState(B.ApplicationWaiting),D.setShouldHandleWaitingState(!1),a(".arcDialogDoc-overlay").remove(),h=parseInt(c.css("z-index"),10)-1,m=a("<div class='arcDialogDoc-overlay'></div>").css("z-index",h),a("#arcContainer").append(m)),O!==b&&(O=b,i.getHasDocActivateEvent(c)&&C.doDocActivateEvent(b)),typeof L=="function"&&L(),l.correctScrollPositionOfScrollObjectsForIE()},N.closeDocument=function(b){var c=f.removeExtension(b),d,g,h=!1,k=a("#"+f.makeID(c,0)).remove();e.log("closeDocument: "+c),H.unregisterDocument(k),k.off("click."+c),l.removeScrolledObjectsThatBelongToDocument(k,c),i.getDocType(k)==="Dialog"&&(D.setShouldHandleWaitingState(!0),D.setWaitingState(B.NotWaiting)),a(".arcDialogDoc-overlay").remove(),j.removeClassesForDocument(f.encodeDocName(c)),i.resetAllPropertiesForDocument(c),v.closeDocumentDialog(c),E.removeArcplanObjects(c);for(d=0;d<M.length;d+=1)if(M[d].name===c){d===M.length-1&&(h=!0),M.splice(d,1);break}M.length>0&&h&&(g=M[M.length-1],N.activateDocument(g.name,g.containerDiv))},N.updateObjects=function(a){var b,c=!0,d,f=[],h=[],i=!1;return!a||!a.Elements?[]:(l.setIgnoreJavaScriptEvents(!0),Z(a,h,b,f),E.updateArcplanObjects(a),g.each(f,function(a,b){var c=v.getDocContainer(b),d=!0,e;typeof D.getFixedWindowSizeForWidget()!="object"&&F.updateLayout(c,C,d),e=bd(c,h),i=i||e,bb(h)}),i===!0&&typeof L=="function"&&L(),M.length>0&&Y(M[M.length-1].containerDiv),l.clearScrolledObjects(),l.setIgnoreJavaScriptEvents(!1),e.log("done updateObjects ("+f+")"),h)},N.oldTransferObjects=function(b,c,d){var h=d,j,r,s=[],t=[],u=parseFloat(a(window).width()),w=parseFloat(a(window).height()),y,z,A;return!c||!c.Elements?[]:(M.length>0&&(y=M[M.length-1].containerDiv,z=y.scrollTop(),A=y.scrollLeft()),g.iterateArcplanArray(c,function(c,d){var e,g,u,w;if(!d||!d.ObjID)return[];d.Worksheet!==undefined&&(h=f.removeExtension(d.Worksheet)),s.indexOf(h)===-1&&s.push(h);if(E.isArcplanObjectAlreadyCreated(h,d.ObjID))return[];g=f.makeID(h,d.ObjID),e=b||v.getDocContainer(h),w=a("#"+g),w.length===0?(w=a("<div id='"+g+"' tabindex='-1'></div>"),w.appendTo(e),w.addClass("objContainer"),i.setObjType(w,c),i.setDocName(w,h),i.setID(w,d.ObjID),i.setActive(w,!0),j=!1):j=!0,typeof d.View=="string"&&G.updateViewProperties(d),l.setIgnoreJavaScriptEvents(!0),d.Data&&(u=d.Data),d.ObjectProperties&&(i.setActive(w,d.ObjectProperties.SelectionEnabled!=="false"),i.setVisible(w,typeof d.ObjectProperties.Invisible!="undefined"&&d.ObjectProperties.Invisible==="false")),d.Position&&i.setZIndex(w,x.positionToZIndex(d.Position)),d.BaseProperties&&(r=n.setBaseProperties(d.BaseProperties,w,j,i.isDocLayoutManaged(e),i.getDocType(e)==="Dialog")),d.ObjectProperties&&(n.setScrollDependencies(d.ObjectProperties,w),n.setProperties(d.ObjectProperties,w),d.ObjectProperties.Invisible==="true"&&w.html("")),d.ObjectData&&(d.ObjectData.NumRows&&i.setNumRows(w,parseInt(d.ObjectData.NumRows,10)),d.ObjectData.NumCols&&i.setNumCols(w,parseInt(d.ObjectData.NumCols,10)),k.isCurrentPopup(w)&&(k.rememberSelection(w),k.unregisterOutSideEvent(w)),i.setScrollWidth(w,undefined),i.setScrollHeight(w,undefined),W(w,d.ObjectData,u,j)),i.isActive(w)?(P.setTypeSpecificEvents(w),d.ObjectProperties&&P.setEvents(d.ObjectProperties,w),P.setEventForInput(w,g,R),P.setDragEvents(w)):((c==="Text"||i.isVHTMLField(w))&&P.setEventForInput(w,g,R),P.removeAllEvents(w)),i.isVisible(w)&&o.applyProperties(w),p.updatePosition(w),m.updateAfterLoadingObject(w),j&&i.isDocLayoutManaged(e)&&(r?(F.resetLayoutManagement(e),F.addToPendingLayoutDocuments(e[0].id)):F.applyLayoutToUpdatedObject(w)),a("input",w).prop("disabled",!i.isActive(w)),a("select",w).prop("disabled",!i.isActive(w)),i.getIsPassword(w)&&a("input",w).attr({readonly:i.isActive(w)?"false":"true",tabindex:"-1"}),w.children().css("position","absolute"),k.isCurrentPopup(w)?k.show(w,!0):c==="MenuHierarchie"&&!i.isUseContentPaging(w)&&k.setSelectionFromPath(i.getSelectionPath(w),w),(c==="VerticalHierarchie"||c==="HorizontalHierarchie"||c==="Row"||c==="Column"||c==="Table"||c==="CheckboxGroup")&&t.push(w),q.loadPattern(w,w.children(),C),(c==="Menu"||c==="MenuHierarchie")&&q.applyDropdownSymbol(w,C),l.clearScrolledObjects(),l.setIgnoreJavaScriptEvents(!1)}),g.each(s,function(a,b){var c=v.getDocContainer(b),d=!0;typeof D.getFixedWindowSizeForWidget()!="object"&&F.updateLayout(c,C,d),v.setDocSizeInDataAttribute(c),v.setDocSize(c,u,w)}),M.length>0&&Y(M[M.length-1].containerDiv),y&&(y.scrollTop()!==z&&y.scrollTop(z),y.scrollLeft()!==A&&y.scrollLeft(A)),e.log("done oldTransferObjects ("+s+")"),t)},N.doPostUpdate=function(){F.updatePendingLayoutDocuments(C)},N.getTopDocumentName=function(){return M.length>0?M[M.length-1].name:null},N.loadDocument=function(b){var d,f,g=b.arcplanDocument,h,j={width:"100%",height:"100%"},k=g.Layers.Layer.Layout,l=D.getDocAreaRectForWidget(),n=D.getFixedWindowSizeForWidget(),p=D.getFixedWindowSizeForWidget(),r=l!==undefined,s,t,u=!0,w=parseFloat(a(window).width()),x=parseFloat(a(window).height()),y=a("#arcContainer").position(),I;h=g.Name,e.log("loadDocument: "+h),d=v.getDocContainer(h),d.length===0&&(u=!1,d=v.createDocumentDiv(h,l,r,k,g.WorksheetType),I=z.createInstance(),i.setDocSelectedObjectManager(d,I),I.registerSelectedObjectChangedCallback(A.createInstance(d).selectedObjectChangedCallback)),d.css("display","none"),i.setDocViews(d,g.Views),G.setInitialViewForDocument(a(window).width(),a(window).height(),d),f={PatternFormat:g.Layers.Layer.Background.PatternFormat,ImageReference:g.Layers.Layer.Background.ImageReference},g.Settings!==undefined&&g.Settings.LayoutManagement!==undefined&&g.Settings.LayoutManagement==="true"?(i.setDocLayoutManaged(d,!0),t=g.Settings.ResizeObject,typeof t=="string"&&t.indexOf("[OBJ")!==-1&&(t=t.replace("[OBJ","").replace("]","")),i.setDocLayoutObjectID(d,t)):i.setDocLayoutManaged(d,!1),g.DocumentProperties!==undefined&&g.DocumentProperties.ActivateEvent!==undefined&&(g.DocumentProperties.ActivateEvent==="true"?i.setHasDocActivateEvent(d,!0):i.setHasDocActivateEvent(d,!1)),g.DocumentProperties!==undefined&&g.DocumentProperties.OpenStartDocAllowed==="true"?i.setOpenStartDocAllowed(d,!0):i.setOpenStartDocAllowed(d,!1),bh(g.Objects,h,d),i.setPattern(d,f),q.loadPattern(d,d,C),i.setDocFixedSize(d,!1),i.setDocType(d,g.WorksheetType),g.WorksheetType==="Dialog"&&D.setWaitingState(B.ApplicationWaiting),D.setShouldHandleWaitingState(g.WorksheetType!=="Dialog"),v.setDocumentPositionAndSizeStylesInCssMap(d,g,k,j,r,l),v.setDocumentPositionAndSizeInProperties(d,k,r,l,y,w,x),g.Layers.Layer.Background.TrueColor1&&(j.backgroundColor=g.Layers.Layer.Background.TrueColor1),d.css(j),u||(H.registerDocument(d),d.on("click."+h,S(d,N.activateDocument,N.getTopDocumentName),c.onDocumentClick)),u?(bf(h,g.Objects),E.updateArcplanObjects(g.Objects),bg(g.Objects)):E.createArcplanObjects(h,d,g.Objects),K?s=_(d,g.Objects,h):(s=N.oldTransferObjects(d,g.Objects,h),d.css("display","inline")),O=h,N.activateDocument(h,d),X(h),m.setCreateBookmarkFunction(C.doCreateBookmark),u&&F.resetLayoutManagement(d),n?F.initializeWithFixedWindowSize(d,C,p):F.initialize(d,C),K?(bd(d),bb(s),d.css("display","inline"),M.length>0&&Y(M[M.length-1].containerDiv)):(v.setDocSizeInDataAttribute(d),v.setDocSize(d,w,x,K)),m.notifyDocumentLoaded(d),o.updateReferences(d,g.Objects,h,C),be()},N.getCurrentDocSize=function(a){var b=v.getDocContainer(a),c,d=0,e=0;return b&&(c=v.calculateObjectsRect(b),d=c.width,e=c.height),{Width:d,Height:e}},N.isLayoutManagedInDoc=function(a){var b=v.getDocContainer(a),c=i.isDocLayoutManaged(b)!==!1;return c},N.showPendingEditCell=function(a,b){R.showPendingEditCell(a,b)},N.getDocCurrentView=function(){var a=M[M.length-1].containerDiv;return i.getDocCurrentView(a)},N.getCurrentDocProperties=function(){var a,b={isDialogCenter:!1,hasDocFixedSize:!1,container:null,isOpenStartDocAllowed:!1};return M.length>0&&(a=M[M.length-1].containerDiv,b.isDialogCenter=i.isDocAutoCenter(a)===!0&&i.getDocType(a)==="Dialog",b.hasDocFixedSize=i.hasDocFixedSize(a)===!0,b.container=a,b.isOpenStartDocAllowed=i.isOpenStartDocAllowed(a)),b},N.executeInputBoxAction=function(b){var c,d,e,g,h=f.removeExtension(b.Worksheet),j=v.getDocContainer(h),k=parseInt(b.Column,10),l=parseInt(b.Row,10);if(j.length>0){d=f.makeID(h,b.ObjID),e=a("#"+d,j);if(e.length>0){c=i.getObjType(e);switch(c){case"Table":case"Field":case"Row":case"Column":R.selectCell(e,d,l,k);break;case"Text":i.isFormattedTextInput(e)?a(".cke_editable_inline",e).length===0?e.trigger(a.Event("click",{data:R.createExtendedEventDataForInput(e,d)})):a(".cke_editable_inline",e).trigger(a.Event("focus")):R.selectTextField(e,d);break;case"Menu":case"MenuHierarchie":e.find(".arcHierPopup").trigger("click");break;case"RadioGroup":g=a("input[type=radio]",e),a(g[l]).click();break;case"CheckboxGroup":g=a("input[type=checkbox]",e),a(g[l]).click();break;case"VerticalHierarchie":case"HorizontalHierarchie":}}}},window.handleClick=function(b,e){var f=bl(e.target),g=d.createInstance(f,a("#"+f)),h=parseInt(i.getXPos(g.ref),10),j=parseInt(i.getYPos(g.ref),10),l={data:g,pageX:e.pageX+h,pageY:e.pageY+j,target:e.target};k.hideCurrentPopup(),c.onClick(l)},N.getPendingEventsHandler=function(){return Q},N.cleanOnSessionEnd=function(){D.setWaitingState(B.NotWaiting),bi(),bj(),bk(),bm(),i.resetAllProperties(),v.closeDocumentDialog(),a("#arcContainer").empty(),w.removeAllHtmlEditorInstances(),l.clearScrolledObjectsForIE(),l.clearScrolledObjects(),k.hideCurrentPopup()},C.setView(N),N}});var ARCPLAN=ARCPLAN||{};define("sessionobject",["jquery","tools","arcplanobjects/arcplanobjectsmanagerfactory","components/button/buttonviewfactory","components/button/buttonbuilderfactory","components/field/fieldviewfactory","components/field/fieldbuilderfactory","requestprocessorfactory","events/eventcallbacks","events/eventorderfactory","logger","view","layoutmanagement/layoutmanagementfactory","responsivedesign/viewmanagementfactory","browserfeatures","servercommunication/imageloader","splashscreen","waitingtypes","clienttype","jquery.simplemodal","events/resizehandlerfactory","popupkeyeventhandler","textinput","htmleditor"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){function y(b){a("#arcSplashContainer").length===0&&(a.modal(a("<div></div>").attr("id","arcLoadingContainer").append(a("<div></div>").attr("class","arcLoadingImage").attr("alt","Loading...")),{close:!1,autoResize:!0,zIndex:2e6,fadeInDelay:1e3,onOpen:function(a){o.mobile&&a.data.show(),a.overlay.show().css("background-color","#000")}}),a(".simplemodal-container").removeClass("arcWaiting"),a(".simplemodal-overlay").removeClass("arcWaiting"),setTimeout(function(){b.isWaitingState()&&(a(".simplemodal-overlay").addClass("arcWaiting"),a(".simplemodal-container").addClass("arcWaiting"))},500))}function z(){a(".simplemodal-container").removeClass("arcWaiting"),a(".simplemodal-overlay").removeClass("arcWaiting"),a(".simplemodal-overlay").append(a("<div></div>")),a("#arcSplashContainer").length===0?a.modal.close():(a("#arcContainer").css("overflow",""),q.hide())}function A(a){var b,c;b=e(d,i.onButtonClickCallback,i.setSelectedObjectCallback,p),a.registerArcplanObjectBuilder("Button",b),b=e(d,i.onSwitchClickCallback,i.setSelectedObjectCallback,p),a.registerArcplanObjectBuilder("Switch",b),ARCPLAN.useFieldComponents===!0&&(b=g(f,i.onFieldClickCallback,i.onFieldTextEditedCallback,p),a.registerArcplanObjectBuilder("Field",b))}return function(d){var e={},f={cgi:"/arcplan/8/scripts/arcCGI8.exe",clientType:d,application:undefined,startdoc:undefined,docAreaRectForWidget:undefined,fixedWindowSizeForWidget:undefined,requestObj:undefined,view:undefined,docSizeChangedListener:undefined,loginEventListener:undefined,changeUserTypeForLoginCallback:undefined,openDocumentFromWidgetListener:undefined,iswaitingstate:!1,shouldHandleWaitingState:!0,processNr:"-1"},g=function(){return f.iswaitingstate||f.requestObj.hasPendingUserinformation()},o={},q={logger:k,getApplication:function(){return f.application},getClientType:function(){return f.clientType},getStartDoc:function(){return f.startdoc},getProcessNr:function(){return f.processNr},getDocAreaRectForWidget:function(){return f.docAreaRectForWidget},getFixedWindowSizeForWidget:function(){return f.fixedWindowSizeForWidget},isWaitingState:function(){return f.iswaitingstate},setWaitingState:function(a){var b=a!==r.NotWaiting;b!==f.iswaitingstate&&(k.log("setWaitingState: "+a),f.iswaitingstate=b,b?y(q):z()),f.shouldHandleWaitingState===!0&&Object.keys(o).forEach(function(b){o[b]({waitingState:a})})},setShouldHandleWaitingState:function(a){f.shouldHandleWaitingState=a},onOpenDocumentFromWidget:function(a){typeof f.openDocumentFromWidgetListener=="function"&&f.openDocumentFromWidgetListener(a)},onDocumentLoaded:function(){typeof ARCPLAN.oOnDocumentLoaded=="function"&&ARCPLAN.oOnDocumentLoaded()},onActivateDocument:function(a){typeof ARCPLAN.onActivateDocument=="function"&&ARCPLAN.onActivateDocument(a)},onNotifyLogin:function(){typeof f.loginEventListener=="function"&&f.loginEventListener(),f.clientType===s.E_HTML5LOGONCLIENT&&e.closeSession(!1)},getChangeUserTypeForEngageLoginCallback:function(){return typeof f.changeUserTypeForLoginCallback!="function"?undefined:function(){e.closeSession(!1),f.changeUserTypeForLoginCallback()}}};return e.isWaitingState=function(){return f.iswaitingstate},e.addWaitingStateChangedCallback=function(a,b){o[b]=a},e.removeWaitingStateChangedCallback=function(a){delete o[a]},e.setCgi=function(a){f.cgi=a},e.setApplication=function(a){f.application=a},e.setStartDoc=function(a){f.startdoc=a},e.setDocAreaRectForWidget=function(a){f.docAreaRectForWidget=a},e.setFixedWindowSizeForWidget=function(a,b){f.fixedWindowSizeForWidget={width:a,height:b}},e.setDocSizeChangedListener=function(a){f.docSizeChangedListener=a},e.setLoginEventListener=function(a){f.loginEventListener=a},e.setProcessNummer=function(a){f.processNr=a},e.setChangeUserTypeForLoginCallback=function(a){f.changeUserTypeForLoginCallback=a},e.setOpenDocumentFromWidgetListener=function(a){f.openDocumentFromWidgetListener=a},e.doInitPresentation=function(){var b=a('meta[name="viewport"]').attr("content"),d,e,g,k=ARCPLAN.useDelayedDomUpdate!==!1?!0:!1,o=n.createInstance(k),r=m.createInstance(k,o);b&&(b=b.replace("maximum-scale=1.0","maximum-scale=10.0"),a('meta[name="viewport"]').attr("content",b)),d=c.createInstance(),f.requestObj=h.createInstance(f.cgi,q,d,o,k),p.setRequestProcessor(f.requestObj),A(d),i.setLastMouseDownPosSetter(f.requestObj.setLastMouseDownPos),e=j.createInstance(f.requestObj),i.setEventOrder(e),w.setEventOrder(e),x.setEventOrder(e),r.setArcplanObjectsManager(d),o.setArcplanObjectsManager(d),g=u.createInstance(r,f.docSizeChangedListener,k,f.docSizeChangedListener),a(window).on("resize.resizeHandler",function(){g.handleResize(f.requestObj)}),f.view=l(f.requestObj,q,d,r,o,g,e,50,k,f.docSizeChangedListener),ARCPLAN.useEventOrder===!0?(v.setDoSendEventCallback(e.doArcplanEvent),f.requestObj.setExecutePendingEventCallback(e.doPendingEvent)):(v.setDoSendEventCallback(f.requestObj.doSendEvent),f.requestObj.setExecutePendingEventCallback(f.view.getPendingEventsHandler().executePendingEvent)),f.requestObj.doInitPresentation()},e.doSendEvent=function(a,b,c,d,e,h){if(f.requestObj===undefined)throw"Session has not been initialized cannot send event: "+a+"_"+b+"_"+c;return g()?!1:(f.requestObj.doSendEvent(a,b,c,d,e,h),!0)},e.doOpenBookmark=function(a,b){if(f.requestObj===undefined)throw"Session has not been initialized cannot send event";return g()?!1:(f.requestObj.doOpenBookmark(a,b),!0)},e.hasPendingUserinformation=function(){if(f.requestObj===undefined)throw"Session has not been initialized cannot send event";return f.requestObj.hasPendingUserinformation()},e.doCreateBookmark=function(a,b){if(f.requestObj===undefined)throw"Session has not been initialized cannot send request";return g()?!1:(f.requestObj.doCreateBookmark(a,b),!0)},e.doGetAreaImage=function(a,b,c){if(f.requestObj===undefined)throw"Session has not been initialized cannot send request";return g()?!1:(f.requestObj.doGetAreaImage(a,b,c),!0)},e.doGetDocCurrentView=function(){return f.view.getDocCurrentView()},e.doGetCurrentDocProperties=function(){return f.view.getCurrentDocProperties()},e.closeSession=function(b){a(window).off("resize.resizeHandler"),f.requestObj.closeSession(b)},e}});var ARCPLAN=ARCPLAN||{};define("arcclient",["jquery","clienttype","sessionobject","userparam","events/eventid","browserfeatures","msgbox","version","motionchartviewmodel","filterpanel","stringsres","stringsid","splashscreen","layoutmanagement/chartloadedhandler","stringtools","popuphandler","waitingtypes"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function t(a){var b=(a.ownerSVGElement||a).id,c,d,e,f=new RegExp("^OBJ"),g=new RegExp(":.*$"),h=new RegExp("^OBJ[0-9]*:");return d=b.replace(f,"").replace(g,""),e=b.replace(h,""),c=o.makeID(e,d),c}function u(a){return a?b.E_HTML5LOGONCLIENT:f.mobile?b.E_HTML5MOBILECLIENT:b.E_HTML5CLIENT}function v(b,d,e,h,i){k.resetCustomStringResources(),a("#arcContainer").children().remove(),r.mockSessionObj?r.sessionObj=r.mockSessionObj:(r.sessionObj=c(h),f.compatibilityMode()&&g.createMsgBox().withCaption(k.getMessageById(l.COMPATIBILITY_WARNING_TITLE)).withText(k.getMessageById(l.COMPATIBILITY_WARNING)).indicating("warning").logIt().andShowIt()),typeof r.docSizeChangedListener=="function"&&r.sessionObj.setDocSizeChangedListener(r.docSizeChangedListener),typeof r.loginEventListener=="function"&&r.sessionObj.setLoginEventListener(r.loginEventListener),typeof r.changeUserTypeForLoginCallback=="function"&&r.sessionObj.setChangeUserTypeForLoginCallback(r.changeUserTypeForLoginCallback),typeof e=="string"&&r.sessionObj.setCgi(e),typeof b=="string"&&r.sessionObj.setApplication(b),typeof d=="string"&&r.sessionObj.setStartDoc(d),typeof i=="string"&&r.sessionObj.setProcessNummer(i)}function w(a,b){p.hideCurrentPopup(),r.sessionObj.isWaitingState()||r.sessionObj.hasPendingUserinformation()?r.sessionObj.addWaitingStateChangedCallback(function(c){var d=c.waitingState!==q.NotWaiting;d||(r.sessionObj.removeWaitingStateChangedCallback(a),b())},a):b()}function x(b,c){var d=a("embed",c),e,f;for(f=0;f<d.length;f+=1)if(decodeURI(b.ownerDocument.location.href).indexOf(decodeURI(d[f].src.trim()))>-1)return a(d[f]);return{}}function y(a){window.console&&window.console.warn(a)}function z(){var b=a("#arcContainer"),c="<div id='arcSplashContainer' class='arcWidgetSplashScreen'><div class='arcVerticalCentered'><div id='arcWidgetSplashScreenContainer'><div class='arcLoadingImage arcHorizontalCentered'></div></div></div></div>";b.before(c)}var r={mockSessionObj:undefined,sessionObj:undefined,docSizeChangedListener:undefined,loginEventListener:undefined,changeUserTypeForLoginCallback:undefined},s={};return s.setMockSessionObj=function(a){r.mockSessionObj=a},s.changeLocation=function(a,b,c,e,f,g){var h=u(f),i;i=typeof ARCPLAN=="object"&&typeof ARCPLAN.engage=="object"&&typeof ARCPLAN.engage.server=="object"&&a===ARCPLAN.engage.server.portalApplication,!f&&!i&&m.show(),v(a,b,c,h,g),typeof e=="function"&&e(d),r.sessionObj.doInitPresentation()},s.showDocAreaForWidget=function(a,b,c,d,e,f,g,h,i){var j=u(!1),k={left:parseInt(d,10),top:parseInt(e,10),right:parseInt(d,10)+parseInt(f,10),bottom:parseInt(e,10)+parseInt(g,10),width:parseInt(f,10),height:parseInt(g,10)},l="-1";if(isNaN(k.left)===!0)throw"docAreaRect.left is not a number";if(isNaN(k.top)===!0)throw"docAreaRect.top is not a number";if(isNaN(k.width)===!0)throw"docAreaRect.width is not a number";if(isNaN(k.height)===!0)throw"docAreaRect.height is not a number";z(),v(a,b,c,j,l),r.sessionObj.setDocAreaRectForWidget(k),h>0&&i>0&&r.sessionObj.setFixedWindowSizeForWidget(h,i),r.sessionObj.doInitPresentation()},s.acSendClickEvent=function(a,b,c,d){var f=c-1,g=d-1;return r.sessionObj.doSendEvent(a,b,e.EID_CLICK,"",f,g)},s.acSendInputEvent=function(a,b,c,d,f){var g=d-1,h=f-1;return r.sessionObj.doSendEvent(a,b,e.EID_INPUT,c,g,h)},s.acSendSwitchEvent=function(a,b,c){return r.sessionObj.doSendEvent(a,b,e.EID_SWITCH,c)},s.acSendEvent=function(a,b,c,d,e,f,g){try{var h;if(c===undefined||c==="")throw"Parameter 'eventName' must not be null or empty.";if(c.toUpperCase()==="CLICK")return s.acSendClickEvent(a,b,f,g);if(c.toUpperCase()==="SWITCH"){if(e===undefined||e.toLowerCase()!=="int")throw"Parameter 'parameterType' must be int for SWITCH-Event.";try{h=parseInt(d,10)}catch(i){throw"Parameter 'parameter="+d+"' for SWITCH-Event is not a number"+i}return s.acSendSwitchEvent(a,b,h)}if(c.toUpperCase()==="INPUT")return s.acSendInputEvent(a,b,d,f,g);throw"Event '"+c+"' is not supported."}catch(j){throw"Exception occurred while trying to send request: "+j}},s.aafNavigation=function(a){w("aafNavigation",function(){s.acSendInputEvent("fsNavigation",29,a,1,1)})},s.aafToolbarAction=function(a){w("aafToolbarAction",function(){s.acSendInputEvent("fsToolbar",146,a,1,1)})},s.addWaitingStateChangedCallback=function(a,b){r.sessionObj.addWaitingStateChangedCallback(a,b)},s.removeWaitingStateChangedCallback=function(a){r.sessionObj.removeWaitingStateChangedCallback(a)},s.createMotionChartModel=function(a,b){return new i.CMotionChartViewModel(a,b)},s.openBookmark=function(a,b){return r.sessionObj.doOpenBookmark(a,b)},s.createBookmark=function(a,b){return r.sessionObj.doCreateBookmark(a,b)},s.getAreaImage=function(a,b,c){return r.sessionObj.doGetAreaImage(a,b,c)},s.getDocCurrentView=function(){return r.sessionObj.doGetDocCurrentView()},s.getCurrentDocProperties=function(){return r.sessionObj.doGetCurrentDocProperties()},s.closeSession=function(a){r.sessionObj!==undefined&&(r.sessionObj.closeSession(a),r={mockSessionObj:r.mockSessionObj})},s.toggleFilterPanel=function(){j.toggleFilterPanel()},s.setDocSizeChangedListener=function(a){r.sessionObj&&r.sessionObj.setDocSizeChangedListener(a),r.docSizeChangedListener=a},s.setFilterPanelEventListener=function(a){j.setEventListener(a)},s.setFilterPanelInitialPinnedState=function(a){j.setIsInitiallyPinned(a)},s.setIsSharedWidget=function(a){j.setIsSharedWidget(a)},s.changeFilterPanelOnSharedWidgetToPrivate=function(){j.changeFilterPanelOnSharedWidgetToPrivate()},s.setSharedWidgetData=function(a){j.setSharedWidgetData(a)},s.setLoginEventListener=function(a){r.loginEventListener=a},s.setChangeUserTypeForLoginCallback=function(a){r.changeUserTypeForLoginCallback=a},s.setOpenDocumentFromWidgetListener=function(a){r.sessionObj&&r.sessionObj.setOpenDocumentFromWidgetListener(a)},s.svgLoaded=function(b,c){var d=t(b.target),e=a("#"+d),f;c!==null?f=a(c):f=x(b.target,e),n.notifyChartLoaded(e,f)},a(document).ready(function(){ARCPLAN.suppressAutomaticStartup!==!0&&(h.logVersion(),s.changeLocation(ARCPLAN.application,ARCPLAN.startDocName,ARCPLAN.arcCgiSite,ARCPLAN.setUserParams)),window.unload=function(){s.closeSession(!0)},window.onbeforeunload=function(){s.closeSession(!0)},f.scrollbarWidth=f.measureScrollbarWidth(),f.zoomOffsetHeightWithBorder=f.measureZoomOffsetHeightWithBorder(),f.zoomOffsetTableTdHeightWithBorder=f.measureZoomOffsetTdHeightWithBorder(),f.zoomOffsetTableTdHeightWithoutBorder=f.measureZoomOffsetTdHeightWithoutBorder()}),s})