(function(){function a(a){a=a.toUpperCase();for(var b=g.length,c=0,d=0;d<b;++d)for(var e=g[d],f=e[1].length;a.substr(0,f)==e[1];a=a.substr(f))c+=e[0];return c}function b(a){a=a.toUpperCase();for(var b=1,c=1;0<a.length;c*=26)b+="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(a.charAt(a.length-1))*c,a=a.substr(0,a.length-1);return b}var c=CKEDITOR.htmlParser.fragment.prototype,d=CKEDITOR.htmlParser.element.prototype;c.onlyChild=d.onlyChild=function(){var a=this.children;return 1==a.length&&a[0]||null},d.removeAnyChildWithName=function(a){for(var b=this.children,c=[],d,e=0;e<b.length;e++)d=b[e],d.name&&(d.name==a&&(c.push(d),b.splice(e--,1)),c=c.concat(d.removeAnyChildWithName(a)));return c},d.getAncestor=function(a){for(var b=this.parent;b&&(!b.name||!b.name.match(a));)b=b.parent;return b},c.firstChild=d.firstChild=function(a){for(var b,c=0;c<this.children.length;c++)if(b=this.children[c],a(b)||b.name&&(b=b.firstChild(a)))return b;return null},d.addStyle=function(a,b,c){var d="";if("string"==typeof b)d+=a+":"+b+";";else{if("object"==typeof a)for(var e in a)a.hasOwnProperty(e)&&(d+=e+":"+a[e]+";");else d+=a;c=b}this.attributes||(this.attributes={}),a=this.attributes.style||"",a=(c?[d,a]:[a,d]).join(";"),this.attributes.style=a.replace(/^;+|;(?=;)/g,"")},d.getStyle=function(a){var b=this.attributes.style;if(b)return b=CKEDITOR.tools.parseCssText(b,1),b[a]},CKEDITOR.dtd.parentOf=function(a){var b={},c;for(c in this)-1==c.indexOf("$")&&this[c][a]&&(b[c]=1);return b};var e=/^(?:\b0[^\s]*\s*){1,4}$/,f={ol:{decimal:/\d+/,"lower-roman":/^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$/,"upper-roman":/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,"lower-alpha":/^[a-z]+$/,"upper-alpha":/^[A-Z]+$/},ul:{disc:/[l\u00B7\u2002]/,circle:/[\u006F\u00D8]/,square:/[\u006E\u25C6]/}},g=[[1e3,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]],h=0,i=null,j,k=CKEDITOR.plugins.pastefromword={utils:{createListBulletMarker:function(a,b){var c=new CKEDITOR.htmlParser.element("cke:listbullet");return c.attributes={"cke:listsymbol":a[0]},c.add(new CKEDITOR.htmlParser.text(b)),c},isListBulletIndicator:function(a){if(/mso-list\s*:\s*Ignore/i.test(a.attributes&&a.attributes.style))return!0},isContainingOnlySpaces:function(a){var b;return(b=a.onlyChild())&&/^(:?\s|&nbsp;)+$/.test(b.value)},resolveList:function(a){var b=a.attributes,c;return(c=a.removeAnyChildWithName("cke:listbullet"))&&c.length&&(c=c[0])?(a.name="cke:li",b.style&&(b.style=k.filters.stylesFilter([["text-indent"],["line-height"],[/^margin(:?-left)?$/,null,function(a){a=a.split(" "),a=CKEDITOR.tools.convertToPx(a[3]||a[1]||a[0]),!h&&null!==i&&a>i&&(h=a-i),i=a,b["cke:indent"]=h&&Math.ceil(a/h)+1||1}],[/^mso-list$/,null,function(a){a=a.split(" ");if(!(2>a.length)){var c=Number(a[0].match(/\d+/));a=Number(a[1].match(/\d+/)),1==a&&(c!==j&&(b["cke:reset"]=1),j=c),b["cke:indent"]=a}}]])(b.style,a)||""),b["cke:indent"]||(i=0,b["cke:indent"]=1),CKEDITOR.tools.extend(b,c.attributes),!0):(j=i=h=null,!1)},getStyleComponents:function(){var a=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;"></div>',CKEDITOR.document);return CKEDITOR.document.getBody().append(a),function(b,c,d){a.setStyle(b,c),b={},c=d.length;for(var e=0;e<c;e++)b[d[e]]=a.getStyle(d[e]);return b}}(),listDtdParents:CKEDITOR.dtd.parentOf("ol")},filters:{flattenList:function(a,b){b="number"==typeof b?b:1;var c=a.attributes,d;switch(c.type){case"a":d="lower-alpha";break;case"1":d="decimal"}for(var e=a.children,f,g=0;g<e.length;g++)if(f=e[g],f.name in CKEDITOR.dtd.$listItem){var h=f.attributes,l=f.children,m=l[0],n=l[l.length-1];m.attributes&&m.attributes.style&&-1<m.attributes.style.indexOf("mso-list")&&(f.attributes.style=m.attributes.style,m.replaceWithChildren()),n.name in CKEDITOR.dtd.$list&&(a.add(n,g+1),--l.length||e.splice(g--,1)),f.name="cke:li",c.start&&!g&&(h.value=c.start),k.filters.stylesFilter([["tab-stops",null,function(a){(a=a.match(/0$|\d+\.?\d*\w+/))&&(i=CKEDITOR.tools.convertToPx(a[0]))}],1==b?["mso-list",null,function(a){a=a.split(" "),a=Number(a[0].match(/\d+/)),a!==j&&(h["cke:reset"]=1),j=a}]:null])(h.style),h["cke:indent"]=b,h["cke:listtype"]=a.name,h["cke:list-style-type"]=d}else if(f.name in CKEDITOR.dtd.$list){arguments.callee.apply(this,[f,b+1]),e=e.slice(0,g).concat(f.children).concat(e.slice(g+1)),a.children=[],f=0;for(l=e.length;f<l;f++)a.add(e[f]);e=a.children}delete a.name,c["cke:list"]=1},assembleList:function(c){var d=c.children,e,g,k,l,m,n;c=[];for(var o,p,q,r,s,t,u=0;u<d.length;u++)if(e=d[u],"cke:li"==e.name)if(e.name="li",g=e.attributes,q=(q=g["cke:listsymbol"])&&q.match(/^(?:[(]?)([^\s]+?)([.)]?)$/),r=s=t=null,g["cke:ignored"])d.splice(u--,1);else{g["cke:reset"]&&(n=l=m=null),k=Number(g["cke:indent"]),k!=l&&(p=o=null);if(q){if(p&&f[p][o].test(q[1]))r=p,s=o;else for(var v in f)for(var y in f[v])if(f[v][y].test(q[1])){if("ol"!=v||!/alpha|roman/.test(y)){r=v,s=y;break}if(o=/roman/.test(y)?a(q[1]):b(q[1]),!t||o<t)t=o,r=v,s=y}!r&&(r=q[2]?"ol":"ul")}else r=g["cke:listtype"]||"ol",s=g["cke:list-style-type"];p=r,o=s||("ol"==r?"decimal":"disc"),s&&s!=("ol"==r?"decimal":"disc")&&e.addStyle("list-style-type",s);if("ol"==r&&q){switch(s){case"decimal":t=Number(q[1]);break;case"lower-roman":case"upper-roman":t=a(q[1]);break;case"lower-alpha":case"upper-alpha":t=b(q[1])}e.attributes.value=t}if(n){if(k>l)c.push(n=new CKEDITOR.htmlParser.element(r)),n.add(e),m.add(n);else{if(k<l){l-=k;for(var z;l--&&(z=n.parent);)n=z.parent}n.add(e)}d.splice(u--,1)}else c.push(n=new CKEDITOR.htmlParser.element(r)),n.add(e),d[u]=n;m=e,l=k}else n&&(n=l=m=null);for(u=0;u<c.length;u++)if(n=c[u],v=n.children,o=o=void 0,y=n.children.length,z=o=void 0,d=/list-style-type:(.*?)(?:;|$)/,l=CKEDITOR.plugins.pastefromword.filters.stylesFilter,o=n.attributes,!d.exec(o.style)){for(m=0;m<y;m++)if(o=v[m],o.attributes.value&&Number(o.attributes.value)==m+1&&delete o.attributes.value,o=d.exec(o.attributes.style)){if(o[1]!=z&&z){z=null;break}z=o[1]}if(z){for(m=0;m<y;m++)o=v[m].attributes,o.style&&(o.style=l([["list-style-type"]])(o.style)||"");n.addStyle("list-style-type",z)}}j=i=h=null},falsyFilter:function(){return!1},stylesFilter:function(a,b){return function(c,d){var e=[];(c||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(c,f,g){f=f.toLowerCase(),"font-family"==f&&(g=g.replace(/["']/g,""));for(var h,i,j,k=0;k<a.length;k++)if(a[k]&&(c=a[k][0],h=a[k][1],i=a[k][2],j=a[k][3],f.match(c)&&(!h||g.match(h)))){f=j||f,b&&(i=i||g),"function"==typeof i&&(i=i(g,d,f)),i&&i.push&&(f=i[0],i=i[1]),"string"==typeof i&&e.push([f,i]);return}!b&&e.push([f,g])});for(var f=0;f<e.length;f++)e[f]=e[f].join(":");return e.length?e.join(";")+";":!1}},elementMigrateFilter:function(a,b){return a?function(c){var d=b?(new CKEDITOR.style(a,b))._.definition:a;c.name=d.element,CKEDITOR.tools.extend(c.attributes,CKEDITOR.tools.clone(d.attributes)),c.addStyle(CKEDITOR.style.getStyleText(d)),d.attributes&&d.attributes["class"]&&(c.classWhiteList=" "+d.attributes["class"]+" ")}:function(){}},styleMigrateFilter:function(a,b){var c=this.elementMigrateFilter;return a?function(d,e){var f=new CKEDITOR.htmlParser.element(null),g={};g[b]=d,c(a,g)(f),f.children=e.children,e.children=[f],f.filter=function(){},f.parent=e}:function(){}},bogusAttrFilter:function(a,b){if(-1==b.name.indexOf("cke:"))return!1},applyStyleFilter:null},getRules:function(a,b){var c=CKEDITOR.dtd,d=CKEDITOR.tools.extend({},c.$block,c.$listItem,c.$tableContent),f=a.config,g=this.filters,h=g.falsyFilter,i=g.stylesFilter,j=g.elementMigrateFilter,k=CKEDITOR.tools.bind(this.filters.styleMigrateFilter,this.filters),l=this.utils.createListBulletMarker,m=g.flattenList,n=g.assembleList,o=this.utils.isListBulletIndicator,p=this.utils.isContainingOnlySpaces,q=this.utils.resolveList,r=function(a){return a=CKEDITOR.tools.convertToPx(a),isNaN(a)?a:a+"px"},s=this.utils.getStyleComponents,t=this.utils.listDtdParents,u=!1!==f.pasteFromWordRemoveFontStyles,v=!1!==f.pasteFromWordRemoveStyles;return{elementNames:[[/meta|link|script/,""]],root:function(a){a.filterChildren(b),n(a)},elements:{"^":function(a){var b;CKEDITOR.env.gecko&&(b=g.applyStyleFilter)&&b(a)},$:function(a){var e=a.name||"",g=a.attributes;e in d&&g.style&&(g.style=i([[/^(:?width|height)$/,null,r]])(g.style)||"");if(e.match(/h\d/)){a.filterChildren(b);if(q(a))return;j(f["format_"+e])(a)}else if(e in c.$inline)a.filterChildren(b),p(a)&&delete a.name;else if(-1!=e.indexOf(":")&&-1==e.indexOf("cke")){a.filterChildren(b);if("v:imagedata"==e){if(e=a.attributes["o:href"])a.attributes.src=e;a.name="img";return}delete a.name}e in t&&(a.filterChildren(b),n(a))},style:function(a){if(CKEDITOR.env.gecko){a=(a=a.onlyChild().value.match(/\/\* Style Definitions \*\/([\s\S]*?)\/\*/))&&a[1];var b={};a&&(a.replace(/[\n\r]/g,"").replace(/(.+?)\{(.+?)\}/g,function(a,c,d){c=c.split(","),a=c.length;for(var e=0;e<a;e++)CKEDITOR.tools.trim(c[e]).replace(/^(\w+)(\.[\w-]+)?$/g,function(a,c,e){c=c||"*",e=e.substring(1,e.length),e.match(/MsoNormal/)||(b[c]||(b[c]={}),e?b[c][e]=d:b[c]=d)})}),g.applyStyleFilter=function(a){var c=b["*"]?"*":a.name,d=a.attributes&&a.attributes["class"];c in b&&(c=b[c],"object"==typeof c&&(c=c[d]),c&&a.addStyle(c,!0))})}return!1},p:function(a){if(/MsoListParagraph/i.exec(a.attributes["class"])||a.getStyle("mso-list")&&!a.getStyle("mso-list").match(/^(none|skip)$/i)){var c=a.firstChild(function(a){return a.type==CKEDITOR.NODE_TEXT&&!p(a.parent)});(c=c&&c.parent)&&c.addStyle("mso-list","Ignore")}a.filterChildren(b),q(a)||(f.enterMode==CKEDITOR.ENTER_BR?(delete a.name,a.add(new CKEDITOR.htmlParser.element("br"))):j(f["format_"+(f.enterMode==CKEDITOR.ENTER_P?"p":"div")])(a))},div:function(a){var b=a.onlyChild();if(b&&"table"==b.name){var c=a.attributes;b.attributes=CKEDITOR.tools.extend(b.attributes,c),c.style&&b.addStyle(c.style),b=new CKEDITOR.htmlParser.element("div"),b.addStyle("clear","both"),a.add(b),delete a.name}},td:function(a){a.getAncestor("thead")&&(a.name="th")},ol:m,ul:m,dl:m,font:function(a){if(o(a.parent))delete a.name;else{a.filterChildren(b);var c=a.attributes,d=c.style,e=a.parent;"font"==e.name?(CKEDITOR.tools.extend(e.attributes,a.attributes),d&&e.addStyle(d),delete a.name):(d=(d||"").split(";"),c.color&&("#000000"!=c.color&&d.push("color:"+c.color),delete c.color),c.face&&(d.push("font-family:"+c.face),delete c.face),c.size&&(d.push("font-size:"+(3<c.size?"large":3>c.size?"small":"medium")),delete c.size),a.name="span",a.addStyle(d.join(";")))}},span:function(a){if(o(a.parent))return!1;a.filterChildren(b);if(p(a))return delete a.name,null;if(o(a)){var c=a.firstChild(function(a){return a.value||"img"==a.name}),d=(c=c&&(c.value||"l."))&&c.match(/^(?:[(]?)([^\s]+?)([.)]?)$/);if(d)return c=l(d,c),(a=a.getAncestor("span"))&&/ mso-hide:\s*all|display:\s*none /.test(a.attributes.style)&&(c.attributes["cke:ignored"]=1),c}if(d=(c=a.attributes)&&c.style)c.style=i([["line-height"],[/^font-family$/,null,u?null:k(f.font_style,"family")],[/^font-size$/,null,u?null:k(f.fontSize_style,"size")],[/^color$/,null,u?null:k(f.colorButton_foreStyle,"color")],[/^background-color$/,null,u?null:k(f.colorButton_backStyle,"color")]])(d,a)||"";return c.style||delete c.style,CKEDITOR.tools.isEmpty(c)&&delete a.name,null},b:j(f.coreStyles_bold),i:j(f.coreStyles_italic),u:j(f.coreStyles_underline),s:j(f.coreStyles_strike),sup:j(f.coreStyles_superscript),sub:j(f.coreStyles_subscript),a:function(a){var b=a.attributes;b.name&&b.name.match(/ole_link\d+/i)?delete a.name:b.href&&b.href.match(/^file:\/\/\/[\S]+#/i)&&(b.href=b.href.replace(/^file:\/\/\/[^#]+/i,""))},"cke:listbullet":function(a){a.getAncestor(/h\d/)&&!f.pasteFromWordNumberedHeadingToList&&delete a.name}},attributeNames:[[/^onmouse(:?out|over)/,""],[/^onload$/,""],[/(?:v|o):\w+/,""],[/^lang/,""]],attributes:{style:i(v?[[/^list-style-type$/,null],[/^margin$|^margin-(?!bottom|top)/,null,function(a,b,c){if(b.name in{p:1,div:1}){b="ltr"==f.contentsLangDirection?"margin-left":"margin-right";if("margin"==c)a=s(c,a,[b])[b];else if(c!=b)return null;if(a&&!e.test(a))return[b,a]}return null}],[/^clear$/],[/^border.*|margin.*|vertical-align|float$/,null,function(a,b){if("img"==b.name)return a}],[/^width|height$/,null,function(a,b){if(b.name in{table:1,td:1,th:1,img:1})return a}]]:[[/^mso-/],[/-color$/,null,function(a){if("transparent"==a)return!1;if(CKEDITOR.env.gecko)return a.replace(/-moz-use-text-color/g,"transparent")}],[/^margin$/,e],["text-indent","0cm"],["page-break-before"],["tab-stops"],["display","none"],u?[/font-?/]:null],v),width:function(a,b){if(b.name in c.$tableContent)return!1},border:function(a,b){if(b.name in c.$tableContent)return!1},"class":function(a,b){return b.classWhiteList&&-1!=b.classWhiteList.indexOf(" "+a+" ")?a:!1},bgcolor:h,valign:v?h:function(a,b){return b.addStyle("vertical-align",a),!1}},comment:CKEDITOR.env.ie?h:function(a,b){var c=a.match(/<img.*?>/),d=a.match(/^\[if !supportLists\]([\s\S]*?)\[endif\]$/);return d?(d=(c=d[1]||c&&"l.")&&c.match(/>(?:[(]?)([^\s]+?)([.)]?)</),l(d,c)):CKEDITOR.env.gecko&&c?(c=CKEDITOR.htmlParser.fragment.fromHtml(c[0]).children[0],(d=(d=(d=b.previous)&&d.value.match(/<v:imagedata[^>]*o:href=['"](.*?)['"]/))&&d[1])&&(c.attributes.src=d),c):!1}}}},l=function(){this.dataFilter=new CKEDITOR.htmlParser.filter};l.prototype={toHtml:function(a){a=CKEDITOR.htmlParser.fragment.fromHtml(a);var b=new CKEDITOR.htmlParser.basicWriter;return a.writeHtml(b,this.dataFilter),b.getHtml(!0)}},CKEDITOR.cleanWord=function(a,b){a=a.replace(/<!\[([^\]]*?)\]>/g,"<!--[$1]-->"),CKEDITOR.env.gecko&&(a=a.replace(/(\x3c!--\[if[^<]*?\])--\x3e([\S\s]*?)\x3c!--(\[endif\]--\x3e)/gi,"$1$2$3")),CKEDITOR.env.webkit&&(a=a.replace(/(class="MsoListParagraph[^>]+>\x3c!--\[if !supportLists\]--\x3e)([^<]+<span[^<]+<\/span>)(\x3c!--\[endif\]--\x3e)/gi,"$1<span>$2</span>$3"));var c=new l,d=c.dataFilter;d.addRules(CKEDITOR.plugins.pastefromword.getRules(b,d)),b.fire("beforeCleanWord",{filter:d});try{a=c.toHtml(a)}catch(e){b.showNotification(b.lang.pastefromword.error)}return a=a.replace(/cke:.*?".*?"/g,""),a=a.replace(/style=""/g,""),a=a.replace(/<span>/g,"")}})()