CKEDITOR.dialog.add("anchor",function(a){function b(a,b){return a.createFakeElement(a.document.createElement("a",{attributes:b}),"cke_anchor","anchor")}return{title:a.lang.link.anchor.title,minWidth:300,minHeight:60,onOk:function(){var e=CKEDITOR.tools.trim(this.getValueOf("info","txtName")),e={id:e,name:e,"data-cke-saved-name":e};if(this._.selectedElement)this._.selectedElement.data("cke-realelement")?(e=b(a,e),e.replace(this._.selectedElement),CKEDITOR.env.ie&&a.getSelection().selectElement(e)):this._.selectedElement.setAttributes(e);else{var f=a.getSelection(),f=f&&f.getRanges()[0];f.collapsed?(e=b(a,e),f.insertNode(e)):(CKEDITOR.env.ie&&9>CKEDITOR.env.version&&(e["class"]="cke_anchor"),e=new CKEDITOR.style({element:"a",attributes:e}),e.type=CKEDITOR.STYLE_INLINE,a.applyStyle(e))}},onHide:function(){delete this._.selectedElement},onShow:function(){var b=a.getSelection(),d=b.getSelectedElement(),e=d&&d.data("cke-realelement"),f=e?CKEDITOR.plugins.link.tryRestoreFakeAnchor(a,d):CKEDITOR.plugins.link.getSelectedLink(a);if(f){this._.selectedElement=f;var g=f.data("cke-saved-name");this.setValueOf("info","txtName",g||""),!e&&b.selectElement(f),d&&(this._.selectedElement=d)}this.getContentElement("info","txtName").focus()},contents:[{id:"info",label:a.lang.link.anchor.title,accessKey:"I",elements:[{type:"text",id:"txtName",label:a.lang.link.anchor.name,required:!0,validate:function(){return this.getValue()?!0:(alert(a.lang.link.anchor.errorName),!1)}}]}]}})